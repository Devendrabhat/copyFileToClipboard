/* module-key = 'com.onresolve.jira.groovy.groovyrunner:userMessageUtil', location = 'js/userMessageRenderer.js' */
(function(c){AJS.toInit(function(){var a=function(a,d,e){AJS.$.get(AJS.params.baseURL+"/rest/scriptrunner/1.0/message",{},function(a){a=a||{};c.each(a,function(a,b){"undefined"!=typeof b&&JIRA.Messages.showMsg(a,{type:JIRA.Messages.Types[b.type],closeable:b.closeable})})})};JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,a);a(null,null,null)})})(AJS.$);
/* module-key = 'com.onresolve.jira.groovy.groovyrunner:bh-issuePluginResources', location = 'js/jquery.tools.min.js' */
/*
 * jQuery Tools 1.2.5 - The missing UI library for the Web
 * 
 * [overlay, toolbox.expose]
 * 
 * NO COPYRIGHTS OR LICENSES. DO WHAT YOU LIKE.
 * 
 * http://flowplayer.org/tools/
 * 
 * File generated: Mon Nov 29 13:12:11 GMT 2010
 */
(function(a){function t(d,b){var c=this,j=d.add(c),o=a(window),k,f,m,g=a.tools.expose&&(b.mask||b.expose),n=Math.random().toString().slice(10);if(g){if(typeof g=="string")g={color:g};g.closeOnClick=g.closeOnEsc=false}var p=b.target||d.attr("rel");f=p?a(p):d;if(!f.length)throw"Could not find Overlay: "+p;d&&d.index(f)==-1&&d.click(function(e){c.load(e);return e.preventDefault()});a.extend(c,{load:function(e){if(c.isOpened())return c;var h=q[b.effect];if(!h)throw'Overlay: cannot find effect : "'+b.effect+
'"';b.oneInstance&&a.each(s,function(){this.close(e)});e=e||a.Event();e.type="onBeforeLoad";j.trigger(e);if(e.isDefaultPrevented())return c;m=true;g&&a(f).expose(g);var i=b.top,r=b.left,u=f.outerWidth({margin:true}),v=f.outerHeight({margin:true});if(typeof i=="string")i=i=="center"?Math.max((o.height()-v)/2,0):parseInt(i,10)/100*o.height();if(r=="center")r=Math.max((o.width()-u)/2,0);h[0].call(c,{top:i,left:r},function(){if(m){e.type="onLoad";j.trigger(e)}});g&&b.closeOnClick&&a.mask.getMask().one("click",
c.close);b.closeOnClick&&a(document).bind("click."+n,function(l){a(l.target).parents(f).length||c.close(l)});b.closeOnEsc&&a(document).bind("keydown."+n,function(l){l.keyCode==27&&c.close(l)});return c},close:function(e){if(!c.isOpened())return c;e=e||a.Event();e.type="onBeforeClose";j.trigger(e);if(!e.isDefaultPrevented()){m=false;q[b.effect][1].call(c,function(){e.type="onClose";j.trigger(e)});a(document).unbind("click."+n).unbind("keydown."+n);g&&a.mask.close();return c}},getOverlay:function(){return f},
getTrigger:function(){return d},getClosers:function(){return k},isOpened:function(){return m},getConf:function(){return b}});a.each("onBeforeLoad,onStart,onLoad,onBeforeClose,onClose".split(","),function(e,h){a.isFunction(b[h])&&a(c).bind(h,b[h]);c[h]=function(i){i&&a(c).bind(h,i);return c}});k=f.find(b.close||".close");if(!k.length&&!b.close){k=a('<a class="close"></a>');f.prepend(k)}k.click(function(e){c.close(e)});b.load&&c.load()}a.tools=a.tools||{version:"1.2.5"};a.tools.overlay={addEffect:function(d,
b,c){q[d]=[b,c]},conf:{close:null,closeOnClick:true,closeOnEsc:true,closeSpeed:"fast",effect:"default",fixed:!a.browser.msie||a.browser.version>6,left:"center",load:false,mask:null,oneInstance:true,speed:"normal",target:null,top:"10%"}};var s=[],q={};a.tools.overlay.addEffect("default",function(d,b){var c=this.getConf(),j=a(window);if(!c.fixed){d.top+=j.scrollTop();d.left+=j.scrollLeft()}d.position=c.fixed?"fixed":"absolute";this.getOverlay().css(d).fadeIn(c.speed,b)},function(d){this.getOverlay().fadeOut(this.getConf().closeSpeed,
d)});a.fn.overlay=function(d){var b=this.data("overlay");if(b)return b;if(a.isFunction(d))d={onBeforeLoad:d};d=a.extend(true,{},a.tools.overlay.conf,d);this.each(function(){b=new t(a(this),d);s.push(b);a(this).data("overlay",b)});return d.api?b:this}})(jQuery);
(function(b){function k(){if(b.browser.msie){var a=b(document).height(),d=b(window).height();return[window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,a-d<20?d:a]}return[b(document).width(),b(document).height()]}function h(a){if(a)return a.call(b.mask)}b.tools=b.tools||{version:"1.2.5"};var l;l=b.tools.expose={conf:{maskId:"exposeMask",loadSpeed:"slow",closeSpeed:"fast",closeOnClick:true,closeOnEsc:true,zIndex:9998,opacity:0.8,startOpacity:0,color:"#fff",onLoad:null,
onClose:null}};var c,i,e,g,j;b.mask={load:function(a,d){if(e)return this;if(typeof a=="string")a={color:a};a=a||g;g=a=b.extend(b.extend({},l.conf),a);c=b("#"+a.maskId);if(!c.length){c=b("<div/>").attr("id",a.maskId);b("body").append(c)}var m=k();c.css({position:"absolute",top:0,left:0,width:m[0],height:m[1],display:"none",opacity:a.startOpacity,zIndex:a.zIndex});a.color&&c.css("backgroundColor",a.color);if(h(a.onBeforeLoad)===false)return this;a.closeOnEsc&&b(document).bind("keydown.mask",function(f){f.keyCode==
27&&b.mask.close(f)});a.closeOnClick&&c.bind("click.mask",function(f){b.mask.close(f)});b(window).bind("resize.mask",function(){b.mask.fit()});if(d&&d.length){j=d.eq(0).css("zIndex");b.each(d,function(){var f=b(this);/relative|absolute|fixed/i.test(f.css("position"))||f.css("position","relative")});i=d.css({zIndex:Math.max(a.zIndex+1,j=="auto"?0:j)})}c.css({display:"block"}).fadeTo(a.loadSpeed,a.opacity,function(){b.mask.fit();h(a.onLoad);e="full"});e=true;return this},close:function(){if(e){if(h(g.onBeforeClose)===
false)return this;c.fadeOut(g.closeSpeed,function(){h(g.onClose);i&&i.css({zIndex:j});e=false});b(document).unbind("keydown.mask");c.unbind("click.mask");b(window).unbind("resize.mask")}return this},fit:function(){if(e){var a=k();c.css({width:a[0],height:a[1]})}},getMask:function(){return c},isLoaded:function(a){return a?e=="full":e},getConf:function(){return g},getExposed:function(){return i}};b.fn.mask=function(a){b.mask.load(a);return this};b.fn.expose=function(a){b.mask.load(a,this);return this}})(jQuery);

/* module-key = 'com.onresolve.jira.groovy.groovyrunner:bh-issuePluginResources', location = 'js/clientvaljq.js' */
var JBHV={};
(function(h){function q(a){return-1<AJS.$.inArray(a,"com.atlassian.jira.plugin.system.customfieldtypes:userpicker;com.atlassian.jira.issue.fields.DueDateSystemField;com.atlassian.jira.plugin.system.customfieldtypes:datepicker;Multi User Picker;com.atlassian.jira.issue.fields.IssueLinksSystemField;com.atlassian.jira.plugin.system.customfieldtypes:grouppicker;com.atlassian.jira.plugin.system.customfieldtypes:multigrouppicker;com.atlassian.jira.plugin.system.customfieldtypes:multiversion".split(";"))}function n(a){return a instanceof
Array&&1==a.length?a[0]:a}function C(a){var b=function(b){if(AJS.$(this).is(".editable-field")||AJS.$(this).is(".editable-field \x3e *"))a.removeClass("editable-field").removeClass("inactive").addClass("uneditable"),a.find("span.aui-iconfont-edit").remove(),a.attr("title","Inline edit disabled."),a.find(".icon").remove(),a.unbind("mouseenter").unbind("mouseleave").unbind("mousemove").unbind("mouseover")};a.is(":hover")?(a.delegate("*,","mouseover",b),a.hover(b),a.mousemove(b)):a.hover(b)}function x(){var a=
[];AJS.$.each(d,function(b,e){e.allowInlineEdit||a.push(b)});try{JIRA.Issues.FocusShifter.getSuggestions=JIRA.Issues.FocusShifter.getSuggestions=function(){var b=JIRA.Issues.Api.getFieldsOnSelectedIssue();return _.chain(b.models).filter(function(b){return!(-1<AJS.$.inArray(b.id,a))}).filter(JIRA.Components.IssueEditor.Models.Field.IS_EDITABLE).filter(function(a){return"comment"!==a.id}).map(function(a){return{label:a.getLabel(),value:a.id}}).value()}}catch(b){console.log("FocusShifter wasn't ready")}AJS.$(".editable-field").each(function(){var b=
AJS.$(this).attr("id");"undefined"!=typeof b&&(b=b.replace("-val",""),-1<AJS.$.inArray(b,a)&&C(AJS.$(this)))})}function l(){for(var a in d)if(0<a.length&&"__I18N__"!=a){var b=r(AJS.$("body"),a);if(0<b.length&&q(d[a].fieldType)){null==s[a]&&(s[a]="");var c=!1;if(null!=b.val()&&null!=s[a]&&"object"==typeof b.val())try{c=b.val().join("")==s[a].join("")}catch(e){console.log("error "+a+", todo")}else c=b.val()==s[a]||null==b.val()&&""==s[a];c||(console.log("Field changed, revalidating: "+b.attr("name")+
": "+b.val()),s[a]=b.val(),b.trigger("change.jbhv"))}}}function D(a){return d.__I18N__?d.__I18N__[a]:a}function u(){AJS.$(this).attr("disabled",!0);AJS.$(this).addClass("clientreadonly")}function E(a,b,c){0<AJS.$("#"+c+"-ms").length&&(a=AJS.$("#"+c+"-ms"));c in d||(console.log("Testing... - should not see this in production"),d[c]={},d[c].fieldType="");if(t(d[c].fieldType))if(a.find("input:checkbox:checked").attr("checked",!1),"object"==typeof b&&b.length)for(var e in b)a.find("input[value\x3d'"+
b[e]+"']").attr("checked",!0);else a.find("input[value\x3d'"+b+"']").attr("checked",!0);else"commentLevel"==a.attr("name")?(a.find("option").removeAttr("selected"),a.find("option[value\x3d'"+b+"']").attr("selected","selected"),c=""===b?AJS.params.securityLevelViewableByAll:AJS.params.securityLevelViewableRestrictedTo,a.parent().find(".current-level").html(AJS.format(c,a.find("option:selected").html()))):a.hasClass("single-user-picker")?AJS.$.get(AJS.params.baseURL+"/rest/api/1.0/users/picker.json",
{showAvatar:!0,query:b},function(c){if(""===b)a.find("option").removeAttr("selected");else{c=JIRA.UserPickerUtil.formatResponse(c)[0].properties.items[0];if("undefined"===typeof c){console.warn("Failed to find user: ",b);return}a.find("option").removeAttr("selected");a.find("optgroup:first").append(AJS.$("\x3coption/\x3e",{selected:"selected","class":"current-user","data-field-text":c.properties.label,value:b,style:"background-image: url("+c.properties.icon+")"}).html(c.properties.label))}a.parent().find("div.aui-ss").remove();
a.removeData("aui-ss");AJS.$(document).trigger(JIRA.Events.NEW_CONTENT_ADDED,[a.parent(),"pageLoad"])}):"comment"==a.attr("name")?a.is(":visible")&&a.val(b):a.hasClass("multi-select-select")?(console.log("set value to : ",b),"[object Array]"!==Object.prototype.toString.call(b)&&(b=[b]),H(a,b)):a.hasClass("aui-ss-select")?a.trigger("set-selection-value",b):a.val(b)}function I(a){var b;if(0<a.find(":radio").length)a.find(":radio").each(u);else if(0<a.find(":checkbox").length)a.find(":checkbox").each(u);
else{b="issuelinks-issues"==a.attr("name")?"issuelinks":a.attr("name");b in d||(console.log("Testing... - should not see this in production"),d[b]={},d[b].fieldType="");if(a.hasClass("cascadingselect-parent"))a.parent().find("select").each(u);else if("com.atlassian.jira.plugin.system.customfieldtypes:userpicker"==d[b].fieldType||"com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker"==d[b].fieldType)AJS.$("#"+b).parent().find("a").each(function(){AJS.$(this).attr("style","display: none")});
else if(a.hasClass("aui-ss-select"))a=a.parent().find("input.aui-ss-field"),u(a),a.parent().find("span.drop-menu").hide();else if(a.hasClass("multi-select-select")){console.log("special treatment for multi select fields");var c=a.parent();AJS.$.each(["textarea","select"],function(a,b){c.find(b).addClass("clientreadonly");c.find(b).attr("disabled",!0)});c.find("span.drop-menu").hide();c.find("a.issue-picker-popup").hide();c.find("em").hide()}else a.parent().is("div.aui-field-datepicker")?AJS.$("#"+
b).parent().find("a").hide():"commentLevel"==b&&(AJS.$("#commentLevel-multi-select \x3e a.drop").find("span:first").removeClass("icon-unlocked").addClass("icon-locked"),AJS.$("#commentLevel-multi-select a span").removeClass("drop-menu"),AJS.$("#commentLevel-multi-select a.drop").unbind("click"));"com.atlassian.jira.issue.fields.AssigneeSystemField"==d[b].fieldType&&AJS.$("#"+b).parent().find("a").hide();a.each(u)}}function v(){AJS.$(this).attr("title","");AJS.$(this).attr("disabled",!1);AJS.$(this).removeClass("clientreadonly")}
function F(a){var b;if(0<a.find(":radio").length)a.find(":radio").each(v);else if(0<a.find(":checkbox").length)a.find(":checkbox").each(v);else{b="issuelinks-issues"==a.attr("name")?"issuelinks":a.attr("name");if(a.hasClass("cascadingselect-parent"))a.parent().find("select").each(v);else if("User Picker"==d[b].fieldType||"Multi User Picker"==d[b].fieldType)AJS.$("#"+b).parent().find("a").each(function(){AJS.$(this).attr("style","")});else if(a.hasClass("aui-ss-select"))a=a.parent().find("input.aui-ss-field"),
v(a),a.parent().find("span.drop-menu").show();else if(a.hasClass("multi-select-select")){var c=a.parent();AJS.$.each(["textarea","select"],function(a,b){c.find(b).removeClass("clientreadonly");c.find(b).attr("disabled",!1)});c.find("span.drop-menu").show();c.find("a.issue-picker-popup").show();c.find("em").show()}else a.parent().is("div.aui-field-datepicker")&&AJS.$("#"+b).parent().find("a").show();"com.atlassian.jira.issue.fields.AssigneeSystemField"==d[b].fieldType&&AJS.$("#"+b).parent().find("a").show();
a.each(v)}}function y(a){return 0<z.serverDone?(alert("Please wait a moment for the server to finish then retry your action."),a.preventDefault(),a.stopImmediatePropagation(),!1):U(a)}function U(a){console.log("submitting form:");var b="",c;AJS.$("div.jbhverror").remove();for(var e in d)if(0<e.length&&"__I18N__"!=e){console.log("submit field: "+e);var g;t(d[e].fieldType)?g=AJS.$("input[name\x3d'"+e+"']:first"):"issuelinks"==e?k=a.data.docRoot.find("#issuelinks-issues"):g=a.data.docRoot.find("#"+e);
if(0<g.length&&""!=d[e].title&&"undefined"!=typeof d[e].title){var b=b+(d[e].displayName+": "+d[e].title+"\n\n"),f=r(a.data.docRoot,e);J(f,d[e].title);c||(c=f);k=g.closest(".tabs-pane").not(".active-pane").attr("id");"undefined"!=typeof k&&(k=AJS.$("a[href\x3d'#"+k+"'] strong"),k.addClass("tabinvalid"),k.click(function(){AJS.$(this).removeClass("tabinvalid")}))}}if(0<b.length){b=c.offset().top-jQuery(window).height()/2;console.log("Scroll to: "+b);if(c.closest("div.tabs-pane").is(".active-pane")||
"comment"==f.attr("id"))"DIV"==a.data.docRoot.prop("tagName")?(c=a.data.docRoot.find(".form-body"),c.animate({scrollTop:b+c.scrollTop()},500)):AJS.$("body").animate({scrollTop:b},500);a.preventDefault();a.stopImmediatePropagation();console.log("Behaviours: Preventing the form from being submitted");return!1}for(e in d)if(0<e.length&&"__I18N__"!=e&&d[e].readonly){console.log("submit form make writable: "+e);var k;k=t(d[e].fieldType)?AJS.$("input[name\x3d'"+e+"']").parent():AJS.$("#"+e);0<k.length&&
(console.log("makeWritable: "+e),F(k))}return!0}function m(a,b){b=AJS.$(this);var c;c=b;c=0<c.parent().find(":radio").length?c.find(":radio")[0].name:0<c.find(":checkbox").length?c.find(":checkbox")[0].name:"issuelinks-issues"==c.attr("name")?"issuelinks":c.attr("name");console.log("Validate field: "+c);!b.hasClass("select")&&b.val()?d[c].title="":b.hasClass("select")&&b.val()&&"-1"!==b.val().toString()&&""!=b.val()?d[c].title="":"select-multiple"==b.attr("type")&&null!=b.val()&&"-1"!=b.val()?d[c].title=
"":"com.atlassian.jira.plugin.system.customfieldtypes:radiobuttons"==d[c].fieldType?-1!=b.parent().find("input:radio:checked").val()?d[c].title="":(d[c].title=D("field.title.missing.value"),A(c)):"com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes"==d[c].fieldType?(console.log("validate checkboxes"),0<b.parent().find("input:checkbox:checked").length?(console.log("remove checkboxes class"),d[c].title=""):(console.log("add checkboxes class"),d[c].title=D("field.title.missing.value"),
A(c))):d[c].title=D("field.title.missing.value")}function A(a){console.log("requireField: "+a);var b=AJS.$("label[for\x3d'"+a+"']");b.length||(b=AJS.$(":input[name\x3d'"+a+"']").parent().parent().find("legend \x3e span"));b.children().size()||b.append('\x3cspan class\x3d"aui-icon icon-required"\x3e\x3c/span\x3e\x3cspan class\x3d"content"\x3eRequired\x3c/span\x3e')}function G(a){console.log("unrequireField: "+a);var b=AJS.$("label[for\x3d'"+a+"']");b.length||(b=AJS.$(":input[name\x3d'"+a+"']").parent().parent().find("legend \x3e span"));
b.children().size()&&b.children().remove()}function V(){for(var a="",b=0;8>b;b++)var c=Math.floor(61*Math.random()),a=a+"0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz".substring(c,c+1);return a}function p(a){var b=AJS.$(this),c;c=null==a.data||"undefined"==typeof a.data?a.data.closest("form"):a.data.docRoot;a=0<b.find(":radio").length?b.find(":radio")[0].name:0<b.find(":checkbox").length?b.find(":checkbox")[0].name:/:/.test(b.attr("name"))?b.attr("name").replace(/:.*/,""):b.attr("name");
var e={};e[a]=b.val();c.find("form.aui").find(":input").each(function(){var a=AJS.$(this);if(a.hasClass("multi-select-select")){var b=[];AJS.$("#"+a.attr("name")+" :selected").each(function(){b.push(AJS.$(this).val())});e[a.attr("name")]=b.join("-*-*-")}else if(a.hasClass("aui-ss-select"))e[a.attr("name")]=n(a.parent().find("select").val());else if("radio"==a.attr("type"))e[a.attr("name")]=a.parent().parent().find(":checked").val();else if("checkbox"==a.attr("type"))b=[],a.closest("fieldset").find(":checked").each(function(){b.push(AJS.$(this).val())}),
e[a.attr("name")]=b.join("-*-*-");else if(a.hasClass("cascadingselect-parent")){var c=a.parent().find("option:selected").map(function(){return AJS.$(this).val()});e[a.attr("name")]=AJS.$.makeArray(c).join("-*-*-")}else e[a.attr("name")]=a.val()});b=c.find("#project");0<b.length&&(e.pid=jQuery.isArray(b.val())?b.val()[0]:b.val());b=c.find("#issuetype");0<b.length&&(e.issuetype=jQuery.isArray(b.val())?b.val()[0]:b.val());e.__validators__=d;console.log("posting runvalidator for field: "+a+". Payload:",
e);z.serverDone++;AJS.$.post(AJS.params.baseURL+"/rest/com.onresolve.jira.plugin.Behaviours/1.0/behaviours/runvalidator.json",{fieldName:a,form:JSON.stringify(e)},function(a){B(c,a,!1)}).error(function(){console.log("Behaviours post failed.")}).complete(function(){z.serverDone--})}function r(a,b){var c;c=b in d&&t(d[b].fieldType)?a.find("input[name\x3d'"+b+"']").parent():"issuelinks"==b?a.find("#issuelinks-issues"):a.find("#"+b);c.exists()||(c=AJS.$("label[for\x3d'"+b+"']"));return c}function J(a,
b){a.parent().find("div.jbhverror").remove();var c=a.parent().find("div.error:last"),d='\x3cdiv class\x3d"error jbhverror"\x3e'+b+"\x3c/div\x3e";0<c.length?c.prepend(d):a.parent().append(d)}function W(a,b){var c=a.parent().find("div.description");c.exists()?c.empty().append(b):a.parent().append(h("\x3cdiv/\x3e",{"class":"description",html:b}))}function K(a,b,c,d){a.unbind("keyup.jbhv",m);a.unbind("change.jbhv",m);a.unbind("click",m);a.unbind("unselect.jbhv",m);a.unbind("selected.jbhv",m);"comment"==
b&&c.find(":input[name\x3d'comment']").unbind("change.jbhv",m);d&&(a.bind("click",m),"comment"==b?c.find(":input[name\x3d'comment']").bind("change.jbhv",m):a.hasClass("multi-select-select")?(a.bind("unselect.jbhv",m),a.bind("selected.jbhv",m)):(a.bind("keyup.jbhv",m),a.bind("change.jbhv",m)))}function L(a,b,c,e,g){console.log("Conversion.... to "+e);if("single-select"==e||"multi-select"==e)if(b.hasClass("aui-ss-select")||"true"==b.data("is-ms-field")||b.is(":hidden")){console.warn("Field already is a select/multiselect list");
return}if("short-text"==e)b.show(),b.removeData("is-ms-field"),AJS.$("#"+c+"-ms-multi-select").remove(),AJS.$("#"+c+"-ms-single-select").remove(),AJS.$("#"+c+"-ms").remove();else if("single-select"==e)if(b.is(".select"))new AJS.SingleSelect({element:b,itemAttrDisplayed:"label",errorMessage:"Invalid value selected"});else{var f=c+"-ms";b.after("\x3cselect id\x3d'"+f+"' name\x3d'"+f+"' class\x3d'select cf-select'\x3e\x3c/select\x3e").hide();e=AJS.$("#"+f+"");e.data("redirect-to",b.attr("id"));e.bind("change, unselect.jbhv, selected.jbhv",
function(a){var b=AJS.$(this);a=b.parent().find("#"+b.data("redirect-to"));b=AJS.$.makeArray(b.val());a.val(b.join("; "))});b=r(a,c);var k=((d||{})[c]||{}).fieldOptions;k&&w(a,e,c,d[c].fieldOptions);new AJS.SingleSelect({element:e,itemAttrDisplayed:"label",errorMessage:"Invalid value selected"})}else if("multi-select"==e)if(b.is(".select"))new AJS.MultiSelect({element:b,itemAttrDisplayed:"label",errorMessage:"Invalid value selected"});else{f=c+"-ms";b.after("\x3cselect id\x3d'"+f+"' name\x3d'"+f+
"' class\x3d'select cf-select' multiple\x3d'multiple'\x3e\x3c/select\x3e").hide();e=AJS.$("#"+f+"");b.data("is-ms-field","true");e.bind("change, unselect.jbhv, selected.jbhv",function(a){var b=AJS.$(this);a=b.parent().find("#"+b.data("redirect-to"));b=AJS.$.makeArray(b.val());a.val(b.join("; "))});b=r(a,c);(k=((d||{})[c]||{}).fieldOptions)&&w(a,e,c,d[c].fieldOptions);if(!(b.val()instanceof Array||_.isEmpty(b.val()))){var k=b.val().split("; "),M={};_.each(k,function(a){M[a]=a});w(a,e,c,M);E(e,k,f)}a=
{element:e,itemAttrDisplayed:"label",errorMessage:"Invalid value selected"};AJS.$.isEmptyObject(g)||("issue"==g.ajaxOptions.formatResponse?g.ajaxOptions.formatResponse=JBHV.IssuePickerUtil.formatResponse:"general"==g.ajaxOptions.formatResponse&&(g.ajaxOptions.formatResponse=JBHV.GeneralPickerUtil.formatResponse));g=g||{};new AJS.MultiSelect(AJS.$.extend(a,g));e.data("redirect-to",b.attr("id"))}else log.warn("Not supported")}function N(a,b){a.parent().find("div.representation").find("span.value-text:contains('"+
b+"')").closest("li").find("em.item-delete").click()}function O(a,b){a.is(".multi-select-select,.aui-ss-select")?a.find("option").each(function(c,d){var g=h(d).data("descriptor");g.value()==b&&(console.log("removing item",g.label()),N(a,g.label()))}):a.parent().find("div.representation").find("option").filter(function(a){return AJS.$(this).val()==b}).remove()}function X(a){return a.find("option").map(function(){return AJS.$(this).val()}).get()}function P(a,b){var c=jQuery.grep(a.find("option"),function(a,
c){return h(a).data("descriptor").value()==b});c.length?a.trigger("selectOption",c):console.warn(AJS.format("Could not add invalid option {0} to ${1}",b,a.selector))}function Q(a,b){var c=h.map(b,function(a,b){return b}),d=!1,g=X(a),f=_(g).difference(c);h.each(f,function(b,c){d=a.val()?-1<a.val().indexOf(c):!1;O(a,c);a.find("option[value\x3d'"+c+"']").remove()});c=_(c).difference(g);h.each(c,function(c,d){a.append(h("\x3coption/\x3e",{text:b[d],value:d}))});a.hasClass("aui-ss-select")&&d&&(console.log("in array"),
(c=a.find("option:first"))&&a.val(c.val()));a.trigger("reset")}function H(a,b){b=b.map(function(a){return String(a)});h.each(b,function(b,d){P(a,d)});_.each(_(a.val()).difference(b),function(b){O(a,b)})}function w(a,b,c,d){b=a.find("#"+c+"-ms").length?a.find("#"+c+"-ms"):a.find("#"+c);Q(b,d)}function B(a,b,c){console.log("Adding listeners: ");console.log(b);if(null!=b){var e=!1,g=AJS.$.extend(!0,{},d);d=b;console.log("Setting timeout for disabling inline edit");setTimeout(x,100);for(var f in d)if(0<
f.length){var k=d[f];b=r(a,f);if(0<b.length){if(console.log("field: "+f),"undefined"!=typeof k){q(d[f].fieldType)&&(e=!0);"true"==d[f].required?(console.log("Make required: "+f),K(b,f,a,!0),A(f),b.trigger("click")):"false"==d[f].required&&(d[f].title="",K(b,f,a,!1),G(f));"undefined"!=typeof d[f].helpText&&J(b,d[f].helpText);"undefined"!=typeof d[f].description&&W(b,d[f].description);"server"==d[f].validator&&(t(k.fieldType)?(b.find("input").unbind("change.jbhv",p).bind("change.jbhv",{docRoot:a},p),
c&&b.find("input:checked").trigger("change.jbhv")):R(k.fieldType)?(console.log("add select fns"),b.parent().find("select").unbind("change.jbhv",p).bind("change.jbhv",{docRoot:a},p)):b.hasClass("multi-select-select")?(b.unbind("unselect.jbhv").bind("unselect.jbhv",{docRoot:a},p),b.unbind("selected.jbhv").bind("selected.jbhv",{docRoot:a},p),c&&b.trigger("selected.jbhv")):(b.unbind("change.jbhv",p).bind("change.jbhv",{docRoot:a},p),c&&(/^(?:com.valiantys.jira.plugins.sql.customfield)$/.test(d[f].fieldType)||
b.trigger("change.jbhv"))));"undefined"!=typeof d[f].label&&b.parent().find("label[for\x3d'"+f+"'").empty().html(d[f].label);"true"==d[f].readonly?(console.log("Make readonly: "+f),I(b)):"false"==d[f].readonly&&F(b);if("undefined"!=typeof d[f].overlay){k=d[f].overlay;console.log(k);var h=V();console.log("overlay id: "+h);AJS.$("body").append('\x3cdiv class\x3d"simple_overlay" id\x3d"'+h+'" ;"\x3e'+k+"\x3c/div\x3e");AJS.$("#"+h).overlay({expose:{color:"#333",loadSpeed:200,opacity:0.9},api:!0}).load()}"true"==
d[f].hidden?(b.closest("fieldset.group").hide(),b.closest("div.field-group").hide()):"false"==d[f].hidden&&(b.closest("fieldset.group").show(),b.closest("div.field-group").show());"undefined"!=typeof d[f].convertTo&&L(a,b,f,d[f].convertTo,d[f].selectOptions||{});d[f].fieldOptions&&w(a,b,f,d[f].fieldOptions);k=d[f].setValue;"undefined"!=typeof k&&E(b,k,f);b="assignee"==f||"priority"==f?a.find("#"+f+"-field"):b;"invalid"==d[f].validity&&b.removeClass("clientok").addClass("invalid");"valid"==d[f].validity&&
b.removeClass("invalid").addClass("clientok");""==d[f].validity&&b.removeClass("invalid").removeClass("clientok");"undefined"!=typeof d[f].errorMsg&&(d[f].title=d[f].errorMsg)}}else"__I18N__"!=f&&console.log("Field not found: "+f)}AJS.$.each(d,function(a,b){a in g?AJS.$.each(d[a],function(b,c){g[a][b]=c}):g[a]=b});d=g;c&&e&&setInterval(function(){l()},700)}}function t(a){return"com.atlassian.jira.plugin.system.customfieldtypes:radiobuttons"==a||"com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes"==
a}function R(a){return"com.atlassian.jira.plugin.system.customfieldtypes:cascadingselect"==a}function Y(a,b,c,d){a.unbind(b,c);a.bind(b,d,c);c=a.data("events")[b];c.unshift(c.pop());a.data("events")[b]=c}function S(){console.log("[behaviors] new content added, clearing outstanding errors...");for(var a in d)if(!(0>=a.length||"__I18N__"==a)){var b=r(AJS.$("body"),a);0>=b.length||(console.log("behaviors] clearing conditions on: "+a),b.parent().find("div.jbhverror").remove(),d[a].helpText="",d[a].title=
"",G(a),t(d[a].fieldType)?b.find("input").unbind("click.jbhv",p):R(d[a].fieldType)?b.parent().find("select").unbind("change.jbhv",p):b.unbind("change.jbhv",p))}l()}var d={},z=[];z.serverDone=0;h.fn.exists=function(){return 0!==this.length};var s=[];"undefined"==typeof console&&(console={log:function(){},trace:function(){},warn:function(){}});var T=function(a,b,c){a=!1;c||(a=!0);"HEADER"==b.prop("tagName")&&"stalker"==b.attr("id")&&(b=AJS.$(document),a=!0);a||!c||c!=JIRA.CONTENT_ADDED_REASON.dialogReady&&
c!=JIRA.CONTENT_ADDED_REASON.pageLoad||(a=!0);if(a){S();d=[];c=n(b.find("input[name\x3d'action']").val());a=n(b.find("#project,input[name\x3dpid]").val());var e=n(b.find("#issuetype,input[name\x3dissuetype]").val()),g=n(b.find("input[name\x3did]").val());b.find("form#issue-create,form#issue-workflow-transition,form#assign-issue,input[type\x3d'hidden'][name\x3d'id'],div.issue-setup-fields").length&&("undefined"!=typeof g?AJS.$.get(AJS.params.baseURL+"/rest/com.onresolve.jira.plugin.Behaviours/1.0/behaviours/validators.json",
{issueId:g,actionId:c},function(a){B(b,a,!0)}):"undefined"!=typeof a&&"undefined"!=typeof e&&AJS.$.get(AJS.params.baseURL+"/rest/com.onresolve.jira.plugin.Behaviours/1.0/behaviours/validatorsByPid.json",{pid:a,issueTypeId:e,actionId:c},function(a){B(b,a,!0)}),Y(b.find("form#issue-create,form#issue-workflow-transition,form#assign-issue,input[type\x3d'hidden'][name\x3d'id'],div.issue-setup-fields").closest("form"),"submit",y,{docRoot:b}))}};AJS.$(document).ready(function(){AJS.$.each(["#key-val","form[id\x3d'issue-workflow-transition']",
"#issue-create","form[id\x3d'issue-edit']","form[id\x3d'subtask-create-details']"],function(a,b){AJS.$(b).unbind("submit",y).bind("submit",{docRoot:AJS.$("body")},y)});T(null,AJS.$(document),null);JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,T)});JBHV.setFieldValue=E;JBHV.findFieldForId=r;JBHV.makeWritable=F;JBHV.makeReadOnly=I;JBHV.setBehaviours=function(a){d=a};JBHV.requireField=A;JBHV.unRequireField=G;JBHV.setFieldOptions=w;JBHV.convertToType=L;JBHV.submitForm=y;JBHV.addFieldListeners=B;JBHV.setMultiSelectListValue=
H;JBHV.addMultiSelectOption=function(a,b){var c=jQuery.grep(a.find("option"),function(a,c){return h(a).data("descriptor").label()==b});c.length?a.trigger("selectOption",c):console.warn(AJS.format("Could not add invalid option {0} to ${1}",b,a.selector))};JBHV.syncOptions=Q;JBHV.getAvailableOptions=function(a){return a.find("option").map(function(){return AJS.$(this).text().trim()}).get()};JBHV.getSelectedOptions=function(a){return a.find("option:selected").map(function(){return AJS.$(this).text().trim()}).get()};
JBHV.removeMultiSelectOption=N;JBHV.addMultiSelectOptionById=P;JBHV.clearAllBehaviours=S})(AJS.$);
(function(h){JBHV.GeneralPickerUtil={formatResponse:function(q){var n=[];h(q).each(function(q,x){var l=new AJS.GroupDescriptor({weight:q,label:x.footer});h(x.items).each(function(){l.addItem(new AJS.ItemDescriptor({value:this.value,label:this.label,html:this.html,icon:this.icon,allowDuplicate:!1,highlighted:!0}))});n.push(l)});return n}};JBHV.IssuePickerUtil={formatResponse:function(h){var n=[],C=function(){var h=parseUri(window.location);return h.protocol+"://"+h.authority}();h&&h.sections&&jQuery(h.sections).each(function(h,
l){console.log("section",l);if("cs"===l.id){var q=new AJS.GroupDescriptor({weight:h,label:l.label,description:l.sub});l.issues&&0<l.issues.length&&jQuery(l.issues).each(function(){q.addItem(new AJS.ItemDescriptor({highlighted:!0,value:this.key,label:this.key+" - "+this.summaryText,icon:this.img?C+contextPath+this.img:null,html:this.keyHtml+" - "+this.summary}))});n.push(q)}});return n}}})(AJS.$);
