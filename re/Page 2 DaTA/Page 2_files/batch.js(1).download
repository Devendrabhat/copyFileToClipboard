/* module-key = 'jira.webresources:autocomplete', location = '/includes/jira/dropdown/Dropdown.js' */
JIRA.Dropdown=function(){var instances=[];return{addInstance:function(){instances.push(this)},hideInstances:function(){var that=this;jQuery(instances).each(function(){if(that!==this){this.hideDropdown()}})},getHash:function(){if(!this.hash){this.hash={container:this.dropdown,hide:this.hideDropdown,show:this.displayDropdown}}return this.hash},displayDropdown:function(){if(JIRA.Dropdown.current===this){return }this.hideInstances();JIRA.Dropdown.current=this;this.dropdown.css({display:"block"});this.displayed=true;var dd=this.dropdown;if(window.top.JIRA&&!window.top.JIRA.Dialog.current){setTimeout(function(){var win=jQuery(window);var minScrollTop=dd.offset().top+dd.prop("offsetHeight")-win.height()+10;if(win.scrollTop()<minScrollTop){jQuery("html,body").animate({scrollTop:minScrollTop},300,"linear")}},100)}},hideDropdown:function(){if(this.displayed===false){return }JIRA.Dropdown.current=null;this.dropdown.css({display:"none"});this.displayed=false},init:function(trigger,dropdown){var that=this;this.addInstance(this);this.dropdown=jQuery(dropdown);this.dropdown.css({display:"none"});jQuery(document).keydown(function(e){if(e.keyCode===9){that.hideDropdown()}});if(trigger.target){jQuery.aop.before(trigger,function(){if(!that.displayed){that.displayDropdown()}})}else{that.dropdown.css("top",jQuery(trigger).outerHeight()+"px");trigger.click(function(e){if(!that.displayed){that.displayDropdown();e.stopPropagation()}else{that.hideDropdown()}e.preventDefault()})}jQuery(document.body).click(function(){if(that.displayed){that.hideDropdown()}})}}}();JIRA.Dropdown.Standard=function(trigger,dropdown){var that=begetObject(JIRA.Dropdown);that.init(trigger,dropdown);return that};JIRA.Dropdown.AutoComplete=function(trigger,dropdown){var that=begetObject(JIRA.Dropdown);that.init=function(trigger,dropdown){this.addInstance(this);this.dropdown=jQuery(dropdown).click(function(e){e.stopPropagation()});this.dropdown.css({display:"none"});if(trigger.target){jQuery.aop.before(trigger,function(){if(!that.displayed){that.displayDropdown()}})}else{trigger.click(function(e){if(!that.displayed){that.displayDropdown();e.stopPropagation()}})}jQuery(document.body).click(function(){if(that.displayed){that.hideDropdown()}})};that.init(trigger,dropdown);return that};AJS.namespace("jira.widget.dropdown",null,JIRA.Dropdown);
/* module-key = 'jira.webresources:autocomplete', location = '/includes/jira/autocomplete/AutoComplete.js' */
define("jira/autocomplete/autocomplete",["jira/ajs/ajax/smart-ajax","jira/util/objects","jquery"],function(SmartAjax,Objects,jQuery){return function(){var inFocus;var delay=function(callback,l){if(delay.t){clearTimeout(delay.t);delay.t=undefined}delay.t=setTimeout(callback,l*1000)};var INVALID_KEYS={9:true,13:true,14:true,25:true,27:true,38:true,40:true,224:true};return{dispatcher:function(){},getSavedResponse:function(){},saveResponse:function(){},renderSuggestions:function(){},disable:function(){this.disabled=true},enable:function(){this.disabled=false},set:function(options){for(var name in options){if(options.hasOwnProperty(name)){this[name]=options[name]}}},completeField:function(value){if(value){this.field.val(value).focus();this.field.trigger("change")}},textToSuggestionCursorPosition:function(){return this.field.val()},_makeRequest:function(options){var that=this,requestParams=Objects.copyObject(options);if(this.pendingRequest){this.pendingRequest.abort()}requestParams.complete=function(){that.pendingRequest=null};requestParams.error=function(xhr){if(!xhr.aborted&&xhr.status!==0&&options.error){options.error.apply(this,arguments)}};return this.pendingRequest=SmartAjax.makeRequest(requestParams)},addSuggestionControls:function(suggestionNodes){var that=this;var evaluateIndex=function(idx,max){var minBoundary=(that.autoSelectFirst===false)?-1:0;if(that.allowArrowCarousel){if(idx>max){return minBoundary}else{if(idx<minBoundary){return max}else{return idx}}}else{if(idx>max){return max}else{if(idx<minBoundary){that.responseContainer.scrollTop(0);return minBoundary}else{return idx}}}};var setActive=function(idx){if(that.selectedIndex!==undefined&&that.selectedIndex>-1){that.suggestionNodes[that.selectedIndex][0].removeClass("active")}that.selectedIndex=evaluateIndex(idx,that.suggestionNodes.length-1);if(that.selectedIndex>-1){that.suggestionNodes[that.selectedIndex][0].addClass("active")}};var evaluateIfActive=function(){return that.suggestionNodes&&that.suggestionNodes[that.selectedIndex]&&that.suggestionNodes[that.selectedIndex][0].hasClass("active")};var keyPressHandler=function(e){if(that.responseContainer.is(":visible")){if(e.keyCode===13){if(evaluateIfActive()&&!that.pendingRequest){that.completeField(that.suggestionNodes[that.selectedIndex][1])}e.preventDefault();e.stopPropagation()}}};var keyboardNavigateHandler=function(e){if(that.responseContainer.is(":visible")){if(that.field[0]!==document.activeElement){that.field.focus()}if(e.keyCode===40){setActive(that.selectedIndex+1);if(that.selectedIndex>=0){var containerHeight=that.responseContainer.height();var bottom=that.suggestionNodes[that.selectedIndex][0].position().top+that.suggestionNodes[that.selectedIndex][0].outerHeight();if(bottom-containerHeight>0){that.responseContainer.scrollTop(that.responseContainer.scrollTop()+bottom-containerHeight+2)}}else{that.responseContainer.scrollTop(0)}e.preventDefault()}else{if(e.keyCode===38){setActive(that.selectedIndex-1);if(that.selectedIndex>=0){var top=that.suggestionNodes[that.selectedIndex][0].position().top;if(top<0){that.responseContainer.scrollTop(that.responseContainer.scrollTop()+top-2)}}e.preventDefault()}else{if(e.keyCode===9){if(evaluateIfActive()){that.completeField(that.suggestionNodes[that.selectedIndex][1]);e.preventDefault()}else{that.dropdownController.hideDropdown()}}}}}};if(suggestionNodes.length){this.selectedIndex=0;this.suggestionNodes=suggestionNodes;for(var i=0;i<that.suggestionNodes.length;i++){var eventData={instance:this,index:i};this.suggestionNodes[i][0].bind("mouseover",eventData,activate).bind("mouseout",eventData,deactivate).bind("click",eventData,complete)}if(!this.keyboardHandlerBinded){jQuery(this.field).keypress(keyPressHandler);jQuery(this.field).keydown(keyboardNavigateHandler);this.keyboardHandlerBinded=true}if(that.autoSelectFirst===false){setActive(-1)}else{setActive(0)}inFocus=this}function activate(event){if(that.dropdownController.displayed){setActive(event.data.index)}}function deactivate(event){if(event.data.index===0){that.selectedIndex=-1}jQuery(this).removeClass("active")}function complete(event){that.completeField(that.suggestionNodes[event.data.index][1])}},clearResponseContainer:function(){this.responseContainer.empty();this.suggestionNodes=undefined},delay:delay,buildResponseContainer:function(){var inputParent=this.field.parent().addClass("atlassian-autocomplete");this.responseContainer=jQuery(document.createElement("div"));this.responseContainer.addClass("suggestions");this.positionResponseContainer();this.responseContainer.appendTo(inputParent)},positionResponseContainer:function(){this.responseContainer.css({top:this.field.outerHeight()})},keyUpHandler:(function(){function callback(){if(!this.responseContainer){this.buildResponseContainer()}this.dispatcher(this.field.val())}return function(e){if(this.field.val().length>=this.minQueryLength){if(!(e.keyCode in INVALID_KEYS)||(this.responseContainer&&!this.responseContainer.is(":visible")&&(e.keyCode==38||e.keyCode==40))){callback.call(this)}}return e}})(),addMultiSelectAdvice:function(delim){var that=this;var alertUserValueAlreadyExists=function(val){if(!alertUserValueAlreadyExists.isAlerting){alertUserValueAlreadyExists.isAlerting=true;var userAlert=jQuery(document.createElement("div")).css({"float":"left",display:"none"}).addClass("warningBox").html("Oops! You have already entered the value <em>"+val+"</em>").appendTo(that.field.parent()).show("fast",function(){that.delay(function(){userAlert.hide("fast",function(){userAlert.remove();alertUserValueAlreadyExists.isAlerting=false})},4)})}};jQuery.aop.before({target:this,method:"dispatcher"},function(innvocation){var val=this.field.val();innvocation[0]=jQuery.trim(val.slice(val.lastIndexOf(delim)+1));return innvocation});jQuery.aop.before({target:this,method:"completeField"},function(args){var valueToAdd=args[0],untrimmedVals=this.field.val().split(delim);var trimmedVals=jQuery(untrimmedVals).map(function(){return jQuery.trim(this)}).get();if(!this.allowDuplicates&&new RegExp("(?:^|[\\s"+delim+"])"+valueToAdd+"\\s*"+delim).test(this.field.val())){alertUserValueAlreadyExists(valueToAdd);trimmedVals[trimmedVals.length-1]=""}else{trimmedVals[trimmedVals.length-1]=valueToAdd;trimmedVals[trimmedVals.length]=""}args[0]=trimmedVals.join(delim.replace(/([^\s]$)/,"$1 "));return args})},addDropdownAdvice:function(){var that=this;jQuery.aop.after({target:this,method:"buildResponseContainer"},function(args){this.dropdownController=JIRA.Dropdown.AutoComplete({target:this,method:"renderSuggestions"},this.responseContainer);jQuery.aop.after({target:this.dropdownController,method:"hideDropdown"},function(){this.dropdown.removeClass("dropdown-ready")});return args});jQuery.aop.after({target:this,method:"renderSuggestions"},function(args){if(args&&args.length>0){this.dropdownController.displayDropdown();if(this.maxHeight&&this.dropdownController.dropdown.prop("scrollHeight")>this.maxHeight){this.dropdownController.dropdown.css({height:this.maxHeight,overflowX:"visible",overflowY:"scroll"})}else{if(this.maxHeight){this.dropdownController.dropdown.css({height:"",overflowX:"",overflowY:""})}}this.dropdownController.dropdown.addClass("dropdown-ready")}else{this.dropdownController.hideDropdown()}return args});jQuery.aop.after({target:this,method:"completeField"},function(args){this.dropdownController.hideDropdown();return args});jQuery.aop.after({target:this,method:"keyUpHandler"},function(e){if((!(this.field.val().length>=this.minQueryLength)||e.keyCode===27)&&this.dropdownController&&this.dropdownController.displayed){this.dropdownController.hideDropdown();if(e.keyCode===27){e.stopPropagation()}}return e})},init:function(options){var that=this;this.set(options);this.field=this.field||jQuery("#"+this.fieldID);this.field.attr("autocomplete","off").keyup(function(e){if(!that.disabled){that.keyUpHandler(e)}}).keydown(function(e){var ESC_KEY=27;if(e.keyCode===ESC_KEY&&that.responseContainer&&that.responseContainer.is(":visible")){e.preventDefault()}}).click(function(e){if(inFocus===that){e.stopPropagation()}}).blur(function(){if(that.pendingRequest){that.pendingRequest.abort()}});this.addDropdownAdvice();if(options.delimChar){this.addMultiSelectAdvice(options.delimChar)}}}}()});AJS.namespace("jira.widget.autocomplete",null,require("jira/autocomplete/autocomplete"));AJS.namespace("JIRA.AutoComplete",null,require("jira/autocomplete/autocomplete"));
/* module-key = 'jira.webresources:autocomplete', location = '/includes/jira/autocomplete/RESTAutoComplete.js' */
define("jira/autocomplete/rest-autocomplete",["jira/autocomplete/autocomplete","jira/util/objects"],function(AutoComplete,Objects){return function(){var that=Objects.begetObject(AutoComplete);that.dispatcher=function(reqFieldVal){var that=this;if(reqFieldVal.length<this.minQueryLength){return }if(!this.getSavedResponse(reqFieldVal)){this.delay(function(){var params=that.getAjaxParams();params.data.query=reqFieldVal;params.success=function(data){that.saveResponse(reqFieldVal,data);that.responseContainer.scrollTop(0);that.renderSuggestions(data)};that._makeRequest(params)},that.queryDelay)}else{that.renderSuggestions(that.getSavedResponse(reqFieldVal));that.responseContainer.scrollTop(0)}};that.getAjaxParams=function(){};that.getSavedResponse=function(val){if(!this.requested){this.requested={}}return this.requested[val]};that.saveResponse=function(val,response){if(typeof val==="string"&&typeof response==="object"){if(!this.requested){this.requested={}}this.requested[val]=response}};return that}()});AJS.namespace("jira.widget.autocomplete.REST",null,require("jira/autocomplete/rest-autocomplete"));AJS.namespace("JIRA.RESTAutoComplete",null,require("jira/autocomplete/rest-autocomplete"));
/* module-key = 'jira.webresources:autocomplete', location = '/includes/jira/autocomplete/IssueAutoComplete.js' */
define("jira/autocomplete/issue-autocomplete",["jira/autocomplete/rest-autocomplete","jira/util/objects","jquery"],function(RESTAutoComplete,Objects,jQuery){var IssueAutoComplete=function(options){var that=Objects.begetObject(RESTAutoComplete);that.getAjaxParams=function(){return{url:contextPath+"/rest/api/1.0/issues/picker",data:options.ajaxData,dataType:"json",type:"GET"}};that.renderSuggestions=function(response){var resultsContainer,suggestionNodes=[];this.clearResponseContainer();if(response&&response.sections&&response.sections.length>0){resultsContainer=jQuery("<ul/>").appendTo(this.responseContainer);jQuery(response.sections).each(function(){var section=this;var subSection=jQuery("<div/>").attr("id",options.fieldID+"_s_"+section.id).addClass("yag").text(section.label);if(section.sub){subSection.append(jQuery("<span/>").addClass("yagt").text("("+section.sub+")"))}resultsContainer.append(jQuery("<li/>").append(subSection).mouseover(function(){jQuery(this).addClass("active")}).mouseout(function(){jQuery(this).removeClass("active")}));if(section.msg){var msg=jQuery("<div/>").attr("id",options.fieldID+"_i_"+section.id+"_n").addClass("yad").text(section.msg);resultsContainer.append(jQuery("<li/>").append(msg).mouseover(function(){jQuery(this).addClass("active")}).mouseout(function(){jQuery(this).removeClass("active")}))}if(section.issues&&section.issues.length>0){jQuery(section.issues).each(function(){var imgUrl;if(/^http/.test(this.img)){imgUrl=this.img}else{imgUrl=contextPath+this.img}var issueNode=jQuery("<li/>").append(jQuery("<div/>").attr("id",options.fieldID+"_i_"+section.id+"_"+this.key).addClass("yad").append(jQuery("<table/>").addClass("yat").attr({cellpadding:"0",cellspacing:"0"}).append(jQuery("<tr/>").append(jQuery("<td/>").append(jQuery("<img/>").attr("src",imgUrl))).append(jQuery("<td/>").append(jQuery("<div/>").addClass("yak").html(this.keyHtml))).append(jQuery("<td/>").css("width","100%").html(this.summary)))));resultsContainer.append(issueNode);suggestionNodes.push([issueNode,this.key])})}});that.addSuggestionControls(suggestionNodes);return suggestionNodes}};options.minQueryLength=1;options.queryDelay=0.25;that.init(options);return that};IssueAutoComplete.init=function(){jQuery("fieldset.issue-picker-params").each(function(){var params=JIRA.parseOptionsFromFieldset(jQuery(this)),$container=jQuery("#"+params.fieldId+"-container").add("#"+params.fieldName+"_container");$container.find("a.popup-trigger").click(function(e){var url=contextPath+"/secure/popups/IssuePicker.jspa?";url+="currentIssue="+params.currentIssueKey+"&";url+="singleSelectOnly="+params.singleSelectOnly+"&";url+="showSubTasks="+params.showSubTasks+"&";url+="showSubTasksParent="+params.showSubTaskParent;if(params.currentProjectId&&params.currentProjectId!=""){url+="&selectedProjectId="+params.currentProjectId}JIRA.IssuePicker.callback=function(keysMap){var $formElement,keys=[];keysMap=JSON.parse(keysMap);if(params.fieldId&&keys){$formElement=jQuery("#"+params.fieldId);if($formElement){jQuery.each(keysMap,function(){keys.push(this.value)});$formElement.val(keys.join(", "))}}};var vWinUsers=window.open(url,"IssueSelectorPopup","status=no,resizable=yes,top=100,left=200,width=620,height=500,scrollbars=yes,resizable");vWinUsers.opener=self;vWinUsers.focus();e.preventDefault()});if(!params.fieldId){params.fieldId=params.fieldName}if(params.issuePickerEnabled===true){IssueAutoComplete({fieldID:params.fieldId,delimChar:params.singleSelectOnly===true?undefined:",",ajaxData:params})}})};return IssueAutoComplete});AJS.namespace("jira.widget.autocomplete.Issues",null,require("jira/autocomplete/issue-autocomplete"));AJS.namespace("JIRA.IssueAutoComplete",null,require("jira/autocomplete/issue-autocomplete"));
/* module-key = 'jira.webresources:autocomplete', location = '/includes/jira/autocomplete/UserAutoComplete.js' */
define("jira/autocomplete/user-autocomplete",["jira/autocomplete/rest-autocomplete","jira/data/parse-options-from-fieldset","jira/util/browser","jira/util/elements","jira/util/objects","jquery"],function(RESTAutoComplete,parseOptionsFromFieldset,Browser,Elements,Objects,jQuery){var UserAutoComplete=function(options){var that=Objects.begetObject(RESTAutoComplete);that.getAjaxParams=function(){return{url:contextPath+"/rest/api/1.0/users/picker",data:{fieldName:options.fieldID,fieldConfigId:options.fieldConfigID,projectId:options.projectId},dataType:"json",type:"GET"}};function fieldsFormHasBeenSubmitted(field){var submitting=false,form=field.closest("form");if(form.length&&form.hasClass("submitting")){submitting=true}return submitting}that.renderSuggestions=function(response){if(fieldsFormHasBeenSubmitted(this.field)||!Browser.isSelenium()&&!Elements.elementIsFocused(this.field)){return false}var resultsContainer,suggestionNodes=[];this.clearResponseContainer();if(response&&response.users&&response.users.length>0){resultsContainer=jQuery("<ul/>").appendTo(this.responseContainer);jQuery(response.users).each(function(){suggestionNodes.push([jQuery("<li/>").html(this.html).appendTo(resultsContainer),this.name])})}if(response.footer){this.responseContainer.append(jQuery("<div/>").addClass("yui-ac-ft").html(response.footer).css("display","block"))}if(suggestionNodes.length>0){that.addSuggestionControls(suggestionNodes);jQuery(".atlassian-autocomplete div.yad, .atlassian-autocomplete .labels li").textOverflow({autoUpdate:true})}return suggestionNodes};options.minQueryLength=2;options.queryDelay=0.25;that.init(options);return that};UserAutoComplete.init=function(parent){jQuery("fieldset.user-picker-params",parent).each(function(){var params=parseOptionsFromFieldset(jQuery(this)),field=(params.fieldId||params.fieldName),$container=jQuery("#"+field+"_container");$container.find("a.popup-trigger").click(function(e){var url=contextPath,vWinUsers;e.preventDefault();if(!params.formName){params.formName=$container.find("#"+field).parents("form").attr("name")}if(params.actionToOpen){url=url+params.actionToOpen}else{url=url+"/secure/popups/UserPickerBrowser.jspa"}url+="?formName="+params.formName+"&";url+="multiSelect="+params.multiSelect+"&";url+="decorator=popup&";url+="element="+field;if(params.fieldConfigId){url+="&fieldConfigId="+params.fieldConfigId}if(params.projectId){if(jQuery.isArray(params.projectId)){for(var projectId in params.projectId){url+="&projectId="+projectId}}else{url+="&projectId="+params.projectId}}vWinUsers=window.open(url,"UserPicker","status=yes,resizable=yes,top=100,left=100,width=800,height=750,scrollbars=yes");vWinUsers.opener=self;vWinUsers.focus()});if(params.userPickerEnabled===true){UserAutoComplete({field:parent?parent.find("#"+field):null,fieldID:field,fieldConfigID:params.fieldConfigId,projectId:params.projectId,delimChar:params.multiSelect===false?undefined:",",ajaxData:{fieldName:params.fieldName}})}})};return UserAutoComplete});AJS.namespace("jira.widget.autocomplete.Users",null,require("jira/autocomplete/user-autocomplete"));AJS.namespace("JIRA.UserAutoComplete",null,require("jira/autocomplete/user-autocomplete"));
/* module-key = 'jira.webresources:autocomplete', location = '/includes/jira/autocomplete/initAutoCompleteFields.js' */
JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){JIRA.UserAutoComplete.init(context);JIRA.IssueAutoComplete.init(context)}});JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){AJS.$("fieldset.user-searcher-params",context).each(function(){var params=JIRA.parseOptionsFromFieldset(AJS.$(this)),$container=AJS.$("#"+params.fieldId+"_container",context);if(params.userPickerEnabled===true){var autocompleter=JIRA.UserAutoComplete({fieldID:params.fieldId,delimChar:params.multiSelect===true?",":undefined,ajaxData:{fieldName:params.fieldName}})}var setupFields=function(related){var field=AJS.$("#"+params.fieldId,context);var userImage=AJS.$("#"+params.fieldId+"Image",context);var groupImage=AJS.$("#"+params.fieldId+"GroupImage",context);var fieldDesc=AJS.$("#"+params.fieldId+"_desc",context);if(related==="select.list.none"){field.val("").attr("disabled","true");userImage.hide();groupImage.hide();fieldDesc.hide()}else{field.removeAttr("disabled");if(related==="select.list.group"){userImage.hide();groupImage.show();if(params.userPickerEnabled===true){autocompleter.disable();fieldDesc.hide()}}else{userImage.show();groupImage.hide();if(params.userPickerEnabled===true){autocompleter.enable();fieldDesc.show()}}}};AJS.$("#"+params.userSelect,context).change(function(){var related=AJS.$(this).find("option:selected").attr("rel");setupFields(related)}).find("option:selected").each(function(){setupFields(AJS.$(this).attr("rel"))});$container.find("a.user-popup-trigger").click(function(e){var url=contextPath+"/secure/popups/UserPickerBrowser.jspa?";url+="formName="+params.formName+"&";url+="multiSelect="+params.multiSelect+"&";url+="decorator=popup&";url+="element="+params.fieldId;var vWinUsers=window.open(url,"UserPicker","status=yes,resizable=yes,top=100,left=100,width=800,height=750,scrollbars=yes");vWinUsers.opener=self;vWinUsers.focus();e.preventDefault()});$container.find("a.group-popup-trigger").click(function(e){var url=contextPath+"/secure/popups/GroupPickerBrowser.jspa?";url+="formName="+params.formName+"&";url+="multiSelect="+params.multiSelect+"&";url+="decorator=popup&";url+="element="+params.fieldId;var vWinUsers=window.open(url,"GroupPicker","status=yes,resizable=yes,top=100,left=100,width=800,height=750,scrollbars=yes");vWinUsers.opener=self;vWinUsers.focus();e.preventDefault()})})}});
/* module-key = 'jira.webresources:ajaxhistory', location = '/includes/lib/dhtmlhistory/dhtmlHistory.js' */
window.dhtmlHistory={isIE:false,isOpera:false,isSafari:false,isKonquerer:false,isGecko:false,isSupported:false,create:function(options){var that=this;var UA=navigator.userAgent.toLowerCase();var platform=navigator.platform.toLowerCase();var vendor=navigator.vendor||"";if(vendor==="KDE"){this.isKonqueror=true;this.isSupported=false}else{if(typeof window.opera!=="undefined"){this.isOpera=true;this.isSupported=true}else{if(typeof document.all!=="undefined"){this.isIE=true;this.isSupported=true}else{if(/\(KHTML, like Gecko\) Safari/i.test(UA)){this.isSafari=true;this.isSupported=(platform.indexOf("mac")>-1)}else{if((UA.indexOf("gecko")!=-1)||(/\(KHTML, like Gecko\) Version\/(.+)Safari/i.test(UA))){this.isGecko=true;this.isSupported=true}}}}}window.historyStorage.setup(options);if(this.isSafari){this.createSafari()}else{if(this.isOpera){this.createOpera()}}var initialHash=this.getCurrentLocation();this.currentLocation=initialHash;if(this.isIE){this.createIE(initialHash)}var unloadHandler=function(){that.firstLoad=null};this.addEventListener(window,"unload",unloadHandler);if(this.isIE){this.ignoreLocationChange=true}else{if(!historyStorage.hasKey(this.PAGELOADEDSTRING)){this.ignoreLocationChange=true;this.firstLoad=true;historyStorage.put(this.PAGELOADEDSTRING,true)}else{this.ignoreLocationChange=false;this.fireOnNewListener=true}}var locationHandler=function(){that.checkLocation()};setInterval(locationHandler,100)},initialize:function(){if(this.isIE){if(!historyStorage.hasKey(this.PAGELOADEDSTRING)){this.fireOnNewListener=false;this.firstLoad=true;historyStorage.put(this.PAGELOADEDSTRING,true)}else{this.fireOnNewListener=true;this.firstLoad=false}}},addListener:function(listener){this.listener=listener;if(this.fireOnNewListener){this.fireHistoryEvent(this.currentLocation);this.fireOnNewListener=false}},addEventListener:function(o,e,l){if(o.addEventListener){o.addEventListener(e,l,false)}else{if(o.attachEvent){o.attachEvent("on"+e,function(){l(window.event)})}}},add:function(newLocation,historyData){if(this.isSafari){newLocation=this.removeHash(newLocation);historyStorage.put(newLocation,historyData);this.currentLocation=newLocation;window.location.hash=newLocation;this.putSafariState(newLocation)}else{var that=this;var addImpl=function(){if(that.currentWaitTime>0){that.currentWaitTime=that.currentWaitTime-that.waitTime}newLocation=that.removeHash(newLocation);if(document.getElementById(newLocation)&&that.debugMode){var e="Exception: History locations can not have the same value as _any_ IDs that might be in the document,"+" due to a bug in IE; please ask the developer to choose a history location that does not match any HTML"+" IDs in this document. The following ID is already taken and cannot be a location: "+newLocation;throw new Error(e)}historyStorage.put(newLocation,historyData);that.ignoreLocationChange=true;that.ieAtomicLocationChange=true;that.currentLocation=newLocation;window.location.hash=newLocation;if(that.isIE){that.iframe.src=contextPath+"/includes/blank.html?"+newLocation}that.ieAtomicLocationChange=false};window.setTimeout(addImpl,this.currentWaitTime);this.currentWaitTime=this.currentWaitTime+this.waitTime}},isFirstLoad:function(){return this.firstLoad},getVersion:function(){return"0.6"},getCurrentLocation:function(){var r=(this.isSafari?this.getSafariState():this.getCurrentHash());return r},getCurrentHash:function(){var r=window.location.href;var i=r.indexOf("#");return(i>=0?r.substr(i+1):"")},PAGELOADEDSTRING:"DhtmlHistory_pageLoaded",listener:null,waitTime:200,currentWaitTime:0,currentLocation:null,iframe:null,safariHistoryStartPoint:null,safariStack:null,safariLength:null,ignoreLocationChange:null,fireOnNewListener:null,firstLoad:null,ieAtomicLocationChange:null,createIE:function(initialHash){this.waitTime=400;var styles=(historyStorage.debugMode?"width: 800px;height:80px;border:1px solid black;":historyStorage.hideStyles);var iframeID="rshHistoryFrame";var iframeHTML='<iframe frameborder="0" id="'+iframeID+'" style="'+styles+'"></iframe>';document.write(iframeHTML);this.iframe=document.getElementById(iframeID);this.iframe.src=contextPath+"/includes/blank.html?"+initialHash},createOpera:function(){this.waitTime=400;var imgHTML='<img src="javascript:location.href=\'javascript:dhtmlHistory.checkLocation();\';" style="'+historyStorage.hideStyles+'" />';document.write(imgHTML)},createSafari:function(){var formID="rshSafariForm";var stackID="rshSafariStack";var lengthID="rshSafariLength";var formStyles=historyStorage.debugMode?historyStorage.showStyles:historyStorage.hideStyles;var inputStyles=(historyStorage.debugMode?"width:800px;height:20px;border:1px solid black;margin:0;padding:0;":historyStorage.hideStyles);var safariHTML='<form id="'+formID+'" style="'+formStyles+'">'+'<input type="text" style="'+inputStyles+'" id="'+stackID+'" value="[]"/>'+'<input type="text" style="'+inputStyles+'" id="'+lengthID+'" value=""/>'+"</form>";document.write(safariHTML);this.safariStack=document.getElementById(stackID);this.safariLength=document.getElementById(lengthID);if(!historyStorage.hasKey(this.PAGELOADEDSTRING)){this.safariHistoryStartPoint=history.length;this.safariLength.value=this.safariHistoryStartPoint}else{this.safariHistoryStartPoint=this.safariLength.value}},getSafariStack:function(){var r=this.safariStack.value;return historyStorage.fromJSON(r)},getSafariState:function(){var stack=this.getSafariStack();var state=stack[history.length-this.safariHistoryStartPoint-1];return state},putSafariState:function(newLocation){var stack=this.getSafariStack();stack[history.length-this.safariHistoryStartPoint]=newLocation;this.safariStack.value=historyStorage.toJSON(stack)},fireHistoryEvent:function(newHash){var historyData=historyStorage.get(newHash);this.listener.call(null,newHash,historyData)},checkLocation:function(){if(!this.isIE&&this.ignoreLocationChange){this.ignoreLocationChange=false;return }if(!this.isIE&&this.ieAtomicLocationChange){return }var hash=this.getCurrentLocation();if(hash==this.currentLocation){return }this.ieAtomicLocationChange=true;if(this.isIE&&this.getIframeHash()!=hash){this.iframe.src=contextPath+"/includes/blank.html?"+hash}else{if(this.isIE){return }}this.currentLocation=hash;this.ieAtomicLocationChange=false;this.fireHistoryEvent(hash)},getIframeHash:function(){var doc=this.iframe.contentWindow.document;var hash=String(doc.location.search);if(hash.length==1&&hash.charAt(0)=="?"){hash=""}else{if(hash.length>=2&&hash.charAt(0)=="?"){hash=hash.substring(1)}}return hash},removeHash:function(hashValue){var r;if(hashValue===null||hashValue===undefined){r=null}else{if(hashValue===""){r=""}else{if(hashValue.length==1&&hashValue.charAt(0)=="#"){r=""}else{if(hashValue.length>1&&hashValue.charAt(0)=="#"){r=hashValue.substring(1)}else{r=hashValue}}}}return r},iframeLoaded:function(newLocation){if(this.ignoreLocationChange){this.ignoreLocationChange=false;return }var hash=String(newLocation.search);if(hash.length==1&&hash.charAt(0)=="?"){hash=""}else{if(hash.length>=2&&hash.charAt(0)=="?"){hash=hash.substring(1)}}window.location.hash=hash;this.fireHistoryEvent(hash)}};window.historyStorage={setup:function(options){if(typeof options!=="undefined"){if(options.debugMode){this.debugMode=options.debugMode}if(options.toJSON){this.toJSON=options.toJSON}if(options.fromJSON){this.fromJSON=options.fromJSON}}var formID="rshStorageForm";var textareaID="rshStorageField";var formStyles=this.debugMode?historyStorage.showStyles:historyStorage.hideStyles;var textareaStyles=(historyStorage.debugMode?"width: 800px;height:80px;border:1px solid black;":historyStorage.hideStyles);var textareaHTML='<form id="'+formID+'" class="dont-default-focus" style="'+formStyles+'">'+'<textarea id="'+textareaID+'" style="'+textareaStyles+'"></textarea>'+"</form>";document.write(textareaHTML);this.storageField=document.getElementById(textareaID);if(typeof window.opera!=="undefined"){this.storageField.focus()}},put:function(key,value){this.assertValidKey(key);if(this.hasKey(key)){this.remove(key)}this.storageHash[key]=value;this.saveHashTable()},get:function(key){this.assertValidKey(key);this.loadHashTable();var value=this.storageHash[key];if(value===undefined){value=null}return value},remove:function(key){this.assertValidKey(key);this.loadHashTable();delete this.storageHash[key];this.saveHashTable()},reset:function(){this.storageField.value="";this.storageHash={}},hasKey:function(key){this.assertValidKey(key);this.loadHashTable();return(typeof this.storageHash[key]!=="undefined")},isValidKey:function(key){return(typeof key==="string")},showStyles:"border:0;margin:0;padding:0;",hideStyles:"left:-1000px;top:-1000px;width:1px;height:1px;border:0;position:absolute;",debugMode:false,storageHash:{},hashLoaded:false,storageField:null,assertValidKey:function(key){var isValid=this.isValidKey(key);if(!isValid&&this.debugMode){throw new Error("Please provide a valid key for window.historyStorage. Invalid key = "+key+".")}},loadHashTable:function(){if(!this.hashLoaded){var serializedHashTable=this.storageField.value;if(serializedHashTable!==""&&serializedHashTable!==null){this.storageHash=this.fromJSON(serializedHashTable);this.hashLoaded=true}}},saveHashTable:function(){this.loadHashTable();var serializedHashTable=this.toJSON(this.storageHash);this.storageField.value=serializedHashTable},toJSON:function(o){return JSON.stringify(o)},fromJSON:function(s){return JSON.parse(s)}};
/* module-key = 'jira.webresources:share-types', location = '/includes/jira/share/Share.js' */
JIRA.Share={i18n:{}};AJS.namespace("atlassian.jira.share",null,JIRA.Share);JIRA.Share.toggleElements=function(idShow,idHide){var elementHide=document.getElementById(idHide);var elementShow=document.getElementById(idShow);if(elementHide&&elementShow){elementHide.style.display="none";elementShow.style.display=""}};JIRA.Share.i18n.getMessage=function(key){if(this[key]){return this[key]}return"unknown"};JIRA.Share.i18n._formatMessage=function(message,escapeFunc,parameters){var regex,currentValue;for(var i=0;i<parameters.length;i++){currentValue=String(parameters[i]);if(escapeFunc){currentValue=escapeFunc(currentValue)}regex=new RegExp("\\{"+i+"\\}","g");while(message.search(regex)>=0){message=message.replace(regex,currentValue)}}return message};JIRA.Share.i18n.formatMessage=function(message){var parameters=Array.prototype.slice.call(arguments,1);return JIRA.Share.i18n._formatMessage(message,htmlEscape,parameters)};JIRA.Share.i18n.formatMessageUnescaped=function(message){var parameters=Array.prototype.slice.call(arguments,1);return JIRA.Share.i18n._formatMessage(message,null,parameters)};JIRA.Share.EditSharesController=function(submitButtonId){this.shares=new Array();this.displayDiv=document.getElementById("share_display_div");this.emptyDiv=document.getElementById("empty_share");this.shareDiv=document.getElementById("share_div");this.submitButtonId=submitButtonId;this.shareTypes={};this.counter=0;this.singleton=false;this.dirty=false};JIRA.Share.EditSharesController.prototype={registerShareType:function(shareType){if(!shareType||!shareType.type){return }this.shareTypes[String(shareType.type)]=shareType},initialise:function(){var i,shareTypeName,shareType,busy,that=this;for(shareTypeName in this.shareTypes){shareType=this.shareTypes[shareTypeName];jQuery("#share_add_"+shareType.type).click((function(shareTypeRef){return function(e){that.addShareCallback(e,shareTypeRef)}})(shareType));if(shareType.initialise){shareType.initialise(this.setDescription)}}var chosen=document.getElementById("share_type_hidden");var dataSpan=document.getElementById("shares_data"),shares;try{shares=JSON.parse(dataSpan.firstChild.nodeValue);if(!(shares instanceof Array)){shares=[]}}catch(ignored){shares=[]}for(i=0;i<shares.length;i++){if(shares[i].type!==undefined){shareType=this.shareTypes[shares[i].type];if(shareType){var display=shareType.getDisplayFromPermission(shares[i]);if(display){this.addDisplay(display)}}}}if(this.shares.length==0){var noShares=this.emptyDiv.cloneNode(true);noShares.removeAttribute("id");noShares.style.display="";this.displayDiv.appendChild(noShares)}this.recalculateHiddenValue();chosen.defaultValue=chosen.value;jQuery(chosen).addClass(JIRA.DirtyForm.ClassNames.SANCTIONED);busy=document.getElementById("share_busy");if(busy){busy.style.display="none";if(busy.parentNode){busy.parentNode.removeChild(busy)}}this.shareDiv.style.display="";jQuery("#share_type_selector").change(function(e){that.selectShareTypeCallback(e)});var selectList=document.getElementById("share_type_selector"),options=selectList.options;var selectedType=options[selectList.selectedIndex].value;document.getElementById("share_"+selectedType).style.display="";var currentShareType=this.shareTypes[selectedType];this.setDescription(currentShareType.getDisplayDescriptionFromUI());this.setWarning(currentShareType.getDisplayWarning());if(this.submitButtonId){jQuery("#"+this.submitButtonId).click(function(e){that.saveCallback(e)})}},addDisplay:function(shareDisplay){var that=this;if(!shareDisplay){return }var index=this.findShare(shareDisplay.permission);if(index>=0){this.animateShare(index);return }var newCount=this.counter++,newDiv=null;if(shareDisplay.singleton){if(this.shares.length!=0){var isOk=confirm(JIRA.Share.i18n.getMessage("common.sharing.remove.shares"));if(!isOk){return }}newDiv=this.clearDiv()}else{if(this.singleton){newDiv=this.clearDiv()}else{if(this.shares.length==0){newDiv=this.clearDiv()}}}if(!newDiv){newDiv=document.createElement("DIV")}else{while(newDiv.firstChild){newDiv.removeChild(newDiv.firstChild)}}newDiv.className="shareItem";newDiv.id="share_div_"+newCount;var shareDiv=document.createElement("DIV");shareDiv.id="share_div_"+newCount+"_inner";shareDiv.title=shareDisplay.description;var filterIcon=this.cloneImage("share_icon");if(filterIcon){shareDiv.appendChild(filterIcon)}var dataSpan=document.createElement("SPAN");dataSpan.innerHTML=shareDisplay.display;shareDiv.appendChild(dataSpan);var newTrash=this.cloneImage("share_trash");if(newTrash){jQuery(newTrash).click(function(e){that.removeCallback(e,newCount)});shareDiv.appendChild(newTrash)}newDiv.appendChild(shareDiv);this.singleton=shareDisplay.singleton;this.displayDiv.appendChild(newDiv);this.shares.push({id:newCount,permission:shareDisplay.permission});this.recalculateHiddenValue()},cloneImage:function(id){var iconImage=document.getElementById(id);if(iconImage){iconImage=iconImage.cloneNode(true);iconImage.removeAttribute("id");iconImage.style.display=""}return iconImage},findShare:function(sharePermission){for(var i=0;i<this.shares.length;i++){if(sharePermission.equals(this.shares[i].permission)){return this.shares[i].id}}return -1},selectShareTypeCallback:function(){var selectList=document.getElementById("share_type_selector"),options=selectList.options,selectedElement;for(var i=0;i<options.length;i++){var element=document.getElementById("share_"+options[i].value);if(element){if(i==selectList.selectedIndex){selectedElement=element}else{element.style.display="none"}}}selectedElement.style.display="";var selectedType=options[selectList.selectedIndex].value;var currentShareType=this.shareTypes[selectedType];this.setDescription(currentShareType.getDisplayDescriptionFromUI());this.setWarning(currentShareType.getDisplayWarning());this.dirty=true},saveCallback:function(e){if(this.dirty){var currentShareType=this.getCurrentShareType();if(currentShareType){var display=currentShareType.getDisplayFromUI();if(display&&display.permission&&this.findShare(display.permission)<0){if(!confirm(JIRA.Share.i18n.getMessage("common.sharing.dirty.warning"))){e.preventDefault()}}}}},addShareCallback:function(ignoredEvent,shareType){this.addDisplay(shareType.getDisplayFromUI())},removeCallback:function(event,id){this.remove(id)},remove:function(id){for(var i=0;i<this.shares.length;i++){if(this.shares[i].id==id){this.shares.splice(i,1);break}}var removeDiv=document.getElementById("share_div_"+id);if(this.shares.length>=1){this.displayDiv.removeChild(removeDiv)}else{removeDiv.innerHTML=this.emptyDiv.innerHTML;removeDiv.className=this.emptyDiv.className;removeDiv.removeAttribute("id")}this.recalculateHiddenValue()},clearDiv:function(){this.shares=new Array();var returnValue=null;while(!returnValue&&this.displayDiv.firstChild){if(this.displayDiv.firstChild.nodeName.toLowerCase()=="div"){returnValue=this.displayDiv.firstChild}else{this.displayDiv.removeChild(this.displayDiv.firstChild)}}if(returnValue){while(returnValue.nextSibling){this.displayDiv.removeChild(returnValue.nextSibling)}}return returnValue},setDescription:function(description){var descriptionDiv=document.getElementById("share_type_description");if(descriptionDiv){descriptionDiv.innerHTML=description}},setWarning:function(warning){var warningDiv=document.getElementById("share_warning");if(warningDiv){if(warning.length>0){AJS.messages.warning("#share_warning",{body:warning,closeable:false,shadowed:false})}else{warningDiv.innerHTML=""}}},recalculateHiddenValue:function(){var hidden=document.getElementById("share_type_hidden");if(hidden){var valueArray=[];for(var i=0;i<this.shares.length;i++){valueArray.push(this.shares[i].permission)}hidden.value=JSON.stringify(valueArray)}},animateShare:function(index){var div=document.getElementById("share_div_"+index+"_inner");if(div){var currentElement=div.parentNode;var bgColor=null;while(!bgColor&&currentElement&&currentElement!=document.body.parentNode){if(currentElement.style){bgColor=currentElement.style.backgroundColor}if(!bgColor&&currentElement.bgColor){bgColor=currentElement.bgColor}currentElement=currentElement.parentNode}if(!bgColor){bgColor="#FFFFFF"}if(!jQuery(div).hasClass("fading")){jQuery(div).addClass("fading");jQuery(div).css({backgroundColor:"#FFCCCC"}).animate({backgroundColor:"#FFFFFF"},2000,function(){jQuery(div).removeClass("fading")})}}},getCurrentShareType:function(){var selectList=document.getElementById("share_type_selector");if(selectList){return this.shareTypes[selectList.options[selectList.selectedIndex].value]}else{return null}}};JIRA.Share.SelectSingleShareTypeController=function(){this.shares=new Array();this.shareTypes={};this.singleton=false};JIRA.Share.SelectSingleShareTypeController.prototype={registerShareType:function(shareType){if(!shareType||!shareType.type){return }this.shareTypes[String(shareType.type)]=shareType},initialise:function(){var shareTypeName,shareType,that=this;for(shareTypeName in this.shareTypes){shareType=this.shareTypes[shareTypeName];if(shareType.initialise){shareType.initialise(this.setDescription)}}var dataSpan=document.getElementById("shares_data"),shares;try{var dataStr=dataSpan.firstChild.nodeValue;shares=JSON.parse(dataStr);if(!(shares instanceof Array)){shares=[]}}catch(ex){shares=[]}var type=null;var sharePermission=null;if(shares.length==0){type="any";shareType=this.shareTypes[type];sharePermission=null}else{type=shares[0].type;shareType=this.shareTypes[type];sharePermission=shares[0]}if(shareType.updateSelectionFromPermission){shareType.updateSelectionFromPermission(sharePermission)}var selectList=document.getElementById("share_type_selector");if(selectList){this.updateShareTypeSelectorList(selectList,type);this.setDescription(shareType.getDisplayDescriptionFromUI());jQuery(selectList).change(function(e){that.selectShareTypeCallback(e)})}var node=document.getElementById("share_busy");if(node){node.style.display="none";if(node.parentNode){node.parentNode.removeChild(node)}}node=document.getElementById("share_div");if(node){node.style.display=""}},updateShareTypeSelectorList:function(selectBox,selectedShareType){var options=selectBox.options;var selectedIndex=0;for(var i=0;i<options.length;i++){var optVal=options[i].value;if(optVal==selectedShareType){selectedIndex=i}document.getElementById("share_"+optVal).style.display="none"}options[selectedIndex].selected=true;var childSelectBox=document.getElementById("share_"+options[selectedIndex].value);if(childSelectBox){childSelectBox.style.display=""}},selectShareTypeCallback:function(){var selectList=document.getElementById("share_type_selector"),options=selectList.options,selectedElement;for(var i=0;i<options.length;i++){var element=document.getElementById("share_"+options[i].value);if(element){if(i==selectList.selectedIndex){selectedElement=element}else{element.style.display="none"}}}selectedElement.style.display="";var selectedType=options[selectList.selectedIndex].value;var ShareType=this.shareTypes[selectedType];this.setDescription(ShareType.getDisplayDescriptionFromUI())},setDescription:function(description){var descriptionDiv=document.getElementById("share_type_description");if(descriptionDiv){descriptionDiv.innerHTML=description}},setWarning:function(warning){var warningDiv=document.getElementById("share_warning");if(warningDiv){if(warning.length>0){warningDiv.className="aui-message warning";warningDiv.innerHTML=warning}else{warningDiv.className="";warningDiv.innerHTML=""}}}};JIRA.Share.GlobalShare=function(){this.type="global";this.singleton=true};JIRA.Share.GlobalShare.prototype={getDisplayFromUI:function(){var newPermission=new JIRA.Share.SharePermission(this.type,null,null);var inner=JIRA.Share.i18n.getMessage("share_global_display");return new JIRA.Share.Display(inner,this.getDisplayDescriptionFromUI(),this.singleton,newPermission)},getDisplayDescriptionFromUI:function(){return JIRA.Share.i18n.getMessage("share_global_description")},getDisplayFromPermission:function(permission){if(!permission||permission.type!=this.type){return null}var newPermission=new JIRA.Share.SharePermission(this.type,null,null);var inner=JIRA.Share.i18n.getMessage("share_global_display");return new JIRA.Share.Display(inner,this.getDisplayDescriptionFromUI(),this.singleton,newPermission)},getDisplayWarning:function(){return JIRA.Share.i18n.getMessage("share_global_warning")}};JIRA.Share.GroupShare=function(){this.type="group";this.singleton=false};JIRA.Share.GroupShare.prototype={initialise:function(setDescription){var that=this;this.setDescription=setDescription;this.groupSelect=document.getElementById("groupShare");if(this.groupSelect){jQuery(this.groupSelect).change(function(e){that.groupChangeCallback(e)})}},getDisplayFromUI:function(){if(!this.groupSelect){return }var value=this.groupSelect.options[this.groupSelect.selectedIndex].value;var newPermission=new JIRA.Share.SharePermission(this.type,value,null);return new JIRA.Share.Display(this.getDisplayString(value),this.getDescriptionString(value,true),this.singleton,newPermission)},getDisplayDescriptionFromUI:function(){if(!this.groupSelect){return""}var group=this.groupSelect.options[this.groupSelect.selectedIndex].value;return this.getDescriptionString(group,false)},getDisplayFromPermission:function(permission){if(!permission||permission.type!=this.type||!permission.param1){return null}var newPermission=new JIRA.Share.SharePermission(this.type,permission.param1,null);return new JIRA.Share.Display(this.getDisplayString(newPermission.param1),this.getDescriptionString(permission.param1,true),this.singleton,newPermission)},getDisplayString:function(group){var inner=JIRA.Share.i18n.getMessage("share_group_display");return JIRA.Share.i18n.formatMessage(inner,group)},getDescriptionString:function(group,unescaped){var inner=JIRA.Share.i18n.getMessage("share_group_description");if(unescaped){return JIRA.Share.i18n.formatMessageUnescaped(inner,group)}else{return JIRA.Share.i18n.formatMessage(inner,group)}},updateSelectionFromPermission:function(sharePermission){if(!this.groupSelect){return }var groupName=sharePermission.param1;var options=this.groupSelect.options;for(var i=0;i<options.length;i++){if(options[i].value==groupName){options[i].selected=true}}},groupChangeCallback:function(){if(this.setDescription){this.setDescription(this.getDisplayDescriptionFromUI())}},getDisplayWarning:function(){return""}};JIRA.Share.ProjectShare=function(){this.roleMap={};this.projectMap={};this.type="project";this.singleton=false};JIRA.Share.ProjectShare.prototype={initialise:function(setDescription){var that=this;this.setDescription=setDescription;this.projectSelect=document.getElementById("projectShare-project");this.roleSelect=document.getElementById("projectShare-role");this.roleSelectGroup=document.getElementById("projectShare-role-group");if(!this.roleSelect||!this.projectSelect||!this.roleSelectGroup){return }var option,i;for(i=1;i<this.roleSelect.options.length;i++){option=this.roleSelect.options[i];this.roleMap[option.value]=option.text}for(i=0;i<this.projectSelect.options.length;i++){option=this.projectSelect.options[i];this.projectMap[option.value]=option.text}this.setRoles();jQuery(this.projectSelect).change(function(e){that.changeCallbackForProject(e)});jQuery(this.roleSelect).change(function(e){that.updateDescription(e)})},getDisplayFromUI:function(){if(!this.projectSelect||!this.roleSelect){return }var selectedProjectOption=this.projectSelect.options[this.projectSelect.selectedIndex];var projectValue=selectedProjectOption.value;var projectDisplay=selectedProjectOption.text;var selectedRoleOption=this.roleSelect.options[this.roleSelect.selectedIndex];var roleValue=selectedRoleOption.value;var roleDisplay=selectedRoleOption.text;var inner;if(roleValue==""){inner=JIRA.Share.i18n.getMessage("share_project_display_all");inner=JIRA.Share.i18n.formatMessage(inner,projectDisplay)}else{inner=JIRA.Share.i18n.getMessage("share_project_display");inner=JIRA.Share.i18n.formatMessage(inner,projectDisplay,roleDisplay)}var newPermission=new JIRA.Share.SharePermission(this.type,projectValue,roleValue);return new JIRA.Share.Display(inner,this.getDescriptionString(projectDisplay,roleValue,roleDisplay,true),this.singleton,newPermission)},getDisplayDescriptionFromUI:function(){if(!this.projectSelect||!this.roleSelect){return""}var selectedProjectOption=this.projectSelect.options[this.projectSelect.selectedIndex];var projectDisplay=selectedProjectOption.text;var selectedRoleOption=this.roleSelect.options[this.roleSelect.selectedIndex];var roleValue=selectedRoleOption.value;var roleDisplay=selectedRoleOption.text;return this.getDescriptionString(projectDisplay,roleValue,roleDisplay,false)},getDescriptionString:function(project,roleValue,roleDisplay,unescaped){var inner;if(!roleValue||roleValue==""){roleValue=null;inner=JIRA.Share.i18n.getMessage("share_project_description");if(unescaped){inner=JIRA.Share.i18n.formatMessageUnescaped(inner,project)}else{inner=JIRA.Share.i18n.formatMessage(inner,project)}}else{inner=JIRA.Share.i18n.getMessage("share_role_description");if(unescaped){inner=JIRA.Share.i18n.formatMessageUnescaped(inner,roleDisplay,project)}else{inner=JIRA.Share.i18n.formatMessage(inner,roleDisplay,project)}}return inner},getDisplayFromPermission:function(permission){var inner,newPermission,description,projectName,roleName;if(!permission||permission.type!=this.type||!permission.param1){return null}if(permission.param2){projectName=this.getProject(permission.param1);roleName=this.getRole(permission.param2);inner=JIRA.Share.i18n.getMessage("share_project_display");inner=JIRA.Share.i18n.formatMessage(inner,projectName,roleName);newPermission=new JIRA.Share.SharePermission(this.type,permission.param1,permission.param2);description=this.getDescriptionString(projectName,permission.param2,roleName,true)}else{projectName=this.getProject(permission.param1);inner=JIRA.Share.i18n.getMessage("share_project_display_all");inner=JIRA.Share.i18n.formatMessage(inner,projectName);newPermission=new JIRA.Share.SharePermission(this.type,permission.param1,null);description=this.getDescriptionString(projectName,null,null,true)}return new JIRA.Share.Display(inner,description,this.singleton,newPermission)},getDisplayWarning:function(){return""},changeCallbackForProject:function(){this.setRoles();this.updateDescription()},updateDescription:function(){if(this.setDescription){this.setDescription(this.getDisplayDescriptionFromUI())}},setProject:function(selectedProjectId){if(!this.projectSelect){return }var options=this.projectSelect.options;for(var i=0;i<options.length;i++){if(options[i].value==selectedProjectId){options[i].selected=true}}},setRoles:function(selectedRoleId){if(!this.projectSelect||!this.roleSelect||!this.roleSelectGroup){return }var option=this.projectSelect.options[this.projectSelect.selectedIndex];var roles=option.getAttribute("roles");var rolesArray;if(roles){try{rolesArray=JSON.parse(roles);if(!rolesArray){rolesArray=[]}}catch(ex){rolesArray=[]}}else{rolesArray=[]}if(this.roleSelectGroup.parentNode){this.roleSelect.removeChild(this.roleSelectGroup);this.roleSelectGroup=this.roleSelectGroup.cloneNode(false)}var selOpt=null;if(rolesArray.length>0){for(var i=0;i<rolesArray.length;i++){var newOption=document.createElement("OPTION");newOption.appendChild(document.createTextNode(this.roleMap[rolesArray[i]]));var roleId=rolesArray[i];newOption.value=roleId;if(roleId==selectedRoleId){selOpt=newOption}this.roleSelectGroup.appendChild(newOption)}this.roleSelect.appendChild(this.roleSelectGroup)}if(selOpt){selOpt.selected=true}},getProject:function(id){var project=this.projectMap[id];if(!project){project=JIRA.Share.i18n.getMessage("share_invalid_project");if(!project){project="[Invalid Project]"}}return project},getRole:function(id){var role=this.roleMap[id];if(!role){role=JIRA.Share.i18n.getMessage("share_invalid_role");if(!role){role="[Invalid Role]"}}return role},updateSelectionFromPermission:function(sharePermission){this.setProject(sharePermission.param1);this.setRoles(sharePermission.param2)}};JIRA.Share.AnyShare=function(){this.type="any";this.singleton=true};JIRA.Share.AnyShare.prototype={getDisplayDescriptionFromUI:function(){return JIRA.Share.i18n.getMessage("share_any_description")}};JIRA.Share.Display=function(display,description,singleton,permission){this.display=display;this.singleton=singleton;this.permission=permission;this.description=description};JIRA.Share.SharePermission=function(type,param1,param2){this.type=type;if(param1){this.param1=param1}if(param2){this.param2=param2}};JIRA.Share.SharePermission.prototype.equals=function(otherPermission){return this.type===otherPermission.type&&this.param1===otherPermission.param1&&this.param2===otherPermission.param2};JIRA.Share.registerEditShareTypes=function(submitButtonId){var editController=new JIRA.Share.EditSharesController(submitButtonId);editController.registerShareType(new JIRA.Share.GlobalShare());editController.registerShareType(new JIRA.Share.GroupShare());editController.registerShareType(new JIRA.Share.ProjectShare());jQuery(document).ready(function(){editController.initialise()})};JIRA.Share.registerSelectShareTypes=function(){var selectController=new JIRA.Share.SelectSingleShareTypeController();selectController.registerShareType(new JIRA.Share.AnyShare());selectController.registerShareType(new JIRA.Share.GroupShare());selectController.registerShareType(new JIRA.Share.ProjectShare());jQuery(document).ready(function(){selectController.initialise()})};
/* module-key = 'jira.webresources:ajax-favourite-control', location = '/includes/jira/field/FavouritePicker.js' */
define("jira/field/favourite-picker",["jquery"],function($){var FavouritePicker=function(options){var entityId=options["entityId"],entityType=options["entityType"],favId=options["tableId"]+"_"+entityType+"_"+entityId,favLink=$("#fav_a_"+favId),enabled=options["enabled"],undoContainer=$("#undo_div"),favCountEnabled=$("#fav_count_enabled_"+favId),favCountDisabled=$("#fav_count_disabled_"+favId),relatedDropdown=options.relatedDropdown;var urlType;if(entityType==="PortalPage"){urlType="dashboards"}else{if(entityType==="SearchRequest"){urlType="filters"}}var theUrl=contextPath+"/rest/api/1.0/"+urlType+"/"+entityId+"/favourite",originalOrder=[],initOriginalOrderArray=function(){$("#"+options["tableId"]).find("[id^=fav_div_]").each(function(i,domElem){originalOrder[originalOrder.length]=$(domElem).attr("rel")})},addUndoAction=function(){if(options["undoText"]!==undefined){var undoEntityName=options["undoEntityName"];var undoMessage=$("<p/>").html(AJS.format(options["undoText"],undoEntityName));var favNode=$("#"+options["removeId"]);undoMessage.find("a").attr("id","fav_undo_a_"+options["removeId"]).click(function(e){e.preventDefault();var theData=undefined;if(originalOrder.length>0){theData={entries:originalOrder}}$.ajax({url:theUrl,contentType:"application/json",data:JSON.stringify(theData),type:"POST",success:function(){undoMessage.remove();enabled="true";updateLink();favNode.show();if(undoContainer.find("p").length===0){undoContainer.addClass("hidden")}recolourSimpleTableRows(options["tableId"])},error:function(){alert($(".favourite-params").find("#errorMsg").val())}})});favNode.hide();recolourSimpleTableRows(options["tableId"]);undoContainer.append(undoMessage);undoContainer.removeClass("hidden")}},toggleFavourite=function(){if(enabled==="true"){$($.ajax({url:theUrl,type:"DELETE",success:function(){enabled="false";updateLink();addUndoAction()},error:function(){alert($(".favourite-params").find("#errorMsg").val())}})).throbber({target:favLink})}else{$($.ajax({url:theUrl,type:"PUT",success:function(){enabled="true";updateLink()},error:function(){alert($(".favourite-params").find("#errorMsg").val())}})).throbber({target:favLink})}},invalidateFiltersList=function(){if(relatedDropdown){if(JIRA.Dropdown[relatedDropdown]){JIRA.Dropdown[relatedDropdown].resetCache()}}},updateLink=function(){if(enabled==="true"){favLink.addClass("enabled").removeClass("disabled").attr("title",options["titleAdd"]).text(options["titleAdd"]);favCountEnabled.show();favCountDisabled.hide()}else{favLink.addClass("disabled").removeClass("enabled").attr("title",options["titleRemove"]).text(options["titleRemove"]);favCountEnabled.hide();favCountDisabled.show()}invalidateFiltersList()};updateLink();favLink.click(function(e){e.preventDefault();toggleFavourite()});initOriginalOrderArray()};FavouritePicker.NewPicker=function(options){var fieldId=options["fieldId"],favLink=$("#fav_a_"+fieldId),favHidden=$("#fav_new_"+fieldId),enabled=options["enabled"],updateLink=function(){if(enabled==="true"){favLink.addClass("enabled").removeClass("disabled").attr("title",options["titleAdd"]).find("span").text(options["titleAdd"]);favHidden.val("true")}else{favLink.addClass("disabled").removeClass("enabled").attr("title",options["titleRemove"]).find("span").text(options["titleRemove"]);favHidden.val("false")}};updateLink();favLink.click(function(e){e.preventDefault();if(enabled==="true"){enabled="false"}else{enabled="true"}updateLink()})};FavouritePicker.init=function(parent){$(".favourite-params",parent).each(function(){var params={};$(this).find("input").each(function(){var $this=$(this);params[$this.attr("id")]=$this.val()});if(params["remote"]==="false"){FavouritePicker.NewPicker(params)}else{FavouritePicker(params)}})};return FavouritePicker});AJS.namespace("JIRA.FavouritePicker",null,require("jira/field/favourite-picker"));AJS.namespace("jira.widget.favourite",null,{Picker:JIRA.FavouritePicker,NewPicker:JIRA.FavouritePicker.NewPicker});
/* module-key = 'jira.webresources:ajax-favourite-control', location = '/includes/jira/field/initFavouritePickers.js' */
JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,$ctx,reason){if(reason==JIRA.CONTENT_ADDED_REASON.pageLoad){JIRA.FavouritePicker.init($ctx)}});
/* module-key = 'jira.webresources:manageshared', location = '/includes/jira/tabs/TabManager.js' */
JIRA.TabManager=function(){return{navigationTabs:function(){var loadEvents={},loadTab,filterTab,activeTab,previousTab,xhrObject,tabs,CONST={filterTabSelector:JIRA.Page.mainContentCssSelector,tabsSelector:"ul.vertical.tabs li",requestParams:"decorator=none&contentOnly=true",stateRequestParams:"decorator=none&contentOnly=true&updateState=true",activeTabClass:"active",loadedTabClass:"loaded",getTabRegEx:/filterView=.*/,checkQualifiedUrlRegEx:/\?(?=filterView=)/,idGeneratorRegEx:/^[^\?]*\?/},runTabLoadEvent=function(hashMapID){if(loadEvents[hashMapID]&&loadEvents[hashMapID] instanceof Array){jQuery(loadEvents[hashMapID]).each(function(){this()})}},navigateToTab=function(tab,historyEvent,url){var tabAnchor=jQuery(tab).find("a"),id=url.replace(CONST.idGeneratorRegEx,""),populateTab=function(contentObj){filterTab.empty();filterTab.html(contentObj);if(!historyEvent){dhtmlHistory.add(id)}runTabLoadEvent(tabAnchor.attr("id"));activeTab.addClass(CONST.loadedTabClass);JIRA.trigger(JIRA.Events.NEW_CONTENT_ADDED,[filterTab,JIRA.CONTENT_ADDED_REASON.tabUpdated])};if(CONST.checkQualifiedUrlRegEx.test(window.location.href)){window.location.href=url.replace(CONST.checkQualifiedUrlRegEx,"#");return }if(url&&(activeTab.get(0)!==tab||url)){if(activeTab&&activeTab.length){previousTab=activeTab.removeClass(CONST.activeTabClass).removeClass(CONST.loadedTabClass)}activeTab=jQuery(tab).addClass("active");if(xhrObject&&xhrObject.get(0)&&xhrObject.get(0).readyState!==4&&xhrObject.get(0).abort){if(jQuery.isFunction(xhrObject.hideThrobber)){xhrObject.hideThrobber()}xhrObject.get(0).abort()}filterTab.html("<h2>"+tabAnchor.attr("title")+"</h2>");xhrObject=jQuery(jQuery.ajax({method:"get",dataType:"html",url:url,data:CONST.requestParams,success:populateTab}).fail(function(jqXHR){if(jqXHR.status===401){window.location.reload()}else{if(jqXHR.statusText!=="abort"){var fragment=jqXHR.responseText&&jqXHR.responseText.match(/<body[^>]*>([\S\s]*)<\/body[^>]*>/);if(fragment&&fragment.length>0){filterTab.html('<div style="padding:0 20px">'+fragment[1]+"</div>")}}}})).throbber({target:tab})}},handleBrowserNavigation=function(newLocation){var node;if(activeTab.find("a").attr("href").replace(CONST.idGeneratorRegEx,"")===newLocation){return }if(newLocation&&newLocation!==""){node=getTab(newLocation);newLocation=jQuery(node).find("a").attr("href").match(CONST.idGeneratorRegEx)+newLocation}else{if(newLocation===""){node=jQuery(loadTab);newLocation=node.find("a").attr("href")}}if(node){navigateToTab(node,true,newLocation)}},getTab=function(url){var tabRegExp=CONST.getTabRegEx,tabToTarget=url.match(tabRegExp),tab;jQuery(tabs).each(function(){var tabToCompare=jQuery(this).find("a").attr("href").match(tabRegExp);if(tabToTarget&&tabToTarget.length>0&&tabToCompare[0]===tabToTarget[0]){tab=this}});return tab};window.onload=function(onload){return function(){if(jQuery.isFunction(onload)){onload()}dhtmlHistory.initialize();dhtmlHistory.addListener(handleBrowserNavigation)}}(window.onload);return{getActiveTab:function(){return activeTab},getProjectTab:function(){return filterTab},addLoadEvent:function(tabName,handler){loadEvents[tabName]=loadEvents[tabName]||[];if(jQuery.isFunction(handler)){loadEvents[tabName].push(handler)}},init:function(opts){AJS.$.extend(CONST,opts);var addressTab;filterTab=jQuery(CONST.filterTabSelector);tabs=jQuery(CONST.tabsSelector).each(function(){if(jQuery(this).hasClass(CONST.activeTabClass)){activeTab=jQuery(this);activeTab.addClass(CONST.loadedTabClass);loadTab=jQuery("#"+activeTab.find("a").attr("id")).parent()}});addressTab=getTab(window.location.href);if(dhtmlHistory.getCurrentHash()&&addressTab&&activeTab&&activeTab.find("a").attr("href").replace(CONST.idGeneratorRegEx,"")!==dhtmlHistory.getCurrentHash()){var newUrl=jQuery(addressTab).find("a").attr("href").match(CONST.idGeneratorRegEx)+dhtmlHistory.getCurrentHash();navigateToTab(jQuery(addressTab),true,newUrl)}jQuery(document).click(function(e){var node=e.target;if(node&&node.nodeName!=="A"){node=node.parentNode}if(node&&node.nodeName==="A"){var tab=getTab(node.href);if(tab){navigateToTab(tab,false,node.href);e.preventDefault()}}});if(opts&&opts.customInit){opts.customInit()}}}}()}}();AJS.namespace("jira.app.manageShared",null,JIRA.TabManager);
/* module-key = 'jira.webresources:version-blocks', location = '/includes/jira/versionblocks/VersionBlocks.js' */
JIRA.VersionBlocks={};JIRA.VersionBlocks.ClassNames={VERSION_LIST:"versions-list",VERSION_CONTAINER:"version-block-container",EXPANDED_CONTENT_CONTAINER:"version-issue-table"};JIRA.VersionBlocks.init=(function(){var classNames=JIRA.VersionBlocks.ClassNames;var dataElement=AJS.$("."+classNames.VERSION_LIST).first();var urlEndpoint=getUrl();AJS.$(document).on("click","a[data-version-block]",function(e){var $a=AJS.$(this),$root=$a.closest("."+classNames.VERSION_CONTAINER);var isActive=$root.data("expanded");var $container=$root.find("."+classNames.EXPANDED_CONTENT_CONTAINER);var $spinner=AJS.$("<span class='icon loading'></span>");if(!$container.size()){$container=AJS.$("<div/>").addClass(classNames.EXPANDED_CONTENT_CONTAINER).hide().appendTo($root)}var extraParams={};extraParams[(isActive)?"collapseVersion":"expandVersion"]=$root.find("[data-version-id]").data("version-id");var request=AJS.$.ajax({url:urlEndpoint,data:getUrlParams(extraParams),dataType:"json",beforeSend:function(){$a.closest("ul").append(AJS.$("<li/>").append($spinner))}});request.always(function(){$spinner.parent("li").remove()});request.fail(function(jqXHR,textStatus,errorThrown){console.log("Failed to load issues for version. User-facing error to do, sorry :(",arguments)});if(!isActive){request.done(function(data,textStatus,jqXHR){var html=AJS.$("<div/>").html(data.content);var content=html.find("."+classNames.EXPANDED_CONTENT_CONTAINER);$container.hide().replaceWith(content).show()})}else{request.done(function(){$container.hide()})}request.done(function(){$root.data("expanded",!isActive)});e.preventDefault()});function getUrl(){var href;href=document.location.href;href=href.replace(document.location.hash,"");href=href.replace(document.location.search,"");return href}function getUrlParams(opts){var params={decorator:"none",contentOnly:true,noTitle:true,selectedTab:getSelectedTab(),pid:dataElement.data("project-id"),component:dataElement.data("component-id")};return jQuery.extend(params,opts)}function getSelectedTab(){var selectedTab=dataElement.data("selected-tab");var paramString=""+document.location.search+document.location.hash;if(paramString.indexOf("selectedTab=")>-1){selectedTab=paramString.replace(/^.*selectedTab=(.*?)(?:&.*$|$)/,"$1");selectedTab=decodeURIComponent(selectedTab)}return selectedTab}});
/* module-key = 'com.atlassian.gadgets.embedded:gadget-core-resources', location = 'js/rpc.js' */
var gadgets=gadgets||{};gadgets.rpc=function(){var CALLBACK_NAME="__cb";var DEFAULT_NAME="";var FE_G2C_CHANNEL="__g2c_rpc";var FE_C2G_CHANNEL="__c2g_rpc";var services={};var iframePool=[];var relayUrl={};var useLegacyProtocol={};var authToken={};var callId=0;var callbacks={};var setup={};var sameDomain={};var params={};if(gadgets.util){params=gadgets.util.getUrlParameters()}authToken[".."]=params.rpctoken||params.ifpctok||0;function getRelayChannel(){return typeof window.postMessage==="function"?"wpm":typeof document.postMessage==="function"?"dpm":navigator.product==="Gecko"?"fe":"ifpc"}function setupChannel(){if(relayChannel==="dpm"||relayChannel==="wpm"){window.addEventListener("message",function(packet){try{if(typeof packet==="object"&&typeof packet.data==="string"){process(gadgets.json.parse(packet.data))}}catch(e){if(AJS.debug){var origin=packet&&packet.origin?packet.origin:"unknown origin";AJS.log("Error processing gadget rpc message from '"+origin+"': "+e)}}},false)}}var relayChannel=getRelayChannel();setupChannel();services[DEFAULT_NAME]=function(){throw new Error("Unknown RPC service: "+this.s)};services[CALLBACK_NAME]=function(callbackId,result){var callback=callbacks[callbackId];if(callback){delete callbacks[callbackId];callback(result)}};function setupFrame(frameId){if(setup[frameId]){return }if(relayChannel==="fe"){try{var frame=document.getElementById(frameId);frame[FE_G2C_CHANNEL]=function(args){process(gadgets.json.parse(args))}}catch(e){}}setup[frameId]=true}function encodeLegacyData(args){var stringify=gadgets.json.stringify;var argsEscaped=[];for(var i=0,j=args.length;i<j;++i){argsEscaped.push(encodeURIComponent(stringify(args[i])))}return argsEscaped.join("&")}function process(rpc){if(rpc&&typeof rpc.s==="string"&&typeof rpc.f==="string"&&rpc.a instanceof Array){if(authToken[rpc.f]){if(authToken[rpc.f]!=rpc.t){if(AJS.debug){console.log("Invalid auth token received for operation: "+rpc.s)}return }}if(rpc.c){rpc.callback=function(result){gadgets.rpc.call(rpc.f,CALLBACK_NAME,null,rpc.c,result)}}var result=(services[rpc.s]||services[DEFAULT_NAME]).apply(rpc,rpc.a);if(rpc.c&&typeof result!="undefined"){gadgets.rpc.call(rpc.f,CALLBACK_NAME,null,rpc.c,result)}}}function callFrameElement(targetId,serviceName,from,rpcData,callArgs){try{if(from!=".."){var fe=window.frameElement;if(typeof fe[FE_G2C_CHANNEL]==="function"){if(typeof fe[FE_G2C_CHANNEL][FE_C2G_CHANNEL]!=="function"){fe[FE_G2C_CHANNEL][FE_C2G_CHANNEL]=function(args){process(gadgets.json.parse(args))}}fe[FE_G2C_CHANNEL](rpcData);return }}else{var frame=document.getElementById(targetId);if(typeof frame[FE_G2C_CHANNEL]==="function"&&typeof frame[FE_G2C_CHANNEL][FE_C2G_CHANNEL]==="function"){frame[FE_G2C_CHANNEL][FE_C2G_CHANNEL](rpcData);return }}}catch(e){}callIfpc(targetId,serviceName,from,rpcData,callArgs)}function callIfpc(targetId,serviceName,from,rpcData,callArgs){var relay=gadgets.rpc.getRelayUrl(targetId);if(!relay){throw new Error("No relay file assigned for IFPC")}var src=null;if(useLegacyProtocol[targetId]){src=[relay,"#",encodeLegacyData([from,callId,1,0,encodeLegacyData([from,serviceName,"","",from].concat(callArgs))])].join("")}else{src=[relay,"#",targetId,"&",from,"@",callId,"&1&0&",encodeURIComponent(rpcData)].join("")}emitInvisibleIframe(src)}function emitInvisibleIframe(src){var iframe;for(var i=iframePool.length-1;i>=0;--i){var ifr=iframePool[i];try{if(ifr&&(ifr.recyclable||ifr.readyState==="complete")){ifr.parentNode.removeChild(ifr);if(window.ActiveXObject){iframePool[i]=ifr=null;iframePool.splice(i,1)}else{ifr.recyclable=false;iframe=ifr;break}}}catch(e){}}if(!iframe){iframe=document.createElement("iframe");iframe.style.border=iframe.style.width=iframe.style.height="0px";iframe.style.visibility="hidden";iframe.style.position="absolute";iframe.onload=function(){this.recyclable=true};iframePool.push(iframe)}iframe.src=src;setTimeout(function(){document.body.appendChild(iframe)},0)}function callSameDomain(target,rpc){if(typeof sameDomain[target]==="undefined"){sameDomain[target]=false;var targetEl=null;if(target===".."){targetEl=parent}else{targetEl=frames[target]}try{sameDomain[target]=targetEl.gadgets.rpc.receiveSameDomain}catch(e){}}if(typeof sameDomain[target]==="function"){sameDomain[target](rpc);return true}return false}if(gadgets.config){function init(config){if(config.rpc.parentRelayUrl.substring(0,7)==="http://"){relayUrl[".."]=config.rpc.parentRelayUrl}else{var params=document.location.search.substring(0).split("&");var parentParam="";for(var i=0,param;param=params[i];++i){if(param.indexOf("parent=")===0){parentParam=decodeURIComponent(param.substring(7));break}}relayUrl[".."]=parentParam+config.rpc.parentRelayUrl}useLegacyProtocol[".."]=!!config.rpc.useLegacyProtocol}var requiredConfig={parentRelayUrl:gadgets.config.NonEmptyStringValidator};gadgets.config.register("rpc",requiredConfig,init)}return{register:function(serviceName,handler){if(serviceName==CALLBACK_NAME){throw new Error("Cannot overwrite callback service")}if(serviceName==DEFAULT_NAME){throw new Error("Cannot overwrite default service:"+" use registerDefault")}services[serviceName]=handler},unregister:function(serviceName){if(serviceName==CALLBACK_NAME){throw new Error("Cannot delete callback service")}if(serviceName==DEFAULT_NAME){throw new Error("Cannot delete default service:"+" use unregisterDefault")}delete services[serviceName]},registerDefault:function(handler){services[""]=handler},unregisterDefault:function(){delete services[""]},call:function(targetId,serviceName,callback,var_args){++callId;targetId=targetId||"..";if(callback){callbacks[callId]=callback}var from="..";if(targetId===".."){from=window.name}var rpc={s:serviceName,f:from,c:callback?callId:0,a:Array.prototype.slice.call(arguments,3),t:authToken[targetId]};if(callSameDomain(targetId,rpc)){return }var rpcData=gadgets.json.stringify(rpc);var channelType=relayChannel;if(useLegacyProtocol[targetId]){channelType="ifpc"}switch(channelType){case"dpm":var targetDoc=targetId===".."?parent.document:frames[targetId].document;targetDoc.postMessage(rpcData);break;case"wpm":var targetWin=targetId===".."?parent:frames[targetId];targetWin.postMessage(rpcData,relayUrl[targetId]);break;case"fe":callFrameElement(targetId,serviceName,from,rpcData,rpc.a);break;default:callIfpc(targetId,serviceName,from,rpcData,rpc.a);break}},getRelayUrl:function(targetId){return relayUrl[targetId]},setRelayUrl:function(targetId,url,opt_useLegacy){relayUrl[targetId]=url;useLegacyProtocol[targetId]=!!opt_useLegacy},setAuthToken:function(targetId,token){authToken[targetId]=token;setupFrame(targetId)},getRelayChannel:function(){return relayChannel},receive:function(fragment){if(fragment.length>4){process(gadgets.json.parse(decodeURIComponent(fragment[fragment.length-1])))}},receiveSameDomain:function(rpc){rpc.a=Array.prototype.slice.call(rpc.a);window.setTimeout(function(){process(rpc)},0)}}}();
/* module-key = 'com.atlassian.gadgets.embedded:gadget-core-resources', location = 'js/util.js' */
Function.prototype.inherits=function(parentCtor){function tempCtor(){}tempCtor.prototype=parentCtor.prototype;this.superClass_=parentCtor.prototype;this.prototype=new tempCtor();this.prototype.constructor=this};
/* module-key = 'com.atlassian.gadgets.embedded:gadget-core-resources', location = 'js/json.js' */
var gadgets=gadgets||{};gadgets.json=function(){function f(n){return n<10?"0"+n:n}Date.prototype.toJSON=function(){return[this.getUTCFullYear(),"-",f(this.getUTCMonth()+1),"-",f(this.getUTCDate()),"T",f(this.getUTCHours()),":",f(this.getUTCMinutes()),":",f(this.getUTCSeconds()),"Z"].join("")};var m={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};function stringify(value){var a,i,k,l,r=/["\\\x00-\x1f\x7f-\x9f]/g,v;switch(typeof value){case"string":return r.test(value)?'"'+value.replace(r,function(a){var c=m[a];if(c){return c}c=a.charCodeAt();return"\\u00"+Math.floor(c/16).toString(16)+(c%16).toString(16)})+'"':'"'+value+'"';case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null"}a=[];if(typeof value.length==="number"&&!(value.propertyIsEnumerable("length"))){l=value.length;for(i=0;i<l;i+=1){a.push(stringify(value[i])||"null")}return"["+a.join(",")+"]"}for(k in value){if(value.hasOwnProperty(k)){if(typeof k==="string"){v=stringify(value[k]);if(v){a.push(stringify(k)+":"+v)}}}}return"{"+a.join(",")+"}"}}return{stringify:stringify,parse:function(text){if(/^[\],:{}\s]*$/.test(text.replace(/\\["\\\/b-u]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){return eval("("+text+")")}return false}}}();
/* module-key = 'com.atlassian.gadgets.embedded:gadget-core-resources', location = 'js/gadgets-core.js' */
var gadgets=gadgets||{};gadgets.error={};gadgets.error.SUBCLASS_RESPONSIBILITY="subclass responsibility";gadgets.error.TO_BE_DONE="to be done";gadgets.log=function(message){if(window.console&&console.log){console.log(message)}else{var logEntry=document.createElement("div");logEntry.className="gadgets-log-entry";logEntry.innerHTML=message;document.body.appendChild(logEntry)}};gadgets.Extensible=function(){};gadgets.Extensible.prototype.setDependencies=function(dependencies){for(var p in dependencies){this[p]=dependencies[p]}};gadgets.Extensible.prototype.getDependencies=function(name){return this[name]};gadgets.UserPrefStore=function(){};gadgets.UserPrefStore.prototype.getPrefs=function(gadget){throw Error(gadgets.error.SUBCLASS_RESPONSIBILITY)};gadgets.UserPrefStore.prototype.savePrefs=function(gadget){throw Error(gadgets.error.SUBCLASS_RESPONSIBILITY)};gadgets.DefaultUserPrefStore=function(){gadgets.UserPrefStore.call(this)};gadgets.DefaultUserPrefStore.inherits(gadgets.UserPrefStore);gadgets.DefaultUserPrefStore.prototype.getPrefs=function(gadget){};gadgets.DefaultUserPrefStore.prototype.savePrefs=function(gadget){};gadgets.GadgetService=function(){};gadgets.GadgetService.prototype.setHeight=function(elementId,height){throw Error(gadgets.error.SUBCLASS_RESPONSIBILITY)};gadgets.GadgetService.prototype.setTitle=function(gadget,title){throw Error(gadgets.error.SUBCLASS_RESPONSIBILITY)};gadgets.GadgetService.prototype.setUserPref=function(id){throw Error(gadgets.error.SUBCLASS_RESPONSIBILITY)};gadgets.IfrGadgetService=function(){gadgets.GadgetService.call(this);var service=this;gadgets.rpc.register("resize_iframe",function(){service.setHeight.apply(this,arguments)});gadgets.rpc.register("set_pref",function(){service.setUserPref.apply(this,arguments)});gadgets.rpc.register("set_title",function(){service.setTitle.apply(this,arguments)});gadgets.rpc.register("requestNavigateTo",function(){service.requestNavigateTo.apply(this,arguments)})};gadgets.IfrGadgetService.inherits(gadgets.GadgetService);gadgets.IfrGadgetService.prototype.setHeight=function(height){if(height>gadgets.container.maxheight_){height=gadgets.container.maxheight_}var element=document.getElementById(this.f);if(element){element.style.height=height+"px"}};gadgets.IfrGadgetService.prototype.requestNavigateTo=function(view,opt_params){var id=this.getGadgetIdFromModuleId(this.f);var url=this.getUrlForView(view);if(opt_params){var paramStr=JSON.stringify(opt_params);if(paramStr.length>0){url+="&appParams="+encodeURIComponent(paramStr)}}if(url&&document.location.href.indexOf(url)==-1){document.location.href=url}};gadgets.IfrGadgetService.prototype.getUrlForView=function(view){if(view==="canvas"){return"/canvas"}else{if(view==="profile"){return"/profile"}else{return null}}};gadgets.IfrGadgetService.prototype.getGadgetIdFromModuleId=function(moduleId){return parseInt(moduleId.match(/_([0-9]+)$/)[1],10)};gadgets.LayoutManager=function(){};gadgets.LayoutManager.prototype.getGadgetChrome=function(gadget){throw Error(gadgets.error.SUBCLASS_RESPONSIBILITY)};gadgets.StaticLayoutManager=function(){gadgets.LayoutManager.call(this)};gadgets.StaticLayoutManager.inherits(gadgets.LayoutManager);gadgets.StaticLayoutManager.prototype.setGadgetChromeIds=function(gadgetChromeIds){this.gadgetChromeIds_=gadgetChromeIds};gadgets.StaticLayoutManager.prototype.getGadgetChrome=function(gadget){var chromeId=this.gadgetChromeIds_[gadget.id];return chromeId?document.getElementById(chromeId):null};gadgets.FloatLeftLayoutManager=function(layoutRootId){gadgets.LayoutManager.call(this);this.layoutRootId_=layoutRootId};gadgets.FloatLeftLayoutManager.inherits(gadgets.LayoutManager);gadgets.FloatLeftLayoutManager.prototype.getGadgetChrome=function(gadget){var layoutRoot=document.getElementById(this.layoutRootId_);if(layoutRoot){var chrome=document.createElement("div");chrome.className="gadgets-gadget-chrome";chrome.style.cssFloat="left";layoutRoot.appendChild(chrome);return chrome}else{return null}};
/* module-key = 'com.atlassian.gadgets.embedded:gadget-container-resources', location = 'js/gadgets-container.js' */
gadgets.Container=function(){this.parentUrl_="http://"+document.location.host;this.country_="ALL";this.language_="ALL";this.view_="default";this.nocache_=1;this.maxheight_=2147483647};gadgets.Container.inherits(gadgets.Extensible);gadgets.Container.prototype.userPrefStore=new gadgets.DefaultUserPrefStore();gadgets.Container.prototype.gadgetService=new gadgets.GadgetService();gadgets.Container.prototype.layoutManager=new gadgets.StaticLayoutManager();gadgets.Container.prototype.setParentUrl=function(url){this.parentUrl_=url};gadgets.Container.prototype.setCountry=function(country){this.country_=country};gadgets.Container.prototype.setNoCache=function(nocache){this.nocache_=nocache};gadgets.Container.prototype.setLanguage=function(language){this.language_=language};gadgets.Container.prototype.setView=function(view){this.view_=view};gadgets.Container.prototype.setMaxHeight=function(maxheight){this.maxheight_=maxheight};gadgets.Container.prototype.getGadgetKey_=function(instanceId){return"gadget_"+instanceId};gadgets.IfrContainer=function(){gadgets.Container.call(this)};gadgets.IfrContainer.inherits(gadgets.Container);gadgets.IfrContainer.prototype.gadgetService=new gadgets.IfrGadgetService();gadgets.IfrContainer.prototype.setParentUrl=function(url){if(!url.match(/^http[s]?:\/\//)){url=document.location.href.match(/^[^?#]+\//)[0]+url}this.parentUrl_=url};gadgets.container=new gadgets.IfrContainer();
/* module-key = 'com.atlassian.gadgets.embedded:gadget-standalone-resources', location = 'js/gadgets-standalone.js' */
new gadgets.IfrGadgetService();gadgets.IfrGadgetService.prototype.setTitle=function(title){};
/* module-key = 'jira.webresources:userprofile', location = '/includes/jira/dialog/UserProfileDialog.js' */
define("jira/dialog/user-profile-dialog",["jira/dialog/form-dialog","jquery"],function(FormDialog,jQuery){return FormDialog.extend({_getDefaultOptions:function(){return jQuery.extend(this._super(),{notifier:"#userdetails-notify"})},_handleSubmitResponse:function(data,xhr,smartAjaxResult){if(this.serverIsDone){if(this.options.autoClose){this.hide()}this._reloadOrNotify()}},_reload:function(){return false},show:function(){this._super();this._hideNotifier()},_reloadOrNotify:function(){if(this._reload()){window.location.reload()}else{this._showNotifier()}},_showNotifier:function(){jQuery(this.options.notifier).removeClass("hidden")},_hideNotifier:function(){jQuery(this.options.notifier).addClass("hidden")}})});AJS.namespace("AJS.UserProfilePopup",null,require("jira/dialog/user-profile-dialog"));AJS.namespace("JIRA.UserProfileDialog",null,require("jira/dialog/user-profile-dialog"));
/* module-key = 'jira.webresources:userprofile', location = '/includes/jira/dialog/EditProfileDialog.js' */
define("jira/dialog/edit-profile-dialog",["jira/dialog/user-profile-dialog","jquery"],function(UserProfileDialog,jQuery){return UserProfileDialog.extend({_handleSubmitResponse:function(data,xhr,smartAjaxResult){if(this.serverIsDone){this._updateName();this._updateMail();this._super(data,xhr,smartAjaxResult)}},_updateName:function(){var oldName=jQuery("#up-d-fullname").text();var name=jQuery("#edit-profile-fullname").val();jQuery("#up-d-fullname").text(name);jQuery("#up-user-title-name").text(name);jQuery("a[href*='ViewProfile.jspa']").each(function(){var $el=jQuery(this);if($el.text().indexOf(oldName)>=0){$el.text(name)}});if(window.frames["gadget-1"]&&window.frames["gadget-1"].AJS){window.frames["gadget-1"].jQuery("a[href*='ViewProfile.jspa']").each(function(){var $el=jQuery(this);if($el.text().indexOf(oldName)>=0){$el.text(name)}})}},_updateMail:function(){var email=jQuery("#edit-profile-email").val();var emailDiv=jQuery("#up-d-email");if(emailDiv.find("a").length===0){if(/\sat\s.*\sdot\s/.test(emailDiv.text())){emailDiv.text(email.replace(/@/g," at ").replace(/\./g," dot "))}else{emailDiv.text(email)}}else{emailDiv.find("a").attr("href","mailto:"+email).text(email)}}})});AJS.namespace("JIRA.EditProfileDialog",null,require("jira/dialog/edit-profile-dialog"));
/* module-key = 'jira.webresources:userprofile', location = '/includes/jira/dialog/EditPreferencesDialog.js' */
define("jira/dialog/edit-preferences-dialog",["jira/dialog/user-profile-dialog","jquery"],function(UserProfileDialog,jQuery){return UserProfileDialog.extend({_getDefaultOptions:function(){return jQuery.extend(this._super(),{notifier:"#userprofile-notify"})},_handleSubmitResponse:function(data,xhr,smartAjaxResult){if(this.serverIsDone){this._updatePageSize();this._updateEmail();this._updateSharing();this._updateOwnNotifications();this._updateLocale();this._updateTimezone();this._updateKeyboardShortcutsNotifications();this._updateAutowatch();this._super(data,xhr,smartAjaxResult)}},_updatePageSize:function(){var pageSize=jQuery("#update-user-preferences-pagesize").val();jQuery("#up-p-pagesize").text(pageSize)},_updateEmail:function(){var email=jQuery("option:selected","#update-user-preferences-mailtype").text();jQuery("#up-p-mimetype").text(email)},_updateSharing:function(){var sharing=jQuery("option:selected","#update-user-preferences-sharing").val();if(sharing!=="false"){jQuery("#up-p-share-private").show();jQuery("#up-p-share-public").hide()}else{jQuery("#up-p-share-private").hide();jQuery("#up-p-share-public").show()}},_updateOwnNotifications:function(){var ownNotifications=jQuery("option:selected","#update-user-preferences-own-notifications").val();if(ownNotifications!=="false"){jQuery("#up-p-notifications_on").show();jQuery("#up-p-notifications_off").hide()}else{jQuery("#up-p-notifications_on").hide();jQuery("#up-p-notifications_off").show()}},_updateLocale:function(){var localeNewValue=jQuery.trim(jQuery("option:selected","#update-user-preferences-locale").text());var localeOldValue=jQuery.trim(jQuery("#up-p-locale").text());if(localeOldValue!==localeNewValue){this._reload=function(){return true}}},_updateTimezone:function(){var current=jQuery("option:selected","#defaultUserTimeZone");var timeZoneNewValue=jQuery.trim(current.text());var timeZoneRegion=current.val();if(timeZoneRegion!="JIRA"){jQuery("#up-p-jira-default").hide()}else{jQuery("#up-p-jira-default").show()}jQuery("#up-p-timezone-label").text(timeZoneNewValue)},_updateKeyboardShortcutsNotifications:function(){var kbShortcutsNewValue=jQuery("option:selected","#update-user-preferences-keyboard-shortcuts").val();var kbShortcutsOldValue=jQuery("#up-p-keyboard-shortcuts-enabled").is(":visible")?"true":"false";if(kbShortcutsOldValue!==kbShortcutsNewValue){if(kbShortcutsNewValue!=="false"){jQuery("#up-p-keyboard-shortcuts-enabled").show();jQuery("#up-p-keyboard-shortcuts-disabled").hide()}else{jQuery("#up-p-keyboard-shortcuts-enabled").hide();jQuery("#up-p-keyboard-shortcuts-disabled").show()}this._reload=function(){return true}}},_updateAutowatch:function(){var autowatchValue=jQuery("option:selected","#update-user-preferences-autowatch").val();if(autowatchValue!=="false"){jQuery("#up-p-autowatch-enabled").show();jQuery("#up-p-autowatch-disabled").hide()}else{jQuery("#up-p-autowatch-enabled").hide();jQuery("#up-p-autowatch-disabled").show()}}})});AJS.namespace("JIRA.EditPreferencesDialog",null,require("jira/dialog/edit-preferences-dialog"));
/* module-key = 'jira.webresources:userprofile', location = '/includes/jira/dialog/initProfileDialogs.js' */
AJS.$(function(){var quickLinks=function(){var $quicklinks=AJS.$("#quicklinks");AJS.Dropdown.create({trigger:$quicklinks.find(".aui-dd-link"),content:$quicklinks.find(".aui-list"),alignment:AJS.RIGHT});return arguments.callee}();JIRA.VersionBlocks.init();new JIRA.EditProfileDialog({trigger:"#edit_profile_lnk",autoClose:true});new JIRA.UserProfileDialog({trigger:"#view_change_password",autoClose:true});new JIRA.UserProfileDialog({trigger:"#view_clear_rememberme",autoClose:true});new JIRA.EditPreferencesDialog({trigger:"#edit_prefs_lnk",autoClose:true})});
/* module-key = 'com.atlassian.jira.jira-tzdetect-plugin:tzdetect-userprofile', location = 'userprofile/tzdetect-checker.js' */
(function(B){var A={hash:location.hash.replace(/^#/,""),zoneId:"",zoneParts:[],zoneKeywords:{set:true,other:true,ignore:false},track:function(E,C){var D={name:"tzdetect.userprofile."+E};if(C){D.data=C}AJS.trigger("analyticsEvent",D)},checkZoneId:function(){if(A.hash.indexOf("zone-")!==0){return }A.zoneId=A.hash.replace(/^zone-/,"");if(A.zoneId in A.zoneKeywords){A.track(A.zoneId)}else{A.track("prefillzone",{zoneId:A.zoneId})}var D=A.zoneId.split("/");A.zoneParts=D.slice(0,1).concat(D.slice(1).join("/"));var C=A.zoneKeywords[A.zoneId];if(C===undefined||C===true){A.openPrefsDialog()}},openPrefsDialog:function(){var C=B("#edit_prefs_lnk");if(C.length){if(!(A.zoneId in A.zoneKeywords)){A.addDialogCallback()}C.click()}},addDialogCallback:function(){B(document).on("dialogContentReady",function C(E,D){if(D.options.trigger==="#edit_prefs_lnk"){B(document).off("dialogContentReady",C);A.setCascadingSelectValues()}})},setCascadingSelectValues:function(){var D=B("#timeZoneRegion");var C=B("#defaultUserTimeZone");D.val(A.zoneParts[0]).trigger("change");C.val(A.zoneParts.join("/")).trigger("change");setTimeout(function(){C.focus()},0)}};if(!window.__tzTesting){B(A.checkZoneId)}(JIRA.plugins||(JIRA.plugins={})).tzChecker=A})(AJS.$);
/* module-key = 'com.atlassian.devrel.developer-toolbox-plugin:dt-toolbar', location = 'assets/js/toolbar.js' */

/* module-key = 'jira-timesheet-plugin:timesheet-preferences-resources', location = '/js/timesheet-preferences.js' */
AJS.$(function(){var a=JIRA.FormDialog.extend({_getDefaultOptions:function(){return jQuery.extend(this._super(),{notifier:"#timesheet-preferences-notify"})},_handleSubmitResponse:function(c,d,b){if(this.serverIsDone){this._updatePrettyDuration();this._updateShowTotalInFront();this._updateHighlightHours();if(this.options.autoClose){this.hide()}this._reloadOrNotify()}},_reload:function(){return false},show:function(){this._super();this._hideNotifier()},_reloadOrNotify:function(){if(this._reload()){window.location.reload()}else{this._showNotifier()}},_showNotifier:function(){jQuery(this.options.notifier).removeClass("hidden")},_hideNotifier:function(){jQuery(this.options.notifier).addClass("hidden")},_updatePrettyDuration:function(){var b=AJS.$("#edit-pretty-duration option:selected").text();AJS.$("#pretty-duration").text(b)},_updateShowTotalInFront:function(){var b=AJS.$("#edit-show-total-in-front option:selected").text();AJS.$("#show-total-in-front").text(b)},_updateHighlightHours:function(){var b=AJS.$("#edit-highlight-hours");var c=b.val();if(c==""){c=b.attr("placeholder")}AJS.$("#highlight-hours").text(c)}});new a({trigger:"#timesheet_preferences_dialog_trigger",autoClose:true})});
/* module-key = 'jira.webresources:avatar-picker', location = '/includes/jquery/plugins/avataror/avataror.js' */
jQuery.fn.avataror=function(options){var $=jQuery,$document=$(document);this.each(function(){var $this=$(this);var imgsrc=$this.find("img").attr("src");$this.css({"-moz-border-radius":"10px","-webkit-border-radius":"10px"});$this.html("<p>Loading?</p>");var avataror={previewSize:48};avataror.preview=$("<div/>").addClass("avataror-preview").css({border:"solid 1px #000","float":"left",height:avataror.previewSize+"px",overflow:"hidden",width:avataror.previewSize+"px",position:"relative",top:"-9999em",left:"-9999em"});avataror.preview.prependTo(options.previewElement);avataror.img=$('<img src="'+imgsrc+'" alt="Avatar Source"/>');avataror.img.load(function(){avataror.image=$("<div/>").css({background:"url('"+imgsrc+"') no-repeat",clear:"left",position:"relative"});avataror.marker=$("<div/>").css({cursor:"move",position:"relative"});avataror.dash=$("<div/>");avataror.shadow=$("<div/>");avataror.dash.add(avataror.shadow).css({cursor:"move",opacity:0.5,left:0,top:0,position:"absolute"});avataror.image.append(avataror.shadow).append(avataror.dash).append(avataror.marker);$this.append(avataror.image);avataror.marker.html("<div></div><div></div><div></div><div></div>");$("div",avataror.marker).each(function(i){var $this=$(this);$this.css({background:"#000",border:"solid 1px #fff",width:"10px",height:"10px",position:"absolute","font-size":"1px"});$this.css(["left","right","right","left"][i],"-6px");$this.css(["top","top","bottom","bottom"][i],"-6px");$this.css("cursor",["nw-resize","ne-resize","se-resize","sw-resize"][i]);$this.mousedown(function(e){e.preventDefault();e.stopPropagation();avataror.dragging={x:e.pageX,y:e.pageY,ax:avataror.x,ay:avataror.y,w:avataror.width,h:avataror.height,i:i+1};avataror.shadow.hide()})});avataror.marker.add(avataror.image).mousedown(function(e){e.preventDefault();avataror.dragging={x:e.pageX,y:e.pageY,ax:avataror.x,ay:avataror.y,w:avataror.width,h:avataror.height};avataror.shadow.hide()});$document.mouseup(function(e){avataror.handleMouseUp(e)});$document.mousemove(function(e){if(avataror.dragging){avataror.handleMouseMove(e.pageX,e.pageY);e.preventDefault()}});avataror.imgwidth=avataror.img.width();avataror.imgheight=avataror.img.height();avataror.x=parseInt($("#avatar-offsetX").val());avataror.y=parseInt($("#avatar-offsetY").val());avataror.width=parseInt($("#avatar-width").val());avataror.height=avataror.width;avataror.image.css({width:avataror.imgwidth+"px",height:avataror.imgheight+"px"});avataror.setMarker();$this.css({width:avataror.imgwidth+"px"});avataror.preview.css({position:"static"});$("p",$this).remove();$this.trigger("AvatarImageLoaded")});avataror.preview.append(avataror.img);avataror.setMarker=function(){avataror.marker.css("border","dashed 1px #fff");avataror.dash.css("border","solid 1px #000");avataror.shadow.css("border","solid 1px #000");avataror.marker.add(this.dash).css("left",this.x-1+"px");avataror.marker.add(avataror.dash).css("top",avataror.y-1+"px");avataror.shadow.css("border-left-width",avataror.x+"px");avataror.shadow.css("border-right-width",avataror.imgwidth-avataror.x-avataror.width+"px");avataror.shadow.css("border-top-width",avataror.y+"px");avataror.shadow.css("border-bottom-width",avataror.imgheight-avataror.y-avataror.height+"px");avataror.shadow.css("width",avataror.width+"px");avataror.shadow.css("height",avataror.height+"px");avataror.marker.add(avataror.dash).css("width",avataror.width+"px");avataror.marker.add(avataror.dash).css("height",avataror.height+"px")};avataror.adjustPreview=function(){avataror.img.attr("width",avataror.imgwidth*avataror.previewSize/avataror.width);avataror.img.attr("height",avataror.imgheight*avataror.previewSize/avataror.height);avataror.img.css("margin-left","-"+avataror.x*avataror.previewSize/avataror.width+"px");avataror.img.css("margin-top","-"+avataror.y*avataror.previewSize/avataror.height+"px");avataror.preview.select()};avataror.handleMouseMove=function(newX,newY){avataror.dragging.nextExec=avataror.dragging.nextExec||0;if(avataror.dragging.nextExec==0){avataror.dragging.nextExec=3}else{avataror.dragging.nextExec--;return }var dx=newX-avataror.dragging.x;var dy=newY-avataror.dragging.y;if(this.dragging.i){var handler=avataror.resizeHandlers[this.dragging.i-1];handler(dx,dy)}else{avataror.x=avataror.dragging.ax+dx;avataror.y=avataror.dragging.ay+dy;if(avataror.x+avataror.width>avataror.imgwidth){avataror.x=avataror.imgwidth-avataror.width}if(avataror.y+avataror.height>avataror.imgheight){avataror.y=avataror.imgheight-avataror.height}if(avataror.x<0){avataror.x=0}if(avataror.y<0){avataror.y=0}}avataror.setMarker();avataror.adjustPreview()};avataror.handleMouseUp=function(e){$("#avatar-offsetX").val(avataror.x);$("#avatar-offsetY").val(avataror.y);$("#avatar-width").val(avataror.width);avataror.dragging=null;avataror.shadow.show()};avataror.originX=function(){return avataror.dragging.ax};avataror.originY=function(){return avataror.dragging.ay};avataror.originBottomX=function(){return avataror.dragging.ax+avataror.dragging.w};avataror.originBottomY=function(){return avataror.dragging.ay+avataror.dragging.h};avataror.originNw=function(){return{x:avataror.originX(),y:avataror.originY()}};avataror.originNe=function(){return{x:avataror.originBottomX(),y:avataror.originY()}};avataror.originSe=function(){return{x:avataror.originBottomX(),y:avataror.originBottomY()}};avataror.originSw=function(){return{x:avataror.originX(),y:avataror.originBottomY()}};avataror.nwHandler=function(dx,dy){var anchor=avataror.originSe();var tmpBase={x:avataror.originX()+dx,y:avataror.originY()+dy};var diffX=Math.abs(tmpBase.x-anchor.x),diffY=Math.abs(tmpBase.y-anchor.y);var newSize=Math.min(diffX,diffY);if(newSize<20){newSize=20}if(anchor.x-newSize<0){newSize=anchor.x}if(anchor.y-newSize<0){newSize=anchor.y}avataror.x=anchor.x-newSize;avataror.y=anchor.y-newSize;avataror.width=avataror.height=newSize};avataror.neHandler=function(dx,dy){var anchor=avataror.originSw();var tmpBase={x:avataror.originBottomX()+dx,y:avataror.originY()+dy};var diffX=Math.abs(tmpBase.x-anchor.x),diffY=Math.abs(tmpBase.y-anchor.y);var newSize=Math.min(diffX,diffY);if(newSize<20){newSize=20}if(anchor.x+newSize>avataror.imgwidth){newSize=avataror.imgwidth-anchor.x}if(anchor.y-newSize<0){newSize=anchor.y}avataror.y=anchor.y-newSize;avataror.width=avataror.height=newSize};avataror.seHandler=function(dx,dy){var anchor=avataror.originNw();var tmpBase={x:avataror.originBottomX()+dx,y:avataror.originBottomY()+dy};var diffX=Math.abs(tmpBase.x-anchor.x),diffY=Math.abs(tmpBase.y-anchor.y);var newSize=Math.min(diffX,diffY);if(newSize<20){newSize=20}if(anchor.x+newSize>avataror.imgwidth){newSize=avataror.imgwidth-anchor.x}if(anchor.y+newSize>avataror.imgheight){newSize=avataror.imgheight-anchor.y}avataror.width=avataror.height=newSize};avataror.swHandler=function(dx,dy){var anchor=avataror.originNe();var tmpBase={x:avataror.originX()+dx,y:avataror.originBottomY()+dy};var diffX=Math.abs(tmpBase.x-anchor.x),diffY=Math.abs(tmpBase.y-anchor.y);var newSize=Math.min(diffX,diffY);if(newSize<20){newSize=20}if(anchor.x-newSize<0){newSize=anchor.x}if(anchor.y+newSize>avataror.imgheight){newSize=avataror.imgheight-anchor.y}avataror.x=anchor.x-newSize;avataror.width=avataror.height=newSize};avataror.resizeHandlers=[avataror.nwHandler,avataror.neHandler,avataror.seHandler,avataror.swHandler]})};
/* module-key = 'jira.webresources:avatar-picker', location = '/includes/ajs/avatarpicker/Avatar.js' */
JIRA.Avatar=Class.extend({init:function(options){this._id=options.id;this._isSystemAvatar=options.isSystemAvatar;this._isSelected=options.isSelected;this._urls=options.urls},setUnSelected:function(){this._isSelected=false},setSelected:function(){this._isSelected=true},isSelected:function(){return !!this._isSelected},isSystemAvatar:function(){return this._isSystemAvatar},getId:function(){return this._id},getUrl:function(size){return this._urls[size]},toJSON:function(){return{id:this._id,isSystemAvatar:this._isSystemAvatar,isSelected:this._isSelected,urls:this._urls}}});JIRA.Avatar.createCustomAvatar=function(descriptor){descriptor.isSystemAvatar=false;return new JIRA.Avatar(descriptor)};JIRA.Avatar.createSystemAvatar=function(descriptor){descriptor.isSystemAvatar=true;return new JIRA.Avatar(descriptor)};JIRA.Avatar.getSizeObjectFromName=function(name){if("object"===typeof name){return name}var nameTrimmed="string"===typeof name?jQuery.trim(name):"";if(JIRA.Avatar.LARGE.param===name){return JIRA.Avatar.LARGE}else{if(JIRA.Avatar.MEDIUM.param===name){return JIRA.Avatar.MEDIUM}else{if(JIRA.Avatar.SMALL.param===name){return JIRA.Avatar.SMALL}else{if("xsmall"===name){return JIRA.Avatar.SMALL}else{return JIRA.Avatar.LARGE}}}}};JIRA.Avatar.LARGE={param:"large",height:48,width:48};JIRA.Avatar.MEDIUM={param:"medium",width:32,height:32};JIRA.Avatar.SMALL={param:"small",width:16,height:16};
/* module-key = 'jira.webresources:avatar-picker', location = '/includes/ajs/avatarpicker/AvatarManager.js' */
JIRA.AvatarManager=Class.extend({init:function(options){this.store=options.store;this.ownerId=options.ownerId;this.username=options.username;this.anonymousAvatarId=options.anonymousAvatarId;this.avatarSrcBaseUrl=options.avatarSrcBaseUrl},selectAvatar:function(avatar,options){return this.store.selectAvatar(avatar,options)},getById:function(id){return this.store.getById(id)},destroy:function(avatar,options){this.store.destroy(avatar,options)},update:function(avatar,options){this.store.update(avatar,options)},add:function(avatar,options){this.store._add(avatar,options)},getAllSystemAvatars:function(){return this.store.getAllSystemAvatars()},getAllCustomAvatars:function(){return this.store.getAllCustomAvatars()},getSelectedAvatar:function(){return this.store.getSelectedAvatar()},getAllAvatars:function(){return this.store.getAllAvatars()},getAllAvatarsRenderData:function(size){var i,instance=this,avatars=this.getAllAvatars(),renderData={system:[],custom:[]};for(i=0;i<avatars.system.length;i++){renderData.system.push(instance.getAvatarRenderData(avatars.system[i],size))}for(i=0;i<avatars.custom.length;i++){renderData.custom.push(instance.getAvatarRenderData(avatars.custom[i],size))}return renderData},getAvatarRenderData:function(avatar,size){var data=avatar.toJSON();data.src=this.getAvatarSrc(avatar,size);data.width=size.width;data.height=size.height;return data},refreshStore:function(options){this.store.refresh(options)},getAvatarSrc:function(avatar,size){if(this.store.isTempAvatar(avatar)){return contextPath+"/secure/temporaryavatar?"+jQuery.param({cropped:true,magic:new Date().getTime(),size:size.param})}return avatar.getUrl(AJS.format("{0}x{1}",size.height,size.width))},createTemporaryAvatar:function(field,options){this.store.createTemporaryAvatar(field,options)},createAvatarFromTemporary:function(instructions,options){this.store.createAvatarFromTemporary(instructions,options)},getAnonymousAvatarId:function(){return this.anonymousAvatarId}});JIRA.AvatarManager.createUniversalAvatarManager=function(options){var restQueryUrl,restUpdateUrl="",restCreateTempUrl="",restUpdateTempUrl="",restSingleAvatarUrl="";if(options.projectId){var urlAvatarOwnerPrefix=contextPath+"/rest/api/latest/universal_avatar/type/"+options.avatarType+"/owner/"+options.projectId;restQueryUrl=urlAvatarOwnerPrefix;var avatarCreateUrl=urlAvatarOwnerPrefix+"/avatar";restUpdateUrl=null;restCreateTempUrl=urlAvatarOwnerPrefix+"/temp";restUpdateTempUrl=avatarCreateUrl;restSingleAvatarUrl=avatarCreateUrl}else{restQueryUrl=contextPath+"/rest/api/latest/avatar/project/system";restCreateTempUrl=contextPath+"/rest/api/latest/avatar/project/temporary";restUpdateTempUrl=contextPath+"/rest/api/latest/avatar/project/temporaryCrop"}var store=new JIRA.AvatarStore({restQueryUrl:restQueryUrl,restUpdateUrl:restUpdateUrl,restCreateTempUrl:restCreateTempUrl,restUpdateTempUrl:restUpdateTempUrl,restSingleAvatarUrl:restSingleAvatarUrl,defaultAvatarId:options.defaultAvatarId});return new JIRA.AvatarManager({store:store,ownerId:options.projectId,avatarSrcBaseUrl:contextPath+"/secure/projectavatar"})};JIRA.AvatarManager.createProjectAvatarManager=function(options){options.avatarType="project";return JIRA.AvatarManager.createUniversalAvatarManager(options)};JIRA.AvatarManager.createUserAvatarManager=function(options){var userRestUrl=contextPath+"/rest/api/latest/user";var store=new JIRA.AvatarStore({restQueryUrl:userRestUrl+"/avatars",restUpdateUrl:userRestUrl+"/avatar",restCreateTempUrl:userRestUrl+"/avatar/temporary",restUpdateTempUrl:userRestUrl+"/avatar",restSingleAvatarUrl:userRestUrl+"/avatar",restParams:{"username":options.username},defaultAvatarId:options.defaultAvatarId});return new JIRA.AvatarManager({store:store,username:options.username,avatarSrcBaseUrl:contextPath+"/secure/useravatar"})};
/* module-key = 'jira.webresources:avatar-picker', location = '/includes/ajs/avatarpicker/AvatarStore.js' */
JIRA.AvatarStore=Class.extend({TEMP_ID:"TEMP",init:function(options){if(!options.restQueryUrl){throw new Error("JIRA.AvatarStore.init: You must specify [restQueryUrl], The rest url for querying avatars (see class description)")}if(!options.restCreateTempUrl){throw new Error("JIRA.AvatarStore.init: You must specify [restCreateTempUrl], The rest url for creating a temporary avatar (see class description)")}if(!options.restUpdateTempUrl){throw new Error("JIRA.AvatarStore.init: You must specify [restUpdateTempUrl], The rest url for updating a temporary avatar (see class description)")}if(!options.defaultAvatarId){throw new Error("JIRA.AvatarStore.init: You must specify [defaultAvatarId] to the contructor so the store "+"knows what to select if you delete the selected one")}this.restQueryUrl=options.restQueryUrl;this.restUpdateUrl=options.restUpdateUrl;this.restCreateTempUrl=options.restCreateTempUrl;this.restUpdateTempUrl=options.restUpdateTempUrl;this.restSingleAvatarUrl=options.restSingleAvatarUrl;this.restParams=options.restParams||{};this.restParams.atl_token=atl_token();this.defaultAvatarId=options.defaultAvatarId;this.avatars={system:[],custom:[]}},_buildCompleteUrl:function(url){var completeUrl=url;if(this.restParams){var queryParams="";for(var name in this.restParams){queryParams+=AJS.format("&{0}={1}",encodeURIComponent(name),encodeURIComponent(this.restParams[name]))}completeUrl+=("?"+queryParams.substr(1))}return completeUrl},getById:function(avatarId){var match;jQuery.each(this.avatars.system,function(i,avatar){if(this.getId()===avatarId){match=avatar;return false}});if(!match){jQuery.each(this.avatars.custom,function(i,avatar){if(this.getId()===avatarId){match=avatar;return false}})}return match},isTempAvatar:function(avatar){return(avatar.getId()===this.TEMP_ID)},_selectAvatar:function(avatar){var selected=this.getSelectedAvatar();if(selected){selected.setUnSelected()}avatar.setSelected()},selectAvatar:function(avatar,options){var instance=this;if(!avatar){throw new Error("JIRA.AvatarStore.selectAvatar: Cannot select Avatar that does not exist")}if(this.restUpdateUrl){JIRA.SmartAjax.makeRequest({type:"PUT",contentType:"application/json",dataType:"json",url:this._buildCompleteUrl(this.restUpdateUrl),data:JSON.stringify(avatar.toJSON()),success:function(){instance._selectAvatar(avatar);if(options.success){options.success.call(this,avatar)}},error:options.error})}else{instance._selectAvatar(avatar);if(options.success){options.success.call(this,avatar)}}},_destory:function(avatar){var index=jQuery.inArray(avatar,this.avatars.custom);if(index!==-1){this.avatars.custom.splice(index,1)}else{throw new Error("JIRA.AvatarStore._destroy: Cannot remove avatar ["+avatar.getId()+"], "+"it might be a system avatar (readonly) or does not exist.")}},destroy:function(avatar,options){var instance=this;options=options||{};if(!avatar){throw new Error("JIRA.AvatarStore.destroy: Cannot delete Avatar that does not exist")}JIRA.SmartAjax.makeRequest({type:"DELETE",url:this.getRestUrlForAvatar(avatar),success:function(){instance._destory(avatar);if(avatar.isSelected()){instance.selectAvatar(instance.getById(instance.defaultAvatarId),options)}else{if(options.success){options.success.apply(this,arguments)}}},error:options.error})},getSelectedAvatar:function(){for(var i=0;i<this.avatars.custom.length;i++){if(this.avatars.custom[i].isSelected()){return this.avatars.custom[i]}}for(i=0;i<this.avatars.system.length;i++){if(this.avatars.system[i].isSelected()){return this.avatars.system[i]}}},_update:function(avatar){var instance=this;if(this.getById(avatar.getId())){jQuery.each(this.avatars.custom,function(i){if(this.getId()===avatar.getId()){instance.avatars.custom[i]=avatar}})}else{throw new Error("JIRA.AvatarStore._update: Cannot update avatar ["+avatar.getId()+"], "+"it might be a system avatar (readonly) or does not exist.")}},update:function(avatar,options){var instance=this;options=options||{};JIRA.SmartAjax.makeRequest({type:"PUT",url:this.getRestUrlForAvatar(avatar),error:options.error,success:function(){instance._update(avatar);if(options.success){options.success.apply(this,arguments)}}})},_add:function(avatar){if(avatar.isSystemAvatar()){this.avatars.system.push(avatar)}else{this.avatars.custom.push(avatar)}},createAvatarFromTemporary:function(instructions,options){var instance=this;options=options||{};if(this.restUpdateTempUrl){JIRA.SmartAjax.makeRequest({type:"POST",url:this._buildCompleteUrl(this.restUpdateTempUrl),data:JSON.stringify(instructions),contentType:"application/json",dataType:"json",success:function(data){if(!data){data={id:instance.TEMP_ID,isSelected:true}}var avatar=JIRA.Avatar.createCustomAvatar(data);instance._add(avatar);if(options.success){options.success.call(this,data)}},error:options.error})}},createTemporaryAvatar:function(fileInput,options){options=AJS.$.extend(true,{},options,{params:this.restParams});JIRA.AvatarUtil.uploadTemporaryAvatar(this.restCreateTempUrl,fileInput,options)},_refresh:function(avatars){var instance=this;instance.avatars.system=[];instance.avatars.custom=[];if(avatars.system){jQuery.each(avatars.system,function(i,descriptor){instance.avatars.system.push(JIRA.Avatar.createSystemAvatar(descriptor))})}if(avatars.custom){jQuery.each(avatars.custom,function(i,descriptor){instance.avatars.custom.push(JIRA.Avatar.createCustomAvatar(descriptor))})}},refresh:function(options){var instance=this;var tempAvatar=this.getById(instance.TEMP_ID);options=options||{};JIRA.SmartAjax.makeRequest({url:this._buildCompleteUrl(this.restQueryUrl),error:options.error,success:function(avatars){instance._refresh(avatars);if(tempAvatar){instance._add(tempAvatar)}if(options.success){options.success.apply(this,arguments)}}})},getAllAvatars:function(){return this.avatars},getAllSystemAvatars:function(){return this.avatars.system},getAllCustomAvatars:function(){return this.avatars.custom},getRestUrlForAvatar:function(avatar){return this._buildCompleteUrl(this.restSingleAvatarUrl+"/"+avatar.getId())}});
/* module-key = 'jira.webresources:avatar-picker', location = '/includes/ajs/avatarpicker/AvatarUtil.js' */
JIRA.AvatarUtil={uploadUsingIframeRemoting:function(url,field,options){options=options||{};var fileName=field.val(),form=new AJS.InlineAttach.Form(new AJS.InlineAttach.FileInput(field,false)),progress=form.addStaticProgress(fileName);var $oldInput=form.cloneFileInput();form.fileSelector.clear();var timer=new AJS.InlineAttach.Timer(function(){!this.cancelled&&progress.show()},this);var upload=new AJS.InlineAttach.FormUpload({$input:$oldInput,url:url,params:AJS.$.extend({},options.params,{filename:fileName,atl_token:atl_token()}),scope:this,before:function(){!this.cancelled&&progress.start()},success:function(val,status){if(val.errorMessages&&val.errorMessages.length){form.addErrorWithFileName(val.errorMessages[0],fileName,JIRA.AvatarUtil.getErrorTarget(form))}else{if(options.success){options.success(val,status)}}},error:function(text){console.log(text);if(this.cancelled){return }if(text.indexOf("SecurityTokenMissing")>=0){form.addError(AJS.InlineAttach.Text.tr("upload.xsrf.timeout",fileName),JIRA.AvatarUtil.getErrorTarget(form))}else{form.addError(AJS.InlineAttach.Text.tr("upload.error.unknown",fileName),JIRA.AvatarUtil.getErrorTarget(form))}},after:function(){timer.cancel();progress.remove();if(!this.cancelled){form.enable()}}});progress.onCancel(function(){upload.abort()});upload.upload()},uploadUsingFileApi:function(url,field,options){var timer,upload,cancelled,file=field[0].files[0],form=new AJS.InlineAttach.Form(new AJS.InlineAttach.FileInput(field,false)),progress=form.addProgress(file);options=options||{};timer=new AJS.InlineAttach.Timer(function(){if(!cancelled){progress.show()}});upload=new AJS.InlineAttach.AjaxUpload({file:file,params:AJS.$.extend({},options.params,{filename:file.name,size:file.size,atl_token:atl_token()}),scope:this,url:url,before:function(){field.hide();!cancelled&&progress.start()},progress:function(val){progress.progress.$progress.parent().parent().show();!cancelled&&progress.update(val)},success:function(val,status){if(cancelled){return }if(val.errorMessages&&val.errorMessages.length){form.addErrorWithFileName(val.errorMessages[0],file.name,JIRA.AvatarUtil.getErrorTarget(form))}else{if(status===201){options.success(val,status)}}},error:function(text,status){if(status<0){form.addError(text,JIRA.AvatarUtil.getErrorTarget(form))}else{form.addError(AJS.InlineAttach.Text.tr("upload.error.unknown",file.name),JIRA.AvatarUtil.getErrorTarget(form))}if(options.error){options.error(text,status)}},after:function(){timer.cancel();progress.finish().remove();field.val("").show()}});upload.upload();progress.onCancel(function(){upload.abort()})},getErrorTarget:function(form){return{$element:form.$form.find(".error")}},uploadTemporaryAvatar:function(url,field,options){if(AJS.InlineAttach.AjaxPresenter.isSupported(field)){this.uploadUsingFileApi(url,field,options)}else{this.uploadUsingIframeRemoting(url,field,options)}}};
/* module-key = 'jira.webresources:avatar-picker', location = '/includes/ajs/avatarpicker/AvatarPicker.js' */
JIRA.AvatarPicker=AJS.Control.extend({init:function(options){this.avatarManager=options.avatarManager;this.avatarRenderer=options.avatarRenderer;this.imageEditor=options.imageEditor;this.size=options.size;this.selectCallback=options.select;this.cropperDialog=null;this.initialSelection=options.initialSelection},render:function(ready){var instance=this;this.avatarManager.refreshStore({success:function(){if(instance.cropperDialog instanceof JIRA.Dialog){instance.cropperDialog.hide();delete instance.cropperDialog}instance.element=jQuery('<div id="jira-avatar-picker" />');instance.element.html(JIRA.Templates.AvatarPicker.picker({avatars:instance.avatarManager.getAllAvatarsRenderData(instance.size)}));instance._assignEvents("selectAvatar",instance.element.find(".jira-avatar img"));instance._assignEvents("deleteAvatar",instance.element.find(".jira-delete-avatar"));instance._assignEvents("uploader",instance.element.find("#jira-avatar-uploader"));if(undefined!=instance.initialSelection){instance.getAvatarElById(instance.initialSelection).addClass("jira-selected-avatar")}ready(instance.element)},error:function(xhr,error,textStatus,smartAjaxResult){instance.appendErrorContent(instance.element,smartAjaxResult);ready(instance.element)}})},appendErrorContent:function(el,smartAjaxResult){try{var errors=JSON.parse(smartAjaxResult.data);if(errors&&errors.errorMessages){jQuery.each(errors.errorMessages,function(i,message){AJS.messages.error(el,{body:AJS.escapeHTML(message),closeable:false,shadowed:false})})}else{el.append(JIRA.SmartAjax.buildDialogErrorContent(smartAjaxResult,true))}}catch(e){el.append(JIRA.SmartAjax.buildDialogErrorContent(smartAjaxResult,true))}},uploadTempAvatar:function(field){var instance=this;this.avatarManager.createTemporaryAvatar(field,{success:function(data){if(data.id){instance.render(function(){instance.selectAvatar(data.id)})}else{field.val("");instance.cropperDialog=new JIRA.Dialog({id:"project-avatar-cropper",width:560,content:function(ready){var $el=instance.imageEditor.render(data);instance.imageEditor.edit({confirm:function(instructions){instance.avatarManager.createAvatarFromTemporary(instructions,{success:function(data){instance.render(function(){instance.selectAvatar(data.id)})}})}});$el.find(".cancel").click(function(){instance.cropperDialog.hide()});ready($el)}});instance.cropperDialog.bind("dialogContentReady",function(){AJS.$(instance).trigger(JIRA.AvatarPicker.ImageEditor.LOADED)});instance.cropperDialog.bind("Dialog.hide",function(){AJS.$(instance).trigger(JIRA.AvatarPicker.ImageEditor.DISMISSED)});instance.cropperDialog.show()}},error:function(){console.log(arguments)}})},getAvatarElById:function(id){return this.element.find(".jira-avatar[data-id='"+id+"']")},selectAvatar:function(id){var avatar,instance=this;avatar=this.avatarManager.getById(id);this.avatarManager.selectAvatar(this.avatarManager.getById(id),{error:function(){},success:function(){instance.getAvatarElById(id).remove();if(instance.selectCallback){instance.selectCallback.call(instance,avatar,instance.avatarManager.getAvatarSrc(avatar,instance.size))}}})},deleteAvatar:function(id){var instance=this;if(confirm("Are you sure you want to delete avatar?")){this.avatarManager.destroy(this.avatarManager.getById(id),{error:function(){},success:function(){var selectedAvatar=instance.avatarManager.getSelectedAvatar(),$avatar=instance.getAvatarElById(id);$avatar.fadeOut(function(){$avatar.remove()});if(selectedAvatar.getId()!==id){instance.getAvatarElById(selectedAvatar.getId()).addClass("jira-selected-avatar");instance.selectCallback.call(instance,selectedAvatar,instance.avatarManager.getAvatarSrc(selectedAvatar,instance.size),true)}}})}},_events:{uploader:{change:function(e,el){this.uploadTempAvatar(el)}},deleteAvatar:{click:function(e,el){this.deleteAvatar(el.attr("data-id"))}},selectAvatar:{click:function(e,el){if(e.target===el[0]){this.selectAvatar(el.attr("data-id"))}}}}});JIRA.AvatarPicker.ImageEditor=AJS.Control.extend({render:function(data){this.element=jQuery('<div id="avatar-picker-image-editor"/>').html(JIRA.Templates.AvatarPicker.imageEditor(data));return this.element},edit:function(options){var instance=this,avator=this.element.find(".avataror");options=options||{};avator.unbind();avator.bind("AvatarImageLoaded",function(){if(options.ready){options.ready()}});avator.find("img").load(function(){avator.avataror({previewElement:instance.element.find(".jira-avatar-cropper-header"),parent:instance.element})});this.element.find("#avataror").submit(function(e){e.preventDefault();if(options.confirm){options.confirm({cropperOffsetX:jQuery("#avatar-offsetX").val(),cropperOffsetY:jQuery("#avatar-offsetY").val(),cropperWidth:jQuery("#avatar-width").val()})}}).find(".cancel").click(function(e){e.preventDefault();if(options.cancel){options.cancel()}})}});JIRA.AvatarPicker.ImageEditor.LOADED="imageEditorLoaded";JIRA.AvatarPicker.ImageEditor.DISMISSED="imageEditorDismissed";JIRA.AvatarPicker.createUniversalAvatarPicker=function(options){return new JIRA.AvatarPicker({avatarManager:JIRA.AvatarManager.createUniversalAvatarManager({projectKey:options.projectKey,projectId:options.projectId,defaultAvatarId:options.defaultAvatarId,avatarType:options.avatarType}),initialSelection:options.initialSelection,imageEditor:new JIRA.AvatarPicker.ImageEditor(),size:options.hasOwnProperty("avatarSize")?options.avatarSize:JIRA.Avatar.LARGE,select:options.select})};JIRA.AvatarPicker.createProjectAvatarPicker=function(options){return new JIRA.AvatarPicker({avatarManager:JIRA.AvatarManager.createProjectAvatarManager({projectKey:options.projectKey,projectId:options.projectId,defaultAvatarId:options.defaultAvatarId}),imageEditor:new JIRA.AvatarPicker.ImageEditor(),size:JIRA.Avatar.LARGE,select:options.select})};JIRA.AvatarPicker.createUserAvatarPicker=function(options){return new JIRA.AvatarPicker({avatarManager:JIRA.AvatarManager.createUserAvatarManager({username:options.username,defaultAvatarId:options.defaultAvatarId}),imageEditor:new JIRA.AvatarPicker.ImageEditor(),size:JIRA.Avatar.LARGE,select:options.select})};JIRA.createUniversalAvatarPickerDialog=function(options){var lastSelection=options.initialSelection||options.defaultAvatarId;var projectAvatarDialog=new JIRA.FormDialog({trigger:options.trigger,id:"project-avatar-picker",width:560,stacked:true,content:function(ready){var avatarPicker,$dialogWrapper;$dialogWrapper=jQuery('<div id="projectavatar-content-wrapper"/>');jQuery("<h2 />").text(options.title||"Select a Project Avatar").appendTo($dialogWrapper);avatarPicker=JIRA.AvatarPicker.createUniversalAvatarPicker({projectKey:options.projectKey,projectId:options.projectId,defaultAvatarId:options.defaultAvatarId,initialSelection:lastSelection,avatarType:options.avatarType,avatarSize:options.avatarSize,select:function(avatar,src,implicit){lastSelection=String(avatar.getId());if(options.select){options.select.apply(this,arguments)}if(!implicit){projectAvatarDialog.hide()}}});avatarPicker.render(function(content){$dialogWrapper.append(content);ready($dialogWrapper)})}});projectAvatarDialog._focusFirstField=function(){}};JIRA.createProjectAvatarPickerDialog=function(options){var projectAvatarDialog=new JIRA.FormDialog({trigger:options.trigger,id:"project-avatar-picker",width:560,stacked:true,content:function(ready){var avatarPicker,$dialogWrapper;$dialogWrapper=jQuery('<div id="projectavatar-content-wrapper"/>');jQuery("<h2 />").text("Select a Project Avatar").appendTo($dialogWrapper);avatarPicker=JIRA.AvatarPicker.createProjectAvatarPicker({projectKey:options.projectKey,projectId:options.projectId,defaultAvatarId:options.defaultAvatarId,select:function(avatar,src,implicit){if(options.select){options.select.apply(this,arguments)}if(!implicit){projectAvatarDialog.hide()}}});avatarPicker.render(function(content){$dialogWrapper.append(content);ready($dialogWrapper)})}});projectAvatarDialog._focusFirstField=function(){}};JIRA.createUserAvatarPickerDialog=function(options){var userAvatarDialog=new JIRA.FormDialog({trigger:options.trigger,id:"user-avatar-picker",width:560,stacked:true,content:function(ready){var avatarPicker,$dialogWrapper;$dialogWrapper=jQuery('<div id="useravatar-content-wrapper"/>');jQuery("<h2 />").text("Select a User Avatar").appendTo($dialogWrapper);avatarPicker=JIRA.AvatarPicker.createUserAvatarPicker({username:options.username,defaultAvatarId:options.defaultAvatarId,select:function(avatar,src,implicit){if(options.select){options.select.apply(this,arguments)}jQuery(".avatar-image").attr("src",src);if(!implicit){userAvatarDialog.hide()}}});avatarPicker.render(function(content){$dialogWrapper.append(content);ready($dialogWrapper)})}});userAvatarDialog._focusFirstField=function(){}};jQuery(function(){JIRA.createUserAvatarPickerDialog({trigger:"#user_avatar_image",username:jQuery("#avatar-owner-id").text(),defaultAvatarId:jQuery("#default-avatar-id").text()})});
/* module-key = 'jira.webresources:avatar-picker', location = '/includes/ajs/avatarpicker/GravatarUtil.js' */
(function(){AJS.namespace("JIRA.GravatarUtil");JIRA.GravatarUtil.showGravatarHelp=function(data){if(typeof (data)!=="undefined"&&typeof (data.entry)!=="undefined"){AJS.$(".gravatar-signup-text").addClass("hidden");AJS.$(".gravatar-login-text").removeClass("hidden")}};var displayGravatarHelp=function(){var gravatarJsonUrl=AJS.$("#gravatar_json_url");if(gravatarJsonUrl.length){AJS.$.ajax(gravatarJsonUrl.val(),{dataType:"jsonp",success:JIRA.GravatarUtil.showGravatarHelp})}};AJS.$(document).ready(function(){if(AJS.$("#gravatar_help_params")){displayGravatarHelp()}})}());
/* module-key = 'jira.webresources:avatar-picker', location = '/includes/ajs/avatarpicker/AvatarPicker.soy' */
// This file was automatically generated from AvatarPicker.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.AvatarPicker == 'undefined') { JIRA.Templates.AvatarPicker = {}; }


JIRA.Templates.AvatarPicker.picker = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<form class="jira-avatar-upload-form" action="#"><input name="id" value="10000" type="hidden" ><input name="pid" value="10000" type="hidden" ><div class="field-group"><label>', soy.$$escapeHtml("Upload a new avatar"), '</label><input type="file" class="ignore-inline-attach" name="avatar" id="jira-avatar-uploader" /><div class="error"></div></div></form><div class="form-body"><ul class="jira-avatars">');
  var avatarList6 = opt_data.avatars.system;
  var avatarListLen6 = avatarList6.length;
  for (var avatarIndex6 = 0; avatarIndex6 < avatarListLen6; avatarIndex6++) {
    var avatarData6 = avatarList6[avatarIndex6];
    output.append('<li class="jira-avatar jira-system-avatar ', (avatarData6.isSelected) ? 'jira-selected-avatar' : '', '" title="Select this Avatar" data-id="', soy.$$escapeHtml(avatarData6.id), '"><span><img id="avatar-', soy.$$escapeHtml(avatarData6.id), '" data-id="', soy.$$escapeHtml(avatarData6.id), '" src="', soy.$$escapeHtml(avatarData6.src), '" width="', soy.$$escapeHtml(avatarData6.width), '" height="', soy.$$escapeHtml(avatarData6.height), '" /></span></li>');
  }
  var avatarList25 = opt_data.avatars.custom;
  var avatarListLen25 = avatarList25.length;
  for (var avatarIndex25 = 0; avatarIndex25 < avatarListLen25; avatarIndex25++) {
    var avatarData25 = avatarList25[avatarIndex25];
    output.append('<li class="jira-avatar jira-custom-avatar ', (avatarData25.isSelected) ? 'jira-selected-avatar' : '', '" title="Select this avatar" data-id="', soy.$$escapeHtml(avatarData25.id), '"><span><img id="avatar-', soy.$$escapeHtml(avatarData25.id), '" data-id="', soy.$$escapeHtml(avatarData25.id), '" src="', soy.$$escapeHtml(avatarData25.src), '" width="', soy.$$escapeHtml(avatarData25.width), '" height="', soy.$$escapeHtml(avatarData25.height), '" /></span><span class="jira-delete-avatar" data-id="', soy.$$escapeHtml(avatarData25.id), '" title="', soy.$$escapeHtml("Delete this Avatar"), '">Delete</span></li>');
  }
  output.append('</ul></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.AvatarPicker.imageEditor = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<form id="avataror" class="jira-avatar-cropper-form aui" action="/jira/secure/project/AvatarPicker.jspa"><input type="hidden" name="cropperOffsetX" id="avatar-offsetX" value="', soy.$$escapeHtml(opt_data.cropperOffsetX), '"><input type="hidden" name="cropperOffsetY" id="avatar-offsetY" value="', soy.$$escapeHtml(opt_data.cropperOffsetY), '"><input type="hidden" name="cropperWidth" id="avatar-width"  value="', soy.$$escapeHtml(opt_data.cropperWidth), '"><div class="jira-avatar-cropper-header"><p>', soy.$$escapeHtml("Please select which part of the uploaded image you wish to use as the avatar."), '</p></div><div class="form-body"><div class="avataror"><img src="', soy.$$escapeHtml(opt_data.url), '" height="300" /></div></div><div class="form-footer buttons-container"><div class="buttons"><input type="submit" class="aui-button" value="', soy.$$escapeHtml("Confirm"), '"><a class="aui-button aui-button-link cancel" href="#">', soy.$$escapeHtml("Cancel"), '</a></div></div></form>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-user-profile-plugin:user-details-resources', location = '/userprofile/ProfileDetails-view.soy' */
// This file was automatically generated from ProfileDetails-view.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.UserProfile == 'undefined') { JIRA.UserProfile = {}; }


JIRA.UserProfile.gravatarLozengeView = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<span class="gravatar-lozenge aui-lozenge aui-lozenge-subtle" title="', soy.$$escapeHtml(AJS.format("JIRA is using the gravatar for {0}",opt_data.userEmail)), '">Gravatar</span>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-user-profile-plugin:user-details-resources', location = '/userprofile/ProfileDetails.js' */
AJS.namespace("JIRA.UserProfile.ProfileDetails");JIRA.UserProfile.ProfileDetails=Backbone.View.extend({initialize:function(a){Backbone.View.prototype.initialize.call(this,a);a=_.defaults({},a,{baseUrl:AJS.params.baseURL});this._baseUrl=a.baseUrl;this._gravatarLozengeDiv=this.$(".gravatar-lozenge-container");this.onAvatarChanged(this.$(".avatar-image").attr("src"))},onAvatarChanged:function(a){if(!_.isEmpty(a)){this._renderGravatarLozenge(a);this._updateImageInProfileHeader(a)}},_renderGravatarLozenge:function(d){var a=JIRA.UserProfile.ProfileDetails._normaliseUrl(d);var c=JIRA.UserProfile.ProfileDetails._normaliseUrl(this._baseUrl);var b=a.substring(0,Math.min(a.length,c.length))===c;if(!b){this._gravatarLozengeDiv.html(JIRA.UserProfile.gravatarLozengeView({userEmail:AJS.$("#up-d-email").find("a").text()}));this.$(".gravatar-lozenge").tooltip({gravity:"w"})}else{this._gravatarLozengeDiv.empty()}},_updateImageInProfileHeader:function(a){AJS.$(".aui-page-header .aui-avatar-large img").attr("src",a)}},{_normaliseUrl:function(c){if(!parseUri){return c}var d={http:80,https:443};var b=parseUri(c);var a=!b.port?(d[b.protocol]||b.port):b.port;return AJS.format("{0}://{1}:{2}{3}",b.protocol,b.host,a,b.path)}});
/* module-key = 'com.atlassian.jira.jira-user-profile-plugin:user-details-resources', location = 'ProfileInit.js' */
AJS.$(function(){var a=[];AJS.$("#details-profile-fragment").each(function(){a.push(new JIRA.UserProfile.ProfileDetails({el:this}))});JIRA.createUserAvatarPickerDialog({trigger:"#details-user-avatar-trigger",username:jQuery("#avatar-owner-id").text(),defaultAvatarId:jQuery("#default-avatar-id").text(),select:function b(c,d){_.each(a,function(e){e.onAvatarChanged&&e.onAvatarChanged(d)})}})});
/* module-key = 'jira.webresources:field-templates', location = '/includes/jira/field/templates/singleUserPicker.soy' */
// This file was automatically generated from singleUserPicker.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.Fields == 'undefined') { JIRA.Templates.Fields = {}; }
if (typeof JIRA.Templates.Fields.Pickers == 'undefined') { JIRA.Templates.Fields.Pickers = {}; }
if (typeof JIRA.Templates.Fields.Pickers.User == 'undefined') { JIRA.Templates.Fields.Pickers.User = {}; }


JIRA.Templates.Fields.Pickers.User.single = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<select id="', soy.$$escapeHtml(opt_data.field.id), '" name="', soy.$$escapeHtml(opt_data.field.name), '" class="single-user-picker js-', (opt_data.type) ? soy.$$escapeHtml(opt_data.type) : 'default-user-picker', '"', (opt_data.inputText) ? ' data-input-text="' + soy.$$escapeHtml(opt_data.inputText) + '"' : '', (opt_data.editValue) ? ' data-edit-value="' + soy.$$escapeHtml(opt_data.editValue) + '"' : '', (opt_data.showDropdownButton) ? ' data-show-dropdown-button="true"' : '', (opt_data.userType) ? ' data-user-type="' + soy.$$escapeHtml(opt_data.userType) + '"' : '', (opt_data.containerClass) ? ' data-container-class="' + soy.$$escapeHtml(opt_data.containerClass) + '"' : '', '>');
  var optionList38 = opt_data.options;
  var optionListLen38 = optionList38.length;
  for (var optionIndex38 = 0; optionIndex38 < optionListLen38; optionIndex38++) {
    var optionData38 = optionList38[optionIndex38];
    if (optionData38.optionGroup) {
      output.append('<optgroup id="', soy.$$escapeHtml(opt_data.field.id), '-group-', soy.$$escapeHtml(optionData38.id), '" label="', soy.$$escapeHtml(optionData38.display), '"', (optionData38.footer) ? ' data-footer-text="' + soy.$$escapeHtml(optionData38.footer) + '"' : '', (optionData38.weight != -1) ? ' data-weight="' + soy.$$escapeHtml(optionData38.weight) + '"' : '', '>');
      var groupOptionList59 = optionData38.groupOptions;
      var groupOptionListLen59 = groupOptionList59.length;
      for (var groupOptionIndex59 = 0; groupOptionIndex59 < groupOptionListLen59; groupOptionIndex59++) {
        var groupOptionData59 = groupOptionList59[groupOptionIndex59];
        JIRA.Templates.Fields.Pickers.User.option(groupOptionData59, output);
      }
      output.append('</optgroup>');
    } else {
      JIRA.Templates.Fields.Pickers.User.option(optionData38, output);
    }
  }
  output.append('</select>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Fields.Pickers.User.option = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<option ', (opt_data.loggedInUser) ? 'class="current-user" ' : '', (opt_data.selected) ? 'selected="selected" ' : '', 'value="', soy.$$escapeHtml(opt_data.optionName), '" data-field-text="', soy.$$escapeHtml(opt_data.displayName), '" data-field-label="', soy.$$escapeHtml(opt_data.displayName), (opt_data.optionName && opt_data.optionName != '-1') ? ' - ' + soy.$$escapeHtml(opt_data.emailAddress) + ' (' + soy.$$escapeHtml(opt_data.optionName) + ')' : '', '" data-icon="', soy.$$escapeHtml(opt_data.avatarURL), '" >', soy.$$escapeHtml(opt_data.displayName), '</option>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'jira.webresources:field-templates', location = '/includes/jira/field/templates/assigneeField.soy' */
// This file was automatically generated from assigneeField.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.Fields == 'undefined') { JIRA.Templates.Fields = {}; }
if (typeof JIRA.Templates.Fields.Pickers == 'undefined') { JIRA.Templates.Fields.Pickers = {}; }
if (typeof JIRA.Templates.Fields.Pickers.User == 'undefined') { JIRA.Templates.Fields.Pickers.User = {}; }


JIRA.Templates.Fields.Pickers.User.assignee = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Templates.Fields.Pickers.User.single(soy.$$augmentData(opt_data, {options: opt_data.assigneeOptions.options, showDropdownButton: true, userType: 'assignee', type: 'assignee-picker', containerClass: 'long-field'}), output);
  output.append((opt_data.isLoggedInUserAssignable) ? '<a href="#' + soy.$$escapeHtml(opt_data.field.id) + '" id="assign-to-me-trigger">' + soy.$$escapeHtml("Assign to me") + '</a>' : '', '<fieldset class="hidden parameters"><input type="hidden" title="projectKeys" value="', soy.$$escapeHtml(opt_data.projectKeys), '"/>', (opt_data.issueKey) ? '<input type="hidden" title="assigneeEditIssueKey" value="' + soy.$$escapeHtml(opt_data.issueKey) + '"/>' : '', (opt_data.actionDescriptorId) ? '<input type="hidden" title="actionDescriptorId" value="' + soy.$$escapeHtml(opt_data.actionDescriptorId) + '"/>' : '', '</fieldset>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources', location = '/js/lib/jquery.dotdotdot-1.5.7.js' */
(function(i){if(i.fn.dotdotdot){return}i.fn.dotdotdot=function(v){if(this.length==0){if(!v||v.debug!==false){b(true,'No element found for "'+this.selector+'".')}return this}if(this.length>1){return this.each(function(){i(this).dotdotdot(v)})}var r=this;if(r.data("dotdotdot")){r.trigger("destroy.dot")}r.bind_events=function(){r.bind("update.dot",function(y,A){y.preventDefault();y.stopPropagation();t.maxHeight=(typeof t.height=="number")?t.height:o(r);t.maxHeight+=t.tolerance;if(typeof A!="undefined"){if(typeof A=="string"||A instanceof HTMLElement){A=i("<div />").append(A).contents()}if(A instanceof i){w=A}}s=r.wrapInner('<div class="dotdotdot" />').children();s.empty().append(w.clone(true)).css({height:"auto",width:"auto",border:"none",padding:0,margin:0});var z=false,x=false;if(q.afterElement){z=q.afterElement.clone(true);q.afterElement.remove()}if(k(s,t)){if(t.wrap=="children"){x=d(s,t,z)}else{x=m(s,r,s,t,z)}}s.replaceWith(s.contents());s=null;if(i.isFunction(t.callback)){t.callback.call(r[0],x,w)}q.isTruncated=x;return x}).bind("isTruncated.dot",function(y,x){y.preventDefault();y.stopPropagation();if(typeof x=="function"){x.call(r[0],q.isTruncated)}return q.isTruncated}).bind("originalContent.dot",function(y,x){y.preventDefault();y.stopPropagation();if(typeof x=="function"){x.call(r[0],w)}return w}).bind("destroy.dot",function(x){x.preventDefault();x.stopPropagation();r.unwatch().unbind_events().empty().append(w).data("dotdotdot",false)});return r};r.unbind_events=function(){r.unbind(".dot");return r};r.watch=function(){r.unwatch();if(t.watch=="window"){var z=i(window),y=z.width(),x=z.height();z.bind("resize.dot"+q.dotId,function(){if(y!=z.width()||x!=z.height()||!t.windowResizeFix){y=z.width();x=z.height();if(p){clearInterval(p)}p=setTimeout(function(){r.trigger("update.dot")},10)}})}else{u=j(r);p=setInterval(function(){var A=j(r);if(u.width!=A.width||u.height!=A.height){r.trigger("update.dot");u=j(r)}},100)}return r};r.unwatch=function(){i(window).unbind("resize.dot"+q.dotId);if(p){clearInterval(p)}return r};var w=r.contents(),t=i.extend(true,{},i.fn.dotdotdot.defaults,v),q={},u={},p=null,s=null;q.afterElement=c(t.after,r);q.isTruncated=false;q.dotId=l++;r.data("dotdotdot",true).bind_events().trigger("update.dot");if(t.watch){r.watch()}return r};i.fn.dotdotdot.defaults={ellipsis:"... ",wrap:"word",lastCharacter:{remove:[" ",",",";",".","!","?"],noEllipsis:[]},tolerance:0,callback:null,after:null,height:null,watch:false,windowResizeFix:true,debug:false};var l=1;function d(s,w,v){var u=s.children(),p=false;s.empty();for(var r=0,q=u.length;r<q;r++){var t=u.eq(r);s.append(t);if(v){s.append(v)}if(k(s,w)){t.remove();p=true;break}else{if(v){v.remove()}}}return p}function m(s,r,A,t,q){var w=s.contents(),x=false;s.empty();var z="table, thead, tbody, tfoot, tr, col, colgroup, object, embed, param, ol, ul, dl, select, optgroup, option, textarea, script, style";for(var y=0,u=w.length;y<u;y++){if(x){break}var v=w[y],p=i(v);if(typeof v=="undefined"){continue}s.append(p);if(q){s[(s.is(z))?"after":"append"](q)}if(v.nodeType==3){if(k(A,t)){x=e(p,r,A,t,q)}}else{x=m(p,r,A,t,q)}if(!x){if(q){q.remove()}}}return x}function e(q,r,p,w,s){var D=false,A=q[0];if(typeof A=="undefined"){return false}var E=(w.wrap=="letter")?"":" ",t=h(A).split(E),F=-1,v=-1,G=0,y=t.length-1;while(G<=y){var x=Math.floor((G+y)/2);if(x==v){break}v=x;a(A,t.slice(0,v+1).join(E)+w.ellipsis);if(!k(p,w)){F=v;G=v}else{y=v}}if(F!=-1&&!(t.length==1&&t[0].length==0)){var u=f(t.slice(0,F+1).join(E),w);D=true;a(A,u)}else{var z=q.parent();q.remove();var C=(s)?s.length:0;if(z.contents().size()>C){var B=z.contents().eq(-1-C);D=e(B,r,p,w,s)}else{var A=z.prev().contents().eq(-1)[0];if(typeof A!="undefined"){var u=f(h(A),w);a(A,u);z.remove();D=true}}}return D}function k(q,p){return q.innerHeight()>p.maxHeight}function f(p,q){while(i.inArray(p.slice(-1),q.lastCharacter.remove)>-1){p=p.slice(0,-1)}if(i.inArray(p.slice(-1),q.lastCharacter.noEllipsis)<0){p+=q.ellipsis}return p}function j(p){return{width:p.innerWidth(),height:p.innerHeight()}}function a(q,p){if(q.innerText){q.innerText=p}else{if(q.nodeValue){q.nodeValue=p}else{if(q.textContent){q.textContent=p}}}}function h(p){if(p.innerText){return p.innerText}else{if(p.nodeValue){return p.nodeValue}else{if(p.textContent){return p.textContent}else{return""}}}}function c(p,q){if(typeof p=="undefined"){return false}if(!p){return false}if(typeof p=="string"){p=i(p,q);return(p.length)?p:false}if(typeof p=="object"){return(typeof p.jquery=="undefined")?false:p}return false}function o(s){var t=s.innerHeight(),r=["paddingTop","paddingBottom"];for(var u=0,q=r.length;u<q;u++){var p=parseInt(s.css(r[u]),10);if(isNaN(p)){p=0}t-=p}return t}function b(q,p){if(!q){return false}if(typeof p=="string"){p="dotdotdot: "+p}else{p=["dotdotdot:",p]}if(typeof window.console!="undefined"){if(typeof window.console.log!="undefined"){window.console.log(p)}}return false}var n=i.fn.html;i.fn.html=function(p){if(typeof p!="undefined"){if(this.data("dotdotdot")){if(typeof p!="function"){return this.trigger("update",[p])}}return n.call(this,p)}return n.call(this)};var g=i.fn.text;i.fn.text=function(q){if(typeof q!="undefined"){if(this.data("dotdotdot")){var p=i("<div />");p.text(q);q=p.html();p.remove();return this.trigger("update",[q])}return g.call(this,q)}return g.call(this)}})(jQuery);
/* module-key = 'com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources', location = '/js/DialogController.js' */
JPT={};(function(){JPT.DialogControllerImpl=Class.extend({WELCOME_REST_URL:AJS.contextPath()+"/rest/welcome/1.0/show/welcome",initialize:function(){_.bindAll(this,"handleProjectTemplateTriggered","openWithSelectedProjectTemplate","hideDialogFromNewUser");if(AJS.Meta.getBoolean("show-welcome-screen")){this.handleProjectTemplateTriggered()}},handleProjectTemplateTriggered:function(){this.openWithSelectedProjectTemplate()},openWithSelectedProjectTemplate:function(b){if(b&&this.dialog){this.dialog.remove()}var a=JPT.SelectProjectTemplateController.loadProjectTemplatesData();a.fail(_.bind(function(c){if(c.status===401&&c.responseText.toLowerCase().indexOf("requires websudo")>=0){this._enableWebSudo()}else{this._handleUnknownErrorOfPTRetrieval()}},this));a.done(_.bind(function(c){this.dialog=JPT.DialogView.draw();this.$dialogElement=this.dialog.popup.element;var d;if(!_.isUndefined(JPT.ConfigModel)&&!_.isUndefined(JPT.ConfigModel.selectedTemplate)){d=JPT.ConfigModel.selectedTemplate}JPT.ConfigModel=c;JPT.ConfigModel.selectedTemplate=d;JPT.SelectProjectTemplateController.init(c.projectTemplates,b)},this))},addPage:function(c){var b=this.dialog.addPage(c.name).page[this.dialog.curpage];this.dialog.addHeader(c.title,"add-project-dialog-header");this.dialog.addPanel(c.panelName,"","pt-content");if(c.backButton){this._addBackButton(b)}this.dialog.addButton(c.submitButtonText,c.submitButtonCallback,c.submitButtonClass+" pt-submit-button");var a=this.$dialogElement.find("."+c.submitButtonClass);a.removeClass("button-panel-button").addClass("aui-button aui-button-primary");a.focus();this.dialog.addCancel("Cancel",_.bind(function(d){this.hideDialogFromNewUser("dismissed");this.dialog.remove()},this));return b},_addBackButton:function(b){this.dialog.addButton("Back",_.bind(function(){var c=JPT.DialogView.get$PTContent();c.css("background-image","none");this.dialog.prevPage();b.remove();this.dialog.page.pop()},this),"add-project-back-button");var a=this.$dialogElement.find(".add-project-back-button");a.removeClass("button-panel-button").addClass("aui-button")},_enableWebSudo:function(){JIRA.SmartAjax.showWebSudoDialog({success:_.bind(function(a){this.handleProjectTemplateTriggered();a()},this)})},_handleUnknownErrorOfPTRetrieval:function(){JPT.DialogView.draw();JPT.DialogView.showErrorMessage("An error occurred while trying to contact JIRA")},hideDialogFromNewUser:function(a){if(AJS.Meta.getBoolean("show-welcome-screen")){AJS.$.ajax({url:this.WELCOME_REST_URL+"/"+a,type:"DELETE",success:function(){if(AJS.isDevMode&&AJS.isDevMode()){AJS.log("don't show project template dialog anymore")}}})}}});JPT.DialogController=new JPT.DialogControllerImpl()})();
/* module-key = 'com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources', location = '/js/DialogView.js' */
(function(){JPT.DialogViewImpl=Backbone.View.extend({events:{"click   .add-project-trigger":"_onClickAddProject","click   #add-project-dialog .import-project-trigger":"_onClickImportProject","keydown #add-project-dialog .pt-templates-list":"_onKeydownInTemplatesList"},draw:function(){var b=new AJS.Dialog({width:840,height:400,id:"add-project-dialog",closeOnOutsideClick:false,keypressListener:_.bind(this._onKeyPressed,this)});var c=b.popup.element;b.addPage("project-templates-page");b.addHeader("Select Project Type","add-project-dialog-header");b.addPanel("ProjectTemplatesListPanel",JIRA.Templates.ProjectTemplates.loadingTemplatesList(),"pt-content");this._dialog=b;this._$dialogElement=c;b.show();return b},remove:function(){this._dialog&&this._dialog.remove()},showErrorMessage:function(b){this._dialog.getPanel(1,0).html(JIRA.Templates.errorMsg({closable:false,msg:b}))},get$PTContent:function a(){return JPT.DialogController.$dialogElement.find(".pt-content")},_onKeyPressed:function(c){var b=27;if(this._dialog){if(c.keyCode===b){JPT.DialogController.hideDialogFromNewUser("dismissed");this._dialog.remove();return false}}return true},_onKeydownInTemplatesList:function(c){var b=13;if(this._dialog){if(c.keyCode===b){this._$dialogElement.find(".pt-submit-button:visible").click();return false}}return true},_onClickAddProject:function(b){b.preventDefault();JPT.DialogController.handleProjectTemplateTriggered()},_onClickImportProject:function(b){JPT.DialogController.hideDialogFromNewUser("importproject")}});JPT.DialogView=new JPT.DialogViewImpl({el:AJS.$(document)})})();
/* module-key = 'com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources', location = '/js/SelectProjectTemplateController.js' */
JPT.SelectProjectTemplateController={};JPT.SelectProjectTemplateController.init=function init(b,a){JPT.DialogController.$dialogElement.hide();JPT.SelectProjectTemplateView.draw(b);if(a){var c=_.find(b,function(d){return d.itemModuleCompleteKey===a});if(!_.isUndefined(c)){JPT.SelectProjectTemplateController.openAddProjectPage(c)}else{JPT.DialogView.showErrorMessage("Unable to find the template you were redirected to.");JPT.SelectProjectTemplateView.disableNextButton()}}JPT.DialogController.$dialogElement.show();JPT.SelectProjectTemplateView.truncateTemplateDescriptions()};JPT.SelectProjectTemplateController.loadProjectTemplatesData=function loadProjectTemplatesData(){return AJS.$.ajax({url:contextPath+"/rest/project-templates/1.0/templates",type:"GET",timeout:5000})};JPT.SelectProjectTemplateController.dialogSubmitted=function dialogSubmitted(){var a=JPT.SelectProjectTemplateView.getSelectedTemplateData();JPT.DialogController.hideDialogFromNewUser("templateselected");JPT.SelectProjectTemplateController.raiseAtlassianEvent(a.itemModuleCompleteKey);if(!_.isUndefined(a.infoSoyPath)){JPT.TemplateInfoController=new JPT.TemplateInfoControllerImpl();JPT.TemplateInfoController.initTemplateInfo(a)}else{JPT.SelectProjectTemplateController.openAddProjectPage(a)}};JPT.SelectProjectTemplateController.openAddProjectPage=function openAddProjectPage(a){if(!a){JPT.DialogView.showErrorMessage("An error occurred while trying to contact JIRA");return}if(a.createProject){JPT.AddProjectController.initProjectTemplate(a)}else{JPT.DialogController.dialog.addPage("blank-template-page");AJS.$("body").trigger(a.itemModuleCompleteKey,JPT.DialogController.dialog)}};JPT.SelectProjectTemplateController.raiseAtlassianEvent=function raiseAtlassianEvent(a){JPT.ConfigModel.selectedTemplate=a;if(AJS.EventQueue){AJS.EventQueue.push({name:"projecttemplates.templateselected",properties:{selectedTemplate:a}})}};
/* module-key = 'com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources', location = '/js/SelectProjectTemplateView.js' */
JPT.SelectProjectTemplateView={};JPT.SelectProjectTemplateView.ROW_LENGTH=2;JPT.SelectProjectTemplateView.draw=function draw(b){this.page=JPT.DialogController.addPage({name:"project-templates-page",title:"Select Project Type",panelName:"ProjectTemplatesListPanel",backButton:false,submitButtonText:"Next",submitButtonCallback:JPT.SelectProjectTemplateController.dialogSubmitted,submitButtonClass:"create-project-dialog-create-button"});JPT.DialogController.dialog.getPanel(this.page.id,0).html(JIRA.Templates.ProjectTemplates.renderList({projectTemplates:b}));if(JPT.ConfigModel.projectCount>=2){AJS.$(JIRA.Templates.ProjectTemplates.addWorkflowsLink({baseUrl:contextPath})).appendTo(JPT.DialogController.$dialogElement.find(".dialog-title"))}var c=JPT.DialogController.$dialogElement.find(".create-project-dialog-create-button");JPT.DialogController.$dialogElement.find(".template").click(function(){var d=AJS.$(this);d.addClass("selected").siblings().removeClass("selected")}).dblclick(function(d){c.click()}).focus(function(){AJS.$(this).click()});var a=JPT.SelectProjectTemplateView.get$TemplatesContainer();AJS.$(JIRA.Templates.ProjectTemplates.importProjectLink({baseUrl:contextPath})).prependTo(JPT.DialogController.$dialogElement.find(".dialog-button-panel"));JPT.SelectProjectTemplateView.bindKeyboardEvents(a);if(b.length==0){c.attr("disabled","disabled")}JPT.SelectProjectTemplateView.focusOnFirstTemplate(a)};JPT.SelectProjectTemplateView.get$TemplatesContainer=function getTemplatesContainer(){return JPT.DialogController.$dialogElement.find(".templates")};JPT.SelectProjectTemplateView.focusOnFirstTemplate=function focusOnFirstTemplate(a){JPT.DialogController.$dialogElement.find(".template:first-child").click();setTimeout(function(){a.focus()},0)};JPT.SelectProjectTemplateView.getSelectedTemplateData=function getSelectedTemplateData(){var a=JPT.DialogController.$dialogElement.find(".template.selected");return a.data()};JPT.SelectProjectTemplateView.getMoveDeltaForKey=function(a){switch(a){case 37:return -1;case 39:return +1;case 38:return -JPT.SelectProjectTemplateView.ROW_LENGTH;case 40:return +JPT.SelectProjectTemplateView.ROW_LENGTH}return 0};JPT.SelectProjectTemplateView.bindKeyboardEvents=function(a){a.bind("keydown",function(b){var c=JPT.SelectProjectTemplateView.getMoveDeltaForKey(b.which);if(c){JPT.SelectProjectTemplateView.moveSelection(a,c);return AJS.stopEvent(b)}})};JPT.SelectProjectTemplateView.moveSelection=function(c,f){var b=c.find(".template");var e=b.filter(".selected");var d=b.index(e)+f;if(d<b.length&&d>=0){var a=b.eq(d);a.click().focus();JPT.SelectProjectTemplateView.scrollToSelectedElement(a)}};JPT.SelectProjectTemplateView.scrollToSelectedElement=function scrollToSelectedElement(c){var f=AJS.$(".dialog-panel-body.pt-content");var a=f.offset().top;var b=c.offset().top;var e=b+c.height();var d=a+f.height();if(b<a){f.scrollTop(f.scrollTop()-(a-b))}else{if(e>(a+f.height())){f.scrollTop(f.scrollTop()+e-d)}}};JPT.SelectProjectTemplateView.get$NextButton=function getNextButton(){return JPT.DialogController.$dialogElement.find(".create-project-dialog-create-button")};JPT.SelectProjectTemplateView.disableNextButton=function disableNextButton(){JPT.SelectProjectTemplateView.get$NextButton().attr("disabled","disabled")};JPT.SelectProjectTemplateView.truncateTemplateDescriptions=function truncateTemplateDescriptions(){var a=AJS.Meta.get("user-locale");var b="word";if(a==="ja_JP"){b="letter"}JPT.DialogController.$dialogElement.find(".template-description").each(function(){AJS.$(this).dotdotdot({wrap:b,lastCharacter:{remove:[" ",",",";",".","!","?",""],noEllipsis:[]}})})};
/* module-key = 'com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources', location = '/soy/ProjectTemplatesList.soy' */
// This file was automatically generated from ProjectTemplatesList.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.ProjectTemplates == 'undefined') { JIRA.Templates.ProjectTemplates = {}; }


JIRA.Templates.ProjectTemplates.renderList = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.projectTemplates.length == 0) {
    JIRA.Templates.errorMsg({closeable: false, msg: "No project templates could be found."}, output);
  } else {
    output.append('<div class="pt-templates-list">');
    JIRA.Templates.ProjectTemplates.renderItems(opt_data, output);
    output.append('</div>');
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ProjectTemplates.renderItems = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<ol class="templates" tabindex="100">');
  var templateList15 = opt_data.projectTemplates;
  var templateListLen15 = templateList15.length;
  for (var templateIndex15 = 0; templateIndex15 < templateListLen15; templateIndex15++) {
    var templateData15 = templateList15[templateIndex15];
    output.append('<li class="template"', (templateData15.itemModuleCompleteKey) ? 'data-item-module-complete-key="' + soy.$$escapeHtml(templateData15.itemModuleCompleteKey) + '"' : '', (templateData15.projectTemplateModuleCompleteKey) ? 'data-project-template-module-complete-key="' + soy.$$escapeHtml(templateData15.projectTemplateModuleCompleteKey) + '"' : '', (templateData15.createProject) ? 'data-create-project="' + soy.$$escapeHtml(templateData15.createProject) + '"' : '', (templateData15.backgroundIconUrl) ? 'data-background-icon-url="' + soy.$$escapeHtml(templateData15.backgroundIconUrl) + '"' : '', (templateData15.name) ? 'data-name="' + soy.$$escapeHtml(templateData15.name) + '"' : '', (templateData15.description) ? 'data-description="' + soy.$$escapeHtml(templateData15.description) + '"' : '', (templateData15.longDescriptionContent) ? 'data-long-description-content="' + soy.$$escapeHtml(templateData15.longDescriptionContent) + '"' : '', (templateData15.infoSoyPath) ? 'data-info-soy-path="' + soy.$$escapeHtml(templateData15.infoSoyPath) + '"' : '', '><img class="template-preview" src="', soy.$$escapeHtml(templateData15.iconUrl), '" /><div class="template-meta"><div class="template-name" title="', soy.$$escapeHtml(templateData15.name), '">', soy.$$escapeHtml(templateData15.name), '</div><div class="template-description" title="', soy.$$escapeHtml(templateData15.description), '">', soy.$$escapeHtml(templateData15.description), '</div></div></li>');
  }
  output.append('</ol>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ProjectTemplates.loadingTemplatesList = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="wait-container"><img class="wait-icon" src="', soy.$$escapeHtml("/jira"), '/images/icons/wait.gif"><span class="wait-text">', soy.$$escapeHtml("Loading project templates"), '&hellip;</span></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ProjectTemplates.importProjectLink = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a class="import-project-trigger button-panel-link" href="', soy.$$escapeHtml(opt_data.baseUrl), '/secure/admin/views/ExternalImport1.jspa" tabindex="-1">', soy.$$escapeHtml("Import from external system"), '</a>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ProjectTemplates.addWorkflowsLink = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a class="add-workflow-link" href="', soy.$$escapeHtml(opt_data.baseUrl), '/plugins/servlet/wfshare-import?src=projecttemplates" tabindex="-1">', soy.$$escapeHtml("View Marketplace Workflows"), '</a>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources', location = '/js/TemplateInfoController.js' */
(function(){JPT.TemplateInfoControllerImpl=Class.extend({init:function(a){_.bindAll(this,"initTemplateInfo","next")},initTemplateInfo:function(a){this.projectTemplateData=a;JPT.TemplateInfoView=new JPT.TemplateInfoViewImpl();JPT.TemplateInfoView.draw(a.infoSoyPath,a.name)},next:function(){JPT.SelectProjectTemplateController.openAddProjectPage(this.projectTemplateData)}})})();
/* module-key = 'com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources', location = '/js/TemplateInfoView.js' */
(function(){JPT.TemplateInfoViewImpl=Backbone.View.extend({initialize:function(a){_.bindAll(this,"draw","onNext")},draw:function(c,b){var d=JPT.DialogController.addPage({name:"template-info",title:b,panelName:"template-info",backButton:true,submitButtonText:"Select",submitButtonCallback:this.onNext,submitButtonClass:"template-info-dialog-create-button"});var a=this._nameToObj(c)();JPT.DialogController.dialog.getPanel(d.id,0).html(a);JPT.DialogController.dialog.gotoPage(d.id)},_nameToObj:function(a){return _.reduce(a.split("."),function(c,b){if(c){return c[b]}},window)},onNext:function(a){JPT.TemplateInfoController.next();return false}})})();
/* module-key = 'com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources', location = '/js/AddProjectController.js' */
(function(){JPT.AddProjectControllerImpl=Class.extend({postProjectCreationCallbacks:[],projectKeyValidationCallbacks:[],projectNamesUpperCased:[],init:function(g){this._window=g.window||window;_.bindAll(this,"projectCreatedHandler","projectValidationFailedHandler","nameTimeout","keyTimeout","submit")},initProjectTemplate:function(g){this.desiredKeyLength=4;this.lastKeyValidated="";this._getExistingProjects();JPT.ProjectKeyGenerator.init(this.desiredKeyLength,JPT.ConfigModel.maxKeyLength);this.webItemData=g;JPT.AddProjectView.prepareDialog(g.name);JPT.AddProjectView.draw({webItemData:this.webItemData,maxKeyLength:JPT.ConfigModel.maxKeyLength,maxNameLength:JPT.ConfigModel.maxNameLength,currentUserName:JPT.ConfigModel.currentUserName,currentUserDisplayName:JPT.ConfigModel.currentUserDisplayName,currentUserAvatarUrl:JPT.ConfigModel.currentUserAvatarUrl,errors:{}})},_resetProjectLeadValues:function(){JPT.ConfigModel.currentUserDisplayName="";JPT.ConfigModel.currentUserName="";JPT.ConfigModel.currentUserAvatarUrl=""},_hasFullyConfiguredProjectLead:function(){return JPT.AddProjectView.getLeadDisplayName()&&JPT.AddProjectView.getAvatarUrlOfSelectedLead()!=""},submit:function(g){var h=JPT.AddProjectView.getAddProjectForm().serialize();if(JPT.AddProjectView.hasInlineErrors()){return}if(JPT.AddProjectView.enterLoadingState()){if(this._hasFullyConfiguredProjectLead()){JPT.ConfigModel.currentUserDisplayName=JPT.AddProjectView.getLeadDisplayName();JPT.ConfigModel.currentUserName=JPT.ConfigModel.currentUserDisplayName?JPT.AddProjectView.getLeadUserName():"";JPT.ConfigModel.currentUserAvatarUrl=JPT.AddProjectView.getAvatarUrlOfSelectedLead()}else{this._resetProjectLeadValues()}var i=AJS.$.ajax({url:contextPath+"/rest/project-templates/1.0/templates",type:"POST",data:h,timeout:50000,headers:{"X-Atlassian-Token":"nocheck"}});i.then(this.projectCreatedHandler,this.projectValidationFailedHandler)}},registerPostProjectCreationCallback:function(g){this.postProjectCreationCallbacks.push(g)},registerProjectKeyValidationCallback:function(g){this.projectKeyValidationCallbacks.push(g)},localStoragePrefix:"jira.projecttemplates.",projectCreatedHandler:function(h){JPT.AddProjectView.avoidDirtyFormWarning();var g=this.localStoragePrefix;var i=["confluenceProject","fisheyeProject","crucibleProject","bambooProject"];_.map(i,function(j){if(h.remoteProjectLinks[j]){localStorage.setItem(g+j,h.remoteProjectLinks[j])}});if(!_.isEmpty(this.postProjectCreationCallbacks)){JPT.DialogController.dialog.addPage("post-project-created-page");_.each(this.postProjectCreationCallbacks,function(j){j(JPT.DialogController.dialog,h.returnUrl,h.projectId,h.projectKey,h.projectName)})}else{this._window.location=contextPath+h.returnUrl}},projectValidationFailedHandler:function(h,j){var i={};if(h.status===400){i=JSON.parse(h.responseText)}else{if(h.status===500&&!_.isUndefined(JSON.parse(h.responseText).message)){var g=JSON.parse(h.responseText);JIRA.Messages.showReloadErrorMsg(g.message);JPT.AddProjectView.avoidDirtyFormWarning();this._window.location=contextPath+g.returnUrl;return}else{if(j==="timeout"){i={errorMessages:["Request timeout when creating project"]}}else{i={errorMessages:[AJS.format("Error creating project, {0}",h.responseText)]}}}}JPT.AddProjectView.draw({webItemData:this.webItemData,errors:i,currentName:JPT.AddProjectView.getName(),currentKey:JPT.AddProjectView.getKey(),currentUserDisplayName:JPT.ConfigModel.currentUserDisplayName,currentUserName:JPT.ConfigModel.currentUserName,currentUserAvatarUrl:JPT.ConfigModel.currentUserAvatarUrl});JPT.AddProjectView.hideLoadingState()},_updateAndValidateKey:function e(g){JPT.AddProjectView.setKey(g);this._validateKey()},_shouldUpdateKey:function d(){return(JPT.AddProjectView.getKeyEdited()!="true")},autofillKeyIfNeeded:function b(){if(this._shouldUpdateKey()){var g=JPT.ProjectKeyGenerator.generate(JPT.AddProjectView.getName());if(g.length>1){this._updateAndValidateKey(g)}else{JPT.AddProjectView.setKey("")}}},_doesProjectNameExists:function(h){var g;for(g in this.projectNamesUpperCased){if(h.toUpperCase()==this.projectNamesUpperCased[g]){return true}}return false},_validateName:function(){var g=AJS.$.trim(JPT.AddProjectView.getName());if(!g){return}if(g.length<JPT.ConfigModel.minNameLength){JPT.AddProjectView.showInlineErrorForName(AJS.format("The project name should be at least {0} characters in length.",JPT.ConfigModel.minNameLength));return}if(g.length>JPT.ConfigModel.maxNameLength){JPT.AddProjectView.showInlineErrorForName(AJS.format("The project name must not exceed {0} characters in length.",JPT.ConfigModel.maxNameLength));return}if(this._doesProjectNameExists(g)){JPT.AddProjectView.showInlineErrorForName("A project with that name already exists.");return}JPT.AddProjectView.hideInlineErrorForName()},_performKeyValidationChecks:function(g){var h=AJS.$.ajax({url:contextPath+"/rest/api/latest/projectvalidate/key?key="+g.toUpperCase(),timeout:5000});h.done(_.bind(function(j){if(j.errors&&j.errors.projectKey){JPT.AddProjectView.showInlineErrorForKey(j.errors.projectKey)}else{var i=false;_.each(this.projectKeyValidationCallbacks,function(l){var k=l(g.toUpperCase());if(k.errors&&k.errors.projectKey){i=true;JPT.AddProjectView.showInlineErrorForKey(k.errors.projectKey)}});if(!i){JPT.AddProjectView.hideInlineErrorForKey()}}},this))},_validateKey:function a(){var g=JPT.AddProjectView.getKey();if(this.lastKeyValidated===g){return}if(g){this.lastKeyValidated=g;this._performKeyValidationChecks(g)}else{JPT.AddProjectView.hideInlineErrorForKey()}},nameTimeout:function c(){this._validateName();this.autofillKeyIfNeeded()},keyTimeout:function f(){JPT.AddProjectView.setKeyEdited();this._validateKey()},_getExistingProjects:function(){if(this.projectNamesUpperCased.length>0){return this.projectNamesUpperCased}var g=AJS.$.ajax({url:contextPath+"/rest/api/latest/project",timeout:5000});g.done(_.bind(function(h){this.projectNamesUpperCased=_.map(h,function(i){return i.name.toUpperCase()})},this))}});JPT.AddProjectController=new JPT.AddProjectControllerImpl({el:AJS.$(document)})})();
/* module-key = 'com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources', location = '/js/AddProjectView.js' */
(function(){JPT.AddProjectViewImpl=Backbone.View.extend({TIMEOUT_MS:100,postDrawCallbacks:[],events:{"submit #add-project-form":"onSubmitForm"},page:undefined,initialize:function(w){_.bindAll(this,"bindHook")},addPostDrawCallback:function(w){this.postDrawCallbacks.push(w)},prepareDialog:function(w){this.page=JPT.DialogController.addPage({name:"add-project",title:w,panelName:"add-project",backButton:true,submitButtonText:"Submit",submitButtonCallback:this.onSubmitForm,submitButtonClass:"add-project-dialog-create-button"})},draw:function(C){function B(D){if(!D.errors){D.errors={}}return D}JPT.DialogController.dialog.gotoPage(this.page.id);var z={maxNameLength:JPT.ConfigModel.maxNameLength,maxKeyLength:JPT.ConfigModel.maxKeyLength,shouldShowLead:JPT.ConfigModel.shouldShowProjectLead,projectTemplateWebItemKey:JPT.ConfigModel.selectedTemplate||C.webItemData.itemModuleCompleteKey,projectTemplateModuleKey:C.webItemData.projectTemplateModuleCompleteKey,projectTemplateTitle:C.webItemData.name,projectTemplateDescriptionContent:C.webItemData.longDescriptionContent||C.webItemData.description,currentKey:C.currentKey||"",currentName:C.currentName||"",errors:B(C.errors),projectLeadPickerField:{id:"lead",name:"lead"},leadOptions:[{selected:true,displayName:C.currentUserDisplayName,optionName:C.currentUserName,avatarURL:C.currentUserAvatarUrl}]};var x=JIRA.Templates.ProjectTemplates.addProjectForm(z);JPT.DialogController.dialog.getPanel(this.page.id,0).html(x);if(C.webItemData.backgroundIconUrl){var w=JPT.DialogController.$dialogElement.find(".pt-content");w.css("background-image",'url("'+C.webItemData.backgroundIconUrl+'")')}var y=AJS.$("#add-project-form");JIRA.trigger(JIRA.Events.NEW_CONTENT_ADDED,[y]);this.nameElement=JPT.DialogController.$dialogElement.find("#name");this.keyElement=JPT.DialogController.$dialogElement.find("#key");this.keyEditedElement=JPT.DialogController.$dialogElement.find("#keyEdited");this.leadDisplayElement=JPT.DialogController.$dialogElement.find("#lead-field");this.leadValueElement=JPT.DialogController.$dialogElement.find("#lead");var A=this.keyElement.parent().find(".aui-icon-help");if(A.length){new AJS.InlineDialog(A,"project-key-help-popup",function(F,E,D){F.html(JIRA.Templates.ProjectTemplates.keyHelp());D()},{width:330,offsetX:-30})}this.keyElement.attr("style","text-transform: uppercase");this.nameElement.focus(_.bind(function(D){this.bindHook(D,JPT.AddProjectController.nameTimeout)},this));this.nameElement.blur(function(D){JPT.AddProjectView.unbindHook(D)});this.nameElement.focus();this.keyElement.focus(_.bind(function(E){var D=AJS.$(E.target);D.data("lastValue",D.val());this.bindHook(E,JPT.AddProjectController.keyTimeout)},this));this.keyElement.blur(_.bind(function(D){this.unbindHook(D)},this));this.keyElement.blur(function(){JPT.AddProjectController.autofillKeyIfNeeded()});if(!_.isEmpty(this.postDrawCallbacks)){_.each(this.postDrawCallbacks,function(D){D()})}},onSubmitForm:function(w){JPT.AddProjectController.submit();return false},get$SubmitButton:function(){return JPT.DialogController.$dialogElement.find(".add-project-dialog-create-button")},get$BackButton:function(){return JPT.DialogController.$dialogElement.find(".add-project-back-button")},bindHook:function j(z,x){var w=AJS.$(z.target),y;y=_.bind(function(){this.unbindHook(z);x.apply();if(w.is(":visible")){w.data("checkHook",setTimeout(y,this.TIMEOUT_MS))}},this);if(!w.data("checkHook")){w.data("checkHook",setTimeout(y,0))}},unbindHook:function(x){var w=AJS.$(x.target);clearTimeout(w.data("checkHook"));w.removeData("checkHook")},showInlineError:function(x,y){var w=x.parent().find(".error");if(!w.length){w=AJS.$("<div class='error'></div>");x.parent().append(w)}w.text(y);w.show()},showInlineErrorForName:function v(w){this.showInlineError(this.nameElement,w)},showInlineErrorForKey:function s(w){this.showInlineError(this.keyElement,w)},hideInlineError:function r(w){w.parent().find(".error").hide()},hideInlineErrorForName:function b(){this.hideInlineError(this.nameElement)},hideInlineErrorForKey:function n(){this.hideInlineError(this.keyElement)},setName:function f(w){this.nameElement.val(w)},getName:function m(){return this.nameElement.val()},setKey:function c(w){this.keyElement.val(w)},getKey:function k(){return this.keyElement.val()},getLeadDisplayName:function o(){return this.leadDisplayElement.val()},getLeadUserName:function p(){return this.leadValueElement.val()},getAvatarUrlOfSelectedLead:function l(){var w=JPT.DialogController.$dialogElement.find("#lead-single-select .aui-ss-entity-icon").css("background-image");if(!_.isUndefined(w)){var x=w.match(/^url\((.+)\)$/);return(x&&x[1])?x[1]:""}else{return""}},setKeyEdited:function i(w){this.keyEditedElement.val(w)},getKeyEdited:function t(){return this.keyEditedElement.val()},setKeyEdited:function i(){var w=this.getKey();if(this.keyElement.data("lastValue")!==w){this.keyEditedElement.val((w)?"true":"false")}this.keyElement.data("lastValue",w)},hasNameErrors:function d(){return this.nameElement.parent().find(".error").size()>0},getAddProjectForm:function e(){return AJS.$("#add-project-form")},get$FormFields:function h(){return JPT.DialogController.$dialogElement.find(":input")},enterLoadingState:function g(){$submitButton=this.get$SubmitButton();if(!$submitButton.attr("disabled")){$backButton=this.get$BackButton();$submitButton.attr("disabled","disabled");$backButton.attr("disabled","disabled");$backButton.before(JIRA.Templates.ProjectTemplates.spinner({id:"addproject-loading"}));this.get$FormFields().attr("disabled","disabled");return true}else{return false}},hideLoadingState:function q(){JPT.DialogController.$dialogElement.find("#addproject-loading").remove();this.get$SubmitButton().removeAttr("disabled");this.get$BackButton().removeAttr("disabled");this.get$FormFields().removeAttr("disabled")},avoidDirtyFormWarning:function a(){if(jQuery.fn.removeDirtyWarning){this.getAddProjectForm().removeDirtyWarning()}},hasInlineErrors:function u(){return JPT.DialogController.$dialogElement.find(".error:visible").length!=0}});JPT.AddProjectView=new JPT.AddProjectViewImpl({el:AJS.$(document),dialogView:JPT.DialogView})})();
/* module-key = 'com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources', location = '/soy/AddProject.soy' */
// This file was automatically generated from AddProject.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.ProjectTemplates == 'undefined') { JIRA.Templates.ProjectTemplates = {}; }


JIRA.Templates.ProjectTemplates.addProjectForm = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.errors.errorMessages) {
    var errorList5 = opt_data.errors.errorMessages;
    var errorListLen5 = errorList5.length;
    for (var errorIndex5 = 0; errorIndex5 < errorListLen5; errorIndex5++) {
      var errorData5 = errorList5[errorIndex5];
      JIRA.Templates.errorMsg({closeable: false, msg: errorData5}, output);
    }
  }
  output.append('<div class="add-project-wrapper"><div class="add-project-form-wrapper">');
  var param11 = new soy.StringBuilder();
  var param13 = new soy.StringBuilder();
  JIRA.Templates.ProjectTemplates.longTextField({id: 'name', name: 'name', isRequired: false, maxLength: opt_data.maxNameLength, labelContent: "Name", descriptionText: AJS.format("Max. {0} characters.",opt_data.maxNameLength), value: opt_data.currentName ? opt_data.currentName : '', errorTexts: opt_data.errors.errors.projectName ? [opt_data.errors.errors.projectName] : []}, param13);
  JIRA.Templates.ProjectTemplates.textFieldWithHelpIcon({id: 'key', name: 'key', isRequired: false, maxLength: opt_data.maxKeyLength, labelContent: "Key", descriptionText: AJS.format("Max. {0} characters.",opt_data.maxKeyLength), helpTitle: "What\x27s a project key?", value: opt_data.currentKey ? opt_data.currentKey : '', errorTexts: opt_data.errors.errors.projectKey ? [opt_data.errors.errors.projectKey] : []}, param13);
  if (opt_data.shouldShowLead) {
    JIRA.Templates.ProjectTemplates.projectLeadField({field: opt_data.projectLeadPickerField, isRequired: false, errorTexts: opt_data.errors.errors.projectLead ? [opt_data.errors.errors.projectLead] : [], options: opt_data.leadOptions}, param13);
  }
  param13.append('<input type="hidden" name="keyEdited" id="keyEdited" value="false"><input type="hidden" name="projectTemplateWebItemKey" value="', soy.$$escapeHtml(opt_data.projectTemplateWebItemKey), '"><input type="hidden" name="projectTemplateModuleKey" value="', soy.$$escapeHtml(opt_data.projectTemplateModuleKey), '"><input type="submit" class="pt-hidden-submit offscreen-left">');
  aui.form.fieldset({legendContent: '', content: param13.toString()}, param11);
  aui.form.form({content: param11.toString(), id: 'add-project-form'}, output);
  output.append('</div>', (opt_data.projectTemplateDescriptionContent) ? '<div class="add-project-description-wrapper"><div class="project-template-title"><h3>' + soy.$$escapeHtml(opt_data.projectTemplateTitle) + '</h3></div><div class="project-template-description">' + opt_data.projectTemplateDescriptionContent + '</div></div>' : '', '</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ProjectTemplates.keyHelp = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="project-key-help"><p><b>', soy.$$escapeHtml("What\x27s a project key?"), '</b></p><ul><li>', soy.$$escapeHtml("It prefixes each issue in the project"), '</li><li>', soy.$$escapeHtml("It can be changed, but this is not a trivial task"), '</li></ul></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ProjectTemplates.projectLeadField = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var param67 = new soy.StringBuilder();
  aui.form.label({forField: opt_data.field.name + '-field', isRequired: opt_data.isRequired, content: "Project Lead"}, param67);
  JIRA.Templates.Fields.Pickers.User.single({field: opt_data.field, options: opt_data.options, editValue: opt_data.value}, param67);
  aui.form.fieldDescription({message: "Enter the username of the Project Lead."}, param67);
  if (opt_data.errorTexts) {
    var errorList80 = opt_data.errorTexts;
    var errorListLen80 = errorList80.length;
    for (var errorIndex80 = 0; errorIndex80 < errorListLen80; errorIndex80++) {
      var errorData80 = errorList80[errorIndex80];
      aui.form.fieldError({message: errorData80}, param67);
    }
  }
  aui.form.fieldGroup({content: param67.toString()}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ProjectTemplates.textFieldWithHelpIcon = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var param86 = new soy.StringBuilder();
  aui.form.label({forField: opt_data.name, isRequired: opt_data.isRequired, content: opt_data.labelContent}, param86);
  aui.form.input({id: opt_data.id, name: opt_data.name, type: 'text', maxLength: opt_data.maxLength, value: opt_data.value}, param86);
  param86.append('<a class="help-lnk" title="', soy.$$escapeHtml(opt_data.helpTitle), '" id="', soy.$$escapeHtml(opt_data.id), '-help-icon"><span class="aui-icon aui-icon-help">', soy.$$escapeHtml(opt_data.helpTitle), '</span></a>');
  if (opt_data.descriptionText) {
    aui.form.fieldDescription({message: opt_data.descriptionText}, param86);
  }
  if (opt_data.errorTexts) {
    var errorList110 = opt_data.errorTexts;
    var errorListLen110 = errorList110.length;
    for (var errorIndex110 = 0; errorIndex110 < errorListLen110; errorIndex110++) {
      var errorData110 = errorList110[errorIndex110];
      aui.form.fieldError({message: errorData110}, param86);
    }
  }
  aui.form.fieldGroup({content: param86.toString()}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ProjectTemplates.longTextField = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var param116 = new soy.StringBuilder();
  aui.form.label({forField: opt_data.name, isRequired: opt_data.isRequired, content: opt_data.labelContent}, param116);
  aui.form.input({id: opt_data.id, name: opt_data.name, type: 'text', maxLength: opt_data.maxLength, value: opt_data.value, extraClasses: 'long-field'}, param116);
  if (opt_data.descriptionText) {
    aui.form.fieldDescription({message: opt_data.descriptionText}, param116);
  }
  if (opt_data.errorTexts) {
    var errorList134 = opt_data.errorTexts;
    var errorListLen134 = errorList134.length;
    for (var errorIndex134 = 0; errorIndex134 < errorListLen134; errorIndex134++) {
      var errorData134 = errorList134[errorIndex134];
      aui.form.fieldError({message: errorData134}, param116);
    }
  }
  aui.form.fieldGroup({content: param116.toString()}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ProjectTemplates.spinner = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<span id=\'', soy.$$escapeHtml(opt_data.id), '\' class=\'icon throbber loading\'/>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ProjectTemplates.formatAnchor = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a href="', soy.$$escapeHtml(opt_data.href), '"', (opt_data.title) ? ' title="' + soy.$$escapeHtml(opt_data.title) + '"' : '', '>', soy.$$escapeHtml(opt_data.body), '</a>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources', location = '/js/ProjectKeyGenerator.js' */
JPT.ProjectKeyGenerator={};JPT.ProjectKeyGenerator.IGNORED_WORDS=["THE","A","AN","AS","AND","OF","OR"];JPT.ProjectKeyGenerator.CHARACTER_MAP={};JPT.ProjectKeyGenerator.CHARACTER_MAP[199]="C";JPT.ProjectKeyGenerator.CHARACTER_MAP[231]="c";JPT.ProjectKeyGenerator.CHARACTER_MAP[252]="u";JPT.ProjectKeyGenerator.CHARACTER_MAP[251]="u";JPT.ProjectKeyGenerator.CHARACTER_MAP[250]="u";JPT.ProjectKeyGenerator.CHARACTER_MAP[249]="u";JPT.ProjectKeyGenerator.CHARACTER_MAP[233]="e";JPT.ProjectKeyGenerator.CHARACTER_MAP[234]="e";JPT.ProjectKeyGenerator.CHARACTER_MAP[235]="e";JPT.ProjectKeyGenerator.CHARACTER_MAP[232]="e";JPT.ProjectKeyGenerator.CHARACTER_MAP[226]="a";JPT.ProjectKeyGenerator.CHARACTER_MAP[228]="a";JPT.ProjectKeyGenerator.CHARACTER_MAP[224]="a";JPT.ProjectKeyGenerator.CHARACTER_MAP[229]="a";JPT.ProjectKeyGenerator.CHARACTER_MAP[225]="a";JPT.ProjectKeyGenerator.CHARACTER_MAP[239]="i";JPT.ProjectKeyGenerator.CHARACTER_MAP[238]="i";JPT.ProjectKeyGenerator.CHARACTER_MAP[236]="i";JPT.ProjectKeyGenerator.CHARACTER_MAP[237]="i";JPT.ProjectKeyGenerator.CHARACTER_MAP[196]="A";JPT.ProjectKeyGenerator.CHARACTER_MAP[197]="A";JPT.ProjectKeyGenerator.CHARACTER_MAP[201]="E";JPT.ProjectKeyGenerator.CHARACTER_MAP[230]="ae";JPT.ProjectKeyGenerator.CHARACTER_MAP[198]="Ae";JPT.ProjectKeyGenerator.CHARACTER_MAP[244]="o";JPT.ProjectKeyGenerator.CHARACTER_MAP[246]="o";JPT.ProjectKeyGenerator.CHARACTER_MAP[242]="o";JPT.ProjectKeyGenerator.CHARACTER_MAP[243]="o";JPT.ProjectKeyGenerator.CHARACTER_MAP[220]="U";JPT.ProjectKeyGenerator.CHARACTER_MAP[255]="Y";JPT.ProjectKeyGenerator.CHARACTER_MAP[214]="O";JPT.ProjectKeyGenerator.CHARACTER_MAP[241]="n";JPT.ProjectKeyGenerator.CHARACTER_MAP[209]="N";JPT.ProjectKeyGenerator.desiredKeyLength=4;JPT.ProjectKeyGenerator.maxKeyLength=10;JPT.ProjectKeyGenerator.getTotalLength=function getTotalLength(a){return a.join("").length};JPT.ProjectKeyGenerator.removeIgnoredWords=function removeIgnoredWords(a){return _.reject(a,function(b){return AJS.$.inArray(b,JPT.ProjectKeyGenerator.IGNORED_WORDS)!==-1})};JPT.ProjectKeyGenerator.createAcronym=function createAcronym(b){var a="";AJS.$.each(b,function(c,d){a+=d.charAt(0)});return a};JPT.ProjectKeyGenerator.getFirstSyllable=function getFirstSyllable(c){var b=false;var a;for(a=0;a<c.length;a++){if(JPT.ProjectKeyGenerator.isVowelOrY(c[a])){b=true}else{if(b){return c.substring(0,a+1)}}}return c};JPT.ProjectKeyGenerator.isVowelOrY=function isVowelOrY(a){return a&&a.length===1&&a.search("[AEIOUY]")!==-1};JPT.ProjectKeyGenerator.init=function init(b,a){JPT.ProjectKeyGenerator.desiredKeyLength=b;JPT.ProjectKeyGenerator.maxKeyLength=a};JPT.ProjectKeyGenerator.generate=function generate(b){b=AJS.$.trim(b);if(!b){return""}var a=[];for(var d=0,f=b.length;d<f;d++){var e=JPT.ProjectKeyGenerator.CHARACTER_MAP[b.charCodeAt(d)];a.push(e?e:b[d])}b=a.join("");var h=[];AJS.$.each(b.split(/\s+/),function(j,k){if(k){k=k.replace(/[^a-zA-Z]/g,"");k=k.toUpperCase();k.length&&h.push(k)}});if(JPT.ProjectKeyGenerator.desiredKeyLength&&JPT.ProjectKeyGenerator.getTotalLength(h)>JPT.ProjectKeyGenerator.desiredKeyLength){h=JPT.ProjectKeyGenerator.removeIgnoredWords(h)}var c;if(h.length==0){c=""}else{if(h.length==1){var g=h[0];if(JPT.ProjectKeyGenerator.desiredKeyLength&&g.length>JPT.ProjectKeyGenerator.desiredKeyLength){c=JPT.ProjectKeyGenerator.getFirstSyllable(g)}else{c=g}}else{c=JPT.ProjectKeyGenerator.createAcronym(h)}}if(JPT.ProjectKeyGenerator.maxKeyLength&&c.length>JPT.ProjectKeyGenerator.maxKeyLength){c=c.substr(0,JPT.ProjectKeyGenerator.maxKeyLength)}return c};
/* module-key = 'com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources', location = '/js/RemoteProjectsCreatedMessage.js' */
AJS.$(function(){var b=localStorage.getItem(JPT.AddProjectController.localStoragePrefix+"confluenceProject");var h=localStorage.getItem(JPT.AddProjectController.localStoragePrefix+"fisheyeProject");var f=localStorage.getItem(JPT.AddProjectController.localStoragePrefix+"crucibleProject");var d=localStorage.getItem(JPT.AddProjectController.localStoragePrefix+"bambooProject");localStorage.removeItem(JPT.AddProjectController.localStoragePrefix+"confluenceProject");localStorage.removeItem(JPT.AddProjectController.localStoragePrefix+"fisheyeProject");localStorage.removeItem(JPT.AddProjectController.localStoragePrefix+"crucibleProject");localStorage.removeItem(JPT.AddProjectController.localStoragePrefix+"bambooProject");var i;function c(k,j){return JIRA.Templates.ProjectTemplates.formatAnchor({href:k,body:j,title:j})}function a(l,m,k,n){var j=[];j.push("a JIRA project");if(l){j.push(c(l,"a Confluence space"))}if(m){j.push(c(m,"a FishEye repository"))}if(k){j.push(c(k,"a Crucible project"))}if(n){j.push(c(n,"a Bamboo project"))}return j}function g(k,m,j,p){var o="The following entities were created: {0} and {1}.";var l=a(k,m,j,p);var n=l.pop();return(l.length>0)?AJS.format(o,l.join(", "),n):null}function e(j){var k=AJS.$(j).offset();if(k){window.scrollTo(k.left,k.top)}}if(b||h||f||d){i=g(b,h,f,d);if(i){JIRA.Messages.showSuccessMsg(i,{closeable:true})}e("#project-config-webpanel-summary-settings")}});
/* module-key = 'com.atlassian.plugins.jira-project-creation:project-creation-resources', location = '/js/lib/ajaxHooks/xdr.js' */
if(window.XDomainRequest){jQuery.ajaxTransport(function(b){if(b.crossDomain&&b.async){if(b.timeout){b.xdrTimeout=b.timeout;delete b.timeout}var a;return{send:function(d,c){function e(f,i,h,g){a.onload=a.onerror=a.ontimeout=jQuery.noop;a=undefined;c(f,i,h,g)}a=new XDomainRequest();a.onload=function(){e(200,"OK",{text:a.responseText},"Content-Type: "+a.contentType)};a.onerror=function(){e(404,"Not Found")};a.onprogress=jQuery.noop;a.ontimeout=function(){e(0,"timeout")};a.timeout=b.xdrTimeout||Number.MAX_VALUE;a.open(b.type,b.url);a.send((b.hasContent&&b.data)||null)},abort:function(){if(a){a.onerror=jQuery.noop;a.abort()}}}}})};
/* module-key = 'com.atlassian.plugins.jira-project-creation:project-creation-resources', location = '/js/project-creation.js' */
ATLAS_PROJECT_CREATE={};(function(h){AJS.EventQueue=AJS.EventQueue||[];var k="jira.project";var B={"confluence.space":30,"bamboo.project":20,"ondemand.svn-repository":10};ATLAS_PROJECT_CREATE.getFilteredRootTypes=function d(J){var L={};for(var K in J.types){if(K!==k){L[K]=J.types[K]}}return L};ATLAS_PROJECT_CREATE.loadRemoteRoots=function a(J){var L=jQuery.Deferred(),M=[],K=[];e(J,function(N){var O=N.capabilitiesUrl;return AJS.$.ajax(O+"/aggregate-root",{success:function(P){var Q=ATLAS_PROJECT_CREATE.getFilteredRootTypes(P);M=M.concat(_.map(Q,function(S,R){return AJS.$.ajax(S.href,{xhrFields:{withCredentials:true},success:function(T){K.push(ATLAS_PROJECT_CREATE.constructFullRootType(T,S.label,R,O,N.id))},error:function(V,T,U){AJS.log("Got "+U+" from aggregate root type "+S.href)}}).promise()}))},error:function(R,P,Q){AJS.log("Got "+Q+" from aggregate roots capapbility for "+O)}}).promise()}).done(function(){u(M).done(function(){L.resolve(K)})});return L.promise()};ATLAS_PROJECT_CREATE.constructFullRootType=function g(J,K,N,M,L){return{keys:J.keys,url:J.links.self,label:K,capabilityKey:N,baseUrl:M,instanceId:L}};ATLAS_PROJECT_CREATE.createLink=function w(K,J){console.log("creating link from "+K.entityType+" to "+K.remoteEntityType);var L=JSON.stringify({local:K.baseUrl+"/aggregate-root/"+K.entityType+"/"+K.entityKey,target:K.remoteInstanceBaseUrl+"/aggregate-root/"+K.remoteEntityType+"/"+K.remoteEntityKey});AJS.$.ajax(K.baseUrl+"/aggregate-root-link",{type:"POST",contentType:"application/json",data:L,timeout:8000,complete:J})};ATLAS_PROJECT_CREATE.linkAllTheThings=function q(M,P,J,R,Q){var L=[];h.each(P,function O(S,T){L.push({baseUrl:T.type.baseUrl,entityType:T.type.capabilityKey,entityKey:T.data.key,remoteInstanceBaseUrl:n()+"/rest/capabilities",remoteEntityType:k,remoteEntityKey:J});L.push({baseUrl:n()+"/rest/capabilities",entityType:k,entityKey:J,remoteInstanceBaseUrl:T.type.baseUrl,remoteEntityType:T.type.capabilityKey,remoteEntityKey:T.data.key});AJS.$.each(P,function U(W,V){if(V!==T){L.push({baseUrl:T.type.baseUrl,entityType:T.type.capabilityKey,entityKey:T.data.key,remoteInstanceBaseUrl:V.type.baseUrl,remoteEntityType:V.type.capabilityKey,remoteEntityKey:V.data.key})}})});var N=0;function K(W,S){if(S!=="success"){N++;var T=W.statusText;try{var V=JSON.parse(W.responseText);if(V&&V.message){T=V.message}}catch(U){}AJS.messages.error(".li-linking-status",{title:"Could not create links between created projects",body:T});M.updateHeight()}if(L.length>0){ATLAS_PROJECT_CREATE.createLink(L.pop(),K)}else{if(N>0){R.find(".linking-status").html('<span class="aui-icon aui-icon-small aui-iconfont-error">'+"Error"+"</span>")}else{R.find(".linking-status").html('<span class="aui-icon aui-icon-small aui-iconfont-success">'+"Success"+"</span>")}Q.prop("disabled",false);Q.attr("aria-disabled","false")}}K(null,"success")};var H;function i(M,J,K){var L=J();h.when(M).then(function(N){L.getCurPanel().body.find(".field-group.loading").remove();N.sort(o);if(N.length!==0){var O=L.getCurPanel().body.find("form");O.append(project.creation.remoteRootsCheckboxes({rootTypes:N}));if(K){O.find('input[type="checkbox"]').filter(".remote-root").change(K)}L.updateHeight()}m(L,true)},function(){L.getCurPanel().body.find(".field-group.loading").remove();m(L,true);L.updateHeight()})}var t;function p(J,K){var L=J();t=L.getCurPanel();t.body.find("form").append(project.creation.remoteRootsLoading({}));m(L,false);L.updateHeight();t.page.element.find(".add-project-back-button").click(function(){L.updateHeight()});G(i,J,K)}function j(K){var L=_.filter(t.body.find("input.remote-root.checkbox"),function(M){return M.checked===true});var J=_.map(L,function(M){return M.id});return _.filter(K,function(M){return _.contains(J,"capability_"+M.capabilityKey)})}var c=AJS.$('meta[name="ajs-remote-user"]');if(!c||!c[0]||!c[0].content){console.log("Project create didn't get a user META tag, or it had no content.  Bailing out");return}if(!AJS.DarkFeatures.isEnabled("rotp.project.create")){return}var I=function I(O,L,N,K,M){var J=function J(P,Q){Q.prop("disabled",true);Q.attr("aria-disabled","true");Q.before('<span class="aui-icon aui-icon-wait project-creation-acknowledge-spinner">'+"Loading, please wait"+"</span>");P()};h.when(H).then(function(Q){var P=j(Q);f(P);if(P.length===0){O.prevPage();L();return}r(O,J,L);var R=[];var S=[];e(P,function(T){var U="creation_status_"+T.capabilityKey.replace(".","_")+"_"+T.instanceId;R.push({statusId:U,label:T.label});return AJS.$.ajax(T.url+"/"+K,{type:"PUT",data:JSON.stringify({label:M}),xhrFields:{withCredentials:true},success:function(V){S=S.concat(D(V,T));z(V,U)},error:function(W,X,V){y(U,T,W,V)},contentType:"application/json",dataType:"json"}).promise()}).always(function(){F(O);console.log("about to begin linking created objects");ATLAS_PROJECT_CREATE.linkAllTheThings(O,S,K,AJS.$(".post-project-created-page-content"),AJS.$(".project-create-acknowledge-button"))});AJS.$(".post-project-created-page-content").append(project.creation.remoteRootsSuccess({rootTypes:R}))})};var l=function l(K){var J;h.when(H).then(function(N){var M=j(N);_.each(M,function(P){if(P.keys){for(var O in P.keys){if(P.keys.hasOwnProperty(O)){if(K.toUpperCase()===O.toUpperCase()){J=P}}}}})});var L={errors:{}};if(J){L.errors.projectKey=AJS.format("{0} with that key already exists in the remote instance",J.label)}return L};function E(){return window.location.origin?window.location.origin:(window.location.protocol+"//"+window.location.host)}function n(){var J=E();return J+AJS.contextPath()}function G(M,K,L){AJS.$.ajax(n()+"/rest/capabilities/awareness",{type:"GET",success:function J(O){var R="source/rest/capabilities";var P=_.pairs(O.applications);var Q=E()+"/svn";var N=_.map(_.filter(P,function(S){return(S[0].substr(0,Q.length))!==Q}),function(T){var S=T[0];if(S.substr(S.length-R.length)===R){A=T[1]}return _.extend(T[1],{capabilitiesUrl:S})});N.push({id:O.links.selfInstanceId,capabilitiesUrl:O.links.collection});H=ATLAS_PROJECT_CREATE.loadRemoteRoots(N);v=O.links.selfInstanceId;if(typeof M==="function"){M(H,K,L)}},error:function(P,N,O){console.log("Project create error - error gathering roots from awareness capability");if(K){h(K().getCurPanel().page.element).find(".pt-submit-button").attr("aria-disabled","false")}}})}var v;var A=null;function e(L,K){var J=_.map(L,K);return u(J)}function u(K){var J=h.Deferred();var L=0;if(K.length===0){J.resolve()}else{_.each(K,function(M){M.always(function(){L++;if(L===K.length){J.resolve()}})})}return J.promise()}function r(L,J,K){L.addPanel("title","","post-project-created-page-content");L.addHeader("Creating and linking companions for your JIRA project");L.addButton("All done!",function(){J(K,AJS.$(this))},"project-create-acknowledge-button");AJS.$(".project-create-acknowledge-button").removeClass("button-panel-button").addClass("aui-button aui-button-primary").attr("aria-disabled","true").prop("disabled",true)}function D(K,J){var L=[];if(J.capabilityKey==="ondemand.svn-repository"){console.log("got back created SVN repository");L.push({type:{capabilityKey:"fecru.repository",instanceId:A.id,baseUrl:A.capabilitiesUrl},data:{key:K.key}});L.push({type:{capabilityKey:"fecru.project",instanceId:A.id,baseUrl:A.capabilitiesUrl},data:{key:"CR-"+K.key}})}else{console.log("got back created thing "+J.capabilityKey);var M={type:J,data:K};L.push(M)}return L}function z(L,M){var K=AJS.$("."+M);K.empty();K.append('<span class="aui-icon aui-icon-small aui-iconfont-success">'+"Success"+"</span>");if(L.links.resource){var J=AJS.$("<a target='_blank'></a>");J.text(L.label);J.attr("href",L.links.resource);J.attr("title",L.label);K.closest("li").append(J)}}function y(Q,K,P,O){var M=AJS.$("."+Q);M.empty();M.append('<span class="aui-icon aui-icon-small aui-iconfont-error">'+"Error"+"</span>");var J=O;if(P&&P.responseText){try{var N=JSON.parse(P.responseText);if(N&&N.message){J=N.message}}catch(L){J=P.responseText}}AJS.messages.error(".li-"+Q,{title:AJS.format("Could not create {0}",K.label),body:J})}function F(J){var K=J.getCurrentPanel();if(K.body.find(".aui-message.error").size()!==0){AJS.messages.warning(".project-creation-success",{title:"We were unable to create everything you requested",body:"<p>"+"However, you can create them yourself and manually set up links."+"</p>"});J.updateHeight()}}function f(J){var K=_.map(J,function(M){return M.capabilityKey});var L=(K.length==0)?"none":K.sort().join("_");AJS.EventQueue.push({name:"project.create.aggregateroots.selected",properties:{capabilitykeys:L}})}function m(K,J){h(K.getCurPanel().page.element).find(".pt-submit-button").attr("aria-disabled",!J)}function o(K,J){return x(J.capabilityKey)-x(K.capabilityKey)}function x(J){return _.has(B,J)?B[J]:0}JPT.AddProjectController.registerProjectKeyValidationCallback(l);var C=function C(){return JPT.DialogView.dialog||JPT.DialogView._dialog};var b=function b(){if(JPT.AddProjectView.getKey().length>=2){JPT.AddProjectController._performKeyValidationChecks(JPT.AddProjectView.getKey())}};JPT.AddProjectView.addPostDrawCallback(function(){p(C,b)});JPT.AddProjectController.registerPostProjectCreationCallback(function(N,O,M,K,L){var J=function(){window.location=AJS.contextPath()+O};I(N,J,M,K,L)});var s=function s(){var M="projectCreation";GH.StartWizardView.registerWizardStepPreRenderCallback(function L(O){if(O==M){G()}});GH.StartWizardView.registerWizardStepPostRenderCallback(function N(Q,O){if(Q==M){p(function P(){return O});O.updateHeight()}});GH.StartWizardView.registerWizardStepOnValidateCallback(function J(T,Q){if(T==M){var S=Q.getCurPanel().body.find("#ghx-wizard-project-projectkey");var P=l(S.val());if(P.errors.projectKey){var O=AJS.$("<div class='error project-creation-error'></div>");var R=S.parent();R.find(".project-creation-error").remove();R.append(O);O.text(P.errors.projectKey);O.show();return false}}return true});GH.StartWizardView.registerWizardStepOnCreateCallbacks(function K(P,Q,O){console.log("creating external entities");P.addPage("post-project-created-page");I(P,Q,null,O.project.key,O.project.name)})};h(function(){AJS.$(".add-project-trigger").live("click",G);if(typeof GH!=="undefined"){if(GH.StartWizardView&&GH.StartWizardView.registerWizardStepPreRenderCallback){s()}}});h(function(){AJS.$(".add-project-trigger").live("click",G)})})(jQuery);
/* module-key = 'com.atlassian.plugins.jira-project-creation:project-creation-resources', location = '/templates/project-creation.soy' */
// This file was automatically generated from project-creation.soy.
// Please don't edit this file by hand.

if (typeof project == 'undefined') { var project = {}; }
if (typeof project.creation == 'undefined') { project.creation = {}; }


project.creation.remoteRootsLoading = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="field-group loading"><span class="aui-icon aui-icon-wait"/>', soy.$$escapeHtml("Retrieving additional project types you might want to create"), '</div>');
  return opt_sb ? '' : output.toString();
};


project.creation.remoteRootsCheckboxes = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<fieldset class="group remote-root-checkboxes"><h4>', soy.$$escapeHtml("Create a linked:"), '</h4><div class=\'field-group\'>');
  var rootTypeList10 = opt_data.rootTypes;
  var rootTypeListLen10 = rootTypeList10.length;
  for (var rootTypeIndex10 = 0; rootTypeIndex10 < rootTypeListLen10; rootTypeIndex10++) {
    var rootTypeData10 = rootTypeList10[rootTypeIndex10];
    output.append('<div class="checkbox"><input class="checkbox remote-root" type="checkbox" id="capability_', soy.$$escapeHtml(rootTypeData10.capabilityKey), '" checked="true" data-url="', soy.$$escapeHtml(rootTypeData10.url), '"></input><label for="capability_', soy.$$escapeHtml(rootTypeData10.capabilityKey), '">', soy.$$escapeHtml(rootTypeData10.label), '</label></div>');
  }
  output.append('</div></fieldset>');
  return opt_sb ? '' : output.toString();
};


project.creation.remoteRootsSuccess = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="project-creation-success"><ul>');
  var rootTypeList24 = opt_data.rootTypes;
  var rootTypeListLen24 = rootTypeList24.length;
  for (var rootTypeIndex24 = 0; rootTypeIndex24 < rootTypeListLen24; rootTypeIndex24++) {
    var rootTypeData24 = rootTypeList24[rootTypeIndex24];
    output.append('<li class="li-', soy.$$escapeHtml(rootTypeData24.statusId), '"><div class="', soy.$$escapeHtml(rootTypeData24.statusId), ' created-entity-status"><span class="aui-icon aui-icon-wait">', soy.$$escapeHtml("Loading, please wait"), '</span></div><div class="created-entity-status">', soy.$$escapeHtml(rootTypeData24.label), '</div></li>');
  }
  output.append('<li class="li-linking-status"><div class="linking-status created-entity-status"><span class="aui-icon aui-icon-wait">', soy.$$escapeHtml("Loading, please wait"), '</span></div><div class="created-entity-status">', soy.$$escapeHtml("Creating links"), '</div></li></ul></div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.analytics.analytics-client:js-events', location = 'js/store-1.3.1.js' */
(function(){var l={},h=window,k=h.document,c="localStorage",n="globalStorage",d="__storejs__",g;l.disabled=false;l.set=function(e,o){};l.get=function(e){};l.remove=function(e){};l.clear=function(){};l.transact=function(e,o){var p=l.get(e);if(typeof p=="undefined"){p={}}o(p);l.set(e,p)};l.serialize=function(e){return JSON.stringify(e)};l.deserialize=function(e){if(typeof e!="string"){return undefined}return JSON.parse(e)};function b(){try{return(c in h&&h[c])}catch(e){return false}}function m(){try{return(n in h&&h[n]&&h[n][h.location.hostname])}catch(e){return false}}if(b()){g=h[c];l.set=function(e,o){if(o===undefined){return l.remove(e)}g.setItem(e,l.serialize(o))};l.get=function(e){return l.deserialize(g.getItem(e))};l.remove=function(e){g.removeItem(e)};l.clear=function(){g.clear()}}else{if(m()){g=h[n][h.location.hostname];l.set=function(e,o){if(o===undefined){return l.remove(e)}g[e]=l.serialize(o)};l.get=function(e){return l.deserialize(g[e]&&g[e].value)};l.remove=function(e){delete g[e]};l.clear=function(){for(var e in g){delete g[e]}}}else{if(k.documentElement.addBehavior){var j,f;try{f=new ActiveXObject("htmlfile");f.open();f.write('<script>document.w=window<\/script><iframe src="/favicon.ico"></frame>');f.close();j=f.w.frames[0].document;g=j.createElement("div")}catch(i){g=k.createElement("div");j=k.body}function a(e){return function(){var p=Array.prototype.slice.call(arguments,0);p.unshift(g);j.appendChild(g);g.addBehavior("#default#userData");g.load(c);var o=e.apply(l,p);j.removeChild(g);return o}}l.set=a(function(p,e,o){if(o===undefined){return l.remove(e)}p.setAttribute(e,l.serialize(o));p.save(c)});l.get=a(function(o,e){return l.deserialize(o.getAttribute(e))});l.remove=a(function(o,e){o.removeAttribute(e);o.save(c)});l.clear=a(function(q){var o=q.XMLDocument.documentElement.attributes;q.load(c);for(var p=0,e;e=o[p];p++){q.removeAttribute(e.name)}q.save(c)})}}}try{l.set(d,d);if(l.get(d)!=d){l.disabled=true}l.remove(d)}catch(i){l.disabled=true}if(typeof module!="undefined"){module.exports=l}else{if(typeof define==="function"&&define.amd){define(l)}else{this.store=l}}})();
/* module-key = 'com.atlassian.analytics.analytics-client:js-events', location = 'js/atlassian-analytics.js' */
(function(f){var j=AJS.$.ajax;var h="atlassian-analytics";var e=typeof AJS.contextPath=="function"?AJS.contextPath():typeof AJS.Confluence!="undefined"?AJS.Confluence.getContextPath():window.contextPath!=null?window.contextPath:"";var d=null;var m=null;var c=null;var b="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var s=Math.random()*16|0,q=t=="x"?s:(s&3|8);return q.toString(16)});var a=function(){var q="unknown";if(document.body.id=="jira"){q="jira"}else{if(document.body.id=="com-atlassian-confluence"){q="confluence"}}m=h+"."+q;c=m+".lock"};var o=function(){if(store.get(c)){return false}store.set(c,b);return(store.get(c)===b)};var k=function(){store.set(c,null)};var g=function(){var r=[],t,u,q,s;if(AJS.EventQueue.length==0){return}r=store.get(m)||r;for(q=0,s=AJS.EventQueue.length;q<s;++q){u=AJS.EventQueue[q];if(u.name){t={name:u.name,properties:u.properties,time:u.time||0};r.push(t)}}AJS.EventQueue.length=0;store.set(m,r)};var l=function(){var r;if(!o()){return}g();r=store.get(m);if(r&&r.length){store.remove(m);k();var s=new Date().getTime();for(var q=0;q<r.length;q++){if(r[q].time>0){r[q].timeDelta=r[q].time-s}else{r[q].timeDelta=q-r.length}delete r[q].time}d=j({type:"POST",url:e+"/rest/analytics/1.0/publish/bulk",data:JSON.stringify(r),contentType:"application/json",dataType:"json"});d.fail(function(){AJS.EventQueue.concat(r);g()})}else{k()}};var n=function(){if(d&&!(d.state()==="resolved"||d.state()==="rejected")){d.abort()}};AJS.EventQueue=AJS.EventQueue||[];var i=Array.prototype.push;AJS.EventQueue.push=function(q){q.time=new Date().getTime();i.call(AJS.EventQueue,q)};AJS.toInit(function(){a();setTimeout(l,500);setInterval(l,5000);p()});f(window).unload(function(){n();g()});AJS.Analytics={triggerPrivacyPolicySafeEvent:function(q,r){AJS.EventQueue.push({name:q,properties:r})}};AJS.bind("analytics",function(q,r){AJS.EventQueue.push({name:r.name,properties:r.data})});AJS.bind("analyticsEvent",function(q,r){AJS.EventQueue.push({name:r.name,properties:r.data})});var p=function(){if(window.location.pathname.indexOf("/secure/admin/ViewApplicationProperties")>-1){AJS.$("[data-property-id='analytics-enabled']").remove()}else{if(window.location.pathname.indexOf("/secure/admin/EditApplicationProperties")>-1){var r=AJS.$(":contains(Enable Atlassian analytics)");if(r.size()>0){var q=r[r.size()-2];if(q){q.remove()}}}}}}(AJS.$));
/* module-key = 'com.atlassian.analytics.analytics-client:policy-update', location = 'js/policy-update.js' */

/* module-key = 'com.atlassian.plugins.atlassian-nav-links-plugin:application-header-administration-cog-resource', location = 'header/cog.js' */
var NavLinks=(function(a){a.ApplicationHeader=function(b){b.Cog=(function(){var c=function(){var d=AJS.$("#system-admin-menu-content");if(d.length>0){return d}var e=AJS.$("#admin-menu-link-content");if(e.length>0){return e}return AJS.$("#bamboo\\.global\\.header-admin\\.menu")};return{getDropdown:c}}());return b}(a.ApplicationHeader||{});return a}(NavLinks||{}));
/* module-key = 'com.atlassian.plugins.atlassian-nav-links-plugin:administration-shortcuts-resources', location = 'adminshortcuts/adminshortcuts.soy' */
// This file was automatically generated from adminshortcuts.soy.
// Please don't edit this file by hand.

if (typeof navlinks == 'undefined') { var navlinks = {}; }
if (typeof navlinks.templates == 'undefined') { navlinks.templates = {}; }
if (typeof navlinks.templates.adminshortcuts == 'undefined') { navlinks.templates.adminshortcuts = {}; }


navlinks.templates.adminshortcuts.section = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var param5 = new soy.StringBuilder('<ul class="aui-list-truncate">');
  var linkList7 = opt_data.links;
  var linkListLen7 = linkList7.length;
  for (var linkIndex7 = 0; linkIndex7 < linkListLen7; linkIndex7++) {
    var linkData7 = linkList7[linkIndex7];
    param5.append('<li><a href="', soy.$$escapeHtml(linkData7.link), '">', soy.$$escapeHtml(linkData7.label), '</a></li>');
  }
  param5.append('</ul>');
  aui.dropdown2.section({id: 'nl-remote-admin-section', label: "Other applications", content: param5.toString()}, output);
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.plugins.atlassian-nav-links-plugin:administration-shortcuts-resources', location = 'adminshortcuts/adminnavlinks.js' */
var NavLinks=(function(a){a.AdminShortcuts=(function(){var c=function(){return AJS.$.ajax({url:AJS.contextPath()+"/rest/menu/latest/admin",cache:false,dataType:"json"})};var b=function(){AJS.$("#nl-remote-admin-section").on("click","a",function(){NL.trackEvent("remoteAdminItemSelected",NL.getCurrentApplication(),$(this).attr("href"))})};return{render:function(){c().done(function(e){e=_.reject(e,function(f){return f.local===true});if(e.length){var d=navlinks.templates.adminshortcuts.section({links:e});a.ApplicationHeader.Cog.getDropdown().append(d);b()}})}}}());return a}(NavLinks||{}));
/* module-key = 'com.atlassian.plugins.atlassian-nav-links-plugin:administration-shortcuts', location = 'adminshortcuts/adminshortcuts-cdn.js' */
AJS.toInit(function(){if(AJS.DarkFeatures&&AJS.DarkFeatures.isEnabled("rotp.admin.shortcuts")){NavLinks.AdminShortcuts.render()}});
/* module-key = 'com.atlassian.plugins.atlassian-nav-links-plugin:rotp-projectshortcuts', location = 'projectshortcuts/projectshortcuts.soy' */
// This file was automatically generated from projectshortcuts.soy.
// Please don't edit this file by hand.

if (typeof navlinks == 'undefined') { var navlinks = {}; }
if (typeof navlinks.templates == 'undefined') { navlinks.templates = {}; }
if (typeof navlinks.templates.projectshortcuts == 'undefined') { navlinks.templates.projectshortcuts = {}; }


navlinks.templates.projectshortcuts.dialogContent = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.localShortcuts && opt_data.localShortcuts.length > 0) {
    navlinks.templates.projectshortcuts.dialogContentShortcuts({shortcuts: opt_data.localShortcuts, listClass: 'projectshortcut-links'}, output);
  }
  if (opt_data.remoteShortcuts != null) {
    if (opt_data.remoteShortcuts.length > 0) {
      output.append('<h2 class="projectshortcuts-heading">Related Links</h2>');
      navlinks.templates.projectshortcuts.dialogContentShortcuts(soy.$$augmentData(opt_data.remoteShortcuts, {shortcuts: opt_data.remoteShortcuts, listClass: 'projectshortcut-links'}), output);
    }
  } else {
    navlinks.templates.projectshortcuts.dialogLoading(null, output);
  }
  return opt_sb ? '' : output.toString();
};


navlinks.templates.projectshortcuts.headingWrapper = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="project-dialog-header-wrapper"><div class="project-header"><img class="project-img" src="', soy.$$escapeHtml(opt_data.logoUrl), '"><h2 class="dialog-title">', soy.$$escapeHtml(opt_data.title), '</h2></div><div class="project-content-wrapper">', opt_data.contentHtml, '</div></div>');
  return opt_sb ? '' : output.toString();
};


navlinks.templates.projectshortcuts.dialogContentShortcuts = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<ul', (opt_data.listClass) ? ' class="' + soy.$$escapeHtml(opt_data.listClass) + '"' : '', '>');
  var shortcutList35 = opt_data.shortcuts;
  var shortcutListLen35 = shortcutList35.length;
  for (var shortcutIndex35 = 0; shortcutIndex35 < shortcutListLen35; shortcutIndex35++) {
    var shortcutData35 = shortcutList35[shortcutIndex35];
    output.append('<li', (shortcutIndex35 == shortcutListLen35 - 1) ? ' class="last"' : '', '>');
    navlinks.templates.projectshortcuts.dialogContentShortcut(shortcutData35, output);
    output.append('</li>');
  }
  output.append('</ul>');
  return opt_sb ? '' : output.toString();
};


navlinks.templates.projectshortcuts.dialogContentShortcut = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a href="', soy.$$escapeHtml(opt_data.link), '"', (opt_data.tooltip) ? ' title="' + soy.$$escapeHtml(opt_data.tooltip) + '"' : '', '>', soy.$$escapeHtml(opt_data.label), '</a>');
  return opt_sb ? '' : output.toString();
};


navlinks.templates.projectshortcuts.dialogLoading = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="projectshortcuts-loading">', (opt_data != null && opt_data.text) ? soy.$$escapeHtml(opt_data.text) : '', '</div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.plugins.atlassian-nav-links-plugin:rotp-projectshortcuts', location = 'projectshortcuts/projectshortcuts.js' */
(function(e,g){var i,k={},m="key",b="name",j="entity-type";function f(s){var n=e(this),o=n.data(m),q=n.data(b),p=n.data(j);if(typeof o==="undefined"){return}s.preventDefault();i=new AJS.Dialog({width:600,keypressListener:function(u){if(u.which==jQuery.ui.keyCode.ESCAPE){i.remove()}},id:"project-shortcuts-dialog"}).addCancel("Close",function(){i.remove()}).addPanel("",navlinks.templates.projectshortcuts.headingWrapper({title:q,logoUrl:h(),contentHtml:navlinks.templates.projectshortcuts.dialogLoading({text:"Retrieving links"})})).show();c(i);if(!k[o]){k[o]={entity:{title:q},localShortcuts:null,remoteShortcuts:null};d(AJS.contextPath()+"/rest/project-shortcuts/1.0/local/"+o,{entityType:p}).done(t);d(AJS.contextPath()+"/rest/project-shortcuts/1.0/remote/"+o,{entityType:p}).done(r).fail(function(){var u=i.getCurrentPanel().body.find(".project-content-wrapper");u.find(".projectshortcuts-loading").remove();AJS.messages.error(u,{body:"Could not retrieve remote project shortcuts",closeable:false});c(i)})}else{l(k[o])}function t(u){k[o].localShortcuts=u.shortcuts;l(k[o])}function r(u){k[o].remoteShortcuts=u.shortcuts;l(k[o])}}function h(){return e(".project-shortcut-dialog-trigger img").attr("src")}function l(n){if(n.localShortcuts){i.getCurrentPanel().html(navlinks.templates.projectshortcuts.headingWrapper({title:n.entity.title,logoUrl:h(),contentHtml:navlinks.templates.projectshortcuts.dialogContent(n)}));c(i)}}function a(p){var o=210;if(!p||p.length<=o){return p}var n=o;while(n>0&&p.charAt(n)!=" "){n--}if(n==0){n=o}p=p.substring(0,n);if(p.length>=n){p=p+"..."}return p}function c(n){var q=n.popup.element,p=q.find(".dialog-panel-body"),o=q.find(".dialog-components");p.height("auto");q.height(o.outerHeight()-1);e(".aui-shadow").remove()}function d(n,o){return e.ajax({url:n,cache:false,data:o,dataType:"json"})}e(document).on("click",".project-shortcut-dialog-trigger",f)}(jQuery,window.NL=(window.NL||{})));
/* module-key = 'com.atlassian.plugins.atlassian-nav-links-plugin:atlassian-ui-popup-display-controller', location = 'popups/DisplayController.js' */
AJS.Popups=AJS.Popups||{};AJS.Popups.DisplayController=function(){var c=[];var a=false;var b=false;AJS.toInit(function(){setTimeout(function(){AJS.Popups.DisplayController.render()},0)});return{request:function(d){c.push(d);if(a&&b===false){this.render()}},render:function(){c.sort(function(e,d){return e.weight-d.weight});a=true;if(c.length!==0){b=true;c[0].show()}}}}();
/* module-key = 'com.atlassian.jira.jira-issue-link-web-plugin:issue-link-web-link', location = 'js/issuelink-weblink.js' */
(function(){var $hiddenImg=AJS.$("<img>"),$iconUrlInput,$urlInput,faviconUrl,throbberTimeoutId;$hiddenImg.load(function(){$iconUrlInput.val(faviconUrl);$urlInput.css("background-image",'url("'+faviconUrl+'")');clearTimeout(throbberTimeoutId);$urlInput.removeClass("loading")});$hiddenImg.error(function(){clearTimeout(throbberTimeoutId);$urlInput.removeClass("loading")});function init(context){$iconUrlInput=AJS.$("#web-link-icon-url",context);$urlInput=AJS.$("#web-link-url",context).bind("change",fetchFavicon);if($iconUrlInput.val()){$urlInput.css("background-image","url("+$iconUrlInput.val()+")")}}function fetchFavicon(){$hiddenImg.attr("src","");$iconUrlInput.val("");$urlInput.css("background-image","");faviconUrl=parseFaviconUrl($urlInput.val());if(!faviconUrl){return }setTimeout(function(){$urlInput.addClass("loading")},0);throbberTimeoutId=setTimeout(function(){$urlInput.removeClass("loading")},3000);$hiddenImg.attr("src",faviconUrl)}function parseFaviconUrl(url){var hostUrl=url.match(/^([^/]*\/\/[^/]+)/)[1];if(!hostUrl){return }return hostUrl+"/favicon.ico"}JIRA.bind(JIRA.Events.NEW_PAGE_ADDED,function(e,context){init(context)})})();
/* module-key = 'com.atlassian.jira.plugins.jira-dnd-attachment-plugin:drag-and-drop-attachment-javascript', location = 'js/jira-amd.js' */
define("dndattachment/JIRA",function(){return JIRA});
/* module-key = 'com.atlassian.jira.plugins.jira-dnd-attachment-plugin:drag-and-drop-attachment-javascript', location = 'js/aui-amd.js' */
define("dndattachment/aui",function(){return AJS});define("dndattachment/aui/dialog",function(){return AJS.Dialog});define("dndattachment/aui/inline-dialog",function(){return AJS.InlineDialog});define("dndattachment/aui/message",function(){return AJS.messages});
/* module-key = 'com.atlassian.jira.plugins.jira-dnd-attachment-plugin:drag-and-drop-attachment-javascript', location = 'js/jquery-amd.js' */
define("dndattachment/jquery",["dndattachment/aui"],function(a){return a.$});
/* module-key = 'com.atlassian.jira.plugins.jira-dnd-attachment-plugin:drag-and-drop-attachment-javascript', location = 'js/i18n.js' */
define("dndattachment/i18n",function(){var a={"dnd.attachment.unsupported.browser":"Drag and Drop of attachments is currently only available for the following browsers:","dnd.attachment.file.is.too.large":"File exceeds maximum size limit set by the administrator ({0}).","dnd.attachment.upload.in.progress":"Upload in progress, please wait."};return function(b){if(a[b]){return a[b]}else{throw"Unknown key: "+b}}});
/* module-key = 'com.atlassian.jira.plugins.jira-dnd-attachment-plugin:drag-and-drop-attachment-javascript', location = 'js/Parser.js' */
define("dndattachment/Parser",["dndattachment/aui","dndattachment/jquery"],function(a,b){var c="-dui-type-parsed";var e="*[duiType]:not(."+c+")";function d(g){var f=b(g).find(e).add(g.filter(e));var h=f.addClass(c).map(function(j,k){var i=new b.Deferred();require([b(k).attr("duiType")],function(l){if(typeof l=="function"){i.resolve(new l(k))}else{i.reject()}});return i});return b.when.apply(window,b.makeArray(h))}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(h,f,g){d(f)});if(b.isReady){d(b("body"))}else{b(function(){d(b("body"))})}return{parse:d}});
/* module-key = 'com.atlassian.jira.plugins.jira-dnd-attachment-plugin:drag-and-drop-attachment-javascript', location = 'js/IssueDropZone.js' */
define("dndattachment/IssueDropZone",["dndattachment/jquery","dndattachment/Parser","dndattachment/aui","dndattachment/JIRA","dndattachment/i18n","dndattachment/TemporaryAttachments"],function(f,h,b,a,e,d){var c=5000;var g=Class.extend({eventGroup:"issuedropzone",progressBarType:"dndattachment/UploadProgressBar",init:function(i){this.$node=f(i);if(!this.isSupportedBrowser()){return this.renderUnsupported()}this.uploadLimit=this.$node.data("upload-limit");this.uploadSize=this.$node.data("upload-size");this.formToken=this.$node.data("form-token");this.pendingQueue=[];this.render();this.connectListeners();this.queueEvent("init")},queueTask:function(i){this.pendingQueue.push(i);i.always(function(){this.pendingQueue.splice(this.pendingQueue.indexOf(i),1)}.bind(this));this.markDirty(true);f.when.apply(window,this.pendingQueue).then(_.debounce(this.checkMarkDirty,false,true).bind(this))},render:function(){this.$node.html(a.Templates.DnDAttachmentPlugin.IssueDropZone({}));this.fileInput=this.$node.find(".issue-drop-zone__file");this.fileLabel=this.fileInput.parent("label.issue-drop-zone__button");if(a.Events.LOCK_PANEL_REFRESHING){a.trigger(a.Events.LOCK_PANEL_REFRESHING,["drag-and-drop-attachment-panel"])}a.trace("jira.issue.dnd.issuedropzone.render")},connectListeners:function(){this.fileInput.change(function(k){this.uploadFiles(this.fileInput[0].files);this.queueEvent("fileInput",{count:this.fileInput[0].files.length});this.fileInput.attr("value",null)}.bind(this));if(f("html.mozilla")[0]&&(parseInt(f.browser.version,10)<22)){this.fileLabel.on("click",function(k){if(k.currentTarget===this.fileLabel[0]&&k.target.nodeName!=="INPUT"){this.fileInput.click()}}.bind(this))}var i=this.$node.parents(".issue-drop-zone").length?this.$node.parents(".issue-drop-zone"):this.$node;var j=i.find(">*").andSelf();j.on("dragover dragenter",function(k){k.preventDefault();k.stopPropagation();i.addClass("dragover")});j.on("drop",function(k){k.preventDefault();k.stopPropagation();if(k.dataTransfer&&k.dataTransfer.files&&k.dataTransfer.files.length>0){this.uploadFiles(k.dataTransfer.files);this.queueEvent("fileDrop",{count:k.dataTransfer.files.length})}i.removeClass("dragover")}.bind(this));j.on("dragleave",function(){i.removeClass("dragover")})},createUploadProgressBar:function(){return h.parse(f('<div duiType="'+this.progressBarType+'" class="upload-progress-bar"></div>').data("upload-size",this.uploadSize).data("form-token",this.formToken).insertAfter(this.$node))},uploadFiles:function(j){var l=[];var i=_.map(j,function(n){var m=new f.Deferred();this.createUploadProgressBar().then(function(o){this.trigger("progressBarInserted",o);l.push(o);o.uploadFile(n,this.uploadLimit).then(m.resolve.bind(m),m.resolve.bind(m)).done(function(){this.trigger("uploadFinished",o)}.bind(this))}.bind(this));return m}.bind(this));var k=f.when.apply(window,i);k.done(function(){var m=_.filter(i.length==1?[arguments]:arguments,function(n){return n&&n[0]&&n[0].id}).map(function(n){return n[0].id});if(m.length==0){return}this.commitUpload(m).then(function(){_.delay(function(){l.some(function(n){if(n.getAutoDestroy()){n.destroy();this.queueEvent("autoDestroy")}}.bind(this))}.bind(this),c)}.bind(this))}.bind(this));this.queueTask(k);return k},loadFiles:function(i){i.forEach(function(j){this.createUploadProgressBar().then(function(k){k.setFileID(j.id);k.setFileName(j.name);k.setFileSize(j.size);k.setProgress(1);k.setFinished();var l=d.getAttachment(j.id);if(l&&l.file){k.loadThumbnail(l.file)}else{}this.trigger("uploadFinished",k)}.bind(this))},this)},commitUpload:function(j){var i=new f.Deferred();a.SmartAjax.makeRequest({type:"POST",url:contextPath+"/secure/AttachFile.jspa",data:{inline:true,id:a.Issue.getIssueId(),filetoconvert:j,atl_token:atl_token()},success:i.resolve.bind(i),error:i.reject.bind(i)});i.then(function(){if(a.Events.REFRESH_ISSUE_PAGE){a.trigger(a.Events.REFRESH_ISSUE_PAGE,[a.Issue.getIssueId()])}a.trace("jira.issue.dnd.attached")});this.queueTask(i);this.queueEvent("commitUpload",{count:j.length});return i},isSupportedBrowser:function(){if(f("html.webkit")[0]||f("html.safari")[0]){if(!(parseFloat(f.browser.version)>=533)){return false}}else{if(f("html.mozilla")[0]){if(!(parseFloat(f.browser.version)>=1.9)){return false}}else{if(f("html.msie")[0]){if(!(parseFloat(f.browser.version)>=10)){return false}}else{return false}}}return true},renderUnsupported:function(){this.$node.addClass("issue-drop-zone__not-supported").text(e("dnd.attachment.unsupported.browser")).append("<ul><li>FireFox 3.6+</li><li>Chrome 5+</li><li>Safari 5</li></ul>")},markDirty:function(i){this.$node.addClass(a.DirtyForm.ClassNames.SANCTIONED);this.$node.toggleClass(a.DirtyForm.ClassNames.EXEMPT,!i);this.$node.attr("value",false);this.$node.attr("defaultValue",true)},checkMarkDirty:function(){if(this.pendingQueue.length==0){this.markDirty(false)}},queueEvent:function(i,j){b.trigger("analytics",{name:"issue.dnd.attachment."+this.eventGroup+"."+i,data:j||{}})}});return g});
/* module-key = 'com.atlassian.jira.plugins.jira-dnd-attachment-plugin:drag-and-drop-attachment-javascript', location = 'js/FormDropZone.js' */
define("dndattachment/FormDropZone",["dndattachment/Parser","dndattachment/IssueDropZone","dndattachment/jquery","dndattachment/aui","dndattachment/i18n","dndattachment/JIRA"],function(g,f,e,b,d,a){var c=f.extend({eventGroup:"formdropzone",init:function(){this._super.apply(this,arguments);this.bind("uploadFinished",this.onUploadFinished.bind(this));this.$containerNode=this.getContainerNode();this.$formNode=this.$node.parents("form");this.formToken=this.$formNode.find('input[name="formToken"]').attr("value");this.$inputNode=e('<input name="dnd-dropzone" type="hidden" />').insertAfter(this.$node);this.$fieldNode=this.$node.parents(".field-group");this.$fieldNode.addClass("long-field");this.$dragoverMask=e('<div class="attach-files-drop-zone__dragover-mask" />');this.$dragoverMask.appendTo(this.$containerNode);this.connectDialogEvents();this.connectFormEvents()},onUploadFinished:function(i,j){var h=e('<input type="checkbox" name="filetoconvert"/>').addClass("upload-progress-bar__checkbox").attr("value",j.fileID).attr("id","filetoconvert-"+j.fileID).prop("checked",true).insertBefore(j.$node);j.bind("onDestroy",function(){h.prop("checked",false)});setTimeout(function(){j.$node.addClass("upload-progress-bar__upload-ready");j.setIcon("aui-iconfont-close-dialog")},1000);a.trace("jira.issue.dnd.uploadfinished")},commitUpload:function(h){this.queueEvent("commitUpload",{count:h.length});return new e.Deferred()},getContainerNode:function(){return this.$node.parents(".jira-dialog-content")},connectDialogEvents:function(){var h=this.$containerNode;h.on("dragover dragenter",function(i){i.preventDefault();i.stopPropagation();h.addClass("attach-files-drop-zone__dragover")});h.on("drop",function(i){i.preventDefault();i.stopPropagation();if(i.dataTransfer&&i.dataTransfer.files&&i.dataTransfer.files.length){this.queueEvent("fileDrop",{count:i.dataTransfer.files.length});this.uploadFiles(i.dataTransfer.files)}h.removeClass("attach-files-drop-zone__dragover")}.bind(this));h.on("dragleave",function(){h.removeClass("attach-files-drop-zone__dragover")})},connectFormEvents:function(){this.$formNode.on("before-submit",function(h){if(this.isDirty){h.preventDefault();var i={};i[this.$inputNode.attr("name")]=d("dnd.attachment.upload.in.progress");a.applyErrorsToForm(this.$formNode,i);this.$formNode.find(".error").toArray().some(function(j){j.scrollIntoView()})}}.bind(this))},markDirty:function(h){f.prototype.markDirty.apply(this,arguments);this.isDirty=h;a.trace(h?"jira.issue.dnd.isdirty":"jira.issue.dnd.isclear")}});return c});
/* module-key = 'com.atlassian.jira.plugins.jira-dnd-attachment-plugin:drag-and-drop-attachment-javascript', location = 'js/AttachFilesDropZone.js' */
define("dndattachment/AttachFilesDropZone",["dndattachment/FormDropZone","dndattachment/jquery"],function(a,b){var c=a.extend({eventGroup:"attachfiledropzone",init:function(){this._super.apply(this,arguments);this.bind("progressBarInserted",function(d,f){var e=new b.Deferred();this.queueTask(e);f.result.done(e.resolve.bind(e));f.bind("onDestroy",function(){e.resolve()})}.bind(this))},checkMarkDirty:function(){if(this.pendingQueue.length<=1){this.markDirty(false)}}});return c});
/* module-key = 'com.atlassian.jira.plugins.jira-dnd-attachment-plugin:drag-and-drop-attachment-javascript', location = 'js/CreateIssueDropZone.js' */
define("dndattachment/CreateIssueDropZone",["dndattachment/jquery","dndattachment/FormDropZone","dndattachment/UploadProgressBar"],function(d,c,b){var a=c.extend({eventGroup:"createissuedropzone",progressBarType:"dndattachment/ProjectUploadProgressBar",getContainerNode:function(){return d(this.$node.parents(".jira-dialog-content")[0]||this.$node.parents("form#issue-create").parents(".aui-page-panel-content")[0])}});return a});
/* module-key = 'com.atlassian.jira.plugins.jira-dnd-attachment-plugin:drag-and-drop-attachment-javascript', location = 'js/ProjectUploadProgressBar.js' */
define("dndattachment/ProjectUploadProgressBar",["dndattachment/UploadProgressBar"],function(a){return a.extend({progressBarType:"dndattachment/ProjectUploadProgressBar",getProjectId:function(){return this.$node.parents("form").find("*[name=pid]").val()},getUploadParams:function(b){var c=a.prototype.getUploadParams.apply(this,arguments);if(this.getProjectId()){c.projectId=this.getProjectId()}return c}})});
/* module-key = 'com.atlassian.jira.plugins.jira-dnd-attachment-plugin:drag-and-drop-attachment-javascript', location = 'js/TemporaryAttachments.js' */
define("dndattachment/TemporaryAttachments",[],function(){var a={};return{getAttachment:function(b){return a[b]},putAttachment:function(d,b){var c={id:d,name:b.name,type:b.type,file:b};a[d]=c;return c}}});
/* module-key = 'com.atlassian.jira.plugins.jira-dnd-attachment-plugin:drag-and-drop-attachment-javascript', location = 'js/UploadProgressBar.js' */
define("dndattachment/UploadProgressBar",["dndattachment/jquery","dndattachment/Parser","dndattachment/FileIconUtil","dndattachment/JIRA","dndattachment/aui","dndattachment/i18n","dndattachment/TemporaryAttachments"],function(e,c,f,b,i,d,h){var g=["aui-iconfont-error","aui-iconfont-success","aui-iconfont-close-dialog"];function a(k,l){i.trigger("analytics",{name:"issue.dnd.attachment.uploadprogress."+k,data:l||{}})}var j=Class.extend({autoDestroy:true,init:function(k){this.result=new e.Deferred();this.$node=e(k);this.uploadSize=this.$node.data("upload-size");this.formToken=this.$node.data("form-token");this.render()},render:function(){this.$node.html(b.Templates.DnDAttachmentPlugin.UploadProgressBar({}));this.$node.find(".upload-progress-bar__control button").on("click",function(){this.destroy();a("buttonClick")}.bind(this))},destroy:function(){this.setAutoDestroy(false);this.trigger("onDestroy");this.$node.animate({opacity:0},{duration:250,complete:function(){this.$node.slideUp(250,function(){if(this.objectURL){window.URL.revokeObjectURL(this.objectURL)}this.$node.remove()}.bind(this))}.bind(this)})},setAutoDestroy:function(k){this.autoDestroy=k},getAutoDestroy:function(){return this.autoDestroy},getUploadParams:function(k){var l={filename:k.name,size:k.size,atl_token:atl_token(),formToken:this.formToken};_.extend(l,this.getEntityParams());return l},getEntityParams:function(){var k={};var m=b.Issue.getIssueId();var l=this.$node.parents("form").find('*[name="pid"]').attr("value");if(l){k.projectId=l}else{if(m){k.issueId=m}}return k},setFileID:function(k){this.fileID=k},setFileName:function(k){this.$node.find(".upload-progress-bar__file-name").text(k)},setFileSize:function(k){if(k>=0){this.$node.find(".upload-progress-bar__file-size").html(i.InlineAttach.Text.fileSize(k))}},uploadFile:function(l,m){this.setFileName(l.name);this.setFileSize(i.InlineAttach.Text.fileSize(l.size));this.loadThumbnail(l);var k=this.result;k.fail(this.reportError.bind(this));if(l.size>m){k.reject(d("dnd.attachment.file.is.too.large").replace("{0}",this.uploadSize),true);return k}this.upload=new i.InlineAttach.AjaxUpload({file:l,params:this.getUploadParams(l),url:i.InlineAttach.AjaxPresenter.DEFAULT_URL,progress:function(n){k.notify(n/l.size)},success:function(o,n){if(o.id!==undefined&&o.name!==undefined){k.notify(1);k.resolve(o,n,l)}else{k.reject(o,n,l)}},error:function(o,n){k.reject("Internal error",n)}});this.monitorUpload(k);this.checkSession().then(function(){this.upload.upload()}.bind(this)).fail(function(){k.reject("Unauthorized",401)});this.$node.find(".upload-progress-bar__control button").on("click",function(){this.upload.abort();k.reject()}.bind(this));k.done(function(n){h.putAttachment(n.id,l);this.setFileID(n.id);b.trace("jira.issue.dnd.uploaded")}.bind(this));return k},monitorUpload:function(k){k.progress(this.setProgress.bind(this));k.done(this.setFinished.bind(this));k.fail(function(){this.$node.addClass("UploadProgressBar_uploadFailed")}.bind(this))},setProgress:function(k){var l=this.$node.find(".upload-progress-bar__progress-bar");l.toggleClass("UploadProgressBar_progressUnknown",k===false);if(k>=0){l.find(".upload-progress-bar__bar").css("width",100*k+"%")}},setFinished:function(){this.$node.addClass("upload-progress-bar__upload-finished");this.$node.find(".upload-progress-bar__control button .aui-icon").addClass("aui-iconfont-success").removeClass("aui-iconfont-close-dialog")},loadThumbnail:function(k){if(k.type.match(/image.*/)){this.objectURL=window.URL.createObjectURL(k)}var l=this.objectURL||f.getIconURL(f.matchExtension(k.name),k.type);var m=this.$node.find(".upload-progress-bar__thumbnail");e("<img/>").attr("src",l).appendTo(m);m.addClass(this.objectURL?"upload-progress-bar__thumbnail_image":"upload-progress-bar__thumbnail_icon")},reportError:function(k){if(typeof k=="object"&&k.errorMessage){k=k.errorMessage}this.setIcon("aui-iconfont-error");this.$node.addClass("upload-progress-bar__upload-error");this.$node.find(".upload-progress-bar__bar").css("width","100%");this.$node.find(".upload-progress-bar__error-message").text(k);this.setAutoDestroy(false);a("error",{message:k})},setIcon:function(l){var k=this.$node.find(".upload-progress-bar__control button .aui-icon");if(!g.some(function(m){k.toggleClass(m,m==l);return m==l})){throw"Unknown icon"}},checkSession:function(){var k=new e.Deferred();i.$.ajax({type:"GET",url:contextPath+"/rest/auth/1/session",contentType:"application/json"}).done(function(){k.resolve()}).fail(function(){this.checkPermissions().done(function(l){k.resolve()}).fail(function(){k.reject()})}.bind(this));return k},checkPermissions:function(){var k=new e.Deferred();i.$.ajax({type:"GET",url:contextPath+"/rest/api/2/mypermissions",contentType:"application/json",data:this.getEntityParams()}).done(function(l){if(l.permissions.CREATE_ATTACHMENT.havePermission){k.resolve()}else{k.reject()}}).fail(function(){k.reject()});return k}});return j});
/* module-key = 'com.atlassian.jira.plugins.jira-dnd-attachment-plugin:drag-and-drop-attachment-javascript', location = 'js/FileIconUtil.js' */
define("dndattachment/FileIconUtil",function(){function a(h,g,e,f){this.extension=h;this.mimeType=g;this.iconFile=e;this.iconURL=contextPath+"/images/icons/attach/"+e;this.extensionName=f}var b=[new a(".pdf","application/pdf","pdf.gif","PDF File"),new a(".gif","image/gif","image.gif","GIF File"),new a(".png","image/png","image.gif","PNG File"),new a(".jpeg","image/jpeg","image.gif","JPEG File"),new a(".xml","text/xml","xml.gif","XML File"),new a(".html","text/html","html.gif","HTML File"),new a(".java","","java.gif","Java Source File"),new a(".jar","","java.gif","Java Archive File"),new a(".txt","text/plain","text.gif","Text File"),new a(".zip","application/zip","zip.gif","Zip Archive"),new a(".gz","application/x-gzip-compressed","zip.gif","GZip Archive")].concat([".doc",".docx","docm","dotx","dotm"].map(function(e){return new a(e,"application/msword","word.gif","Microsoft Word")})).concat([".xls","xlsx","xlsm","xltx","xltm","xlsb","xlam"].map(function(e){return new a(e,"application/vnd.ms-excel","excel.gif","Microsoft Excel")})).concat(["pptx","pptm","potx","potm","ppam","ppsx","ppsm"].map(function(e){return new a(e,"application/vnd.ms-powerpoint","powerpoint.gif","Microsoft PowerPoint")}));var c=/(\.([a-z]+))$/g;var d=new a("","","file.gif","Unknown format");return{getIcon:function(f,e){return b.filter(function(g){return g.extension==f||g.mimeType==e})[0]||d},getIconURL:function(g,f){var e=this.getIcon(g,f);return e&&e.iconURL},matchExtension:function(f){var e=f.match(c);return e&&e[0]}}});
/* module-key = 'com.atlassian.jira.plugins.jira-dnd-attachment-plugin:drag-and-drop-attachment-javascript', location = 'templates/IssueDropZone.soy' */
// This file was automatically generated from IssueDropZone.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.DnDAttachmentPlugin == 'undefined') { JIRA.Templates.DnDAttachmentPlugin = {}; }


JIRA.Templates.DnDAttachmentPlugin.IssueDropZone = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="issue-drop-zone__target"></div><div class="issue-drop-zone__text"><span>', soy.$$escapeHtml("Drop files here to attach them"), '</span><span>', soy.$$escapeHtml("or"), '</span></div><label class="issue-drop-zone__button aui-button">', soy.$$escapeHtml("Select files"), '<input class="issue-drop-zone__file ignore-inline-attach upfile" type="file" multiple /></label>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.plugins.jira-dnd-attachment-plugin:drag-and-drop-attachment-javascript', location = 'templates/AttachFilesDropZone.soy' */
// This file was automatically generated from AttachFilesDropZone.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.DnDAttachmentPlugin == 'undefined') { JIRA.Templates.DnDAttachmentPlugin = {}; }


JIRA.Templates.DnDAttachmentPlugin.AttachFilesDropZone = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div duiType="dndattachment/AttachFilesDropZone" class="issue-drop-zone" data-upload-limit="', soy.$$escapeHtml(opt_data.jiraAttachmentSize), '" data-upload-size="', soy.$$escapeHtml(opt_data.uploadLimit), '"></div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.plugins.jira-dnd-attachment-plugin:drag-and-drop-attachment-javascript', location = 'templates/CreateIssueDropZone.soy' */
// This file was automatically generated from CreateIssueDropZone.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.DnDAttachmentPlugin == 'undefined') { JIRA.Templates.DnDAttachmentPlugin = {}; }


JIRA.Templates.DnDAttachmentPlugin.CreateIssueDropZone = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div duiType="dndattachment/CreateIssueDropZone" class="issue-drop-zone" data-upload-limit="', soy.$$escapeHtml(opt_data.jiraAttachmentSize), '" data-upload-size="', soy.$$escapeHtml(opt_data.uploadLimit), '"></div>', (opt_data.description) ? '<div class="description">' + soy.$$escapeHtml(opt_data.description) + '</div>' : '');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.plugins.jira-dnd-attachment-plugin:drag-and-drop-attachment-javascript', location = 'templates/UploadProgressBar.soy' */
// This file was automatically generated from UploadProgressBar.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.DnDAttachmentPlugin == 'undefined') { JIRA.Templates.DnDAttachmentPlugin = {}; }


JIRA.Templates.DnDAttachmentPlugin.UploadProgressBar = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="upload-progress-bar__thumbnail"> </div><span class="upload-progress-bar__file-name"> </span><span class="upload-progress-bar__file-size"> </span><div class="upload-progress-bar__progress-bar"><span class="upload-progress-bar__bar"> </span></div><div class="upload-progress-bar__control"><button type="button" class="aui-button aui-button-subtle aui-button-compact"><span class="aui-icon aui-icon-small aui-iconfont-close-dialog">Cancel upload</span></button></div><div class="upload-progress-bar__error-message"></div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.plugins.atlassian-plugins-webresource-plugin:data', location = 'js/data/data.js' */
(function(){if(!window.WRM){window.WRM={}}function a(c){if(!c){return c}return JSON.parse(c)}function b(d,c){return Object.prototype.hasOwnProperty.call(d,c)}WRM.data={claim:function(c){if(WRM._unparsedData&&b(WRM._unparsedData,c)){var g=WRM._unparsedData[c];try{var d=a(g);delete WRM._unparsedData[c];return d}catch(f){console&&console.log&&console.log("JSON Error parsing data with key "+c+": "+f)}}}}}());
/* module-key = 'com.atlassian.jira.plugins.jira-dnd-attachment-plugin:drag-and-drop-attachment-javascript-init', location = 'js/initIssueDropZone.js' */
require(["dndattachment/Parser","dndattachment/jquery","dndattachment/IssueDropZone","dndattachment/aui","dndattachment/FileIconUtil"],function(a,b,g,i,d){if(!g.prototype.isSupportedBrowser()){return}var e="com.atlassian.jira.plugins.jira-dnd-attachment-plugin:drag-and-drop-attachment-javascript.upload-limit";var f=_.isFunction(WRM.data)?WRM.data(e):WRM.data.claim(e);function j(l,p){var k=l.find(".field-group.file-input-list");if(k.size()==0){return}if(k.find('*[duiType*="'+p+'"]').length>0){return}var n=k.find("input[name=filetoconvert]:checked").map(function(q,r){return{id:r.value,name:b(r).siblings("label").text()}}).toArray();var m=k.find(".description:last-child").html();k.empty();var o=b(JIRA.Templates.DnDAttachmentPlugin[p]({uploadLimit:i.InlineAttach.Text.fileSize(f),jiraAttachmentSize:f,description:m}));a.parse(o.appendTo(k)).then(function(q){if(q!=null){q.loadFiles(n)}})}function h(k,l){k.onContentReady(function(m){j(k.$popupContent,l)})}var c=function(){if(JIRA.Dialogs.attachFile){h(JIRA.Dialogs.attachFile,"AttachFilesDropZone")}var k=["create-issue-dialog","create-subtask-dialog","edit-issue-dialog"];var l=_.map(l,function(n){return"#"+n}).join(",");b(i).on("Dialog.show",function(p,n,o){if(_.contains(k,n.attr("id"))){h(o,"CreateIssueDropZone")}});JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(p,n,o){if(n.parents(l).size()>0){j(n,"CreateIssueDropZone")}});var m=b("form#issue-create, form#issue-edit");if(m.size()>0){j(m,"CreateIssueDropZone")}};if(b.isReady){c()}else{i.$(c)}b.event.props.push("dataTransfer")});
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:release-report-clientside', location = 'js/util/Helpers.js' */
define("jira-development-status/util/helpers",function(){return{getContextPath:AJS.contextPath}});
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:release-report-clientside', location = 'js/util/Strings.js' */
define("jira-development-status/util/strings",function(){return{format:AJS.format}});
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:release-report-clientside', location = 'js/releasereport/tab-model.js' */
define("jira-development-status/releasereport/tab-model",["jira-development-status/util/strings","jira-development-status/util/helpers","backbone","underscore","jquery"],function(f,d,e,c,a){var b=e.Model.extend({properties:["selectedTab","projectKey","versionId"],namedEvents:["fetchTabContentRequested","fetchTabContentFailed","fetchTabContentSucceeded"],shouldUpdateData:function(g){return(this.get("selectedTab")!=g)},updateData:function(i,g,k){var h=this;this.set("selectedTab",i);this.set("projectKey",g);this.set("versionId",k);var j=a.ajax({url:this._getTabContentUrl(),type:"GET",data:{selectedTab:this.get("selectedTab")}}).promise();j.done(function(l){h.trigger("fetchTabContentSucceeded",l,i)});j.fail(function(m,l){h.trigger("fetchTabContentFailed",m,l,i)})},_getTabContentUrl:function(){return f.format("{0}/rest/release-report/1.0/tab/content/{1}/{2}",d.getContextPath(),this.get("projectKey"),this.get("versionId"))}});return b});
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:release-report-clientside', location = 'js/releasereport/tab-view.js' */
define("jira-development-status/releasereport/tab-view",["aui/tabs","jira/util/events","jira/util/events/types","jira/util/events/reasons","backbone","underscore","jquery"],function(d,c,f,a,h,g,e){var b=h.View.extend({events:{"click  .release-report-link":"_updateTabContent"},initialize:function(i){this.model=i.model;this._initFetchHandlers();this._initTabs()},render:function(){},_renderLoadingState:function(){var i=this._getTabBody();i.empty();i.spin("large");i.show()},_initFetchHandlers:function(){this.listenTo(this.model,"fetchTabContentSucceeded",this._handleTabContentSucceeded);this.listenTo(this.model,"fetchTabContentFailed",this._handleTabContentFetchFailed)},_handleTabContentSucceeded:function(i,j){var k=this._getTabBody();k.empty();k.append(i)},_handleTabContentFetchFailed:function(l,i,j){var k=this._getTabBody();k.empty();k.append("failure: "+l.status+", "+l.responseText+", status: "+i)},_updateTabContent:function(n){n.preventDefault();var i=e(n.target);var k=(i.prop("tagName").toLowerCase()=="a"?i.attr("id"):i.parent().attr("id"));var l=this.$el.find("#jira-release-report-tabs-section");var j=l.attr("data-project-key");var m=l.attr("data-version-id");if(this.model.shouldUpdateData(k)){this._renderLoadingState();this.model.updateData(k,j,m)}},_initTabs:function(j){var i=this;c.bind(f.NEW_CONTENT_ADDED,function(n,l,m){if(m===a.tabUpdated&&e("#jira-release-report").length>0){var k=i.$el.find(".activetab .release-report-link").attr("id");d.setup();i.model.set("selectedTab",k)}})},_getTabBody:function(){return this.$el.find("#release-report-tab-body")}});return b});
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:release-report-clientside', location = 'js/releasereport/tab-module.js' */
define("jira-development-status/releasereport/tab-module",["jira-development-status/releasereport/tab-model","jira-development-status/releasereport/tab-view","backbone","underscore","jquery"],function(a,e,f,d,b){var c=f.Model.extend({initialize:function(g){var h=b("#project-tab");this.model=new a({});this.view=new e({model:this.model,el:h})}});return c});
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:release-report-clientside', location = 'js/releasereport/tab-module-init.js' */
require(["jira-development-status/releasereport/tab-module","jquery"],function(b,a){a(function(){new b({})})});
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:release-report-clientside', location = 'js/component/tooltip.js' */
define("jira-development-status/component/tooltip",["underscore","jquery"],function(d,b){var a=20;function g(h){var o=h.options.gravity;if(typeof o==="function"){o=o.call(h.$element[0])}if(o.charAt(0)==="n"||o.charAt(0)==="s"){var m=h.$tip;var l=m.offset();var k=Math.max(0,a-l.left);var n=Math.max(0,a+l.left+m.outerWidth()-b(window).width());var j=m.find(".tipsy-arrow");var i=(k&&n)?0:(k||-n);if(i){m.css("left",parseInt(m.css("left"),10)+i);j.css("marginLeft",-j.outerWidth()/2-i)}else{j.css("marginLeft","")}}}function c(h){var i=250;setTimeout(function(){if(h.$tip.is(":visible")){if(h.$element.is(":visible")){c(h)}else{h.hide()}}},i)}function e(h){if(h){h.show();if(h.$tip){g(h);c(h)}}}var f={};f.tipsify=function(h){h=d.extend({},h,{trigger:"manual",title:"data-tooltip"});if(!h.selector){return}b(h.context).on({mouseenter:function(){var i=b(this).tooltip(h).tipsy(true);e(i)},mouseleave:function(){var i=b(this).tipsy(true);if(i){i.hide()}}},h.selector)};return f});
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:release-report-clientside', location = 'js/releasereport/avatar-tooltips.js' */
require(["jira-development-status/component/tooltip","jquery"],function(c,a){var b=function(){c.tipsify({selector:".author-avatar",context:"section#project-tab"})};a(b)});
/* module-key = 'com.atlassian.jira.plugins.jira-software-plugin:jira-software-project-template-resources', location = '/projecttemplates/soy/SoftwareDevelopmentTemplate.soy' */
// This file was automatically generated from SoftwareDevelopmentTemplate.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.ProjectTemplates == 'undefined') { JIRA.Templates.ProjectTemplates = {}; }
if (typeof JIRA.Templates.ProjectTemplates.SoftwareTemplates == 'undefined') { JIRA.Templates.ProjectTemplates.SoftwareTemplates = {}; }


JIRA.Templates.ProjectTemplates.SoftwareTemplates.renderSoftwareDevelopmentExplanation = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="software-development-info"><div class="left-info"><p>', soy.$$escapeHtml("Select this project to work on new features for your product and to also track any bugs. JIRA will provide you with a basic workflow with the following issue types. You can optionally configure these later."), '</p><h3>', soy.$$escapeHtml("Issue Types"), '</h3><ul class="project-template-issuetype-list"><li><span class="issuetype-list-label"><span class="issuetype-icon story"></span><span class="issuetype-name">', soy.$$escapeHtml("Story"), '</span></span></li><li><span class="issuetype-list-label"><span class="issuetype-icon task"></span><span class="issuetype-name">', soy.$$escapeHtml("Task"), '</span></span></li><li><span class="issuetype-list-label"><span class="issuetype-icon subtask"></span><span class="issuetype-name">', soy.$$escapeHtml("Sub-task"), '</span></span></li><li><span class="issuetype-list-label"><span class="issuetype-icon newfeature"></span><span class="issuetype-name">', soy.$$escapeHtml("New Feature"), '</span></span></li><li><span class="issuetype-list-label"><span class="issuetype-icon bug"></span><span class="issuetype-name">', soy.$$escapeHtml("Bug"), '</span></span></li></ul></div><div class="right-info software-development-screenshot"></div></div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.googlecode.jira-suite-utilities:common', location = 'com/googlecode/jsu/maps/LocationField.js' */
(function(i){var d=window,j="onJSUGMapsLoad",n=[],g=false,a=false;function k(){var p;while(p=n.shift()){p()}}function e(q){var p=d.google.maps&&d.google.maps.LatLng;if(p){n.push(q);k()}else{if(a){n.push(q)}else{a=true;n.push(q);google.load("maps","3",{other_params:"sensor=false",callback:k})}}}function f(q){if(d.google&&d.google.load){e(q)}else{if(g){n.push(q)}else{g=true;d[j]=function(){e(q)};var p=document.createElement("script");p.src="https://www.google.com/jsapi?callback="+j;p.type="text/javascript";i("body").append(p)}}}function b(p,q){f(function(){new google.maps.Geocoder().geocode({address:p},q)})}function c(p){if(p.hasClass("open")||p.hasClass("notFound")){l(p)}else{m(p)}}function l(p){p.removeClass("open");p.removeClass("notFound")}function o(p){return !isNaN(parseFloat(p))&&isFinite(p)}function h(p){return(!p||0===p.length)}function m(t){var q=t.find("a.location").text(),p="",r=t.find(".jsuMap");var s=q.split("=>");if(s.length==2){q=s[0].trim();p=s[1].trim()}b(q,function(w,u){if(u==google.maps.GeocoderStatus.OK){t.addClass("open");var A=new google.maps.Map(r.get(0),{zoom:8,center:w[0].geometry.location,mapTypeId:google.maps.MapTypeId.ROADMAP});var z=q.split(",");if(z.length==2&&o(z[0])&&o(z[1])){var B=new google.maps.LatLng(z[0],z[1]);new google.maps.Marker({position:B,map:A,title:q})}else{new google.maps.Marker({map:A,position:w[0].geometry.location,title:q})}if(!h(p)){var v=new google.maps.DirectionsRenderer();var y=new google.maps.DirectionsService();v.setMap(A);var x={origin:q,destination:p,travelMode:google.maps.TravelMode.DRIVING};y.route(x,function(D,C){if(C==google.maps.DirectionsStatus.OK){v.setDirections(D)}})}}else{t.addClass("notFound")}})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(s,p,r){if(r===JIRA.CONTENT_ADDED_REASON.panelRefreshed||r===JIRA.CONTENT_ADDED_REASON.pageLoad){var q=i(".jsuLocation.ready",p);q.removeClass("ready");q.each(function(t,u){u=i(u);u.find("> a").click(function(v){v.preventDefault();c(u)})})}});JIRA.bind(JIRA.Events.INLINE_EDIT_STARTED,function(){JIRA.Issues.InlineEdit.BlurTriggerMapping.custom.locationselect=JIRA.Issues.InlineEdit.BlurTriggers.Default;JIRA.Issues.InlineEdit.BlurTriggerMapping.custom.locationtextfield=JIRA.Issues.InlineEdit.BlurTriggers.Default;JIRA.Issues.InlineEdit.BlurTriggerMapping.custom.directionsfield=JIRA.Issues.InlineEdit.BlurTriggers.Default})})(AJS.$);
/* module-key = 'com.atlassian.plugins.atlassian-plugins-webresource-plugin:context-path', location = 'js/data/context-path.js' */
(function(){var a=null;(window.AJS||(window.AJS={}));AJS.contextPath=function(){if(a===null){a=WRM.data.claim("com.atlassian.plugins.atlassian-plugins-webresource-plugin:context-path.context-path")}return a};AJS.contextPath._reset=function(){a=null}}());
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-public', location = 'js/applinks.public.js' */
var ApplinksUtils=ApplinksUtils||(function(f){var c={},b={};var p="com_atlassian_applinks_authentication";function o(r){var q=f('<span class="aui-icon icon-close"></span>').click(function(){r.trigger("messageClose",[this]).remove()});r.append(q)}function g(){if(window===parent.window){return null}var r=null,q=window;f("iframe",parent.document.body).each(function(s){if(this.contentWindow.window===q){r=this}});return r}function d(r,w,v,q,s){if(w in c){var t=c[w];if(v){t.authAdminUri=q;delete c[w]}j(t,v)}if(!s&&parent&&(parent!==window)){var u=window;f("iframe",parent.document.body).each(function(x,z){var y=z.contentWindow;if(y!==u){if(y.AJS&&y.AJS.$){y.AJS.$(y.document).trigger("applinks.auth.completion",[w,v,q,true])}}})}}function j(q,t){var s=f(document);if(t){var r=function(u){if(u.isDefaultPrevented()){m(q)}else{h(q);document.location.reload(true)}};s.bind("applinks.auth.approved",r);s.trigger("applinks.auth.approved",q);s.unbind("applinks.auth.approved",r)}else{s.trigger("applinks.auth.denied",q)}}function k(r,q){var s=r.find("a.applink-authenticate");if(r.hasClass("aui-message")){o(r)}s.click(function(t){window.open(q.authUri,p);t.preventDefault()});c[q.id]=q;return r}function n(){f(".applinks-auth-request").each(function(t){var s=f(this),v=s.find(".applinkId").val(),q=s.find(".appName").val(),r=s.find(".appUri").val(),u=s.find(".authUri").val();if(v&&u){k(s,{id:v,appName:q,appUri:r,authUri:u})}})}function i(q){var r=f('<div class="aui-message warning closeable applinks-auth-request"><p><span class="aui-icon icon-applinks-key"></span></p></div>');r.append(AJS.format("Additional information may be available, please \u003ca class=\"applink-authenticate\" href=\"{0}\"\u003eauthenticate\u003c/a\u003e with \u003ca href=\"{1}\"\u003e{2}\u003c/a\u003e.",AJS.escapeHtml(q.authUri),AJS.escapeHtml(q.appUri),AJS.escapeHtml(q.appName)));k(r,q);return r}function e(u,r){var q=f('<span class="applinks-auth-request"></span>'),s=f('<span class="applinks-request-description"></span>'),t=AJS.format("\u003ca class=\"applink-authenticate\" href=\"{0}\"\u003eAuthenticate\u003c/a\u003e to see additional information.",AJS.escapeHtml(r.authUri));if(u){s.append(u);s.append(" - ")}s.append(t);q.append(s);k(q,r);return q}function h(q){var r=g();if((!r)||(!r.id)){return}if(!parent.ApplinksUtils.pendingConfirmations){parent.ApplinksUtils.pendingConfirmations={}}if(!(r.id in parent.ApplinksUtils.pendingConfirmations)){parent.ApplinksUtils.pendingConfirmations[r.id]=[]}parent.ApplinksUtils.pendingConfirmations[r.id].push(q);return}function l(){if(parent&&parent.ApplinksUtils&&parent.ApplinksUtils.pendingConfirmations){var r=g();if(r){if(r.id in parent.ApplinksUtils.pendingConfirmations){var s=parent.ApplinksUtils.pendingConfirmations[r.id];delete parent.ApplinksUtils.pendingConfirmations[r.id];for(var q=0,t=s.length;q<t;q++){m(s[q])}}}}}function m(s){var t=f(document),r=f('<div class="aui-message success closeable applinks-auth-confirmation"><p><span class="aui-icon icon-applinks-key-success"></span></p></div>'),q=t.find("div.applinks-auth-confirmation-container");if(!q.length){q=t.find("body")}r.append(AJS.format("This application is now using \u003ca href=\"{0}\"\u003e{1}\u003c/a\u003e\'\'s credentials. Revoke access at any time by going to \u003ca href=\"{2}\"\u003eOAuth access tokens\u003c/a\u003e.",AJS.escapeHtml(s.appUri),AJS.escapeHtml(s.appName),AJS.escapeHtml(s.authAdminUri)));o(r);q.prepend(r);setTimeout(function(){r.fadeOut(1000,function(){f(this).remove()})},5000)}function a(){if(parent&&!(parent===window)){if(!parent.ApplinksUtils){parent.ApplinksUtils={}}}f(document).bind("applinks.auth.completion",d);n();l()}f(document).ready(a);return{createAuthRequestBanner:i,createAuthRequestInline:e}})(AJS.$);
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-util-js', location = 'js/fecru-compatibility.js' */
if(jQuery!=undefined&&AJS!=undefined){jQuery=AJS.$};
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-util-js', location = 'js/rest-service.js' */
AppLinks=AJS.$.extend(window.AppLinks||{},{Event:{NAMESPACE:"applinks",}});AppLinks.Event=AJS.$.extend(window.AppLinks.Event,{PREREADY:AppLinks.Event.NAMESPACE+".preready",READY:AppLinks.Event.NAMESPACE+".ready"});if(AJS.AppLinksInitialisationBinder){AppLinks.initialisationBinder=AJS.AppLinksInitialisationBinder}else{AppLinks.initialisationBinder=function(a){AJS.toInit(a)}}AppLinks.initialisationBinder(function(){var b=AJS.$;AppLinks=b.extend(window.AppLinks||{},{failure:function(e){if(e.status==401){window.location.reload()}else{var c=AppLinks.parseError(e);var d=b(".page-error");if(d.length>0){d.html(c).fadeIn("slow")}else{alert("REST request failed: "+c)}}},jsonRequest:function(d,e,f,g,c){if(f){f=JSON.stringify(f)}b(".page-error").fadeOut("fast");if(!c){c=AppLinks.failure}return jQuery.ajax({url:d,type:e,data:f,dataType:"json",contentType:"application/json; charset=utf-8",cache:false,success:g,error:c})},xmlRequest:function(d,e,f,g,c){if(f){f=JSON.stringify(f)}b(".page-error").fadeOut("fast");if(!c){c=AppLinks.failure}return jQuery.ajax({url:d,type:e,data:f,dataType:"xml",contentType:"application/xml; charset=utf-8",cache:false,success:g,error:c})},parseError:function(f){var c;try{c=JSON.parse(f.responseText)}catch(d){if(f.statusText){return c=f.statusText}else{return f}}if(c.message){if(b.isArray(c.message)){return c.message.join(" ")}return c.message}else{return f.statusText}},put:function(d,e,f,c){return AppLinks.jsonRequest(d,"PUT",e,f,c)},post:function(d,e,f,c){return AppLinks.jsonRequest(d,"POST",e,f,c)},update:function(d,e,c){AppLinks.put(AppLinks.self_link(d),d,e,c)},get:function(d,e,c){return AppLinks.jsonRequest(d,"GET",null,e,c)},getXml:function(d,e,c){return AppLinks.xmlRequest(d,"GET",null,e,c)},self_link:function(e){for(var c=0,f=e.link.length;c<f;c++){var d=e.link[c];if(d.rel=="self"){return d.href}}throw"No self-link found"},del:function(f,e,d){var c;if(typeof(f)=="string"){c=f}else{c=AppLinks.self_link(f)}return AppLinks.jsonRequest(c,"DELETE",null,e,d)},SPI:b.extend({},{API_VERSION:"1.0",REST_RESOURCE_URL:AJS.contextPath()+"/rest/applinks/",BASE_URL:AJS.contextPath()+"/rest/applinks/1.0",setApiVersion:function(c){AppLinks.SPI.API_VERSION=c;AppLinks.SPI.setBaseUrl(AppLinks.SPI.REST_RESOURCE_URL+AppLinks.SPI.API_VERSION)},setBaseUrl:function(c){AppLinks.SPI.BASE_URL=c},getRemoteRestBaseUrl:function(c){return c+"/rest/applinks/"+AppLinks.SPI.API_VERSION},getRemotePluginServletBaseUrl:function(c){return c+"/plugins/servlet"},getAllLinks:function(e,d){var c=AppLinks.SPI.BASE_URL+"/applicationlink";return AppLinks.get(c,e,d)},getAllLinksWithAuthInfo:function(e,d){var c=AppLinks.SPI.BASE_URL+"/listApplicationlinks";return AppLinks.get(c,e,d)},getLinksOfType:function(e,f,d){var c=AppLinks.SPI.BASE_URL+"/applicationlink/type/"+e;return AppLinks.get(c,f,d)},tryToFetchManifest:function(e,f,d){var c=AppLinks.SPI.BASE_URL+"/applicationlinkForm/manifest.json?url="+encodeURIComponent(e);return AppLinks.get(c,f,d)},getManifestFor:function(f,e,d){var c=AppLinks.SPI.BASE_URL+"/manifest/"+f+".json";return AppLinks.get(c,e,d)},getLocalManifest:function(e,d){var c=AppLinks.SPI.BASE_URL+"/manifest.json";return AppLinks.get(c,e,d)},getRemoteManifest:function(e,f,d){var c=AppLinks.SPI.getRemoteRestBaseUrl(e)+"/manifest.json";return AppLinks.get(c,f,d)},getRemoteOAuthConsumerInfo:function(e,f,d){var c=AppLinks.SPI.getRemotePluginServletBaseUrl(e)+"/oauth/consumer-info";return AppLinks.getXml(c,f,d)},createStaticUrlAppLink:function(f,e,d){var c=AppLinks.SPI.BASE_URL+"/applicationlinkForm/createStaticUrlAppLink?typeId="+f;return AppLinks.post(c,null,e,d)},createLink:function(j,h,l,d,i,k,f,m,e){var c=AppLinks.SPI.BASE_URL+"/applicationlinkForm/createAppLink";var g={applicationLink:j,username:h,password:l,createTwoWayLink:d,customRpcURL:i,rpcUrl:k,configFormValues:f};return AppLinks.post(c,g,m,e)},createLinkWithOrphanedTrust:function(j,h,m,d,i,k,f,l,n,e){var c=AppLinks.SPI.BASE_URL+"/applicationlinkForm/createAppLink";var g={applicationLink:j,username:h,password:m,createTwoWayLink:d,customRpcURL:i,rpcUrl:k,configFormValues:f,orphanedTrust:l};return AppLinks.post(c,g,n,e)},verifyTwoWayLinkDetails:function(c,i,j,f,h,e){var d=AppLinks.SPI.BASE_URL+"/applicationlinkForm/details";var g={username:j,password:f,remoteUrl:c,rpcUrl:i};return AppLinks.post(d,g,h,e)},getApplicationLinkInfo:function(e,f,d){var c=AppLinks.SPI.BASE_URL+"/applicationlinkInfo/id/"+e;return AppLinks.get(c,f,d)},deleteLink:function(g,c,f,e){var d=AppLinks.SPI.BASE_URL+"/applicationlink/"+g.id;if(c){d+="?reciprocate=true"}return AppLinks.del(d,f,e)},makePrimary:function(e,d){var c=AppLinks.SPI.BASE_URL+"/applicationlink/primary/"+e.id;return AppLinks.post(c,null,d)},relocate:function(h,f,c,g,e){var d=AppLinks.SPI.BASE_URL+"/relocateApplicationlink/"+h.id+"?newUrl="+encodeURIComponent(f)+"&nowarning="+(c?"true":"false");return AppLinks.post(d,null,g,e)},legacyUpgrade:function(f,e,d){var c=AppLinks.SPI.BASE_URL+"/upgrade/legacy/"+f.id;return AppLinks.post(c,null,e,d)},ualUpgrade:function(g,c,f,e){var d=AppLinks.SPI.BASE_URL+"/upgrade/ual/"+g.id;return AppLinks.post(d,c,f,e)},getEntityTypesForApplicationType:function(f,e,d){var c=AppLinks.SPI.BASE_URL+"/type/entity/"+f;return AppLinks.get(c,e,d)},getLocalEntitiesWithLinksToApplication:function(c,f,e){var d=AppLinks.SPI.BASE_URL+"/entitylink/localEntitiesWithLinksTo/"+c+".json";return AppLinks.get(d,f,e)},getEntityLinksForApplication:function(c,f,e){var d=AppLinks.SPI.BASE_URL+"/entities/"+c+".json";AppLinks.get(d,f,e)},getEntityLinksForApplicationUsingAnonymousAccess:function(c,f,e){var d=AppLinks.SPI.BASE_URL+"/entities/anonymous/"+c+".json";return AppLinks.get(d,f,e)},createNonUalEntityLink:function(l,g,d,f,j,e,k,i){var c=AppLinks.SPI.BASE_URL+"/entitylink/"+l+"/"+g+"?reciprocate=false";var h={applicationId:d,typeId:f,key:j,name:e,isPrimary:false};return AppLinks.put(c,h,k,i)},createEntityLink:function(h,g,d,c,i,f){var e=AppLinks.SPI.BASE_URL+"/entitylink/"+h+"/"+g+"?reciprocate=";e+=(c?"true":"false");return AppLinks.put(e,d,i,f)},getConfiguredEntityLinks:function(f,e,g,d){var c=AppLinks.SPI.BASE_URL+"/entitylink/primaryLinks/"+f+"/"+e+".json";return AppLinks.get(c,g,d)},deleteEntityLink:function(h,g,d,c,i,f){var e=AppLinks.SPI.BASE_URL+"/entitylink/"+h+"/"+g+"?typeId="+d.typeId+"&key="+d.key+"&applicationId="+d.applicationId+"&reciprocate="+c;return AppLinks.del(e,i,f)},makePrimaryEntityLink:function(g,f,c,h,e){var d=AppLinks.SPI.BASE_URL+"/entitylink/primary/"+g+"/"+f+"?typeId="+c.typeId+"&key="+c.key+"&applicationId="+c.applicationId;return AppLinks.post(d,null,h,e)},canDeleteAppLink:function(f,e,d){var c=AppLinks.SPI.BASE_URL+"/permission/reciprocate-application-delete/"+f;return AppLinks.get(c,e,d)},canDeleteEntityLink:function(g,f,c,h,e){var d=AppLinks.SPI.BASE_URL+"/permission/reciprocate-entity-delete/"+c.applicationId+"/"+g+"/"+f+"/"+c.typeId+"/"+c.key;return AppLinks.get(d,h,e)},canCreateReciprocateEntityLink:function(f,e,d){var c=AppLinks.SPI.BASE_URL+"/permission/reciprocate-entity-create/"+f;return AppLinks.get(c,e,d)},processPermissionCode:function(d){var c={noPermission:function(){},missing:function(){},credentialsRequired:function(e){},authenticationFailed:function(e){},noAuthentication:function(e){},noAuthenticationConfigured:function(){},noConnection:function(){},allowed:function(){},unrecognisedCode:function(e){},updateView:function(g,f,e){}};if(!d){d={}}d=b.extend(c,d);return function(f){var e=f.code;if(e=="NO_PERMISSION"){d.noPermission()}else{if(e=="MISSING"){d.missing()}else{if(e=="CREDENTIALS_REQUIRED"){d.credentialsRequired(f.url)}else{if(e=="AUTHENTICATION_FAILED"){d.authenticationFailed(f.url)}else{if(e=="NO_AUTHENTICATION"){d.noAuthentication(f.url)}else{if(e=="NO_AUTHENTICATION_CONFIGURED"){d.noAuthenticationConfigured()}else{if(e=="NO_CONNECTION"){d.noConnection()}else{if(e=="ALLOWED"){d.allowed()}else{d.unrecognisedCode(f.code)}}}}}}}}}},addAuthenticationTrigger:function(e,c,d){if(!d){d={}}if(typeof d.onSuccess=="undefined"){d.onSuccess=function(){location.reload()}}if(typeof d.onFailure=="undefined"){d.onFailure=function(){return true}}b(e).unbind("click");b(e).click(function(){if(d.before){d.before()}AppLinks.authenticateRemoteCredentials(c,d.onSuccess,d.onFailure)})},deleteOrphanedTrust:function(g,e,f,d){var c=AppLinks.SPI.BASE_URL+"/orphaned-trust/"+e+"/"+g;return AppLinks.del(c,f,d)},getOrphanedTrust:function(e,d){var c=AppLinks.SPI.BASE_URL+"/orphaned-trust/";return AppLinks.get(c,e,d)},showCreateEntityLinkSuggestion:function(){return true},getApplicationLink:function(f,e,d){var c=AppLinks.SPI.BASE_URL+"/applicationlink/"+f;return AppLinks.get(c,e,d)},createApplicationLink:function(f,d,i,j,c,k,g){var e=AppLinks.SPI.BASE_URL+"/applicationlink";var h={id:f,name:d,rpcUrl:i,displayUrl:j,typeId:c};return AppLinks.put(e,h,k,g)},createConsumer:function(e,n,d,m,i,l,g,p,h,k,o,f){var c=AppLinks.SPI.BASE_URL+"/applicationlink/"+e+"/authentication/consumer";var j={key:n,name:d,description:m,sharedSecret:i,publicKey:l,outgoing:k,twoLOAllowed:g,executingTwoLOUser:p,twoLOImpersonationAllowed:h};return AppLinks.put(c,j,o,f)},createConsumerAutoConfigure:function(j,i,f,c,h,e){var d=AppLinks.SPI.BASE_URL+"/applicationlink/"+j+"/authentication/consumer?autoConfigure=true";var g={twoLOAllowed:i,executingTwoLOUser:f,twoLOImpersonationAllowed:c};return AppLinks.put(d,g,h,e)},registerProvider:function(i,h,e,g,d){var c=AppLinks.SPI.BASE_URL+"/applicationlink/"+i+"/authentication/provider";var f={config:e,provider:h};return AppLinks.put(c,f,g,d)}},(window.AppLinks&&window.AppLinks.SPI)||{})});var a="applinks";AppLinks.UI={showInfoBox:function(c){b(".aui-message.success").remove();AppLinks.UI.createMessage("success",c,"page-info")},hideInfoBox:function(){b(".aui-message.success").remove()},showErrorBox:function(c){AppLinks.UI.createMessage("error",c,"page-error")},hideErrorBox:function(){b(".aui-message.error").remove()},showWarningBox:function(d){if(b.isArray(d)&&d.length>0){var c=b("<ul></ul>");b(d).each(function(f){c.append(b("<li/>",{text:d[f]}))});var e=b('<div class="page-warning"></div>').append(c);AppLinks.UI.createMessage("warning",e.html(),"page-warning")}else{AppLinks.UI.createMessage("warning",d,"page-warning")}},hideWarningBox:function(){b(".aui-message.warning").remove()},shortenString:function(d,c){if(d.length>c){d=d.substring(0,c)+"..."}return d},createMessage:function(d,e,c){var f=b('<div class="'+c+'">');f.html(e);AJS.messages[d](".applinks-message-bar",{title:"",body:f.wrap("<div></div>").parent().html(),closeable:true})},displayValidationErrorMessages:function(c,f,e){if(b.isArray(e)){b(e).each(function(j,h){var k=b('<div class="error applinks-error">');k.text(h);b(f).find("."+c).append(k)})}else{if(typeof e!="undefined"){var g=b('<div class="error applinks-error">');g.text(e.toString());b(f).find("."+c).append(g)}}},displayValidationError:function(c,d,e){return function(j){if(j.status==401){window.location.reload();return}b(".applinks-error").remove();b(".loading").remove();var h=j.responseText;var i=b.parseJSON(h);var g=i.message;if(typeof i.fields=="undefined"){AppLinks.UI.displayValidationErrorMessages(c,d,g)}else{var f=i.fields;b(f).each(function(k){var l=b('<div class="error applinks-error" id="'+f[k]+'-error">');l.text(g[k]);if(b(d).find("."+f[k]).length>0){l.insertAfter(b(d).find("."+f[k]))}else{l.insertAfter(b(d).find("."+c).append(l))}})}b(d).find("."+c).addClass("fully-populated-errors");if(e){e()}}},addProtocolToURL:function(c){var f=b.trim(c);var e=f.toLowerCase();var d=false;if(e.length>=7){if(e.substring(0,7).indexOf("http")!=-1){d=true}}if(!d){f="http://"+f}return f},prettyJoin:function(d,g,f){if(!f){f=AppLinks.I18n.getText("applinks.and")}var c=d.length;var e="";b.each(d,function(h,i){if(h==(c-1)&&c>1){e+=" "+f+"  "+g(i)}else{e+=g(i);if(h+2<c){e+=", "}}});return e},showLoadingIcon:function(c){b('<span class="loading">&nbsp;</span>').insertAfter(c)},hideLoadingIcon:function(c){b(c).next(".loading").remove()},findUrl:function(f){var e=undefined;var g=f.toLowerCase();var d=g.indexOf("http:");if(d==-1){d=g.indexOf("https:")}if(d>-1){var c=g.indexOf(" ",d);if(c==-1){c=g.length}e=f.substring(d,c)}return e},findApplicationType:function(c){c=c.toLowerCase();if(c.indexOf("jira")!=-1){return"jira"}else{if(c.indexOf("fisheye")!=-1){return"fecru"}else{if(c.indexOf("confluence")!=-1){return"confluence"}else{if(c.indexOf("refapp")!=-1){return"refapp"}else{return undefined}}}}},escapeSelector:function(c){return c.replace(/([#;&,\.\+\*\~':"\!\^$\[\]\(\)=>\|])/g,"\\$1")},sanitiseHTML:function(c){var d={"<":"&lt;",'"':"&quot;","&":"&amp;"};return c.replace(/[<"&]/g,function(e){return d[e]})},refreshOrphanedTrust:function(){var c=function(d){b("tr.orphaned-trust-row").each(function(){var j=b(this);var k=j.attr("data-id");var g=j.attr("data-type");var f=false;for(var e=0;e<d.orphanedTrust.length;e++){var h=d.orphanedTrust[e];if(k==h.id&&g==h.type){f=true;break}}if(!f){j.remove();if(d.orphanedTrust.length==0){b(".orphaned-trust-warning").hide()}}})};AppLinks.SPI.getOrphanedTrust(c)},removeCssClass:function(c,d){b(c).removeClass(function(f,h){var g=h.split(" ");var e="";b.each(g,function(i,j){if(j.indexOf(d)!=-1){e=j}});return e})}};(function(){var c=b({});b.each(["bind","unbind","trigger"],function(d,e){AppLinks.UI[e]=function(){return c[e].apply(c,arguments)}})})();AppLinks.I18n={interpolate:function(d,c){if(c){if(!b.isArray(c)){c=[new String(c)]}c.unshift(d);d=AJS.format.apply(AJS,c)}return d},getTextWithPrefix:function(c,d){return AppLinks.I18n.interpolate(appLinksI18n.entries[a+"."+c],d)},getText:function(c,d){return AppLinks.I18n.interpolate(AppLinks.I18n.resolveValue(c),d)},getApplicationTypeName:function(c){return appLinksI18n.entries["applinks.application.type."+c]},getEntityTypeName:function(c){return appLinksI18n.entries["applinks.entity.type."+c]},getPluralizedEntityTypeName:function(c){return appLinksI18n.entries["applinks.entity.type.plural."+c]},getAuthenticationTypeName:function(c){return appLinksI18n.entries["applinks.auth.provider."+c]},resolveValue:function(c){var d=appLinksI18n.entries[c];return typeof d=="undefined"?c:d}};AppLinks.Docs={createDocLink:function(d,e,c){if(!c){c=""}else{c=" "+c}return b("<a/>",{"class":"ual-help-link"+c,href:AppLinks.Docs.getDocHref(d,e),target:"_blank",text:AppLinks.I18n.getText("applinks.help"),title:AppLinks.I18n.getText("applinks.help")})},getDocHref:function(d,e){var c=AppLinks.Docs.resolveValue("applinks.docs.root")+"/"+AppLinks.Docs.resolveValue(d);if(e){c+="#"+AppLinks.Docs.resolveValue(e)}return c},resolveValue:function(c){var d=applinksDocs.entries[c];return typeof d=="undefined"?c:d}};b(document).trigger(AppLinks.Event.PREREADY);b(document).trigger(AppLinks.Event.READY)});
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-util-js', location = 'js/json2.js' */
if(!this.JSON){this.JSON={}}(function(){function f(n){return n<10?"0"+n:n}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(key){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(key){return this.valueOf()}}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(string){escapable.lastIndex=0;return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+string+'"'}function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];if(value&&typeof value==="object"&&typeof value.toJSON==="function"){value=value.toJSON(key)}if(typeof rep==="function"){value=rep.call(holder,key,value)}switch(typeof value){case"string":return quote(value);case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null"}gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==="[object Array]"){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||"null"}v=partial.length===0?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]";gap=mind;return v}if(rep&&typeof rep==="object"){length=rep.length;for(i=0;i<length;i+=1){k=rep[i];if(typeof k==="string"){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}else{for(k in value){if(Object.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}v=partial.length===0?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}";gap=mind;return v}}if(typeof JSON.stringify!=="function"){JSON.stringify=function(value,replacer,space){var i;gap="";indent="";if(typeof space==="number"){for(i=0;i<space;i+=1){indent+=" "}}else{if(typeof space==="string"){indent=space}}rep=replacer;if(replacer&&typeof replacer!=="function"&&(typeof replacer!=="object"||typeof replacer.length!=="number")){throw new Error("JSON.stringify")}return str("",{"":value})}}if(typeof JSON.parse!=="function"){JSON.parse=function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==="object"){for(k in value){if(Object.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v}else{delete value[k]}}}}return reviver.call(holder,key,value)}text=String(text);cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})}if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse")}}}());
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-util-js', location = 'js/autocomplete.js' */
AJS.$(document).bind(AppLinks.Event.READY,function(){AppLinks.autoComplete={cacheManager:function(c){var a={},b=[],c=c||30;return{get:function(d){return a[d]},put:function(d,e){a[d]=e;b.push(d);if(b.length>c){delete a[b.shift()]}},clear:function(){a={};b=[]}}}};(function(d){var c=function(f){AJS.log("InputDrivenDropDown: truncating text");var h=f.$.closest(".aui-dropdown").width(),g=20;d("a span:not(.icon)",f.$).each(function(){var j=d(this),i=AJS("var","&#8230;"),l=i.width(),k=false;j.wrapInner(d("<em>"));d("em",j).each(function(){var m=d(this);m.show();if(this.offsetLeft+this.offsetWidth>h){var t=this.childNodes,s=false;for(var o=t.length-1;o>=0;o--){var p=t[o],n=1,r=(p.nodeType==3)?"nodeValue":"innerHTML",q=p[r];do{if(n<=q.length){p[r]=q.substr(0,q.length-n++)}else{break}}while(this.offsetLeft+this.offsetWidth+l>h-g);if(n<=q.length){s=true;break}}if(s){k=true}else{m.hide()}}});if(k){j.append(i);this.elpss=i}})};var b=function(f,l){if(!l.length||!l[0]){return}AJS.log("InputDrivenDropDown: highlighting tokens");for(var h=0,j=l.length;h<j;h++){var g=l[h];l[h]=g?g.replace(/[\.\*\+\?\|\(\)\[\]{}\\]/g,"\\$"):""}var k=new RegExp("("+l.join("|")+")","gi");d("li a:not(.dropdown-prevent-highlight) span",f.$).each(function(){var m=d(this),i=m.html().replace(k,"<strong>$1</strong>");m.html(i)})};var e=function(j,g){var i=j.options,h=j.dd;if(h){h.hide();h.$.remove()}i.ajsDropDownOptions=i.ajsDropDownOptions||{};if(i.ajsDropDownOptions&&!i.ajsDropDownOptions.alignment){i.ajsDropDownOptions.alignment="left"}i.ajsDropDownOptions.selectionHandler=i.ajsDropDownOptions.selectionHandler||function(l,k){if(l.type!="click"){l.preventDefault();d("a",k).click();document.location=d("a",k).attr("href")}};i.ajsDropDownOptions.displayHandler=function(k){return AJS.escapeHtml(k.name)};var f=j.dd=new AJS.dropDown(g.matrix,i.ajsDropDownOptions)[0];if(i.ajsDropDownOptions&&i.ajsDropDownOptions.className){f.$.addClass(i.ajsDropDownOptions.className)}if(i.dropdownPlacement){i.dropdownPlacement(f.$)}else{AJS.log("No dropdownPlacement function specified. Appending dropdown to the body.");d("body").append(f.$)}b(f,g.queryTokens||[g.query]);c(f);if(i.dropdownPostprocess){i.dropdownPostprocess(f.$)}f.show(j._effect);if(typeof i.onShow=="function"){i.onShow.call(f,f.$)}return f};function a(g,f){this._effect="appear";this._timer=null;this.id=g;this.options=f;this.inactive=false;this.busy=false;this.cacheManager=AppLinks.autoComplete.cacheManager()}a.prototype.clearCache=function(){this.cacheManager.clear()};a.prototype.change=function(h,g){var f=this;if(h!=f._value||g){f._value=h;f.busy=false;clearTimeout(f._timer);if(g||(/\S{0,}/).test(h)){var i=f.cacheManager.get(h);if(i){e(f,i)}else{f.busy=true;f._timer=setTimeout(function(){f.options.getDataAndRunCallback.call(f,h,f.show)},200)}}else{f.dd&&f.dd.hide()}}};a.prototype.dropDownLength=function(){return this.dd.links?this.dd.links.length:0};a.prototype.dropDownItem=function(f){return this.dropDownLength()>f?this.dd.links[f]:null};a.prototype.hide=function(){this.dd&&this.dd.hide()};a.prototype.remove=function(){var f=this.dd;if(f){this.hide();f.$.remove()}this.inactive=true;this.options.onDeath&&this.options.onDeath()};a.prototype.show=function(g,i,h){if(this.inactive){AJS.log("Quick search abandoned before server response received, ignoring. "+this);return}var f={matrix:g,query:i,queryTokens:h};this.cacheManager.put(i,f);e(this,f);this.busy=false};AppLinks.inputDrivenDropdown=function(f){return new a("inputdriven-dropdown",f)}})(jQuery)});
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-util-js', location = 'js/wizard.js' */
AJS.$(document).bind(AppLinks.Event.PREREADY,function(){(function(d){d.fn.wizard=function(v){var u={width:500,height:350,onshow:function(w,x){return true},aftershow:function(){return true},oncancel:function(){return true},onsubmit:function(){return true},aftersubmit:function(){return true},onnext:function(){return true},onprevious:function(){return true},cancelLabel:AppLinks.I18n.getText("applinks.cancel"),submitLabel:AppLinks.I18n.getText("applinks.create"),nextLabel:AppLinks.I18n.getText("applinks.next"),previousLabel:AppLinks.I18n.getText("applinks.previous"),id:""};if(!v){v={}}v=d.extend(u,v);var t=this;this.each(function(){var D=d(this);var w=new AJS.Dialog(v.width,v.height,v.id);var L=q(w,v.onshow,v.aftershow);var K=c(w,v.oncancel);var z=h(w,v.onsubmit,v.aftersubmit);var M=a(w,v.onprevious);var I=m(w,v.onnext);var G=k(w);var B=o(w);var C=g(w);var H=l(w);var J=s(w);var E=n(w);if(v.showButtonId){d("#"+v.showButtonId).click(L)}var y=f(D);for(var A=0;A<y.length;A++){var F=y[A];j(w,F);if(F.className){w.addHeader(F.title,F.className+"-header")}else{w.addHeader(F.title)}if(A!=0&&d(F.div).attr("previous")!="false"){w.addButton(v.previousLabel,M,"applinks-previous-button")}if(A<y.length-1&&d(F.div).attr("submit")!="true"&&d(F.div).attr("next")!="false"){w.addButton(v.nextLabel,I,"applinks-next-button")}if(d(F.div).attr("submit")=="true"){w.addButton(v.submitLabel,z,"wizard-submit")}if(!w.getPage(A).buttonpanel){w.addButton("",null);d(w.getPage(A).buttonpanel).empty();var x=d('<a class="button-panel-button applinks-cancel-link">'+v.cancelLabel+"</a>");w.getPage(A).buttonpanel.append(x);x.click(K)}else{var x=d('<a class="button-panel-link button-panel-cancel-link applinks-cancel-link">'+v.cancelLabel+"</a>");d(w.getPage(A).buttonpanel).append(x);x.click(K)}if(A<y.length-1){w.addPage()}}t={dialog:w,nextPage:I,prevPage:M,submit:z,cancel:K,show:L,disableNextBtn:G,enableNextBtn:B,disableSubmitBtn:C,enableSubmitBtn:H,disablePreviousBtn:J,enablePreviousBtn:E};w.gotoPage(0);w.gotoPanel(0)});return t};function s(t){return function(){b(r(t,"applinks-previous-button"))}}function n(t){return function(){i(r(t,"applinks-previous-button"))}}function k(t){return function(){b(r(t,"applinks-next-button"))}}function o(t){return function(){i(r(t,"applinks-next-button"))}}function g(t){return function(v){var u=r(t,"wizard-submit");b(u);if(typeof(v)=="undefined"||v){d('<span class="loading">&nbsp;</span>').insertBefore(u)}else{u.parent().find(".loading").remove()}}}function l(t){return function(){var u=r(t,"wizard-submit");i(u);u.parent().find(".loading").remove()}}function r(u,t){return d(u.getPage(u.curpage).buttonpanel).find("."+t)}function p(t){d(t.popup.element).find("form").each(function(){this.reset()})}function i(t){t.attr("disabled",false)}function b(t){t.attr("disabled",true)}function q(t,u,v){return function(w){if(u(t,w)!==false){t.gotoPage(0);t.gotoPanel(0);d(document).unbind("keydown.ual.dialog");d(document).bind("keydown.ual.dialog",e(t));t.show();v()}}}function c(t,u){return function(){if(u(t)!==false){t.hide();p(t)}}}function a(t,u){return function(){if(u(t)!==false){t.prevPage()}}}function m(t,u){return function(){if(u(t)!==false){t.nextPage()}}}function e(t){return function(u){if(u.keyCode===27){p(t);d(document).unbind("keydown.ual.dialog")}}}function h(u,v,t){return function(){if(v(u)!==false){t(u);p(u)}}}function j(v,w){var u=d("> div[panel]",w.div);if(u.length>0){u.each(function(y,z){var x=v.addPanel(z.title,null,z.className,"menu-"+z.id);x.getCurrentPanel().body.append(u[y])})}else{var t=v.addPanel(w.title);t.getCurrentPanel().body.append(w.div)}}function f(v){var u=d(" > div",v);var t=[];u.each(function(x){var w=d(this);t[x]={title:w.attr("title")||null,className:w.attr("class"),div:w}});return t}})(jQuery)});
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-util-js', location = 'js/applinkwizard.js' */
(function(a){AppLinks.Wizard={getWizard:function(){return a("#create-application-link-container").data("wizard")},initAuthenticationUI:function(d){var h=a(d);var f=h.find(".create-reciprocal-link");var c=h.find(".ual-arrow");var l=h.find(".two-way-link-details");var j=h.find(".reciprocal-link-description");var b=h.find(".no-reciprocal-link-description");f.click(function(){if(f.is(":checked")){c.removeClass("no-background");l.show();j.show();b.hide()}else{c.addClass("no-background");l.hide();j.hide();b.show()}});var i=h.find(".same-user-radio-btn");var k=h.find(".different-user-radio-btn");var e=h.find(".different-userbase-image");var g=h.find(".same-userbase-image");i.click(function(){e.addClass("different-userbase-image-grey");g.removeClass("same-userbase-image-grey")});k.click(function(){g.addClass("same-userbase-image-grey");e.removeClass("different-userbase-image-grey")})},initNonUALUI:function(e){var c=a(e);var b=c.find(".application-types");for(var d=0;d<nonAppLinksApplicationTypes.length;d++){a('<option value="'+nonAppLinksApplicationTypes[d].typeId+'">'+nonAppLinksApplicationTypes[d].label+"</option>").appendTo(b)}},fetchManifest:function(e,h,d,b){var i=h.find("#application-url");if(i.val()==""){var c=h.find("#application-types");if(c.val()==""){a('<div class="error applinks-error">'+AppLinks.I18n.getText("applinks.error.url.field.empty")+"</div>").insertAfter(i);return false}var g=function(j){e.enableSubmitBtn();e.enablePreviousBtn();e.cancel();AppLinks.UI.listApplicationLinks(j.applicationLink.id,"new",j)};AppLinks.SPI.createStaticUrlAppLink(c.val(),g,null);return true}var f=AppLinks.UI.addProtocolToURL(i.val());AppLinks.UI.showLoadingIcon(i);var g=function(l){var k=l;e.enableNextBtn();h.find(".loading").remove();h.find(".reciprocal-rpc-url").val(a("#baseUrl").val());if(typeof l.typeId!="undefined"){AppLinks.Wizard.handleUALManifest(k,h);e.dialog.gotoPage(2);h.find(".reciprocal-link-username").focus();if(d){d(k)}}else{if(l.code=="applinks.warning.redirected.host"&&!i.data("hasWarnedAboutRedirection")){AppLinks.UI.displayValidationErrorMessages("manifest-validation-errors",h,l.warning);i.data("hasWarnedAboutRedirection","true");var m=function(){a(i).removeData("hasWarnedAboutRedirection");a(i).unbind("change",m)};i.bind("change",m)}else{if(l.code=="applinks.warning.unknown.host"&&!i.data("forceWhenHostIsOffline")){AppLinks.UI.displayValidationErrorMessages("manifest-validation-errors",h,l.warning);i.data("forceWhenHostIsOffline","true");var j=function(){a(i).removeData("forceWhenHostIsOffline");a(i).unbind("change",j)};i.bind("change",j)}else{if(k.code=="applinks.warning.unknown.host"||k.code=="applinks.warning.redirected.host"){delete k.warning;delete k.code}AppLinks.Wizard.handleNonUALManifest(k,f,h);e.dialog.gotoPage(1);h.find(".application-name").focus();if(b){b(k)}}}}};e.disableNextBtn();AppLinks.SPI.tryToFetchManifest(f,g,AppLinks.UI.displayValidationError("manifest-validation-errors",h,function(){e.enableNextBtn()}));return f},handleUALManifest:function(f,e){var c=a(e);c.find(".remote-app-image").removeClass(function(j,l){var k=l.split(" ");var i="";a.each(k,function(m,n){if(n.indexOf("application-type-image-")!=-1){i=n}});return i});c.find(".remote-app-image").addClass("application-type-image-"+f.typeId);c.find(".link-to-app-type").html(AppLinks.I18n.getText("applinks.create.title.link.to",AppLinks.I18n.getApplicationTypeName(f.typeId)));c.find(".remote-app-name").text(AppLinks.UI.shortenString(f.name,20));c.find(".create-reciprocal-link").attr("checked",true);c.find("#reciprocal-link-back-to-server").html(AppLinks.I18n.getText("applinks.create.link.back.to.server",AJS.escapeHtml(f.name)));var d=["administrator",AJS.escapeHtml(f.name),'<a target="_blank" href="'+AppLinks.Docs.getDocHref("applinks.docs.adding.application.link")+'">',"</a>"];var h=f.applinksVersion.split(".");var b=parseInt(h[0]);var g=parseInt(h[1]);if((f.typeId=="jira"||f.typeId=="confluence")&&(b==3&&g<10)){d[0]="system administrator"}c.find(".reciprocal-link-description").html(AppLinks.I18n.getText("applinks.create.two.way.link",d));c.find(".no-reciprocal-link-description").hide();c.find(".no-reciprocal-link-description").html(AppLinks.I18n.getText("applinks.create.two.way.no.link",AJS.escapeHtml(f.name)));c.find(".reciprocal-link-username").val("");c.find(".reciprocal-link-password").val("");c.find(".ual-arrow").removeClass("no-background");c.find(".two-way-link-details").show();c.find(".reciprocal-link-description").show();c.find(".no-reciprocal-link-description").hide()},handleNonUALManifest:function(d,e,c){var b=a(c);b.find(".application-name").val("");b.find(".application-types option:first-child").attr("selected","selected");b.find(".non-ual-application-url").text(e);if(d.warning){b.find(".create-non-ual-warning").show();b.find(".create-non-ual-warning").html(d.warning)}else{b.find(".create-non-ual-warning").hide()}},checkReciprocalLinkFormThreeStepMode:function(c,d,g,j,f){var h=a(c);if(h.find(".create-reciprocal-link").is(":checked")){var k=a.trim(h.find(".reciprocal-rpc-url").val());if(k==""){a("<div class='error applinks-error'>"+AppLinks.I18n.getText("applinks.error.url.field.empty")+"</div>").insertAfter(h.find(".reciprocal-rpc-url"));if(f){f()}return}var e=h.find(".reciprocal-link-username");var b=h.find(".reciprocal-link-password");if(e.val()==""){a('<div class="error applinks-error">'+AppLinks.I18n.getText("applinks.error.username.empty")+"</div>").insertAfter(e);if(f){f()}return false}var i=function(l){h.find(".same-user-description").find("input").attr("checked",true);h.find(".trust-radio-btn").attr("checked",true);h.find(".same-user-radio-btn").click();g(l)};k=AppLinks.UI.addProtocolToURL(k);AppLinks.SPI.verifyTwoWayLinkDetails(j,k,e.val(),b.val(),i,AppLinks.UI.displayValidationError("two-way-link-errors",c,f));return false}else{d();return false}},checkReciprocalLinkFormTwoStepMode:function(f,h,b,i){var c=a(f);var g=a.trim(c.find(".reciprocal-rpc-url").val());if(g==""){a("<div class='error applinks-error'>"+AppLinks.I18n.getText("applinks.error.url.field.empty")+"</div>").insertAfter(c.find(".reciprocal-rpc-url"));if(i){i()}return}var d=c.find(".reciprocal-link-username");var e=c.find(".reciprocal-link-password");if(d.val()==""){a('<div class="error applinks-error">'+AppLinks.I18n.getText("applinks.error.username.empty")+"</div>").insertAfter(d);if(i){i()}return false}g=AppLinks.UI.addProtocolToURL(g);AppLinks.SPI.verifyTwoWayLinkDetails(h,g,d.val(),e.val(),b,AppLinks.UI.displayValidationError("two-way-link-errors",f,i));return false}}})(AJS.$);
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-util-js', location = 'js/urls.js' */
(function(){AppLinks.Urls={generateUrl:function(b,a){var c=b;if(typeof a=="undefined"){return c}else{AJS.$.each(a,function(d,e){if(c.indexOf("?")<0){c=c+"?"}else{c=c+"&"}c=c+d+"="+encodeURIComponent(JSON.stringify(e))});return c}},generateApplinksAdminUrl:function(d,c,a){var b=d+"/plugins/servlet/applinks/listApplicationLinks";if(c==="confluence"){b=d+"/admin/listapplicationlinks.action"}return AppLinks.Urls.generateUrl(b,a)}}})();
/* module-key = 'com.atlassian.jira.jira-issue-link-applinks-common-plugin:issue-link-applinks', location = 'js/issuelink-applinks.js' */
var IssueLinkAppLinks=IssueLinkAppLinks||(function($){function createHelper(servers,context,settings){var helper={};var selectedServer=null;function selectServer(appId){selectedServer=getServer(servers,appId);var authenticationRequired=selectedServer&&selectedServer.requireCredentials;doAuthenticationRequired(authenticationRequired,context);return{authenticationRequired:authenticationRequired}}function setAuthenticationRequired(appId,authenticationRequired){var server=getServer(servers,appId);if(server){server.requireCredentials=authenticationRequired;if(selectedServer&&selectedServer.id===appId){doAuthenticationRequired(authenticationRequired,context)}}}function doAuthenticationRequired(required,context){$(".issue-link-applinks-authentication-message",context).empty();if(required){createAuthRequiredBanner($(".issue-link-applinks-authentication-message",context),context);$(".issue-link-oauth-toggle").hide();$(".buttons-container input[type=submit]",context).attr("disabled","disabled")}else{$(".issue-link-oauth-toggle").show();$(".buttons-container input[type=submit]",context).removeAttr("disabled")}}function createAuthRequiredBanner($container,context){var oauthCallbacks={onSuccess:function(){selectedServer.requireCredentials=false;doAuthenticationRequired(false,context);if(settings.onAuthenticationSuccessCallback){settings.onAuthenticationSuccessCallback(context,selectedServer.id,helper)}},onFailure:function(){if(settings.onAuthenticationFailedCallback){settings.onAuthenticationFailedCallback(context,selectedServer.id,helper)}}};var encodedServerName=AJS.escapeHtml(selectedServer.name);if(selectedServer.authUrl){var $banner=$('<div class="aui-message warning closeable shadowed applinks-auth-request"><p><span class="aui-icon icon-applinks-key"></span></p></div>');$banner.append(AJS.format("Authorization required to create issue link. Please \u003ca href=\"{0}\" class=\"applink-authenticate\"\u003eauthenticate\u003c/a\u003e with \u003ca href=\"{1}\"\u003e{2}\u003c/a\u003e.",selectedServer.authUrl,selectedServer.url,encodedServerName));$("a",$banner).addClass("applink-authenticate");$(".applink-authenticate",$banner).click(function(e){authenticateRemoteCredentials(selectedServer.authUrl,oauthCallbacks.onSuccess,oauthCallbacks.onFailure);e.preventDefault()});$container.append($banner)}else{var warningMessage=AJS.format("Unable to create a link to \u003ca href=\"{0}\"\u003e{1}\u003c/a\u003e as the application does not have any authentication configured.",selectedServer.url,encodedServerName);AJS.messages.warning($container,{body:warningMessage})}}function createOAuthCallback(){if(!AppLinks.OAuthCallback&&typeof (oauthCallback)==="undefined"){AppLinks.OAuthCallback=function(){};AppLinks.OAuthCallback.prototype.success=function(){this.aouthWindow.close();this.onSuccess();delete oauthCallback;delete AppLinks.OAuthCallback};AppLinks.OAuthCallback.prototype.failure=function(){this.aouthWindow.close();this.onFailure();delete oauthCallback;delete AppLinks.OAuthCallback};AppLinks.OAuthCallback.prototype.show=function(url,onSuccess,onFailure){this.onSuccess=onSuccess;this.onFailure=onFailure;this.aouthWindow=window.open(url,"com_atlassian_applinks_authentication")};oauthCallback=new AppLinks.OAuthCallback()}}function authenticateRemoteCredentials(url,onSuccess,onFailure){createOAuthCallback();$(".applinks-error").remove();oauthCallback.show(url,onSuccess,onFailure)}return $.extend(helper,{selectServer:selectServer,setAuthenticationRequired:setAuthenticationRequired})}function getServer(servers,appId){var i;if(servers.length){for(i=0;i<servers.length;i++){if(servers[i].id===appId){return servers[i]}}}return null}function initApplinkServers(settings,context,deferred){var currentAppId=settings.getCurrentAppId(context);var applicationType=$(".issue-link-applinks-application-type",context).val();var issueId=settings.getIssueId(context);$.get(AJS.contextPath()+"/rest/issueLinkAppLink/1/appLink/info",{type:applicationType,issueIdOrKey:issueId},function(servers){var helper=createHelper(servers,context,settings);var currentRequiresCredentials;if(servers&&servers.length){var currentServer=getServer(servers,currentAppId);if(currentServer){currentRequiresCredentials=$(".issue-link-applinks-authentication-message",context).hasClass("required");if(currentRequiresCredentials){currentServer.requireCredentials=true}helper.selectServer(currentAppId)}deferred.resolve(context,helper)}else{deferred.reject(context)}})}function init(settings,context){var deferred=$.Deferred();var isIssueLinkAppLinkContent=$(".issue-link-applinks-authentication-message",context).length!==0;if(isIssueLinkAppLinkContent&&settings.shouldExecute(context)){initApplinkServers(settings,context,deferred)}return deferred.promise()}return{init:init}})(AJS.$);
/* module-key = 'com.atlassian.jira.jira-issue-link-remote-jira-plugin:issue-link-remote-jira-js', location = 'js/issuelink-jira.js' */
(function($){var settings={getCurrentAppId:function(context){return $("#jira-app-link",context).val()},shouldExecute:function(context){return $("#jira-app-link",context).length!==0},getIssueId:function(context){return $("input[name=id]",context).val()}};var updateIssuePicker=function($select,appId){if($select.length){$select.attr("data-ajax-options.data.app-id",appId);if(appId&&appId!==""){$select.attr("data-ajax-options.url",contextPath+"/rest/remoteJiraIssueLink/1/remoteJira/picker")}else{$select.attr("data-ajax-options.url",contextPath+"/rest/api/1.0/issues/picker")}$select.trigger("updateOptions");$select.trigger("clearSelection")}};var updateCreateReciprocalCheckbox=function(appId,context){var $reciprocalCheckbox=$("#create-reciprocal",context);if($reciprocalCheckbox.length){if(appId&&appId!==""){var defaultChoice=($("#create-reciprocal-default",context).val()=="true");if(defaultChoice){$reciprocalCheckbox.attr("checked","checked")}else{$reciprocalCheckbox.removeAttr("checked")}$reciprocalCheckbox.removeAttr("disabled");$("#create-reciprocal-fieldset",context).removeClass("disabled")}else{$reciprocalCheckbox.attr("checked","checked");$reciprocalCheckbox.attr("disabled","disabled");$("#create-reciprocal-fieldset",context).addClass("disabled")}}};JIRA.bind(JIRA.Events.NEW_PAGE_ADDED,function(e,context){var $select=$("#jira-issue-keys",context);if($select.length){var appId=$("#jira-app-link",context).val();updateIssuePicker($select,appId);updateCreateReciprocalCheckbox(appId,context)}IssueLinkAppLinks.init(settings,context).done(function(context,helper){$("#jira-app-link",context).change(function(){var appId=$(this).val();helper.selectServer(appId);updateIssuePicker($select,appId);updateCreateReciprocalCheckbox(appId,context)})})})})(AJS.$);
/* module-key = 'jira.webresources:jqlautocomplete', location = '/includes/jira/autocomplete/JQLAutoComplete.js' */
define("jira/jql/jql-grammar",function(){var grammar={};grammar.jql_order_by=[{value:"ORDER BY",displayName:"ORDER BY"}];grammar.jql_operators=[{value:"=",displayName:"="},{value:"!=",displayName:"!="},{value:"~",displayName:"~"},{value:"<=",displayName:"&lt;="},{value:">=",displayName:"&gt;="},{value:">",displayName:"&gt;"},{value:"<",displayName:"&lt;"},{value:"!~",displayName:"!~"},{value:"is not",displayName:"is not"},{value:"is",displayName:"is"},{value:"not in",displayName:"not in"},{value:"in",displayName:"in"},{value:"was",displayName:"was"},{value:"was not",displayName:"was not"},{value:"was in",displayName:"was in"},{value:"was not in",displayName:"was not in"},{value:"changed",displayName:"changed"}];grammar.jql_logical_operators=[{value:"AND",displayName:"AND"},{value:"OR",displayName:"OR"}];grammar.jql_logical_operators_and_order_by=grammar.jql_logical_operators.concat(grammar.jql_order_by);grammar.jql_order_by_direction=[{value:"ASC",displayName:"ASC"},{value:"DESC",displayName:"DESC"}];grammar.empty_operand=[{value:"EMPTY",displayName:"EMPTY",types:["java.lang.Object"]}];grammar.jql_not_logical_operator=[{value:"NOT",displayName:"NOT"}];grammar.jql_was_predicates=[{value:"AFTER",displayName:"AFTER",type:"java.util.Date",supportsList:"false"},{value:"BEFORE",displayName:"BEFORE",type:"java.util.Date",supportsList:"false"},{value:"BY",displayName:"BY",type:"com.atlassian.crowd.embedded.api.User",supportsList:"false",auto:"true"},{value:"DURING",displayName:"DURING",type:"java.util.Date",supportsList:"true"},{value:"ON",displayName:"ON",type:"java.util.Date",supportsList:"false"}];grammar.jql_changed_predicates=grammar.jql_was_predicates.concat([{value:"FROM",displayName:"FROM",type:"java.lang.String",supportsList:"true",auto:"true"},{value:"TO",displayName:"TO",type:"java.lang.String",supportsList:"true",auto:"true"}]);grammar.jql_was_predicates_and_order_by=grammar.jql_was_predicates.concat(grammar.jql_logical_operators_and_order_by);grammar.jql_was_predicates_and_logical_operators=grammar.jql_was_predicates.concat(grammar.jql_logical_operators);grammar.jql_changed_predicates_and_order_by=grammar.jql_changed_predicates.concat(grammar.jql_logical_operators_and_order_by);grammar.jql_changed_predicates_and_logical_operators=grammar.jql_changed_predicates.concat(grammar.jql_logical_operators);grammar.REGEXP_ANDS=/^AND\s/i;grammar.REGEXP_ORS=/^OR\s/i;grammar.REGEXP_NOTS=/^NOT\s/i;grammar.REGEXP_SNOT=/^\s+not/i;grammar.REGEXP_SIN=/^\s+in/i;grammar.REGEXP_SNOT_IN=/^\s+(not\s+in|not|in)/i;grammar.REGEXP_COMMA_DELIMITER=/^\s*,/;grammar.REGEXP_ASCENDING=/^\s+asc/i;grammar.REGEXP_DESCENDING=/^\s+desc/i;grammar.REGEXP_ORDER_BY=/^order\s+by/i;grammar.REGEXP_WHITESPACE=/^\s/;grammar.REGEXP_UNICODE=/^u[a-fA-F0-9]{4}/;grammar.REGEXP_FIELD_NAME=/^\s-\scf\[\d\d\d\d\d\]/;grammar.REGEXP_NEW_LINE=/[\r\n]/;grammar.REGEXP_NUMBER=/\d/;grammar.REGEXP_TOKEN_CHAR=/[^=!~<>(),\s&|\]]/;grammar.REGEXP_SPECIAL_CHAR=/[{}*\/%+$#@?;\][]/;grammar.REGEXP_SPACE_OR_ELSE=/[\s(]/;grammar.REGEXP_CHARS_TO_ESCAPE=/[^trn"'\\\s]/;grammar.REGEXP_NOTSTART=/^NO?$/i;grammar.REGEXP_INSTART=/^IN?$/i;grammar.REGEXP_PREDICATE=/^(after|before|by|during|from|on|to)/i;return grammar});define("jira/autocomplete/jql-autocomplete",["jira/autocomplete/autocomplete","jira/jql/jql-grammar","jira/jql/util","jira/jql/operator-util","jira/util/data/meta","jira/util/objects","jquery"],function(AutoComplete,grammar,Util,OperatorUtil,Meta,Objects,jQuery){var JQLAutoComplete=function(options){var that=Objects.begetObject(AutoComplete);var parser=options.parser;var result;var jql_field_names=jQuery.grep(options.jqlFieldNames,function(arrValue){return arrValue.searchable});var jql_order_by_field_names=jQuery.grep(options.jqlFieldNames,function(arrValue){return arrValue.orderable});var jql_function_names=options.jqlFunctionNames;var PARSE_INDICATOR=jQuery("#"+options.errorID);var suggestionCount=0;var jqlcolumnnum=jQuery("#jqlcolumnnum");var jqlrownum=jQuery("#jqlrownum");var autoCompleteUrl=options.autoCompleteUrl||contextPath+"/rest/api/1.0/jql/autocomplete";that.textToSuggestionCursorPosition=function(){return that.field.selectionRange().textBefore};that.pushSuggestionsOnHtmlStack=function(suggestions,suggestionNodes,htmlParts,listItemIdentifier,mayNeedParenthesis){var length=Math.min(15,suggestions.length);for(var i=0;i<length;i++){var actualValueSug;var displayNameSug;if(suggestions[i].value){var resultSug=suggestions[i];if(result&&mayNeedParenthesis){actualValueSug=((result.getNeedsOpenParen())?"(":"")+resultSug.value}else{actualValueSug=resultSug.value}displayNameSug=resultSug.displayName}else{displayNameSug=suggestions[i];actualValueSug=displayNameSug}suggestionNodes.push(actualValueSug);htmlParts.push('<li id="',listItemIdentifier,i,'">',displayNameSug,"</li>")}};that.renderSuggestions=function(suggestions,moreSuggestions,operatorSuggestions){var suggestionNodes=[];if(suggestions instanceof Array){if(suggestions.length<1&&(moreSuggestions&&moreSuggestions.length<1)&&(operatorSuggestions&&operatorSuggestions.length<1)){return suggestionNodes}var htmlParts=["<ul>"];if(operatorSuggestions&&operatorSuggestions.length>0){that.pushSuggestionsOnHtmlStack(operatorSuggestions,suggestionNodes,htmlParts,"jql_operator_suggest_",false)}that.pushSuggestionsOnHtmlStack(suggestions,suggestionNodes,htmlParts,"jql_value_suggest_",true);if(moreSuggestions&&moreSuggestions.length>0){that.pushSuggestionsOnHtmlStack(moreSuggestions,suggestionNodes,htmlParts,"jql_function_suggest_",false)}htmlParts.push("</ul>");var syntaxHelpLink=jQuery('<a class="syntax-help" target="_jiraHelp"></a>').attr("title",Meta.get("advanced-search-help-title")).attr("href",Meta.get("advanced-search-help-url")).text("Syntax Help");var syntaxHelpContainer=jQuery('<div class="syntax-help-container">').append(syntaxHelpLink);that.responseContainer.html(htmlParts.join("")).append(syntaxHelpContainer).find("li").each(function(i){suggestionNodes[i]=[jQuery(this),suggestionNodes[i]]});that.addSuggestionControls(suggestionNodes)}return suggestionNodes};that.completeField=function(value){var start=that.getReplacementStartIndex(result,value);var end=that.getReplacementEndIndex(result,start);that.replaceValue(start,end,value);var newToken=parser.parse(that.field.val());that.updateParseIndicator(newToken)};that.prepareOperandSuggestions=function(canAutoComplete,fieldName,functionSuggestions,operatorSuggestions,suggestedValue){if(canAutoComplete){var currentSuggestionCount=suggestionCount;var fieldValue=(suggestedValue==null)?((result.getLastOperand()===null)?"":Util.stripEscapeCharacters(result.getLastOperand())):suggestedValue;var fieldNameValueKey=fieldName+":"+fieldValue;var data={fieldName:Util.stripEscapeCharacters(fieldName)};if(result.getLastOperand()!==null||suggestedValue!==null){data.fieldValue=fieldValue}var includeEmpty=OperatorUtil.isWasOperator(result.getLastOperator());if(!that.getSavedResponse(fieldNameValueKey)){that.dropdownController.dropdown.removeClass("dropdown-ready");that.delay(function(){that._makeRequest({url:autoCompleteUrl,dataType:"json",data:data,success:function(response){var results;if(response!==null&&response.results!==null){results=response.results}else{results=[]}if(includeEmpty){var suggestion=data.fieldValue;results=that.appendEmpty(suggestion,results)}that.saveResponse(fieldNameValueKey,results);that.renderSuggestionsForOperands(fieldValue,results,functionSuggestions,operatorSuggestions,currentSuggestionCount)},error:function(){that.renderSuggestionsForOperands(fieldValue,[],functionSuggestions,operatorSuggestions,currentSuggestionCount)}})},that.queryDelay)}else{that.renderSuggestionsForOperands(fieldValue,that.getSavedResponse(fieldNameValueKey),functionSuggestions,operatorSuggestions,currentSuggestionCount)}}else{that.renderSuggestionsForOperands(Util.stripEscapeCharacters(result.getLastOperand()),[],functionSuggestions,operatorSuggestions,suggestionCount)}};that.preparePredicateSuggestions=function(predicateName,suggestedValue){var currentSuggestionCount=suggestionCount;if(typeof suggestedValue=="undefined"){suggestedValue=null}var functionSuggestions=that.slimListForPredicates(suggestedValue,jql_function_names,predicateName);that.boldMatchingString(suggestedValue,functionSuggestions);var predicateValue=(suggestedValue==null)?((result.getLastOperand()===null)?"":Util.stripEscapeCharacters(result.getLastOperand())):suggestedValue;var predicateNameValueKey=predicateName+":"+predicateValue;var data={predicateName:Util.stripEscapeCharacters(predicateName)};if(result.getLastOperand()!==null||suggestedValue!==null){data.predicateValue=predicateValue}if(result.getLastFieldName()!==null){data.fieldName=result.getLastFieldName();predicateNameValueKey=result.getLastFieldName()+":"+predicateNameValueKey}if(that.predicateSupportsAutoComplete(predicateName)){if(!that.getSavedResponse(predicateNameValueKey)){that.dropdownController.dropdown.removeClass("dropdown-ready");that.delay(function(){that._makeRequest({url:autoCompleteUrl,dataType:"json",data:data,success:function(response){var results;if(response!==null&&response.results!==null){results=response.results}else{results=[]}var suggestion=data.predicateValue;results=that.appendEmpty(suggestion,results);that.saveResponse(predicateNameValueKey,results);that.renderSuggestions(results,functionSuggestions)},error:function(){that.renderSuggestionsForOperands(predicateValue,[])}})},that.queryDelay)}else{that.renderSuggestions(that.getSavedResponse(predicateNameValueKey),functionSuggestions)}}else{that.renderSuggestions([],functionSuggestions)}};that.incompleteOperator=function(){var tokens=result.getTokens();if(tokens==null||tokens.length<2){return""}else{tokens=that.textToSuggestionCursorPosition().split(" ");if(tokens.length>2){return tokens[tokens.length-1]}}return""};that.incompletePredicateValue=function(){var tokens=result.getTokens();if(tokens==null||tokens.length<3){return""}else{tokens=that.textToSuggestionCursorPosition().split(/[\s(,]+/);if(tokens.length>3){return tokens[tokens.length-1]}}return""};that.appendEmpty=function(suggestion,results){var empty_list=that.slimListForMapResults(suggestion,grammar.empty_operand,true);if(suggestion!=null){that.boldMatchingString(suggestion,empty_list)}if(results.length<15){results=results.concat(empty_list)}else{results[14]=empty_list[0]}return results};that.dispatcher=function(val){var selectionRange=jQuery(that.field).selectionRange();var parseValue=val.substring(0,selectionRange.start);var value;var functionSuggestions;var token=parser.parse(parseValue);result=token.getResult();suggestionCount++;if(result.getNeedsField()){that.renderSuggestionsFromMap(Util.stripEscapeCharacters(result.getLastFieldName()),jql_field_names,grammar.jql_not_logical_operator,true)}else{if(result.getNeedsOperatorOrOperand()){functionSuggestions=(OperatorUtil.isEmptyOnlyOperator(result.getLastOperator()))?grammar.empty_operand:jql_function_names;token.calcLastOperandStartIndex();var parsedOperator=token.getParsedOperator();var operatorSuggestions=that.getSuggestionsForOperators(parsedOperator,grammar.jql_operators);if(operatorSuggestions&&operatorSuggestions.length>0){var operandSuggestion=that.incompleteOperator();that.prepareOperandSuggestions(true,result.getLastFieldName(),functionSuggestions,operatorSuggestions,operandSuggestion)}}else{if(result.getNeedsOperator()){that.renderSuggestionsForOperators(result.getLastOperator(),grammar.jql_operators)}else{if(result.getNeedsPredicateOperand()){var predicate=result.getLastWasPredicate();that.preparePredicateSuggestions(predicate,Util.stripEscapeCharacters(result.getLastOperand()))}else{if(result.getNeedsLogicalOperator()){if(result.getNeedsWasPredicate()){if(result.getNeedsOrderBy()){value=(result.getLastOrderBy()===null)?result.getLastWasPredicate():result.getLastOrderBy();if(result.getLastOperator()=="was"){that.renderSuggestionsFromMap(value,grammar.jql_was_predicates_and_order_by,false)}else{that.renderSuggestionsFromMap(value,grammar.jql_changed_predicates_and_order_by,false)}}else{if(result.getLastOperator()=="was"){that.renderSuggestionsFromMap(result.getLastWasPredicate(),grammar.jql_was_predicates_and_logical_operators,false)}else{that.renderSuggestionsFromMap(result.getLastWasPredicate(),grammar.jql_changed_predicates_and_logical_operators,false)}}}else{if(result.getNeedsOrderBy()){value=(result.getLastOrderBy()===null)?result.getLastLogicalOperator():result.getLastOrderBy();that.renderSuggestionsFromMap(value,grammar.jql_logical_operators_and_order_by,false)}else{that.renderSuggestionsFromMap(result.getLastLogicalOperator(),grammar.jql_logical_operators,false)}}}else{if(result.getNeedsOrderByField()){that.renderSuggestionsFromMap(Util.stripEscapeCharacters(result.getLastOrderByFieldName()),jql_order_by_field_names,true)}else{if(result.getNeedsOrderByDirection()){that.renderSuggestionsFromMap(result.getLastOrderByDirection(),grammar.jql_order_by_direction,false)}else{if(result.getNeedsOperand()){var fieldName=result.getLastFieldName();var canAutoComplete=false;if(!OperatorUtil.isEmptyOnlyOperator(result.getLastOperator())){for(var i=0;i<jql_field_names.length;i++){if(Util.equalsIgnoreCase(result.getUnquotedString(jql_field_names[i].value),fieldName)||(jql_field_names[i].cfid&&Util.equalsIgnoreCase(jql_field_names[i].cfid,fieldName))){canAutoComplete=jql_field_names[i].auto;break}}}functionSuggestions=(OperatorUtil.isEmptyOnlyOperator(result.getLastOperator()))?grammar.empty_operand:jql_function_names;that.prepareOperandSuggestions(canAutoComplete,fieldName,functionSuggestions,{})}else{if(result.getNeedsOrderBy()){that.renderSuggestionsFromMap(result.getLastOrderBy(),grammar.jql_logical_operators_and_order_by,false)}else{that.dropdownController.hideDropdown()}}}}}}}}}that.parse(val)};that.parse=function(val){var newToken=parser.parse(val);that.updateParseIndicator(newToken);that.updateColumnLineCount();return newToken.getResult()};that.renderSuggestionsFromMap=function(stringVal,list,otherSuggestions,showFull){if(!otherSuggestions){otherSuggestions={}}var suggestions=that.slimListForMapResults(stringVal,list,showFull);var relevantOtherSuggestions=that.slimListForMapResults(stringVal,otherSuggestions,showFull);that.boldMatchingString(stringVal,relevantOtherSuggestions);that.boldMatchingString(stringVal,suggestions);that.renderSuggestions(suggestions,relevantOtherSuggestions);if(suggestions.length===0&&relevantOtherSuggestions.length===0){that.dropdownController.hideDropdown()}};that.getSuggestionsForOperators=function(stringVal,list){var suggestions=that.slimListForMapResults(stringVal,list,false);var fieldName=result.getLastFieldName();var supportedOperators;for(var i=0;i<jql_field_names.length;i++){if(Util.equalsIgnoreCase(result.getUnquotedString(jql_field_names[i].value),fieldName)||(jql_field_names[i].cfid&&Util.equalsIgnoreCase(jql_field_names[i].cfid,fieldName))){supportedOperators=jql_field_names[i].operators;break}}if(supportedOperators){suggestions=jQuery.grep(suggestions,function(arrValue){return jQuery.inArray(arrValue.value,supportedOperators)>-1})}that.boldMatchingString(stringVal,suggestions);return suggestions};that.renderSuggestionsForOperators=function(stringVal,list){var suggestions=that.getSuggestionsForOperators(stringVal,list);that.renderSuggestions(suggestions);if(suggestions.length===0){that.dropdownController.hideDropdown()}};that.renderSuggestionsForOperands=function(stringVal,ajaxSuggestions,functions,operatorSuggestions,providedSuggestionCount){if(providedSuggestionCount===suggestionCount){var functionsSuggestions=that.slimListForFunctionResults(stringVal,functions,result.getLastOperator());that.boldMatchingString(stringVal,functionsSuggestions);that.renderSuggestions(ajaxSuggestions,functionsSuggestions,operatorSuggestions);if(ajaxSuggestions.length===0&&functionsSuggestions.length===0&&operatorSuggestions.length==0){that.dropdownController.hideDropdown()}}};that.boldMatchingString=function(stringVal,list){if(stringVal==null||list.length===0){return }var boldLength=stringVal.length;for(var j=0,n=boldLength;j<n;j++){switch(stringVal.charAt(j)){case"<":case">":boldLength+=3;break;case"&":boldLength+=4;break;case'"':boldLength+=5;break}}for(var i=0;i<list.length;i++){if(list[i].displayName){var origVal=list[i].displayName;list[i]={value:list[i].value,displayName:"<b>"+origVal.substring(0,boldLength)+"</b>"+origVal.substring(boldLength)}}else{list[i]={value:list[i],displayName:"<b>"+list[i].substring(0,boldLength)+"</b>"+list[i].substring(boldLength)}}}};that.getReplacementStartIndex=function(result,value){var jQueryReference=jQuery(that.field);var start;if(result.getNeedsField()){start=result.getLastFieldNameStartIndex()}else{if(result.getNeedsOperatorOrOperand()){if(result.getNeedsOperator()&&OperatorUtil.isWasOperator(value)){start=result.getLastOperatorStartIndex()}else{start=result.getLastOperandStartIndex()}}else{if(result.getNeedsOperand()){start=result.getLastOperandStartIndex()}else{if(result.getNeedsOperator()){start=result.getLastOperatorStartIndex()}else{if(result.getNeedsOrderByField()){start=result.getLastOrderByFieldNameStartIndex()}else{if(result.getNeedsOrderByDirection()){start=result.getLastOrderByDirectionStartIndex()}else{if(result.getNeedsPredicateOperand()){start=result.getLastOperandStartIndex()}else{if(result.getNeedsLogicalOperator()){if(result.getLastLogicalOperatorStartIndex()!==null&&result.getLastLogicalOperatorStartIndex()!==0){start=result.getLastLogicalOperatorStartIndex()}else{if(result.getLastOrderBy()!==null&&result.getLastOrderByStartIndex()!==0){start=result.getLastOrderByStartIndex()}else{if(result.getLastWasPredicate()!=null&&result.getLastWasPredicateStartIndex()!==0){start=result.getLastWasPredicateStartIndex()}else{if(result.getMustBeOperatorOrPredicate()===true){start=jQueryReference.selectionRange().start}else{start=jQueryReference.selectionRange().start-1}}}}}else{if(result.getNeedsWasPredicate()){start=result.getLastWasPredicateStartIndex()}else{if(result.getNeedsOrderBy()){start=result.getLastOrderByStartIndex()}else{start=jQueryReference.selectionRange().start-1}}}}}}}}}}return start!=null?start:jQueryReference.selectionRange().start};that.getReplacementEndIndex=function(result,start){var jQueryReference=jQuery(that.field);var selectionRange=jQueryReference.selectionRange();var end=null;if(selectionRange.start===selectionRange.end&&selectionRange.end!==that.field.val().length){var currentTokenIdx=result.getTokens().length-1;var token=parser.parse(that.field.val());if(!token.getParseError()){var fullTokenValue=token.getResult().getTokens()[currentTokenIdx];if(fullTokenValue!==null&&fullTokenValue!=="("&&fullTokenValue!==")"){var fullTextVal=that.field.val();var remainingString=fullTextVal.substring(start,fullTextVal.length);var remainingStringArr=remainingString.split("");var whitespaceCount=0;for(var i=0;i<remainingStringArr.length;i++){if(grammar.REGEXP_WHITESPACE.test(remainingStringArr[i])){whitespaceCount++}else{break}}end=start+fullTokenValue.length+whitespaceCount}}}if(end===null){end=selectionRange.end}if(end<start){that.replaceValue(start,end," ");end=start}return end};that.replaceValue=function(start,end,newValue){var jQueryReference=jQuery(that.field);jQueryReference.selectionRange(start,end);jQueryReference.selection(newValue);var newEnd=jQueryReference.selectionRange().end;jQueryReference.selectionRange(newEnd,newEnd)};that.slimListForMapResults=function(stringVal,list,showFull){var escString=Util.htmlEscape(stringVal);var slimedList=jQuery.grep(list,function(arrValue){return Util.startsWithIgnoreCaseNullsMeanAll(escString,arrValue.displayName)});if(!showFull){if(slimedList.length===1&&!Util.startsWithNotEqualsIgnoreCaseNullMeansAll(escString,slimedList[0].displayName)){return{}}}return slimedList};that.slimListForFunctionResults=function(stringVal,list,operator){var fieldName=result.getLastFieldName();var supportedTypes;for(var i=0;i<jql_field_names.length;i++){if(Util.equalsIgnoreCase(result.getUnquotedString(jql_field_names[i].value),fieldName)||(jql_field_names[i].cfid&&Util.equalsIgnoreCase(jql_field_names[i].cfid,fieldName))){supportedTypes=jql_field_names[i].types;break}}var slimedList=jQuery.grep(list,function(arrValue){if((arrValue.isList&&!OperatorUtil.isListSupportingOperator(operator))||(!arrValue.isList&&OperatorUtil.isListSupportingOperator(operator))){return false}if(supportedTypes){var supportsFunction=jQuery.inArray("java.lang.Object",arrValue.types)>-1||jQuery.inArray("java.lang.Object",supportedTypes)>-1;for(var i=0;i<supportedTypes.length&&!supportsFunction;i++){supportsFunction=jQuery.inArray(supportedTypes[i],arrValue.types)!==-1}if(!supportsFunction){return false}}else{return false}return Util.startsWithIgnoreCaseNullsMeanAll(stringVal,arrValue.value)||Util.startsWithIgnoreCaseNullsMeanAll(stringVal,arrValue.displayName)});if(slimedList.length===1&&!Util.startsWithNotEqualsIgnoreCaseNullMeansAll(stringVal,slimedList[0].displayName)){return{}}return slimedList};that.slimListForPredicates=function(stringVal,list,predicate){var supportedType;var supportsList;for(var i=0;i<grammar.jql_changed_predicates.length;i++){if(Util.equalsIgnoreCase(result.getUnquotedString(grammar.jql_changed_predicates[i].value),predicate)){supportedType=grammar.jql_changed_predicates[i].type;supportsList=grammar.jql_changed_predicates[i].supportsList;break}}var slimedList=jQuery.grep(list,function(arrValue){if(typeof arrValue.isList!="undefined"){if((arrValue.isList&&!!supportsList)||(!arrValue.isList&&supportsList)){return false}}var supportsFunction=jQuery.inArray(supportedType,arrValue.types)!==-1;return supportsFunction?Util.startsWithIgnoreCaseNullsMeanAll(stringVal,arrValue.value)||Util.startsWithIgnoreCaseNullsMeanAll(stringVal,arrValue.displayName):false});if(slimedList.length===1&&!Util.startsWithNotEqualsIgnoreCaseNullMeansAll(stringVal,slimedList[0].displayName)){return{}}return slimedList};that.predicateSupportsAutoComplete=function(predicate){var auto;for(var i=0;i<grammar.jql_changed_predicates.length;i++){if(Util.equalsIgnoreCase(result.getUnquotedString(grammar.jql_changed_predicates[i].value),predicate)){auto=grammar.jql_changed_predicates[i].auto;break}}return auto};that.getSavedResponse=function(val){if(!this.requested){this.requested={}}return this.requested[val]};that.saveResponse=function(val,response){if(typeof val==="string"&&typeof response==="object"){if(!this.requested){this.requested={}}this.requested[val]=response}};that.startsWithIgnoreCase=function(startStr,str){if(str===null||startStr===null||str.length<startStr.length){return false}else{return startStr.toLowerCase()==str.substr(0,startStr.length).toLowerCase()}};that.updateParseIndicator=function(token){if(token.getParseError()){PARSE_INDICATOR.attr("title",token.getResult().getParseErrorMsg()).removeClass("jqlgood").addClass("jqlerror")}else{PARSE_INDICATOR.attr("title","").removeClass("jqlerror").addClass("jqlgood")}};that.updateColumnLineCount=function(){var jQueryReference=jQuery(that.field);var totalCharCountToCursor=0;if(that.field[0]===document.activeElement){var selectionRange=jQueryReference.selectionRange();totalCharCountToCursor=selectionRange.start}else{totalCharCountToCursor=that.field[0].value.length}var rowCount=1;var colCount=1;var fieldValue=that.field.val();for(var i=0;i<totalCharCountToCursor;i++){if(grammar.REGEXP_NEW_LINE.test(fieldValue.charAt(i))){rowCount++;colCount=1}else{colCount++}}jqlcolumnnum.text(colCount);jqlrownum.text(rowCount)};that.init(options);return that};return JQLAutoComplete});define("jira/jql/util",["jira/jql/jql-grammar"],function(grammar){var JQLAutoCompleteUtil={};JQLAutoCompleteUtil.htmlEscape=function(stringVal){if(stringVal==null){return null}var escapedVal="";var strArr=stringVal.split("");for(var j=0;j<strArr.length;j++){if(strArr[j]==="<"){escapedVal+="&lt;"}else{if(strArr[j]===">"){escapedVal+="&gt;"}else{if(strArr[j]==="&"){escapedVal+="&amp;"}else{if(strArr[j]==='"'){escapedVal+="&quot;"}else{escapedVal+=strArr[j]}}}}}return escapedVal};JQLAutoCompleteUtil.stripEscapeCharacters=function(val){if(val==null){return val}var newVal="";var strArr=val.split("");for(var i=0;i<strArr.length;i++){if(strArr[i]=="\\"){if(!grammar.REGEXP_UNICODE.test(val.substring(i,val.length))){i++;if(i>=val.length){break}}}newVal+=strArr[i]}return newVal};JQLAutoCompleteUtil.equalsIgnoreCase=function(str1,str2){if(str1===null&&str2===null){return true}else{if(str1===null||str1===null){return false}else{return str1.toLowerCase()===str2.toLowerCase()}}};JQLAutoCompleteUtil.startsWithIgnoreCaseNullsMeanAll=function(startStr,str){if(str===null||startStr===null){return true}if(str.length<startStr.length){return false}else{return startStr.toLowerCase()==str.substr(0,startStr.length).toLowerCase()}};JQLAutoCompleteUtil.startsWithNotEqualsIgnoreCaseNullMeansAll=function(startStr,str){if(str===null||startStr===null){return true}if(str.length<startStr.length){return false}else{var subStrEquals=startStr.toLowerCase()==str.substr(0,startStr.length).toLowerCase();if(subStrEquals){var equalsString=null;if(grammar.REGEXP_FIELD_NAME.test(str.substr(startStr.length,str.length))){equalsString=str.substr(0,startStr.length)}else{equalsString=str}return startStr.toLowerCase()!=equalsString.toLowerCase()}return false}};return JQLAutoCompleteUtil});define("jira/jql/operator-util",function(){var that={};that.isListSupportingOperator=function(operator){return operator==="in"||operator==="not in"||operator=="was not in"||operator=="was in"};that.isEmptyOnlyOperator=function(operator){return operator==="is"||operator==="is not"};that.isWasOperator=function(operator){return operator==="was"||operator==="was in"||operator=="was not in"||operator=="was not"};that.isChangedOperator=function(operator){return operator==="changed"};that.isHistoryOperator=function(operator){return that.isWasOperator(operator)||that.isChangedOperator(operator)};return that});define("jira/jql/jql-parser",["jira/jql/jql-grammar","jira/jql/jql-parse-token","jira/jql/operator-util","jquery"],function(grammar,Token,OperatorUtil,jQuery){return function(jqlReservedWords){var jql_reserved_words=jqlReservedWords;return{parse:function(input){var token=Token();token.init(input);this.jql(token);return token},orderByClause:function(token){var remainingString=token.remainingString();var matchArray=remainingString.match(grammar.REGEXP_ORDER_BY);if(matchArray){var orderByString=remainingString.substring(0,matchArray[0].length);token.consumeCharacters(orderByString.length);token.getResult().setLastOrderBy(orderByString,token);if(!token.isComplete()){remainingString=token.remainingString();if(grammar.REGEXP_WHITESPACE.test(remainingString)){this.chewWhitespace(token);this.orderByFields(token)}else{token.getResult().resetLogicalOperators();token.setParseError()}}else{token.getResult().resetLogicalOperators();token.setParseError()}}else{token.consumeCharacters(remainingString.length);token.getResult().setLastOrderBy(remainingString,token);token.setParseError()}},orderByFields:function(token){this.orderByField(token);this.chewWhitespace(token);if(token.isComplete()){if(!token.getResult().getNeedsOrderByField()){token.getResult().setLastOrderByDirection("",token)}}else{var remainingString=token.remainingString();if(this.startsWithIgnoreCase(",",remainingString)){token.consumeCharacter();this.orderByFields(token);this.chewWhitespace(token)}else{remainingString=token.remainingString();if(remainingString!==null){token.consumeCharacters(remainingString.length)}token.getResult().setNeedsOrderByDirection();token.getResult().setLastOrderByDirection(remainingString,token);token.setParseError()}}},orderByField:function(token){this.chewWhitespace(token);var fieldName=this.fieldName(token);if(fieldName.length!==0){token.getResult().setLastOrderByFieldName(fieldName,token);var remainingString=token.remainingString();if(!token.isComplete()&&!grammar.REGEXP_COMMA_DELIMITER.test(remainingString)){if(grammar.REGEXP_ASCENDING.test(remainingString)){this.chewWhitespace(token);token.consumeCharacters(3);token.getResult().setLastOrderByDirection("asc",token);token.getResult().setNeedsOrderByComma()}else{if(grammar.REGEXP_DESCENDING.test(remainingString)){this.chewWhitespace(token);token.consumeCharacters(4);token.getResult().setLastOrderByDirection("desc",token);token.getResult().setNeedsOrderByComma()}else{token.getResult().setNeedsOrderByDirection()}}}else{token.getResult().setNeedsOrderByField();this.chewWhitespace(token)}}else{token.getResult().setLastOrderByFieldName("",token);token.getResult().setNeedsOrderByField();token.setParseError()}},jql:function(token){this.orClause(token);var remainingString=token.remainingString();if(this.startsWithIgnoreCase("ord",remainingString)){this.orderByClause(token)}},orClause:function(token){while(!token.isComplete()&&!this.startsWithIgnoreCase(")",token.remainingString())){this.chewWhitespace(token);var remainingString=token.remainingString();if(this.startsWithIgnoreCase("ord",remainingString)){break}if(token.getResult().getMustBeOperatorOrPredicate()){token.getResult().resetLastPredicates()}else{token.getResult().resetLogicalOperators();this.andClause(token)}if(!token.isComplete()&&token.getResult().getLastLogicalOperator()===null){if(token.getResult().getNeedsWasPredicate()){this.predicateClause(token)}if(token.isComplete()){return }remainingString=token.remainingString();if(this.startsWithIgnoreCase("ord",remainingString)){break}else{if(remainingString!==null&&(grammar.REGEXP_ORS.test(remainingString)||this.startsWithIgnoreCase("|",remainingString)||this.startsWithIgnoreCase("||",remainingString))){if(this.startsWithIgnoreCase("||",remainingString)){token.getResult().setLastLogicalOperator("||",token.getTokenStringIdx());token.consumeCharacters(2)}else{if(grammar.REGEXP_ORS.test(remainingString)){token.getResult().setLastLogicalOperator("OR",token.getTokenStringIdx());token.consumeCharacters(3)}else{token.getResult().setLastLogicalOperator("|",token.getTokenStringIdx());token.consumeCharacters(1)}}token.getResult().resetTerminalClause();if(token.isComplete()){token.setParseError()}token.getResult().setNeedsField()}else{if(!this.startsWithIgnoreCase(")",remainingString)||!token.getInParens()){this.chewWhitespace(token);var errorIdx=(remainingString===null)?token.getMaxTokenStringIdx():token.getMaxTokenStringIdx()-remainingString.length;var tokens;if(remainingString!=null){tokens=remainingString.split(" ");token.getResult().setLastLogicalOperator(tokens[0],errorIdx);token.getResult().setLastWasPredicate(tokens[0],token);token.getResult().setNeedsLogicalOperator(token)}if(token.getResult().getLastWasOperator()==null){token.setParseError()}else{if(tokens!=null){if(grammar.REGEXP_PREDICATE.test(tokens[0])){token.getResult().setLastLogicalOperator(null);token.getResult().resetNeedsPredicateOperand()}else{if(grammar.REGEXP_ANDS.test(remainingString)){token.consumeCharacters(4);token.getResult().resetTerminalClause();token.getResult().setNeedsField()}if(token.isComplete()||tokens.length==1){token.setParseError()}}}}}}}}}},andClause:function(token){this.chewWhitespace(token);this.notClause(token);if(!token.isComplete()&&token.getResult().getLastLogicalOperator()===null){this.chewWhitespace(token);var remainingString=token.remainingString();if(remainingString!==null&&(grammar.REGEXP_ANDS.test(remainingString)||this.startsWithIgnoreCase("&",remainingString)||this.startsWithIgnoreCase("&&",remainingString))){if(this.startsWithIgnoreCase("&&",remainingString)){token.getResult().setLastLogicalOperator("&&",token.getTokenStringIdx());token.consumeCharacters(2)}else{if(this.startsWithIgnoreCase("&",remainingString)){token.getResult().setLastLogicalOperator("&",token.getTokenStringIdx());token.consumeCharacters(1)}else{token.getResult().setLastLogicalOperator("AND",token.getTokenStringIdx());token.consumeCharacters(4)}}token.getResult().resetTerminalClause();if(token.isComplete()){token.setParseError()}token.getResult().setNeedsField()}else{token.getResult().setNeedsLogicalOperator(token);if(token.isComplete()){token.getResult().setLastLogicalOperator(null,token.getMaxTokenStringIdx())}}}},notClause:function(token){this.chewWhitespace(token);if(!token.isComplete()){this.chewWhitespace(token);var remainingString=token.remainingString();if(remainingString!==null&&(grammar.REGEXP_NOTS.test(remainingString)||this.startsWithIgnoreCase("!",remainingString))){token.getResult().needsField=false;if(this.startsWithIgnoreCase("!",remainingString)){token.getResult().setLastLogicalOperator("!",token.getTokenStringIdx());token.consumeCharacters(1)}else{token.getResult().setLastLogicalOperator("NOT",token.getTokenStringIdx());token.consumeCharacters(4)}token.getResult().resetTerminalClause();if(token.isComplete()){token.setParseError()}token.getResult().setNeedsField()}else{this.terminalClause(token)}}else{this.terminalClause(token);token.setParseError()}},predicateClause:function(token){this.chewWhitespace(token);if(!token.isComplete()){var remainingString=token.remainingString();var tokens=remainingString.split(/[\s(]+/);if(remainingString!==null){token.getResult().setMustBeOperatorOrPredicate(false);if(this.startsWithLogicalOperator(remainingString)){if(tokens.length==1){token.getResult().setLastWasPredicate(tokens[0],token);token.setParseError();return }return }token.getResult().resetNeedsPredicateOperand();token.consumeCharacters(tokens[0].length);token.getResult().setLastWasPredicate(tokens[0],token);if(tokens.length==1){token.setParseError();return }if(this.wasPredicateComplete(tokens[0])){token.getResult().setNeedsPredicateOperand();token.getResult().setLastOperand(null,token);this.predicateOperand(token)}else{token.setParseError()}}}else{token.setParseError()}},predicateOperand:function(token){this.chewWhitespace(token);var predicateOperand=this.collectPredicateOperands(token);if(predicateOperand==null||predicateOperand==""){token.getResult().setLastOperandStartIndex(token.getTokenStringIdx());token.setParseError()}if(token.remainingString()!=null){token.getResult().resetNeedsPredicateOperand();token.getResult().resetLastPredicates();token.getResult().setMustBeOperatorOrPredicate(true);token.getResult().setNeedsLogicalOperator(token);this.chewWhitespace(token)}},collectPredicateOperands:function(token){if(token.getResult().getLastWasPredicate()==="DURING"){token.getResult().setNeedsOpenParen(true)}var predicateOperand=this.listOperand(token,true);if(predicateOperand.length===0){predicateOperand=this.functionOperand(token);if(predicateOperand.length===0){predicateOperand=this.singleValueOperand(token)}else{token.getResult().setNeedsOpenParen(false)}}else{token.getResult().setNeedsOpenParen(false)}return token.getResult().getUnquotedString(predicateOperand)},terminalClause:function(token){token.getResult().resetTerminalClause();this.chewWhitespace(token);var remainingString=token.remainingString();if(this.startsWithIgnoreCase("(",remainingString)){token.getResult().addToken("(");token.setInParens();token.consumeCharacter();this.orClause(token);this.chewWhitespace(token);remainingString=token.remainingString();if(this.startsWithIgnoreCase(")",remainingString)){token.getResult().addToken(")");token.consumeCharacter();token.setOutOfParens();if(token.isComplete()){token.getResult().resetLogicalOperators();token.getResult().resetLastPredicates()}}else{token.setParseError()}}else{this.field(token);if(!token.isComplete()){this.oper(token);if(!token.isComplete()){if(token.getResult().getLastWasOperator()==="changed"){token.getResult().setNeedsLogicalOperator(token);return }this.operand(token);if(token.getResult().getOperandComplete()){var lastWasOperator=token.getResult().getLastWasOperator();token.getResult().setNeedsNothing();if(lastWasOperator){token.getResult().setLastWasOperator(lastWasOperator)}}else{if(token.isComplete()&&!token.getResult().getNeedsListComma()){token.getResult().setNeedsOperand()}}}else{if(token.getResult().getLastOperator()=="was"||token.getResult().getLastOperator()=="was not"){token.getResult().setNeedsOperandOrOperator()}else{if(token.getResult().getLastWasOperator()==="changed"){var currentChar=token.currentCharacter();if(currentChar!==null&&grammar.REGEXP_SPACE_OR_ELSE.test(currentChar)){token.getResult().setNeedsLogicalOperator(token)}else{token.getResult().resetLogicalOperators();token.getResult().setNeedsOrderBy(false)}return }else{token.getResult().setNeedsOperator()}}token.setParseError()}}else{token.getResult().setNeedsField();token.setParseError()}}},field:function(token){var fieldName=this.fieldName(token);if(fieldName.length!==0){token.getResult().setLastFieldName(fieldName,token)}else{if(token.getResult().getLastFieldName()===null){var remainingString=token.remainingString();token.getResult().setNeedsField();token.getResult().setLastFieldName(remainingString,token);token.setParseError()}}},fieldName:function(token){this.chewWhitespace(token);var remainingString=token.remainingString();if(this.startsWithIgnoreCase("cf",remainingString)){var origIdx=token.getTokenStringIdx();var origString=token.remainingString();token.consumeCharacters(2);this.chewWhitespace(token);remainingString=token.remainingString();if(this.startsWithIgnoreCase("[",remainingString)){token.consumeCharacter();remainingString=token.remainingString();var custFieldId=this.numberValue(token);if(custFieldId.length!==0){this.chewWhitespace(token);remainingString=token.remainingString();if(this.startsWithIgnoreCase("]",remainingString)){token.consumeCharacter();return origString.substring(0,token.getTokenStringIdx()-origIdx)}}}token.setParseError();return origString}else{if(this.startsWithIgnoreCase("issue.property",remainingString)){return this.entityPropertyName("issue.property",token)}else{return this.fieldOrFunctionName(token)}}},entityPropertyName:function(propertyPrefix,token){token.consumeCharacters(propertyPrefix.length);this.chewWhitespace(token);var remainingString=token.remainingString();if(this.startsWithIgnoreCase("[",remainingString)){token.consumeCharacter();var propertyKeys=[this.stringValue(token)];while(!token.parseError&&this.startsWithIgnoreCase(".",token.remainingString())){token.consumeCharacter();propertyKeys[propertyKeys.length]=this.stringValue(token)}if(propertyKeys.length!==0&&propertyKeys[0].length!==0&&!this.startsWithIgnoreCase(".",propertyKeys[0])){this.chewWhitespace(token);remainingString=token.remainingString();if(this.startsWithIgnoreCase("]",remainingString)){token.consumeCharacter();var propertyPaths=[this.stringValue(token)];while(!token.parseError&&this.startsWithIgnoreCase(".",token.remainingString())){token.consumeCharacter();propertyPaths[propertyPaths.length]=this.stringValue(token)}return propertyPrefix+"["+propertyKeys.join(".")+"]"+propertyPaths.join(".")}}}token.setParseError();return""},oper:function(token){this.chewWhitespace(token);var remainingString=token.remainingString();var operator=this.getLongestOperatorMatch(remainingString,grammar.jql_operators);if(operator!==null){token.getResult().setLastOperator(operator,token.getTokenStringIdx());if(OperatorUtil.isWasOperator(operator)||OperatorUtil.isChangedOperator(operator)){token.getResult().setLastWasOperator(operator)}token.consumeCharacters(operator.length);if(operator=="in"||operator=="is"||operator=="is not"||operator=="not in"||operator=="was"||operator=="was not"||operator=="was in"||operator=="was not in"){var currentChar=token.currentCharacter();if(currentChar!==null&&!grammar.REGEXP_SPACE_OR_ELSE.test(currentChar)){token.setParseError()}}if(operator=="was"){token.getResult().setNeedsOperandOrOperator();this.chewWhitespace(token);remainingString=token.remainingString();if(remainingString!=null&&(grammar.REGEXP_NOTSTART.test(remainingString)||grammar.REGEXP_INSTART.test(remainingString))){token.setParseError()}}else{if(operator=="was not"){token.getResult().setNeedsOperandOrOperator();this.chewWhitespace(token);remainingString=token.remainingString();if(remainingString!=null&&(grammar.REGEXP_INSTART.test(remainingString))){token.setParseError()}}else{if(operator=="changed"){token.getResult().setNeedsLogicalOperator(token)}else{token.getResult().setNeedsOperand()}}}}else{if(token.getResult().getLastOperator()===null){var errorIdx=(remainingString===null)?token.getMaxTokenStringIdx():token.getMaxTokenStringIdx()-remainingString.length;token.getResult().setLastOperator(remainingString,errorIdx);token.getResult().setNeedsOperator();token.setParseError()}}},operand:function(token){this.chewWhitespace(token);if(token.getResult().getLastOperator()==="in"||token.getResult().getLastOperator()==="not in"||token.getResult().getLastOperator()==="was not in"||token.getResult().getLastOperator()==="was in"){token.getResult().setNeedsOpenParen(true)}var operand=this.listOperand(token,true);if(operand.length===0){operand=this.functionOperand(token);if(operand.length===0){operand=this.singleValueOperand(token)}else{token.getResult().setNeedsOpenParen(false)}}else{token.getResult().setNeedsOpenParen(false)}if(operand===null||operand.length===0){var remainingString=token.remainingString();token.getResult().setLastOperand(remainingString,token);token.getResult().setNeedsOperand();token.setParseError()}if(operand.length!==0){return operand}return""},singleValueOperand:function(token){var operand=this.stringValue(token);if(operand.length!==0){token.getResult().setLastOperand(operand,token);if(operand.toLowerCase()!="empty"&&operand.toLowerCase()!="null"&&this.isReservedWord(operand.toLowerCase())){token.setParseError()}return operand}return""},functionOperand:function(token){var startIdx=token.getTokenStringIdx();var functionName=this.fieldOrFunctionName(token);this.chewWhitespace(token);var listArguments=this.listOperand(token,false);if(functionName.length!==0&&listArguments.length!==0){var operand=functionName+listArguments;token.getResult().setLastOperand(operand,token);return operand}else{token.backTrackToIdx(startIdx);return""}},listOperand:function(token,treatAsOperands){if(token.currentCharacter()=="("){token.consumeCharacter();var listValue=this.collectListValues(token,treatAsOperands);var operandVal="("+listValue;this.chewWhitespace(token);if(token.currentCharacter()==")"){token.consumeCharacter();operandVal+=")";if(operandVal=="()"&&treatAsOperands){token.getResult().setLastOperand(operandVal,token)}if(treatAsOperands){token.getResult().setOperandComplete();token.getResult().resetNeedsPredicateOperand()}}else{token.setParseError()}return operandVal}else{return""}},collectListValues:function(token,treatAsOperands){if(treatAsOperands){token.getResult().setNeedsOperand()}this.chewWhitespace(token);var currentOperand=(treatAsOperands)?this.operand(token):this.stringValue(token);if(currentOperand.length!==0){if(this.chewWhitespace(token)&&treatAsOperands){token.getResult().setNeedsListComma()}if(token.currentCharacter()==","){token.consumeCharacter();var nextValue=this.collectListValues(token,treatAsOperands);if(nextValue.length===0){token.setParseError()}return currentOperand+", "+nextValue}else{return currentOperand}}else{return""}},startsWithIgnoreCase:function(startStr,str){if(str===null||startStr===null||str.length<startStr.length){return false}else{return startStr.toLowerCase()==str.substr(0,startStr.length).toLowerCase()}},startsWithLogicalOperator:function(str){if(str===null){return false}else{return this.startsWithOr(str)||this.startsWithAnd(str)||this.startsWithNot(str)||this.startsWithBraces(str)}},startsWithOr:function(str){return this.startsWithIgnoreCase("|",str)||this.startsWithIgnoreCase("||",str)||this.startsWithIgnoreCase("or",str)},startsWithAnd:function(str){return this.startsWithIgnoreCase("&",str)||this.startsWithIgnoreCase("&&",str)||this.startsWithIgnoreCase("and",str)},startsWithNot:function(str){return this.startsWithIgnoreCase("!",str)||this.startsWithIgnoreCase("not",str)},startsWithBraces:function(str){return this.startsWithIgnoreCase("(",str)||this.startsWithIgnoreCase(")",str)},chewWhitespace:function(token){var foundWhiteSpace=false;var currentChar=token.currentCharacter();while(currentChar!==null&&grammar.REGEXP_WHITESPACE.test(currentChar)){token.consumeCharacter();currentChar=token.currentCharacter();foundWhiteSpace=true}return foundWhiteSpace},getLongestOperatorMatch:function(value,listOfValues){var longestMatch=null;var matchArray;if(this.startsWithIgnoreCase("is",value)){matchArray=value.substring(2).match(grammar.REGEXP_SNOT);if(matchArray){longestMatch=value.substring(0,matchArray[0].length+2)}else{longestMatch="is"}}if(this.startsWithIgnoreCase("was",value)){matchArray=value.substring(3).match(grammar.REGEXP_SNOT_IN);if(matchArray){longestMatch=value.substring(0,matchArray[0].length+3)}else{longestMatch="was"}}else{if(this.startsWithIgnoreCase("not",value)){var matchArrayNot=value.substring(3).match(grammar.REGEXP_SIN);if(matchArrayNot){longestMatch=value.substring(0,matchArrayNot[0].length+3)}}else{for(var i=0;i<listOfValues.length;i++){if(this.startsWithIgnoreCase(listOfValues[i].value,value)){if(longestMatch===null||grammar.jql_operators[i].value.length>longestMatch){longestMatch=grammar.jql_operators[i].value}}}}}return longestMatch},getValueMinusExtraWhitespace:function(value){if(value===null){return null}var newValue="";var firstWhitespace=true;var valueArr=value.split("");for(var i=0;i<valueArr.length;i++){var currentChar=valueArr[i];if(grammar.REGEXP_WHITESPACE.test(currentChar)){if(firstWhitespace){firstWhitespace=false;newValue=newValue+currentChar}}else{firstWhitespace=true;newValue=newValue+currentChar}}return newValue},fieldOrFunctionName:function(token){var stringValue=this.stringValue(token);if(stringValue==='""'||stringValue==="''"){token.setParseError()}if(this.isReservedWord(stringValue.toLowerCase())){token.setParseError()}return stringValue},isReservedWord:function(word){return jQuery.inArray(word,jql_reserved_words)!==-1},stringValue:function(token){var stringValue="";var inQuote=false;var inSingleQuote=false;var currentChar=token.currentCharacter();while(currentChar!==null&&(inQuote||inSingleQuote||grammar.REGEXP_TOKEN_CHAR.test(currentChar))){stringValue=stringValue+currentChar;token.consumeCharacter();if(currentChar=="\\"){currentChar=token.currentCharacter();if(currentChar===null){token.setParseError();break}else{if(grammar.REGEXP_CHARS_TO_ESCAPE.test(currentChar)){var remainingString=token.remainingString();if(!grammar.REGEXP_UNICODE.test(remainingString)){token.setParseError();break}}}stringValue=stringValue+currentChar;token.consumeCharacter()}else{if(grammar.REGEXP_SPECIAL_CHAR.test(currentChar)&&!(inQuote||inSingleQuote)){token.setParseError();break}else{if(currentChar=='"'&&!inSingleQuote){inQuote=!inQuote}else{if(currentChar=="'"&&!inQuote){inSingleQuote=!inSingleQuote}}}}currentChar=token.currentCharacter()}if(token.isComplete()&&(inQuote||inSingleQuote)){token.setParseError()}return stringValue},numberValue:function(token){var numberVal="";this.chewWhitespace(token);var currentChar=token.currentCharacter();while(currentChar!==null){if(grammar.REGEXP_NUMBER.test(currentChar)){numberVal=numberVal+currentChar;token.consumeCharacter()}else{break}currentChar=token.currentCharacter()}return numberVal},wasPredicateComplete:function(predicate){var foundPredicate=false;var arLen=grammar.jql_changed_predicates.length;for(var i=0;i<arLen;++i){if(predicate.toLowerCase()==grammar.jql_changed_predicates[i].value.toLowerCase()){foundPredicate=true;break}}return foundPredicate}}}});define("jira/jql/jql-parse-result",function(){return function(){var tokens=[];var tokenIdx=0;return{getTokens:function(){return tokens},addToken:function(token){tokens[tokenIdx++]=token},setLastFieldName:function(lastFieldName,token){this.fieldNameStartIndex=(lastFieldName===null)?token.getMaxTokenStringIdx():(token.getTokenStringIdx()-lastFieldName.length);this.lastFieldName=this.getUnquotedString(lastFieldName);tokens[tokenIdx++]=lastFieldName},getLastFieldName:function(){return this.lastFieldName},getLastFieldNameStartIndex:function(){return this.fieldNameStartIndex},setLastOrderByFieldName:function(lastFieldName,token){this.orderByFieldNameStartIndex=(lastFieldName===null)?token.getMaxTokenStringIdx():(token.getTokenStringIdx()-lastFieldName.length);this.lastOrderByFieldName=this.getUnquotedString(lastFieldName);this.lastOrderByDirection=null;tokens[tokenIdx++]=lastFieldName},getLastOrderByFieldName:function(){return this.lastOrderByFieldName},getLastOrderByFieldNameStartIndex:function(){return this.orderByFieldNameStartIndex},setLastOrderByDirection:function(lastDirection,token){this.orderByDirectionStartIndex=(lastDirection===null)?token.getMaxTokenStringIdx():(token.getTokenStringIdx()-lastDirection.length);this.lastOrderByDirection=lastDirection;tokens[tokenIdx++]=lastDirection},getLastOrderByDirection:function(){return this.lastOrderByDirection},getLastOrderByDirectionStartIndex:function(){return this.orderByDirectionStartIndex},setNeedsField:function(){this.needsOperator=false;this.needsOperand=false;this.needsLogicalOperator=false;this.needsOrderBy=false;this.needsField=true;this.needsOrderByField=false;this.needsOrderByDirection=false;this.needsListComma=false;this.needsWasPredicate=false;this.lastWasOperator=null},getNeedsField:function(){return this.needsField},setNeedsOrderByField:function(){this.needsOperator=false;this.needsOperand=false;this.needsLogicalOperator=false;this.needsOrderBy=false;this.needsField=false;this.needsOrderByField=true;this.needsOrderByDirection=false;this.lastOrderByDirection=null;this.needsListComma=false},getNeedsOrderByField:function(){return this.needsOrderByField},setNeedsOrderByDirection:function(){this.needsOperator=false;this.needsOperand=false;this.needsLogicalOperator=false;this.needsOrderBy=false;this.needsField=false;this.needsOrderByField=false;this.needsOrderByDirection=true;this.needsListComma=false},getNeedsOrderByDirection:function(){return this.needsOrderByDirection},setNeedsOrderByComma:function(){this.needsOperator=false;this.needsOperand=false;this.needsLogicalOperator=false;this.needsOrderBy=false;this.needsField=false;this.needsOrderByField=false;this.needsOrderByDirection=false;this.needsListComma=false},setNeedsListComma:function(){this.needsOperator=false;this.needsOperand=false;this.needsLogicalOperator=false;this.needsOrderBy=false;this.needsField=false;this.needsOrderByField=false;this.needsOrderByDirection=false;this.needsListComma=true},getNeedsListComma:function(){return this.needsListComma},setLastOperator:function(lastOperator,startIndex){this.lastOperator=lastOperator;this.operatorStartIndex=startIndex;tokens[tokenIdx++]=lastOperator},setLastWasOperator:function(lastWasOperator){this.lastWasOperator=lastWasOperator},getLastWasOperator:function(){return this.lastWasOperator},getLastOperator:function(){return this.lastOperator},getLastOperatorStartIndex:function(){return this.operatorStartIndex},setLastOperand:function(lastOperand,token){this.operandStartIndex=(lastOperand===null)?token.getMaxTokenStringIdx():(token.getTokenStringIdx()-lastOperand.length);this.lastOperand=this.getUnquotedString(lastOperand);tokens[tokenIdx++]=lastOperand},getLastOperand:function(){return this.lastOperand},setNeedsOperand:function(){this.needsField=false;this.needsOperator=false;this.needsLogicalOperator=false;this.needsOperand=true;this.needsOrderBy=false;this.needsOrderByField=false;this.needsOrderByDirection=false;this.needsListComma=false},setNeedsOperandOrOperator:function(){this.needsField=false;this.needsOperator=true;this.needsLogicalOperator=false;this.needsOperand=true;this.needsOrderBy=false;this.needsOrderByField=false;this.needsOrderByDirection=false;this.needsListComma=false},getNeedsOperand:function(){return this.needsOperand},setNeedsPredicateOperand:function(){this.needsPredicateOperand=true},resetNeedsPredicateOperand:function(){this.needsPredicateOperand=false;this.needsOperand=false},getNeedsPredicateOperand:function(){return this.needsPredicateOperand},getLastOperandStartIndex:function(){return this.operandStartIndex},setLastOperandStartIndex:function(index){this.operandStartIndex=index},setLastLogicalOperator:function(lastLogicalOperator,startIndex){this.lastLogicalOperator=lastLogicalOperator;this.logicalOperatorStartIndex=startIndex;tokens[tokenIdx++]=lastLogicalOperator},setNeedsOperator:function(){this.needsField=false;this.needsOperand=false;this.needsLogicalOperator=false;this.needsOrderBy=false;this.needsOperator=true;this.needsOrderByField=false;this.needsOrderByDirection=false;this.needsListComma=false},getNeedsOperatorOrOperand:function(){return this.needsOperator&&this.needsOperand},getNeedsOperator:function(){return this.needsOperator},getLastLogicalOperator:function(){return this.lastLogicalOperator},getLastLogicalOperatorStartIndex:function(){return this.logicalOperatorStartIndex},setNeedsLogicalOperator:function(token){this.needsLogicalOperator=true;this.needsOperator=false;this.needsOperand=false;this.needsField=false;this.needsOrderByField=false;this.needsOrderByDirection=false;this.needsListComma=false;this.needsOrderBy=!token.getInParens();if(this.lastWasOperator!=null){this.needsWasPredicate=true}},setNeedsOpenParen:function(value){this.needsOpenParen=value},getNeedsOpenParen:function(){return this.needsOpenParen},getNeedsLogicalOperator:function(){return this.needsLogicalOperator},setNeedsOrderBy:function(value){this.needsOrderBy=value},getNeedsOrderBy:function(){return this.needsOrderBy},getNeedsWasPredicate:function(){return this.needsWasPredicate},setLastWasPredicate:function(lastWasPredicate,token){this.wasPredicateStartIndex=(lastWasPredicate===null)?token.getMaxTokenStringIdx():(token.getTokenStringIdx()-lastWasPredicate.length);this.lastWasPredicate=lastWasPredicate;tokens[tokenIdx++]=lastWasPredicate},getLastWasPredicate:function(){return this.lastWasPredicate},resetLastPredicates:function(){this.lastLogicalOperator=null;this.lastWasPredicate=null;this.lastOperand=null;this.wasPredicateStartIndex=null;this.operandStartIndex=null},getLastWasPredicateStartIndex:function(){return this.wasPredicateStartIndex},setLastOrderBy:function(lastOrderBy,token){this.orderByStartIndex=(lastOrderBy===null)?token.getMaxTokenStringIdx():(token.getTokenStringIdx()-lastOrderBy.length);this.lastOrderBy=lastOrderBy;tokens[tokenIdx++]=lastOrderBy},getLastOrderBy:function(){return this.lastOrderBy},getLastOrderByStartIndex:function(){return this.orderByStartIndex},resetLogicalOperators:function(){this.lastLogicalOperator=null;this.logicalOperatorStartIndex=null;this.needsLogicalOperator=null},getUnquotedString:function(value){var secondToLastNotEsacape=value!=null&&value.length>=3&&value.charAt(value.length-2)!="\\";if(value!=null&&value.charAt(0)=='"'){value=value.substring(1,value.length);if(value.charAt(value.length-1)=='"'&&secondToLastNotEsacape){value=value.substring(0,value.length-1)}}else{if(value!=null&&value.charAt(0)=="'"){value=value.substring(1,value.length);if(value.charAt(value.length-1)=="'"&&secondToLastNotEsacape){value=value.substring(0,value.length-1)}}}return value},setParseError:function(message){this.parseError=true;this.parseErrorMsg=message},getParseError:function(){return this.parseError},getParseErrorMsg:function(){return this.parseErrorMsg},setNeedsNothing:function(){this.needsOperator=false;this.needsOperand=false;this.needsLogicalOperator=false;this.needsOrderBy=false;this.needsField=false;this.needsOrderByField=false;this.needsOrderByDirection=false;this.needsOpenParen=false;this.needsListComma=false;this.needsWasPredicate=null;this.needsPredicateOperand=null;this.mustBeOperatorOrPredicate=null;this.lastWasOperator=null},setOperandComplete:function(){this.operandComplete=true},getOperandComplete:function(){return this.operandComplete},setMustBeOperatorOrPredicate:function(state){this.mustBeOperatorOrPredicate=state},getMustBeOperatorOrPredicate:function(){return this.mustBeOperatorOrPredicate},resetTerminalClause:function(){this.lastFieldName=null;this.fieldNameStartIndex=null;this.needsField=null;this.lastOperator=null;this.operatorStartIndex=null;this.needsOperator=null;this.lastOperand=null;this.operandStartIndex=null;this.needsOperand=null;this.operandComplete=null;this.needsOpenParen=null;this.needsListComma=false;this.mustBeOperatorOrPredicate=null},init:function(){this.lastFieldName=null;this.fieldNameStartIndex=null;this.needsField=null;this.lastOperator=null;this.operatorStartIndex=null;this.needsOperator=null;this.lastOperand=null;this.operandStartIndex=null;this.needsOperand=null;this.lastLogicalOperator=null;this.logicalOperatorStartIndex=null;this.lastOrderByFieldName=null;this.lastOrderByFieldNameStartIndex=null;this.lastOrderByDirection=null;this.lastOrderByDirectionStartIndex=null;this.orderByStartIndex=null;this.lastOrderBy=null;this.needsOrderBy=null;this.needsOrderByField=null;this.needsOrderByDirection=null;this.operandComplete=null;this.needsOpenParen=null;this.needsListComma=null;this.wasPredicateStartIndex=null;this.lastWasPredicate=null;this.needsWasPredicate=null;this.needsPredicateOperand=null;this.mustBeOperatorOrPredicate=null;this.lastWasOperator=null}}}});define("jira/jql/jql-parse-token",["jira/jql/jql-parse-result"],function(ParseResult){return function(){return{init:function(tokenString){this.tokenStringIdx=0;this.tokenString=tokenString;this.parseError=false;this.parseErrorMsg=null;this.result=ParseResult();this.result.init();this.inParens=0},consumeCharacter:function(){this.tokenStringIdx++},consumeCharacters:function(numChars){this.tokenStringIdx=this.tokenStringIdx+numChars},backTrackToIdx:function(backTrackIdx){this.tokenStringIdx=backTrackIdx;this.parseError=false;this.parseErrorMsg=null;this.result.parseError=false;this.result.parseErrorMsg=null},getTokenStringIdx:function(){return this.tokenStringIdx},currentCharacter:function(){if(this.tokenStringIdx>=this.tokenString.length){return null}return this.tokenString.charAt(this.tokenStringIdx)},remainingString:function(){if(this.tokenStringIdx>=this.tokenString.length){return null}return this.tokenString.substr(this.tokenStringIdx,this.tokenString.length)},getMaxTokenStringIdx:function(){return this.tokenString.length},isComplete:function(){if(this.parseError){return true}return this.tokenStringIdx>=this.tokenString.length},setInParens:function(){this.inParens++},setOutOfParens:function(){if(this.inParens!==0){this.inParens--}},getInParens:function(){return this.inParens!==0},setParseError:function(){this.parseError=true;var preFixIdx=((this.tokenStringIdx-9)<0)?0:this.tokenStringIdx-9;var errorPrefix=this.tokenString.substring(preFixIdx,this.tokenStringIdx-1);this.result.setParseError("..."+errorPrefix+"^"+this.tokenString.substring(this.tokenStringIdx,this.tokenString.length))},getParseError:function(){return this.parseError},calcLastOperandStartIndex:function(){var result=this.getResult();var operator=result.getLastOperator();if(operator.length>0){var numSpaces=operator.length-(operator.replace(/\s+/g,"")).length;result.setLastOperandStartIndex(result.getLastOperatorStartIndex()+operator.length+numSpaces+1)}},getParsedOperator:function(){var result=this.getResult();return(result.getLastOperator().length>0)?this.tokenString.substr(result.getLastOperatorStartIndex()):null},getResult:function(){return this.result}}}});AJS.namespace("jira.widget.autocomplete.JQL",null,require("jira/autocomplete/jql-autocomplete"));AJS.namespace("JIRA.JQLAutoComplete",null,require("jira/autocomplete/jql-autocomplete"));AJS.namespace("JIRA.JQLAutoComplete.MyParser",null,require("jira/jql/jql-parser"));AJS.namespace("JIRA.JQLAutoComplete.ParseResult",null,require("jira/jql/jql-parse-result"));AJS.namespace("JIRA.JQLAutoComplete.Token",null,require("jira/jql/jql-parse-token"));
/* module-key = 'jira.webresources:jqlautocomplete', location = '/includes/jira/autocomplete/initJQLAutoComplete.js' */
(function(){var JQLAutoComplete=require("jira/autocomplete/jql-autocomplete");var JQLParser=require("jira/jql/jql-parser");var Forms=require("jira/util/forms");var jQuery=require("jquery");jQuery(function(){jQuery(".jql-autocomplete-params").each(function(){var params={};jQuery(this).find("input").each(function(){var $this=jQuery(this);params[$this.attr("id")]=$this.val()});var jqlFieldNames=JSON.parse(jQuery("#jqlFieldz").text());var jqlFunctionNames=JSON.parse(jQuery("#jqlFunctionNamez").text());var jqlReservedWords=JSON.parse(jQuery("#jqlReservedWordz").text());var jqlAutoComplete=JQLAutoComplete({fieldID:"jqltext",parser:JQLParser(jqlReservedWords),queryDelay:0.65,jqlFieldNames:jqlFieldNames,jqlFunctionNames:jqlFunctionNames,minQueryLength:0,allowArrowCarousel:true,autoSelectFirst:false,errorID:"jqlerrormsg"});var jQueryRef=jQuery("#jqltext");jQueryRef.unbind("keypress",Forms.submitOnEnter).keypress(function(e){if(jqlAutoComplete.dropdownController===null||!jqlAutoComplete.dropdownController.displayed||jqlAutoComplete.selectedIndex<0){if(e.keyCode===13&&!e.ctrlKey&&!e.shiftKey){jQuery("#jqlform").submit();return false}else{return true}}});jqlAutoComplete.buildResponseContainer();jqlAutoComplete.parse(jQueryRef.text());jqlAutoComplete.updateColumnLineCount();jQueryRef.click(function(){jqlAutoComplete.dropdownController.hideDropdown()})})})})();
/* module-key = 'com.atlassian.jira.jira-issue-link-remote-jira-plugin:issue-link-jira-search-js', location = 'js/issuelink-jira-jqlautocomplete.js' */
var IssueLinkJQLAutoComplete=IssueLinkJQLAutoComplete||(function($){function initialize(options){var fieldID=options.fieldID;var errorID=options.errorID;var autoCompleteUrl=options.autoCompleteUrl;var autoCompleteData=options.autoCompleteData;var formSubmitFunction=options.formSubmitFunction;var $field=$("#"+fieldID);var hasFocus=$field.length>0&&$field[0]==document.activeElement;var jqlFieldNames=autoCompleteData.visibleFieldNames||[];var jqlFunctionNames=autoCompleteData.visibleFunctionNames||[];var jqlReservedWords=autoCompleteData.jqlReservedWords||[];var jqlAutoComplete=JIRA.JQLAutoComplete({fieldID:fieldID,parser:JIRA.JQLAutoComplete.MyParser(jqlReservedWords),queryDelay:0.65,jqlFieldNames:jqlFieldNames,jqlFunctionNames:jqlFunctionNames,minQueryLength:0,allowArrowCarousel:true,autoSelectFirst:false,errorID:errorID,autoCompleteUrl:autoCompleteUrl});$field.unbind("keypress",submitOnEnter);if(formSubmitFunction){$field.keypress(function(e){if(jqlAutoComplete.dropdownController===null||!jqlAutoComplete.dropdownController.displayed||jqlAutoComplete.selectedIndex<0){if(e.keyCode==13&&!e.ctrlKey&&!e.shiftKey){formSubmitFunction();return false}else{return true}}})}jqlAutoComplete.buildResponseContainer();jqlAutoComplete.parse($field.text());jqlAutoComplete.updateColumnLineCount();$field.click(function(){jqlAutoComplete.dropdownController.hideDropdown()});if(hasFocus){$field.select()}}return{initialize:initialize}})(AJS.$);
/* module-key = 'com.atlassian.jira.jira-issue-link-remote-jira-plugin:issue-link-jira-search-js', location = 'js/issuelink-jira-search.js' */
AJS.$(function($){var remoteJiraSearchDialog=new JIRA.FormDialog({id:"remote-jira-search-dialog",trigger:"#link-jira-issue .remote-jira-search-trigger",widthClass:"large",content:function(render){render(JIRA.Templates.RemoteJiraIssueSearch.dialog());initSearchDialog(this.$popup)},submitHandler:function(e,callback){e.preventDefault();$("#simple-search-panel-button").removeAttr("disabled");$("#advanced-search-panel-button").removeAttr("disabled");if($(e.target).attr("id")=="remote-jira-simple-search-form"){$("#simple-search-panel-button").click()}else{$("#advanced-search-panel-button").click()}callback()}});function initSearchDialog($dialog){var appId=$("#jira-app-link").val();var autoCompletePromise=getJqlAutoCompleteData(appId);$("#simple-search-panel-button",$dialog).click(function(){$("#search-results-table",$dialog).empty();var searchText=$("#link-search-text",$dialog).val();searchText=$.trim(searchText);if(searchText){doSimpleSearch(searchText,$dialog)}else{AJS.messages.info("#search-results-table",{body:"Please enter search value.",closeable:false})}return false});$("#advanced-search-panel-button",$dialog).click(function(){advancedSearchButtonClick($dialog);return false});$("#simple-search-toggle",$dialog).click(function(){$("#remote-jira-simple-search-form",$dialog).show();$("#remote-jira-advanced-search-form",$dialog).hide();return false});$("#linkjiraissue-add-selected",$dialog).click(function(){$("table tbody tr:visible  td.selection input:checked",$dialog).each(function(){var issueKey=$(this).parent().data("key");$("#jira-issue-keys").trigger("selectOption",[{value:issueKey}])});$("#link-issue-dialog .error").hide();remoteJiraSearchDialog.hide();$("#link-issue-dialog").show().trigger("multiSelectRevealed");$("#jira-issue-keys-textarea").focus().select()});$("#advanced-search-toggle",$dialog).click(function(){$("#remote-jira-advanced-search-form",$dialog).show();$("#remote-jira-simple-search-form",$dialog).hide();var $jqlSearchText=$("#jql-search-text");if(!$jqlSearchText.attr("jql-initialized")){setAutoCompleteLoadingIconVisible(true,$dialog);autoCompletePromise.done(function(smartAjaxResult){if(smartAjaxResult.successful){IssueLinkJQLAutoComplete.initialize({fieldID:"jql-search-text",errorID:"jql-search-error",autoCompleteUrl:getAutoCompleteUrl(appId),autoCompleteData:smartAjaxResult.data,formSubmitFunction:function(){advancedSearchButtonClick($dialog)}})}else{setJQLErrorVisible(false,$dialog);setAutoCompleteFailedIconVisible(true,$dialog)}setAutoCompleteLoadingIconVisible(false,$dialog);$jqlSearchText.attr("jql-initialized",1)})}$jqlSearchText.focus();return false});$("#simple-search-toggle",$dialog).trigger("click")}function getAutoCompleteUrl(appId){if(appId&&appId!==""){return contextPath+"/rest/remoteJiraIssueLink/1/remoteJira/autocomplete?appId="+appId}return""}function advancedSearchButtonClick($dialog){$("#search-results-table",$dialog).empty();var searchText=$("#jql-search-text",$dialog).val();searchText=$.trim(searchText);if(searchText){doAdvancedSearch(searchText,$dialog)}else{AJS.messages.info("#search-results-table",{body:"Please enter search value.",closeable:false})}}function setLoadingIconVisible(visible,$context){$("#link-search-loading",$context).toggleClass("hidden",!visible)}function setAutoCompleteLoadingIconVisible(visible,$context){$("#autocomplete-loading",$context).toggleClass("hidden",!visible)}function setAutoCompleteFailedIconVisible(visible,$context){$("#autocomplete-failed",$context).toggleClass("hidden",!visible)}function setJQLErrorVisible(visible,$context){$("#jql-search-error",$context).toggleClass("hidden",!visible)}function doSimpleSearch(searchText,$context){setLoadingIconVisible(true,$context);var appId=$("#jira-app-link").val();var issueKeyJql='key = "'+searchText+'"';var projectJql='project = "'+searchText+'"';var plainTextJql='summary ~ "'+searchText+'" OR description ~ "'+searchText+'" OR comment ~ "'+searchText+'"';jqlSearch(issueKeyJql,appId).done(function(smartAjaxResult){if(smartAjaxResult.successful&&smartAjaxResult.data.issues.length>0){setLoadingIconVisible(false,$context);showResults(smartAjaxResult,$context)}else{jqlSearch(projectJql,appId).done(function(smartAjaxResult){if(smartAjaxResult.successful&&smartAjaxResult.data.issues.length>0){setLoadingIconVisible(false,$context);showResults(smartAjaxResult,$context)}else{jqlSearch(plainTextJql,appId).done(function(smartAjaxResult){setLoadingIconVisible(false,$context);if(smartAjaxResult.successful){showResults(smartAjaxResult,$context)}else{showResultsError(smartAjaxResult)}})}})}})}function doAdvancedSearch(jql,$context){setLoadingIconVisible(true,$context);var appId=$("#jira-app-link").val();jqlSearch(jql,appId).done(function(smartAjaxResult){setLoadingIconVisible(false,$context);if(smartAjaxResult.successful){showResults(smartAjaxResult,$context)}else{if(smartAjaxResult.status===400){AJS.messages.warning("#search-results-table",{body:"Invalid JQL query.",closeable:false})}else{showResultsError(smartAjaxResult)}}})}function jqlSearch(jql,appId){var deferred=$.Deferred();var url;if(appId&&appId!==""){url=contextPath+"/rest/remoteJiraIssueLink/1/remoteJira/search?jql="+jql+"&appId="+appId+"&maxResults=10"}else{var currentIssueKey=$("#current-issue-key").val();jql="("+jql+") and key != "+currentIssueKey;url=contextPath+"/rest/api/2/search?jql="+jql+"&maxResults=10"}JIRA.SmartAjax.makeRequest({url:url,complete:function(xhr,textStatus,smartAjaxResult){deferred.resolve(smartAjaxResult)}});return deferred.promise()}function getJqlAutoCompleteData(appId){var deferred=$.Deferred();var remote;var url;if(appId&&appId!==""){url=contextPath+"/rest/remoteJiraIssueLink/1/remoteJira/autocompletedata?appId="+appId;remote=true}else{url=contextPath+"/rest/api/2/jql/autocompletedata";remote=false}JIRA.SmartAjax.makeRequest({url:url,complete:function(xhr,textStatus,smartAjaxResult){if(!smartAjaxResult.successful&&remote){JIRA.SmartAjax.makeRequest({url:contextPath+"/rest/remoteJiraIssueLink/1/remoteJira/autocompletedata/legacy?appId="+appId,complete:function(xhr,textStatus,smartAjaxResult){deferred.resolve(smartAjaxResult)}})}else{deferred.resolve(smartAjaxResult)}}});return deferred.promise()}function showResults(smartAjaxResult,$context){var resultHtml=JIRA.Templates.RemoteJiraIssueSearch.resultsTable({result:smartAjaxResult.data});$("#search-results-table",$context).html(resultHtml);$("#linkjiraissue-select-all",$context).click(function(){var $masterStatus=$(this).prop("checked");$("tbody tr td.selection input",$context).prop("checked",$masterStatus)});$("tbody tr",$context).click(function(e){if($(e.target).is(":checkbox")){return }var checkbox=$(this).find("td.selection input");checkbox.prop("checked",!checkbox.prop("checked"))})}function showResultsError(smartAjaxResult){AJS.messages.error("#search-results-table",{body:JIRA.SmartAjax.buildSimpleErrorContent(smartAjaxResult),closeable:false})}});
/* module-key = 'com.atlassian.jira.jira-issue-link-remote-jira-plugin:issue-link-jira-search-js', location = 'templates/dialog/linkjiraissue-search.soy' */
// This file was automatically generated from linkjiraissue-search.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.RemoteJiraIssueSearch == 'undefined') { JIRA.Templates.RemoteJiraIssueSearch = {}; }


JIRA.Templates.RemoteJiraIssueSearch.dialog = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<h2>', soy.$$escapeHtml("Find JIRA issues"), '</h2><form class="aui search-form" id="remote-jira-simple-search-form" action="#" method="post"><div class="field-group"><label for="link-search-text">', soy.$$escapeHtml("Search"), ':</label><input id="link-search-text" type="text" tabindex="0" class="text" size="50"> <input type="submit" tabindex="0" class="button" id="simple-search-panel-button" value="', soy.$$escapeHtml("Search"), '"> <a id="advanced-search-toggle" href="#" title="', soy.$$escapeHtml("Perform a JQL search"), '">', soy.$$escapeHtml("Advanced Search"), '</a><span id="link-search-loading" class="icon loading throbber hidden"/></div></form><form class="aui search-form" id="remote-jira-advanced-search-form" action="#" method="post"><div class="field-group"><label for="jql-search-text">', soy.$$escapeHtml("JQL Search"), '<span id="autocomplete-loading" class="hidden"><span class="icon loading throbber"/>', soy.$$escapeHtml("Loading auto-complete"), '</span><span id="autocomplete-failed" class="hidden">', soy.$$escapeHtml("(auto-complete unavailable)"), '</span></label><div id="jql-search-container"><span id="jql-search-error" class="icon jqlgood" /><div class="atlassian-autocomplete"><textarea id="jql-search-text" class="text full-width-field" tabindex="0" /></div><button class="aui-button aui-button-primary search-button" id="advanced-search-panel-button" type="submit"><span class="aui-icon aui-icon-small aui-iconfont-search" title="', soy.$$escapeHtml("Search"), '"></span></button></div> <a id="simple-search-toggle" href="#" title="', soy.$$escapeHtml("Perform a plain text search"), '">', soy.$$escapeHtml("Simple Search"), '</a><span id="link-search-loading" class="icon loading throbber hidden"/></div></form><div class="message-panel hidden"></div><div id="search-results-table" class="data-table"></div><div class="buttons-container form-footer"><div class="buttons"><button type="button" class="aui-button" id="linkjiraissue-add-selected">', soy.$$escapeHtml("Add"), '</button><button class="aui-button aui-button-link cancel" href="#" id="remote-jira-link-cancel" title="', soy.$$escapeHtml("Press Esc to close"), '">', soy.$$escapeHtml("Close"), '</button></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.RemoteJiraIssueSearch.resultsTable = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.result.issues.length > 0) {
    output.append('<table id="remote-jira-searchresult" class="aui"><thead><tr><th class="selection" ><input id="linkjiraissue-select-all" type="checkbox"/></th><th class="type">', soy.$$escapeHtml("Type"), '</th><th class="key">', soy.$$escapeHtml("Key"), '</th><th class="summary">', soy.$$escapeHtml("Summary"), '</th><th class="status">', soy.$$escapeHtml("Status"), '</th></tr></thead><tbody>');
    var issueList44 = opt_data.result.issues;
    var issueListLen44 = issueList44.length;
    for (var issueIndex44 = 0; issueIndex44 < issueListLen44; issueIndex44++) {
      var issueData44 = issueList44[issueIndex44];
      output.append('<tr title="', soy.$$escapeHtml(issueData44.key), '"><td class="selection" data-key="', soy.$$escapeHtml(issueData44.key), '"><input type="checkbox"/></td><td class="type">');
      JIRA.Templates.RemoteJiraIssueSearch.issueType({issueType: issueData44.fields.issuetype}, output);
      output.append('</td><td class="key" title="', soy.$$escapeHtml(issueData44.key), '">', soy.$$escapeHtml(issueData44.key), '</td><td class="summary" title="', soy.$$escapeHtml(issueData44.fields.summary), '">', soy.$$escapeHtml(issueData44.fields.summary), '</td><td class="status">');
      JIRA.Templates.RemoteJiraIssueSearch.status({status: issueData44.fields.status}, output);
      output.append('</td></tr>');
    }
    output.append('</tbody></table>');
  } else {
    output.append('<div class="aui-message info"><span class="aui-icon icon-info"></span><p>', soy.$$escapeHtml("Search returned no results."), '</p></div>');
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.RemoteJiraIssueSearch.issueType = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<img src="', soy.$$escapeHtml(opt_data.issueType.iconUrl), '" alt="', soy.$$escapeHtml(opt_data.issueType.name), '" title="', soy.$$escapeHtml(opt_data.issueType.name), ' - ', soy.$$escapeHtml(opt_data.issueType.description), '"/>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.RemoteJiraIssueSearch.status = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Template.Util.Issue.Status.issueStatusResolver({issueStatus: opt_data.status}, output);
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-invite-user-plugin:inviteuser-signup-resources', location = 'js/inviteuser-signup.js' */
(function(a){JIRA.bind(JIRA.Events.NEW_PAGE_ADDED,function(c,b){a("#consolation-login-link").click(function(){AJS.EventQueue&&AJS.EventQueue.push({name:"invitationsignupconsolationlogin",properties:{}})})})})(AJS.$);
/* module-key = 'com.atlassian.support.stp:stp-license-status-resources', location = 'js/stp-licenseStatus.js' */

/* module-key = 'jira.webresources:jira-analytics', location = '/includes/jira/analytics/analytics.js' */
AJS.toInit(function($){function getBrowseProjectTab(){return $("li.active a.browse-tab").attr("id")}_.defer(function(){if(AJS.EventQueue){$(document).delegate("#project-admin-link","click",function(){var selectedTab=getBrowseProjectTab();AJS.EventQueue.push({name:"browseproject.administerproject",properties:{selectedtab:selectedTab}})});$(document).delegate("#browse-projects-create-project","click",function(){AJS.EventQueue.push({name:"browseprojects.createproject",properties:{}})});$(document).delegate("#no-issues-create-issue","click",function(){AJS.EventQueue.push({name:"browseproject.issuesblankslate.createissue",properties:{}})});$(document).delegate("a.issue-filter-link","click",function(){var $el=$(this);var id=$el.attr("id").replace("filter_","");var type=$el.attr("data-type");AJS.EventQueue.push({name:"browse"+type+".issuefilter."+id,properties:{}})});$(document).on("click","#project_import_link_lnk",function(){AJS.EventQueue.push({name:"topnav.jim",properties:{}})});$(document).on("click",".issueaction-viewworkflow",function(){var isNew=AJS.$(this).attr("class").indexOf("new-workflow-designer")>-1;var version=isNew?"new":"old";var newEnabled=AJS.DarkFeatures.isEnabled("casper.VIEW_ISSUE");AJS.EventQueue.push({name:"issue.viewworkflow",properties:{version:version,newEnabled:newEnabled}})});$.fn.ready(function captureWindowSize(){var width,height,shouldCapture=false;shouldCapture=shouldCapture||$(document.body).hasClass("page-type-navigator");if(!shouldCapture){return }width=$(window).width();height=$(window).height();AJS.EventQueue.push({name:"browserWindowSize",properties:{width:width,height:height}})})}})});
/* module-key = 'jira.webresources:avatar-picker-trigger', location = '/includes/jira/admin/initAvatarPickerTrigger.js' */
(function(){var AvatarPickerContentRetriever=AJS.ContentRetriever.extend({init:function(avatarPicker){this.avatarPicker=avatarPicker},content:function(finished){this.avatarPicker.render(function(el){finished(jQuery("<div />").html(el))})},cache:function(){return false},isLocked:function(){},startingRequest:function(){},finishedRequest:function(){}});var InlineAvatarPicker=AJS.InlineLayer.extend({init:function(options){var instance=this;this.avatarPicker=JIRA.AvatarPicker.createProjectAvatarPicker({projectId:options.projectId,projectKey:options.projectKey,defaultAvatarId:options.defaultAvatarId,select:function(avatar,src,implicit){if(options.select){options.select.apply(this,arguments)}if(!implicit){instance.hide()}instance.offsetTarget().attr("src",src);instance.offsetTarget().trigger("AvatarSelected")}});options.contentRetriever=new AvatarPickerContentRetriever(this.avatarPicker);jQuery(this.avatarPicker.imageEditor).bind(JIRA.AvatarPicker.ImageEditor.LOADED,function(){instance.setWidth(instance.layer().attr("scrollWidth"))});this._super(options);var $triggerImg=this.offsetTarget();var $triggerContainer=jQuery("<span class='jira-avatar-picker-trigger'></span>");$triggerContainer.insertBefore($triggerImg).append($triggerImg);this._assignEvents("offsetTarget",$triggerContainer)},_events:{offsetTarget:{click:function(e){this.show()}}}});function initProjectAvatarPicker(ctx){var trigger=jQuery(".jira-avatar-picker-trigger");var triggerImg=jQuery(".jira-avatar-picker-trigger img, img.jira-avatar-picker-trigger",ctx);var avatarIdField=jQuery(ctx).find("#avatar-picker-avatar-id");var avatarIconurlField=jQuery(ctx).find("#avatar-picker-iconurl");var avatarTypeElement=jQuery(ctx).find("#avatar-type");if(""===avatarTypeElement.text()){return }JIRA.createUniversalAvatarPickerDialog({trigger:trigger,title:jQuery(ctx).find("#avatar-dialog-title").text(),projectId:jQuery(ctx).find("#avatar-owner-id").text(),projectKey:jQuery(ctx).find("#avatar-owner-key").text(),defaultAvatarId:jQuery(ctx).find("#default-avatar-id").text(),initialSelection:avatarIdField.val(),avatarSize:JIRA.Avatar.getSizeObjectFromName(jQuery(ctx).find("#avatar-size").text()),avatarType:avatarTypeElement.text(),select:function(avatar,src){triggerImg.attr("src",src);avatarIconurlField.val(src);avatarIdField.val(avatar.getId())}})}function initProjectInlineAvatarPicker(ctx){var $triggerImg=jQuery(".jira-inline-avatar-picker-trigger",ctx);if($triggerImg.length){new InlineAvatarPicker({offsetTarget:$triggerImg,projectId:jQuery(ctx).find("#avatar-owner-id").text(),projectKey:jQuery(ctx).find("#avatar-owner-key").text(),defaultAvatarId:jQuery(ctx).find("#default-avatar-id").text(),alignment:AJS.LEFT,width:420,allowDownsize:true})}}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){initProjectAvatarPicker(context);initProjectInlineAvatarPicker(context)}})})();
/* module-key = 'jira.webresources:croneditor', location = '/includes/js/cron/croneditor.js' */
function hideCronEdit(elementid){document.getElementById(elementid).style.display="none"}function showCronEdit(elementid){document.getElementById(elementid).style.display=""}function toggleFrequencyControl(paramPrefix,setOriginal){var select=document.getElementById(paramPrefix+"interval");if(select.value==0){switchToOnce(paramPrefix,setOriginal)}else{switchToMany(paramPrefix,setOriginal)}}function switchToOnce(paramPrefix,setOriginal){hideCronEdit(paramPrefix+"runMany");showCronEdit(paramPrefix+"runOnce");if(setOriginal){timesOnce[paramPrefix]=true}}function switchToMany(paramPrefix,setOriginal){hideCronEdit(paramPrefix+"runOnce");showCronEdit(paramPrefix+"runMany");if(setOriginal){timesOnce[paramPrefix]=false}}function switchToDaysOfMonth(paramPrefix){hideCronEdit(paramPrefix+"daysOfWeek");showCronEdit(paramPrefix+"daysOfMonth");showCronEdit(paramPrefix+"freqDiv");hideCronEdit(paramPrefix+"innerFreqDiv");hideCronEdit(paramPrefix+"advanced");switchToOnce(paramPrefix,false)}function switchToDaysOfWeek(paramPrefix){showCronEdit(paramPrefix+"daysOfWeek");hideCronEdit(paramPrefix+"daysOfMonth");showCronEdit(paramPrefix+"freqDiv");showCronEdit(paramPrefix+"innerFreqDiv");hideCronEdit(paramPrefix+"advanced");switchToOriginal(paramPrefix)}function switchToDaily(paramPrefix){hideCronEdit(paramPrefix+"daysOfWeek");hideCronEdit(paramPrefix+"daysOfMonth");showCronEdit(paramPrefix+"freqDiv");showCronEdit(paramPrefix+"innerFreqDiv");hideCronEdit(paramPrefix+"advanced");switchToOriginal(paramPrefix)}function switchToAdvanced(paramPrefix){hideCronEdit(paramPrefix+"daysOfWeek");hideCronEdit(paramPrefix+"daysOfMonth");hideCronEdit(paramPrefix+"runOnce");hideCronEdit(paramPrefix+"runMany");hideCronEdit(paramPrefix+"freqDiv");showCronEdit(paramPrefix+"advanced")}function switchToOriginal(paramPrefix){if(timesOnce[paramPrefix]){switchToOnce(paramPrefix,false)}else{switchToMany(paramPrefix,false)}};
/* module-key = 'jira.webresources:calendar', location = '/includes/lib/calendar/Calendar.js' */
Calendar=function(firstDayOfWeek,dateStr,onSelected,onClose){this.activeDiv=null;this.currentDateEl=null;this.getDateStatus=null;this.getDateToolTip=null;this.getDateText=null;this.timeout=null;this.onSelected=onSelected||null;this.onClose=onClose||null;this.dragging=false;this.hidden=false;this.minYear=1970;this.maxYear=2050;this.dateFormat=Calendar._TT["DEF_DATE_FORMAT"];this.ttDateFormat=Calendar._TT["TT_DATE_FORMAT"];this.isPopup=true;this.weekNumbers=true;this.firstDayOfWeek=typeof firstDayOfWeek=="number"?firstDayOfWeek:Calendar._FD;this.showsOtherMonths=false;this.dateStr=dateStr;this.ar_days=null;this.showsTime=false;this.time24=true;this.yearStep=2;this.hiliteToday=true;this.multiple=null;this.table=null;this.element=null;this.tbody=null;this.firstdayname=null;this.monthsCombo=null;this.yearsCombo=null;this.hilitedMonth=null;this.activeMonth=null;this.hilitedYear=null;this.activeYear=null;this.dateClicked=false;if(typeof Calendar._SDN=="undefined"){if(typeof Calendar._SDN_len=="undefined"){Calendar._SDN_len=3}var ar=new Array();for(var i=8;i>0;){ar[--i]=Calendar._DN[i].substr(0,Calendar._SDN_len)}Calendar._SDN=ar;if(typeof Calendar._SMN_len=="undefined"){Calendar._SMN_len=3}ar=new Array();for(var i=12;i>0;){ar[--i]=Calendar._MN[i].substr(0,Calendar._SMN_len)}Calendar._SMN=ar}};Calendar._C=null;Calendar.is_ie=(/msie/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent));Calendar.is_ie5=(Calendar.is_ie&&/msie 5\.0/i.test(navigator.userAgent));Calendar.is_ie6=(Calendar.is_ie&&/msie 6\.0/i.test(navigator.userAgent));Calendar.is_opera=/opera/i.test(navigator.userAgent);Calendar.is_khtml=/Konqueror|Safari|KHTML/i.test(navigator.userAgent);Calendar.getAbsolutePos=function(el){var coords=jQuery(el).offset();coords.x=coords.left;coords.y=coords.top;return coords};Calendar.isRelated=function(el,evt){var related=evt.relatedTarget;if(!related){var type=evt.type;if(type=="mouseover"){related=evt.fromElement}else{if(type=="mouseout"){related=evt.toElement}}}while(related){if(related==el){return true}related=related.parentNode}return false};Calendar.removeClass=function(el,className){if(!(el&&el.className)){return }var cls=el.className.split(" ");var ar=new Array();for(var i=cls.length;i>0;){if(cls[--i]!=className){ar[ar.length]=cls[i]}}el.className=ar.join(" ")};Calendar.addClass=function(el,className){Calendar.removeClass(el,className);el.className+=" "+className};Calendar.getElement=function(ev){var f=Calendar.is_ie?window.event.srcElement:ev.currentTarget;while(f.nodeType!=1||/^div$/i.test(f.tagName)){f=f.parentNode}return f};Calendar.getTargetElement=function(ev){var f=Calendar.is_ie?window.event.srcElement:ev.target;while(f.nodeType!=1){f=f.parentNode}return f};Calendar.stopEvent=function(ev){if(!ev){ev=window.event}if(ev.stopPropagation){ev.preventDefault();ev.stopPropagation()}else{ev.cancelBubble=true;ev.returnValue=false}return false};Calendar.addEvent=function(el,evname,func){if(el.attachEvent){el.attachEvent("on"+evname,func)}else{if(el.addEventListener){el.addEventListener(evname,func,true)}else{el["on"+evname]=func}}};Calendar.removeEvent=function(el,evname,func){if(el.detachEvent){el.detachEvent("on"+evname,func)}else{if(el.removeEventListener){el.removeEventListener(evname,func,true)}else{el["on"+evname]=null}}};Calendar.createElement=function(type,parent){var el=null;if(document.createElementNS){el=document.createElementNS("http://www.w3.org/1999/xhtml",type)}else{el=document.createElement(type)}if(typeof parent!="undefined"){parent.appendChild(el)}return el};Calendar._add_evs=function(el){with(Calendar){addEvent(el,"mouseover",dayMouseOver);addEvent(el,"mousedown",dayMouseDown);addEvent(el,"mouseout",dayMouseOut);if(is_ie){addEvent(el,"dblclick",dayMouseDblClick);el.setAttribute("unselectable",true)}}};Calendar.findMonth=function(el){if(typeof el.month!="undefined"){return el}else{if(typeof el.parentNode.month!="undefined"){return el.parentNode}}return null};Calendar.findYear=function(el){if(typeof el.year!="undefined"){return el}else{if(typeof el.parentNode.year!="undefined"){return el.parentNode}}return null};Calendar.showMonthsCombo=function(){var cal=Calendar._C;if(!cal){return false}var cal=cal;var cd=cal.activeDiv;var mc=cal.monthsCombo;if(cal.hilitedMonth){Calendar.removeClass(cal.hilitedMonth,"hilite")}if(cal.activeMonth){Calendar.removeClass(cal.activeMonth,"active")}var mon=cal.monthsCombo.getElementsByTagName("div")[cal.date.getMonth()];Calendar.addClass(mon,"active");cal.activeMonth=mon;var s=mc.style;s.display="block";if(cd.navtype<0){s.left=cd.offsetLeft+"px"}else{var mcw=mc.offsetWidth;if(typeof mcw=="undefined"){mcw=50}s.left=(cd.offsetLeft+cd.offsetWidth-mcw)+"px"}s.top=(cd.offsetTop+cd.offsetHeight)+"px"};Calendar.showYearsCombo=function(fwd){var cal=Calendar._C;if(!cal){return false}var cal=cal;var cd=cal.activeDiv;var yc=cal.yearsCombo;if(cal.hilitedYear){Calendar.removeClass(cal.hilitedYear,"hilite")}if(cal.activeYear){Calendar.removeClass(cal.activeYear,"active")}cal.activeYear=null;var Y=cal.date.getFullYear()+(fwd?1:-1);var yr=yc.firstChild;var show=false;for(var i=12;i>0;--i){if(Y>=cal.minYear&&Y<=cal.maxYear){yr.innerHTML=Y;yr.year=Y;yr.style.display="block";show=true}else{yr.style.display="none"}yr=yr.nextSibling;Y+=fwd?cal.yearStep:-cal.yearStep}if(show){var s=yc.style;s.display="block";if(cd.navtype<0){s.left=cd.offsetLeft+"px"}else{var ycw=yc.offsetWidth;if(typeof ycw=="undefined"){ycw=50}s.left=(cd.offsetLeft+cd.offsetWidth-ycw)+"px"}s.top=(cd.offsetTop+cd.offsetHeight)+"px"}};Calendar.tableMouseUp=function(ev){var cal=Calendar._C;if(!cal){return false}if(cal.timeout){clearTimeout(cal.timeout)}var el=cal.activeDiv;if(!el){return false}var target=Calendar.getTargetElement(ev);ev||(ev=window.event);Calendar.removeClass(el,"active");if(target==el||target.parentNode==el){Calendar.cellClick(el,ev)}var mon=Calendar.findMonth(target);var date=null;if(mon){date=new Date(cal.date);if(mon.month!=date.getMonth()){date.setMonth(mon.month);cal.setDate(date);cal.dateClicked=false;cal.callHandler()}}else{var year=Calendar.findYear(target);if(year){date=new Date(cal.date);if(year.year!=date.getFullYear()){date.setFullYear(year.year);cal.setDate(date);cal.dateClicked=false;cal.callHandler()}}}with(Calendar){removeEvent(document,"mouseup",tableMouseUp);removeEvent(document,"mouseover",tableMouseOver);removeEvent(document,"mousemove",tableMouseOver);cal._hideCombos();_C=null;return stopEvent(ev)}};Calendar.tableMouseOver=function(ev){var cal=Calendar._C;if(!cal){return }var el=cal.activeDiv;var target=Calendar.getTargetElement(ev);if(target==el||target.parentNode==el){Calendar.addClass(el,"hilite active");Calendar.addClass(el.parentNode,"rowhilite")}else{if(typeof el.navtype=="undefined"||(el.navtype!=50&&(el.navtype==0||Math.abs(el.navtype)>2))){Calendar.removeClass(el,"active")}Calendar.removeClass(el,"hilite");Calendar.removeClass(el.parentNode,"rowhilite")}ev||(ev=window.event);if(el.navtype==50&&target!=el){var pos=Calendar.getAbsolutePos(el);var w=el.offsetWidth;var x=ev.clientX;var dx;var decrease=true;if(x>pos.x+w){dx=x-pos.x-w;decrease=false}else{dx=pos.x-x}if(dx<0){dx=0}var range=el._range;var current=el._current;var count=Math.floor(dx/10)%range.length;for(var i=range.length;--i>=0;){if(range[i]==current){break}}while(count-->0){if(decrease){if(--i<0){i=range.length-1}}else{if(++i>=range.length){i=0}}}var newval=range[i];el.innerHTML=newval;cal.onUpdateTime()}var mon=Calendar.findMonth(target);if(mon){if(mon.month!=cal.date.getMonth()){if(cal.hilitedMonth){Calendar.removeClass(cal.hilitedMonth,"hilite")}Calendar.addClass(mon,"hilite");cal.hilitedMonth=mon}else{if(cal.hilitedMonth){Calendar.removeClass(cal.hilitedMonth,"hilite")}}}else{if(cal.hilitedMonth){Calendar.removeClass(cal.hilitedMonth,"hilite")}var year=Calendar.findYear(target);if(year){if(year.year!=cal.date.getFullYear()){if(cal.hilitedYear){Calendar.removeClass(cal.hilitedYear,"hilite")}Calendar.addClass(year,"hilite");cal.hilitedYear=year}else{if(cal.hilitedYear){Calendar.removeClass(cal.hilitedYear,"hilite")}}}else{if(cal.hilitedYear){Calendar.removeClass(cal.hilitedYear,"hilite")}}}return Calendar.stopEvent(ev)};Calendar.tableMouseDown=function(ev){if(Calendar.getTargetElement(ev)==Calendar.getElement(ev)){return Calendar.stopEvent(ev)}};Calendar.calDragIt=function(ev){var cal=Calendar._C;if(!(cal&&cal.dragging)){return false}var posX;var posY;if(Calendar.is_ie){posY=window.event.clientY+document.body.scrollTop;posX=window.event.clientX+document.body.scrollLeft}else{posX=ev.pageX;posY=ev.pageY}var st=cal.element.style;st.left=(posX-cal.xOffs)+"px";st.top=(posY-cal.yOffs)+"px";return Calendar.stopEvent(ev)};Calendar.calDragEnd=function(ev){var cal=Calendar._C;if(!cal){return false}cal.dragging=false;with(Calendar){removeEvent(document,"mousemove",calDragIt);removeEvent(document,"mouseup",calDragEnd);tableMouseUp(ev)}};Calendar.dayMouseDown=function(ev){var el=Calendar.getElement(ev);if(el.disabled){return false}var cal=el.calendar;cal.activeDiv=el;Calendar._C=cal;if(el.navtype!=300){with(Calendar){if(el.navtype==50){el._current=el.innerHTML;addEvent(document,"mousemove",tableMouseOver)}else{addEvent(document,Calendar.is_ie5?"mousemove":"mouseover",tableMouseOver)}addClass(el,"hilite active");addEvent(document,"mouseup",tableMouseUp)}}else{if(cal.isPopup){cal._dragStart(ev)}}if(el.navtype==-1||el.navtype==1){if(cal.timeout){clearTimeout(cal.timeout)}cal.timeout=setTimeout("Calendar.showMonthsCombo()",250)}else{if(el.navtype==-2||el.navtype==2){if(cal.timeout){clearTimeout(cal.timeout)}cal.timeout=setTimeout((el.navtype>0)?"Calendar.showYearsCombo(true)":"Calendar.showYearsCombo(false)",250)}else{cal.timeout=null}}return Calendar.stopEvent(ev)};Calendar.dayMouseDblClick=function(ev){Calendar.cellClick(Calendar.getElement(ev),ev||window.event);if(Calendar.is_ie){document.selection.empty()}};Calendar.dayMouseOver=function(ev){var el=Calendar.getElement(ev);if(Calendar.isRelated(el,ev)||Calendar._C||el.disabled){return false}if(el.ttip){if(el.ttip.substr(0,1)=="_"){el.ttip=el.caldate.print(el.calendar.ttDateFormat)+el.ttip.substr(1)}el.calendar.tooltips.innerHTML=el.ttip}if(el.navtype!=300){Calendar.addClass(el,"hilite");if(el.caldate){Calendar.addClass(el.parentNode,"rowhilite")}}return Calendar.stopEvent(ev)};Calendar.dayMouseOut=function(ev){with(Calendar){var el=getElement(ev);if(isRelated(el,ev)||_C||el.disabled){return false}removeClass(el,"hilite");if(el.caldate){removeClass(el.parentNode,"rowhilite")}if(el.calendar){el.calendar.tooltips.innerHTML=_TT["SEL_DATE"]}return stopEvent(ev)}};Calendar.cellClick=function(el,ev){var cal=el.calendar;var closing=false;var newdate=false;var date=null;if(typeof el.navtype=="undefined"){if(cal.currentDateEl){Calendar.removeClass(cal.currentDateEl,"selected");Calendar.addClass(el,"selected");closing=(cal.currentDateEl==el);if(!closing){cal.currentDateEl=el}}cal.date.setDateOnly(el.caldate);date=cal.date;var other_month=!(cal.dateClicked=!el.otherMonth);if(!other_month&&!cal.currentDateEl){cal._toggleMultipleDate(new Date(date))}else{newdate=!el.disabled}if(other_month){cal._init(cal.firstDayOfWeek,date)}}else{if(el.navtype==200){Calendar.removeClass(el,"hilite");cal.callCloseHandler();return }date=new Date(cal.date);if(el.navtype==0){date.setDateOnly(new Date())}cal.dateClicked=false;var year=date.getFullYear();var mon=date.getMonth();function setMonth(m){var day=date.getDate();var max=date.getMonthDays(m);if(day>max){date.setDate(max)}date.setMonth(m)}switch(el.navtype){case 400:Calendar.removeClass(el,"hilite");var text=Calendar._TT["ABOUT"];if(typeof text!="undefined"){text+=cal.showsTime?Calendar._TT["ABOUT_TIME"]:""}else{text="Help and about box text is not translated into this language.\n"+"If you know this language and you feel generous please update\n"+'the corresponding file in "lang" subdir to match calendar-en.js\n'+"and send it back to <mihai_bazon@yahoo.com> to get it into the distribution  ;-)\n\n"+"Thank you!\n"+"http://dynarch.com/mishoo/calendar.epl\n"}alert(text);return ;case -2:if(year>cal.minYear){date.setFullYear(year-1)}break;case -1:if(mon>0){setMonth(mon-1)}else{if(year-->cal.minYear){date.setFullYear(year);setMonth(11)}}break;case 1:if(mon<11){setMonth(mon+1)}else{if(year<cal.maxYear){date.setFullYear(year+1);setMonth(0)}}break;case 2:if(year<cal.maxYear){date.setFullYear(year+1)}break;case 100:cal.setFirstDayOfWeek(el.fdow);return ;case 50:var range=el._range;var current=el.innerHTML;for(var i=range.length;--i>=0;){if(range[i]==current){break}}if(ev&&ev.shiftKey){if(--i<0){i=range.length-1}}else{if(++i>=range.length){i=0}}var newval=range[i];el.innerHTML=newval;cal.onUpdateTime();return ;case 0:if((typeof cal.getDateStatus=="function")&&cal.getDateStatus(date,date.getFullYear(),date.getMonth(),date.getDate())){return false}break}if(!date.equalsTo(cal.date)){cal.setDate(date);newdate=true}else{if(el.navtype==0){newdate=closing=true}}}if(newdate){ev&&cal.callHandler()}if(closing){Calendar.removeClass(el,"hilite");ev&&cal.callCloseHandler()}};Calendar.prototype.create=function(_par){var parent=null;if(!_par){parent=document.getElementsByTagName("body")[0];this.isPopup=true}else{parent=_par;this.isPopup=false}if(this.dateStr){this.date=new Date(this.dateStr)}if(!this.date||isNaN(this.date)){this.date=new Date()}var table=Calendar.createElement("table");this.table=table;table.cellSpacing=0;table.cellPadding=0;table.calendar=this;Calendar.addEvent(table,"mousedown",Calendar.tableMouseDown);var div=Calendar.createElement("div");this.element=div;div.className="calendar";if(this.isPopup){div.style.position="absolute";div.style.display="none"}div.appendChild(table);var thead=Calendar.createElement("thead",table);var cell=null;var row=null;var cal=this;var hh=function(text,cs,navtype){cell=Calendar.createElement("td",row);cell.colSpan=cs;cell.className="button";if(navtype!=0&&Math.abs(navtype)<=2){cell.className+=" nav"}Calendar._add_evs(cell);cell.calendar=cal;cell.navtype=navtype;cell.innerHTML="<div unselectable='on'>"+text+"</div>";return cell};row=Calendar.createElement("tr",thead);var title_length=6;(this.isPopup)&&--title_length;(this.weekNumbers)&&++title_length;hh("?",1,400).ttip=Calendar._TT["INFO"];this.title=hh("",title_length,300);this.title.className="title";if(this.isPopup){this.title.ttip=Calendar._TT["DRAG_TO_MOVE"];this.title.style.cursor="move";hh("&#x00d7;",1,200).ttip=Calendar._TT["CLOSE"]}row=Calendar.createElement("tr",thead);row.className="headrow";this._nav_py=hh("&#x00ab;",1,-2);this._nav_py.ttip=Calendar._TT["PREV_YEAR"];this._nav_pm=hh("&#x2039;",1,-1);this._nav_pm.ttip=Calendar._TT["PREV_MONTH"];this._nav_now=hh(Calendar._TT["TODAY"],this.weekNumbers?4:3,0);this._nav_now.ttip=Calendar._TT["GO_TODAY"];this._nav_nm=hh("&#x203a;",1,1);this._nav_nm.ttip=Calendar._TT["NEXT_MONTH"];this._nav_ny=hh("&#x00bb;",1,2);this._nav_ny.ttip=Calendar._TT["NEXT_YEAR"];row=Calendar.createElement("tr",thead);row.className="daynames";if(this.weekNumbers){cell=Calendar.createElement("td",row);cell.className="name wn";cell.innerHTML=Calendar._TT["WK"]}for(var i=7;i>0;--i){cell=Calendar.createElement("td",row);if(!i){cell.navtype=100;cell.calendar=this;Calendar._add_evs(cell)}}this.firstdayname=(this.weekNumbers)?row.firstChild.nextSibling:row.firstChild;this._displayWeekdays();var tbody=Calendar.createElement("tbody",table);this.tbody=tbody;for(i=6;i>0;--i){row=Calendar.createElement("tr",tbody);if(this.weekNumbers){cell=Calendar.createElement("td",row)}for(var j=7;j>0;--j){cell=Calendar.createElement("td",row);cell.calendar=this;Calendar._add_evs(cell)}}if(this.showsTime){row=Calendar.createElement("tr",tbody);row.className="time";cell=Calendar.createElement("td",row);cell.className="time";cell.colSpan=2;cell.innerHTML=Calendar._TT["TIME"]||"&nbsp;";cell=Calendar.createElement("td",row);cell.className="time";cell.colSpan=this.weekNumbers?4:3;(function(){function makeTimePart(className,init,range_start,range_end){var part=Calendar.createElement("span",cell);part.className=className;part.innerHTML=init;part.calendar=cal;part.ttip=Calendar._TT["TIME_PART"];part.navtype=50;part._range=[];if(typeof range_start!="number"){part._range=range_start}else{for(var i=range_start;i<=range_end;++i){var txt;if(i<10&&range_end>=10){txt="0"+i}else{txt=""+i}part._range[part._range.length]=txt}}Calendar._add_evs(part);return part}var hrs=cal.date.getHours();var mins=cal.date.getMinutes();var t12=!cal.time24;var pm=(hrs>12);if(t12&&pm){hrs-=12}var H=makeTimePart("hour",hrs,t12?1:0,t12?12:23);var span=Calendar.createElement("span",cell);span.innerHTML=":";span.className="colon";var M=makeTimePart("minute",mins,0,59);var AP=null;cell=Calendar.createElement("td",row);cell.className="time";cell.colSpan=2;if(t12){AP=makeTimePart("ampm",pm?Calendar._TT["PM"]:Calendar._TT["AM"],[Calendar._TT["am"],Calendar._TT["pm"]])}else{cell.innerHTML="&nbsp;"}cal.onSetTime=function(){var pm,hrs=this.date.getHours(),mins=this.date.getMinutes();if(t12){pm=(hrs>=12);if(pm){hrs-=12}if(hrs==0){hrs=12}AP.innerHTML=pm?Calendar._TT["pm"]:Calendar._TT["am"]}H.innerHTML=(hrs<10)?("0"+hrs):hrs;M.innerHTML=(mins<10)?("0"+mins):mins};cal.onUpdateTime=function(){var date=this.date;var h=parseInt(H.innerHTML,10);if(t12){if(new RegExp(Calendar._TT["pm"],"i").test(AP.innerHTML)&&h<12){h+=12}else{if(new RegExp(Calendar._TT["am"],"i").test(AP.innerHTML)&&h==12){h=0}}}var d=date.getDate();var m=date.getMonth();var y=date.getFullYear();date.setHours(h);date.setMinutes(parseInt(M.innerHTML,10));date.setFullYear(y);date.setMonth(m);date.setDate(d);this.dateClicked=false;this.callHandler()}})()}else{this.onSetTime=this.onUpdateTime=function(){}}var tfoot=Calendar.createElement("tfoot",table);row=Calendar.createElement("tr",tfoot);row.className="footrow";cell=hh(Calendar._TT["SEL_DATE"],this.weekNumbers?8:7,300);cell.className="ttip";if(this.isPopup){cell.ttip=Calendar._TT["DRAG_TO_MOVE"];cell.style.cursor="move"}this.tooltips=cell;div=Calendar.createElement("div",this.element);this.monthsCombo=div;div.className="combo";for(i=0;i<Calendar._MN.length;++i){var mn=Calendar.createElement("div");mn.className=Calendar.is_ie?"label-IEfix":"label";mn.month=i;mn.innerHTML=Calendar._SMN[i];div.appendChild(mn)}div=Calendar.createElement("div",this.element);this.yearsCombo=div;div.className="combo";for(i=12;i>0;--i){var yr=Calendar.createElement("div");yr.className=Calendar.is_ie?"label-IEfix":"label";div.appendChild(yr)}this._init(this.firstDayOfWeek,this.date);parent.appendChild(this.element);Calendar.addEvent(this.element,"mousedown",function(ev){ev.preventDefault?ev.preventDefault():ev.returnValue=false})};Calendar._upkeyEvent=function(e){if(e.keyCode===27){window.setTimeout(function(){var cal=window._dynarch_popupCalendar;if(!cal||cal.multiple){return false}else{cal.callCloseHandler()}},0)}};Calendar._keyEvent=function(ev){var cal=window._dynarch_popupCalendar;if(!cal||cal.multiple){return false}var act=(Calendar.is_ie||ev.type=="keydown"),K=ev.keyCode;if(ev.ctrlKey){switch(K){case 37:act&&Calendar.cellClick(cal._nav_pm);break;case 38:act&&Calendar.cellClick(cal._nav_py);break;case 39:act&&Calendar.cellClick(cal._nav_nm);break;case 40:act&&Calendar.cellClick(cal._nav_ny);break}}else{switch(K){case 32:Calendar.cellClick(cal._nav_now);break;case 37:case 38:case 39:case 40:if(act){var prev,x,y,ne,el,step;prev=K==37||K==38;step=(K==37||K==39)?1:7;function setVars(){el=cal.currentDateEl;var p=el.pos;x=p&15;y=p>>4;ne=cal.ar_days[y][x]}setVars();function prevMonth(){var date=new Date(cal.date);date.setDate(date.getDate()-step);cal.setDate(date)}function nextMonth(){var date=new Date(cal.date);date.setDate(date.getDate()+step);cal.setDate(date)}while(1){switch(K){case 37:if(--x>=0){ne=cal.ar_days[y][x]}else{x=6;K=38;continue}break;case 38:if(--y>=0){ne=cal.ar_days[y][x]}else{prevMonth();setVars()}break;case 39:if(++x<7){ne=cal.ar_days[y][x]}else{x=0;K=40;continue}break;case 40:if(++y<cal.ar_days.length){ne=cal.ar_days[y][x]}else{nextMonth();setVars()}break}break}if(ne){if(!ne.disabled){Calendar.cellClick(ne)}else{if(prev){prevMonth()}else{nextMonth()}}}}break;case 13:if(act){Calendar.cellClick(cal.currentDateEl,ev)}break}}return Calendar.stopEvent(ev)};Calendar.prototype._init=function(firstDayOfWeek,seedDate){var date=new Date(seedDate);date.setHours(13);var today=new Date(),TY=today.getFullYear(),TM=today.getMonth(),TD=today.getDate();this.table.style.visibility="hidden";var year=date.getFullYear();if(year<this.minYear){year=this.minYear;date.setFullYear(year)}else{if(year>this.maxYear){year=this.maxYear;date.setFullYear(year)}}this.firstDayOfWeek=firstDayOfWeek;var month=date.getMonth();var mday=date.getDate();var no_days=date.getMonthDays();date.setDate(1);var day1=(date.getDay()-this.firstDayOfWeek)%7;if(day1<0){day1+=7}date.setDate(-day1);date.setDate(date.getDate()+1);var row=this.tbody.firstChild;var MN=Calendar._SMN[month];var ar_days=this.ar_days=new Array();var weekend=Calendar._TT["WEEKEND"];var dates=this.multiple?(this.datesCells={}):null;for(var i=0;i<6;++i,row=row.nextSibling){var cell=row.firstChild;if(this.weekNumbers){cell.className="day wn";var monthStartDate=date;if(month==0&&i==0&&Date.useISO8601WeekNumbers==false){monthStartDate=new Date(year,month,1)}cell.innerHTML=monthStartDate.getWeekNumber(this.firstDayOfWeek);cell=cell.nextSibling}row.className="daysrow";var hasdays=false,iday,dpos=ar_days[i]=[];for(var j=0;j<7;++j,cell=cell.nextSibling,date.setDate(iday+1)){iday=date.getDate();var wday=date.getDay();cell.className="day day-"+iday;cell.pos=i<<4|j;dpos[j]=cell;var current_month=(date.getMonth()==month);if(!current_month){if(this.showsOtherMonths){cell.className+=" othermonth";cell.otherMonth=true}else{cell.className="emptycell";cell.innerHTML="&nbsp;";cell.disabled=true;continue}}else{cell.otherMonth=false;hasdays=true}cell.disabled=false;cell.innerHTML=this.getDateText?this.getDateText(date,iday):iday;if(dates){dates[date.print("%Y%m%d")]=cell}if(this.getDateStatus){var status=this.getDateStatus(date,year,month,iday);if(this.getDateToolTip){var toolTip=this.getDateToolTip(date,year,month,iday);if(toolTip){cell.title=toolTip}}if(status===true){cell.className+=" disabled";cell.disabled=true}else{if(/disabled/i.test(status)){cell.disabled=true}cell.className+=" "+status}}if(!cell.disabled){cell.caldate=new Date(date);cell.ttip="_";if(!this.multiple&&current_month&&iday==mday&&this.hiliteToday){cell.className+=" selected";this.currentDateEl=cell}if(date.getFullYear()==TY&&date.getMonth()==TM&&iday==TD){cell.className+=" today";cell.ttip+=Calendar._TT["PART_TODAY"]}if(weekend.indexOf(wday.toString())!=-1){cell.className+=cell.otherMonth?" oweekend":" weekend"}}}if(!(hasdays||this.showsOtherMonths)){row.className="emptyrow"}}this.date=new Date(seedDate);this.onSetTime();this.title.innerHTML=Calendar._MN[month]+", "+year;this.table.style.visibility="visible";this._initMultipleDates()};Calendar.prototype._initMultipleDates=function(){if(this.multiple){for(var i in this.multiple){var cell=this.datesCells[i];var d=this.multiple[i];if(!d){continue}if(cell){cell.className+=" selected"}}}};Calendar.prototype._toggleMultipleDate=function(date){if(this.multiple){var ds=date.print("%Y%m%d");var cell=this.datesCells[ds];if(cell){var d=this.multiple[ds];if(!d){Calendar.addClass(cell,"selected");this.multiple[ds]=date}else{Calendar.removeClass(cell,"selected");delete this.multiple[ds]}}}};Calendar.prototype.setDateToolTipHandler=function(unaryFunction){this.getDateToolTip=unaryFunction};Calendar.prototype.setDate=function(date){if(!date.equalsTo(this.date)){this._init(this.firstDayOfWeek,date)}};Calendar.prototype.refresh=function(){this._init(this.firstDayOfWeek,this.date)};Calendar.prototype.setFirstDayOfWeek=function(firstDayOfWeek){this._init(firstDayOfWeek,this.date);this._displayWeekdays()};Calendar.prototype.setDateStatusHandler=Calendar.prototype.setDisabledHandler=function(unaryFunction){this.getDateStatus=unaryFunction};Calendar.prototype.setRange=function(a,z){this.minYear=a;this.maxYear=z};Calendar.prototype.callHandler=function(){if(this.onSelected){this.onSelected(this,this.date.print(this.dateFormat))}};Calendar.prototype.callCloseHandler=function(){if(this.onClose){this.onClose(this)}};Calendar.prototype.destroy=function(){var el=this.element.parentNode;el.removeChild(this.element);Calendar._C=null;window._dynarch_popupCalendar=null};Calendar.prototype.reparent=function(new_parent){var el=this.element;el.parentNode.removeChild(el);new_parent.appendChild(el)};Calendar._checkCalendar=function(ev){var calendar=window._dynarch_popupCalendar;if(!calendar){return false}var el=Calendar.is_ie?Calendar.getElement(ev):Calendar.getTargetElement(ev);for(;el!=null&&el!=calendar.element;el=el.parentNode){}if(el==null){window._dynarch_popupCalendar.callCloseHandler();return Calendar.stopEvent(ev)}};Calendar.prototype.show=function(){if(this.params.inputField.disabled){return }var rows=this.table.getElementsByTagName("tr");for(var i=rows.length;i>0;){var row=rows[--i];Calendar.removeClass(row,"rowhilite");var cells=row.getElementsByTagName("td");for(var j=cells.length;j>0;){var cell=cells[--j];Calendar.removeClass(cell,"hilite");Calendar.removeClass(cell,"active")}}Calendar.current=this;this.element.style.display="block";this.element.className+=" active";this.hidden=false;if(this.isPopup){window._dynarch_popupCalendar=this;Calendar.addEvent(document,"keyup",Calendar._upkeyEvent);Calendar.addEvent(document,"keydown",Calendar._keyEvent);Calendar.addEvent(document,"mousedown",Calendar._checkCalendar)}};Calendar.prototype.hide=function(){if(this.isPopup){Calendar.removeEvent(document,"keyup",Calendar._upkeyEvent);Calendar.removeEvent(document,"keydown",Calendar._keyEvent);Calendar.removeEvent(document,"mousedown",Calendar._checkCalendar)}Calendar.current=null;this.element.style.display="none";this.element.className=this.element.className.replace(/active/gi,"");this.hidden=true};Calendar.prototype.showAt=function(x,y){var s=this.element.style;s.left=x+"px";s.top=y+"px";this.show()};Calendar.prototype.showAtElement=function(el,opts){var self=this;var p=Calendar.getAbsolutePos(el);if(!opts||typeof opts!="string"){this.showAt(p.x,p.y+el.offsetHeight);return true}function fixPosition(box){if(box.x<0){box.x=0}if(box.y<0){box.y=0}var cp=document.createElement("div");var s=cp.style;s.position="absolute";s.right=s.bottom=s.width=s.height="0px";document.body.appendChild(cp);var br=Calendar.getAbsolutePos(cp);document.body.removeChild(cp);br.y+=jQuery(window).scrollTop();br.x+=jQuery(window).scrollLeft();var tmp=box.x+box.width-br.x;if(tmp>0){box.x-=tmp}tmp=box.y+box.height-br.y;if(tmp>0){box.y-=tmp}}this.element.style.display="block";Calendar.continuation_for_the_khtml_browser=function(){var w=jQuery(self.element).outerWidth();var h=jQuery(self.element).outerHeight();self.element.style.display="none";var valign=opts.substr(0,1);var halign="l";if(opts.length>1){halign=opts.substr(1,1)}switch(valign){case"T":p.y-=h;break;case"B":p.y+=jQuery(el).outerHeight();break;case"C":p.y+=(jQuery(el).outerHeight()-h)/2;break;case"t":p.y+=jQuery(el).outerHeight()-h;break;case"b":break}switch(halign){case"L":p.x-=w;break;case"R":p.x+=jQuery(el).outerWidth();break;case"C":p.x+=(jQuery(el).outerWidth()-w)/2;break;case"l":p.x+=jQuery(el).outerWidth()-w;break;case"r":break}p.width=w;p.height=h+40;self.monthsCombo.style.display="none";fixPosition(p);self.showAt(p.x,p.y)};Calendar.continuation_for_the_khtml_browser()};Calendar.prototype.setDateFormat=function(str){this.dateFormat=str};Calendar.prototype.setTtDateFormat=function(str){this.ttDateFormat=str};Calendar.prototype.parseDate=function(str,fmt){if(!fmt){fmt=this.dateFormat}this.setDate(Date.parseDate(str,fmt))};Calendar.prototype._displayWeekdays=function(){var fdow=this.firstDayOfWeek;var cell=this.firstdayname;var weekend=Calendar._TT["WEEKEND"];for(var i=0;i<7;++i){cell.className="day name";var realday=(i+fdow)%7;if(i){cell.ttip=Calendar._TT["DAY_FIRST"].replace("%s",Calendar._DN[realday]);cell.navtype=100;cell.calendar=this;cell.fdow=realday;Calendar._add_evs(cell)}if(weekend.indexOf(realday.toString())!=-1){Calendar.addClass(cell,"weekend")}cell.innerHTML=Calendar._SDN[(i+fdow)%7];cell=cell.nextSibling}};Calendar.prototype._hideCombos=function(){this.monthsCombo.style.display="none";this.yearsCombo.style.display="none"};Calendar.prototype._dragStart=function(ev){if(this.dragging){return }this.dragging=true;var posX;var posY;if(Calendar.is_ie){posY=window.event.clientY+document.body.scrollTop;posX=window.event.clientX+document.body.scrollLeft}else{posY=ev.clientY+window.scrollY;posX=ev.clientX+window.scrollX}var st=this.element.style;this.xOffs=posX-parseInt(st.left);this.yOffs=posY-parseInt(st.top);with(Calendar){addEvent(document,"mousemove",calDragIt);addEvent(document,"mouseup",calDragEnd)}};Date._MD=new Array(31,28,31,30,31,30,31,31,30,31,30,31);Date.SECOND=1000;Date.MINUTE=60*Date.SECOND;Date.HOUR=60*Date.MINUTE;Date.DAY=24*Date.HOUR;Date.WEEK=7*Date.DAY;Date._multisplit=function(s,seps){if(s==null){return null}if(seps==null){seps=""}var arr=[];var len=s.length;var token="";var inWord=false;for(i=0;i<len;i++){var c=s.charAt(i);if(seps.indexOf(c)==-1){inWord=true;token+=c}else{if(inWord){arr[arr.length]=token;token="";inWord=false}}}if(token.length>0){arr[arr.length]=token}if(arr.length==0){arr[arr.length]=""}return arr};Date._parseNonDateFormatChars=function(s){var magicChars="aAbBCdeHIJklmMnpPRSstUWVuwyY%";var nonMagicChars="";var len=s.length;var inMagic=false;for(i=0;i<len;i++){var c=s.charAt(i);if(c=="%"){var peekc="";if(i+1<len){peekc=s.charAt(i+1)}i=i+1;if(peekc.length>0&&magicChars.indexOf(peekc)!=-1){continue}else{if(nonMagicChars.indexOf(c)==-1){nonMagicChars+=c}if(peekc.length>0&&nonMagicChars.indexOf(peekc)==-1){nonMagicChars+=peekc}}}else{if(nonMagicChars.indexOf(c)==-1){nonMagicChars+=c}}}return nonMagicChars};Date.parseDate=function(str,fmt){var today=new Date();var y=0;var m=-1;var d=0;var seps=Date._parseNonDateFormatChars(fmt);var a=Date._multisplit(str,seps);var b=fmt.match(/%./g);var i=0,j=0;var hr=0;var min=0;for(i=0;i<a.length;++i){if(!a[i]){continue}switch(b[i]){case"%d":case"%e":d=parseInt(a[i],10);break;case"%m":m=parseInt(a[i],10)-1;break;case"%Y":case"%y":y=parseInt(a[i],10);(y<100)&&(y+=(y>29)?1900:2000);break;case"%b":case"%B":var monthName=a[i].toLowerCase();var found=false;if(b[i]=="%b"){for(j=0;j<12;++j){if(Calendar._SMN[j].substr(0,monthName.length).toLowerCase()==monthName){m=j;found=true;break}}}if(!found){for(j=0;j<12;++j){if(Calendar._MN[j].substr(0,monthName.length).toLowerCase()==monthName){m=j;break}}}break;case"%H":case"%I":case"%k":case"%l":hr=parseInt(a[i],10);break;case"%P":case"%p":if(/pm/i.test(a[i])&&hr<12){hr+=12}else{if(/am/i.test(a[i])&&hr>=12){hr-=12}}break;case"%M":min=parseInt(a[i],10);break;case"%R":var hrMinString=a[i];var hrMinSeparator=hrMinString.indexOf(":");var hrString=hrMinString.substring(0,hrMinSeparator);var minString=hrMinSeparator==-1?0:hrMinString.substring(hrMinSeparator+1);hr=parseInt(hrString,10);min=parseInt(minString,10);break}}if(isNaN(y)){y=today.getFullYear()}if(isNaN(m)){m=today.getMonth()}if(isNaN(d)){d=today.getDate()}if(isNaN(hr)){hr=today.getHours()}if(isNaN(min)){min=today.getMinutes()}if(y!=0&&m!=-1&&d!=0){return new Date(y,m,d,hr,min,0)}y=0;m=-1;d=0;for(i=0;i<a.length;++i){if(a[i].search(/[a-zA-Z]+/)!=-1){var t=-1;for(j=0;j<12;++j){if(Calendar._MN[j].substr(0,a[i].length).toLowerCase()==a[i].toLowerCase()){t=j;break}}if(t!=-1){if(m!=-1){d=m+1}m=t}}else{if(parseInt(a[i],10)<=12&&m==-1){m=a[i]-1}else{if(parseInt(a[i],10)>31&&y==0){y=parseInt(a[i],10);(y<100)&&(y+=(y>29)?1900:2000)}else{if(d==0){d=a[i]}}}}}if(y==0){y=today.getFullYear()}if(m!=-1&&d!=0){return new Date(y,m,d,hr,min,0)}return today};Date.prototype.getMonthDays=function(month){var year=this.getFullYear();if(typeof month=="undefined"){month=this.getMonth()}if(((0==(year%4))&&((0!=(year%100))||(0==(year%400))))&&month==1){return 29}else{return Date._MD[month]}};Date.prototype.getDayOfYear=function(){var now=new Date(this.getFullYear(),this.getMonth(),this.getDate(),13,0,0);var then=new Date(this.getFullYear(),0,0,13,0,0);var time=now-then;return Math.floor(time/Date.DAY)};Date.prototype.getWeekNumber=function(startOfWeek){if(Date.useISO8601WeekNumbers){return this.getISO8601WeekNumber()}else{return this.getSimpleWeekNumber(startOfWeek)}};Date.prototype.getISO8601WeekNumber=function(){function gregdaynumber(year,month,day){y=year;m=month;if(month<3){y=y-1}if(month<3){m=m+12}return Math.floor(365.25*y)-Math.floor(y/100)+Math.floor(y/400)+Math.floor(30.6*(m+1))+day-62}function isocalendar1(date){year=date.getFullYear();month=date.getMonth();day=date.getDate();wday=date.getDay();weekday=((wday+6)%7)+1;isoyear=year;d0=gregdaynumber(year,1,0);weekday0=((d0+4)%7)+1;d=gregdaynumber(year,month+1,day);isoweeknr=Math.floor((d-d0+weekday0+6)/7)-Math.floor((weekday0+3)/7);if((month==11)&&((day-weekday)>27)){isoweeknr=1;isoyear=isoyear+1}if((month==0)&&((weekday-day)>3)){d0=gregdaynumber(year-1,1,0);weekday0=((d0+4)%7)+1;isoweeknr=Math.floor((d-d0+weekday0+6)/7)-Math.floor((weekday0+3)/7);isoyear=isoyear-1}return isoweeknr}return isocalendar1(this)};Date.prototype.getSimpleWeekNumber=function(startOfWeek){function OddWkNo1(D,d1,d2){var Yr=D.getFullYear(),Jan1=new Date(Yr,0,1),Q;Q=Math.round((D-Jan1)/86400000);if(d1!=null){Q-=(7+d1-Jan1.getDay())%7}if(d2!=null){Q+=d2}return[Yr,1+Q/7|0,1+(7+Q)%7]}return OddWkNo1(this,startOfWeek?startOfWeek:6,6)[1]};Date.prototype.equalsTo=function(date){return((this.getFullYear()==date.getFullYear())&&(this.getMonth()==date.getMonth())&&(this.getDate()==date.getDate())&&(this.getHours()==date.getHours())&&(this.getMinutes()==date.getMinutes()))};Date.prototype.setDateOnly=function(date){var tmp=new Date(date);this.setDate(1);this.setFullYear(tmp.getFullYear());this.setMonth(tmp.getMonth());this.setDate(tmp.getDate())};Date.prototype.print=function(str){var m=this.getMonth();var d=this.getDate();var y=this.getFullYear();var wn=this.getWeekNumber();var w=this.getDay();var s={};var hr=this.getHours();var pm=(hr>=12);var ir=(pm)?(hr-12):hr;var dy=this.getDayOfYear();if(ir==0){ir=12}var min=this.getMinutes();var sec=this.getSeconds();s["%a"]=Calendar._SDN[w];s["%A"]=Calendar._DN[w];s["%b"]=Calendar._SMN[m];s["%B"]=Calendar._MN[m];s["%C"]=1+Math.floor(y/100);s["%d"]=(d<10)?("0"+d):d;s["%e"]=d;s["%H"]=(hr<10)?("0"+hr):hr;s["%I"]=(ir<10)?("0"+ir):ir;s["%j"]=(dy<100)?((dy<10)?("00"+dy):("0"+dy)):dy;s["%k"]=hr;s["%l"]=ir;s["%m"]=(m<9)?("0"+(1+m)):(1+m);s["%M"]=(min<10)?("0"+min):min;s["%n"]="\n";s["%p"]=pm?Calendar._TT["PM"]:Calendar._TT["AM"];s["%P"]=pm?Calendar._TT["PM"]:Calendar._TT["AM"];s["%R"]=s["%k"]+":"+s["%M"];s["%s"]=Math.floor(this.getTime()/1000);s["%S"]=(sec<10)?("0"+sec):sec;s["%t"]="\t";s["%U"]=s["%W"]=s["%V"]=(wn<10)?("0"+wn):wn;s["%u"]=w+1;s["%w"]=w;s["%y"]=(""+y).slice(-2);s["%Y"]=y;s["%%"]="%";var re=/%./g;if(!Calendar.is_ie5&&!Calendar.is_khtml){return str.replace(re,function(par){return s[par]||par})}var a=str.match(re);for(var i=0;i<a.length;i++){var tmp=s[a[i]];if(tmp){re=new RegExp(a[i],"g");str=str.replace(re,tmp)}}return str};Date.prototype.__msh_oldSetFullYear=Date.prototype.setFullYear;Date.prototype.setFullYear=function(y){var d=new Date(this);d.__msh_oldSetFullYear(y);if(d.getMonth()!=this.getMonth()){this.setDate(28)}this.__msh_oldSetFullYear(y)};window._dynarch_popupCalendar=null;
/* module-key = 'jira.webresources:calendar', location = '/includes/lib/calendar/Calendar.setup.js' */
Calendar.setup=function(params){params=params||{};function param_default(pname,def){if(typeof params[pname]=="undefined"){params[pname]=def}}param_default("inputField",null);param_default("context",null);param_default("displayArea",null);param_default("button",null);param_default("eventName","click");param_default("ifFormat","%Y/%m/%d");param_default("daFormat","%Y/%m/%d");param_default("singleClick",true);param_default("disableFunc",null);param_default("dateStatusFunc",params["disableFunc"]);param_default("dateText",null);param_default("firstDay",null);param_default("align","Br");param_default("range",[1900,2999]);param_default("weekNumbers",true);param_default("useISO8601WeekNumbers",false);param_default("flat",null);param_default("flatCallback",null);param_default("onSelect",null);param_default("onClose",null);param_default("onUpdate",null);param_default("date",null);param_default("showsTime",false);param_default("timeFormat","24");param_default("electric",true);param_default("step",1);param_default("position",null);param_default("cache",false);param_default("showOthers",false);param_default("multiple",null);var i,item;var unwrap=["context","inputField","button","displayArea"];for(i in unwrap){item=unwrap[i];if(params[item] instanceof jQuery){params[item]=params[item][0]}}var tmp=["inputField","displayArea","button"];for(i in tmp){item=tmp[i];if(typeof params[item]==="string"){var escapedSelector="#"+params[item].escapejQuerySelector();var el=jQuery(params.context||document.body).find(escapedSelector);params[item]=el[0]}}if(!(params.flat||params.multiple||params.inputField||params.displayArea||params.button)){AJS.log("Calendar.setup:\n  Nothing to setup (no fields found).  Please check your code");return false}if(params.firstDay&&params.firstDay!==null){params.firstDay=+params.firstDay}function onSelect(cal){var p=cal.params;var update=(cal.dateClicked||p.electric);if(update&&p.inputField){p.inputField.value=cal.date.print(p.ifFormat);jQuery(p.inputField).change()}if(update&&p.displayArea){p.displayArea.innerHTML=cal.date.print(p.daFormat)}if(update&&typeof p.onUpdate=="function"){p.onUpdate(cal)}if(update&&p.flat){if(typeof p.flatCallback=="function"){p.flatCallback(cal)}}if(p.singleClick==="true"){p.singleClick=true}else{if(p.singleClick==="false"){p.singleClick=false}}if(update&&p.singleClick&&cal.dateClicked){cal.callCloseHandler()}}if(params.flat!=null){if(typeof params.flat=="string"){params.flat=document.getElementById(params.flat)}if(!params.flat){AJS.log("Calendar.setup:\n  Flat specified but can't find parent.");return false}var cal=new Calendar(params.firstDay,params.date,params.onSelect||onSelect);cal.showsOtherMonths=params.showOthers;cal.showsTime=params.showsTime;cal.time24=(params.timeFormat=="24");cal.params=params;cal.weekNumbers=params.weekNumbers;cal.setRange(params.range[0],params.range[1]);cal.setDateStatusHandler(params.dateStatusFunc);cal.getDateText=params.dateText;if(params.ifFormat){cal.setDateFormat(params.ifFormat)}if(params.inputField&&typeof params.inputField.value=="string"){cal.parseDate(params.inputField.value)}cal.create(params.flat);cal.show();return false}var triggerEl=params.button||params.displayArea||params.inputField;jQuery(triggerEl).bind(params.eventName,function(e){e.preventDefault();createCalendar()});if(params.inputField){enhanceInputField()}function createCalendar(){if(Calendar._UNSUPPORTED===true){alert("The JIRA Calendar does not currently support your language.");return }var dateEl=params.inputField||params.displayArea;var dateFmt=params.inputField?params.ifFormat:params.daFormat;var mustCreate=false;var cal=window.calendar;if(cal){cal.hide()}if(dateEl){if(dateEl.value||dateEl.innerHTML){params.date=Date.parseDate(dateEl.value||dateEl.innerHTML,dateFmt)}}if(!(cal&&params.cache)){window.calendar=cal=new Calendar(params.firstDay,params.date,params.onSelect||onSelect,params.onClose||function(cal){cal.hide()});cal.showsTime=params.showsTime;cal.time24=(params.timeFormat=="24");cal.weekNumbers=params.weekNumbers;Date.useISO8601WeekNumbers=params.useISO8601WeekNumbers;if(params.useISO8601WeekNumbers){cal.firstDayOfWeek=1}mustCreate=true}else{if(params.date){cal.setDate(params.date)}cal.hide()}if(params.multiple){cal.multiple={};for(var i=params.multiple.length;--i>=0;){var d=params.multiple[i];var ds=d.print("%Y%m%d");cal.multiple[ds]=d}}cal.showsOtherMonths=params.showOthers;cal.yearStep=params.step;cal.setRange(params.range[0],params.range[1]);cal.params=params;cal.setDateStatusHandler(params.dateStatusFunc);cal.getDateText=params.dateText;cal.setDateFormat(dateFmt);if(mustCreate){cal.create()}cal.refresh();if(!params.position){cal.showAtElement(params.button||params.displayArea||params.inputField,params.align)}else{cal.showAt(params.position[0],params.position[1])}return false}function enhanceInputField(){var $inputField=jQuery(params.inputField);if(params.button){jQuery(params.button).mousedown(function(e){e.preventDefault();if(!$inputField.is(":focus")&&$inputField.is(":enabled")){$inputField.focus()}})}$inputField.keydown(function(e){var cal=window.calendar;if(e.keyCode===40){if(!cal||cal.hidden){setTimeout(function(){createCalendar()},1)}}})}return cal};
/* module-key = 'jira.webresources:group-pickers', location = '/includes/jira/field/groupPickerUtil.js' */
JIRA.GroupPickerUtil={formatResponse:function(data){var ret=[];AJS.$(data).each(function(i,suggestions){var groupDescriptor=new AJS.GroupDescriptor({weight:i,label:suggestions.header});AJS.$(suggestions.groups).each(function(){groupDescriptor.addItem(new AJS.ItemDescriptor({value:this.name,label:this.name,html:this.html,highlighted:true}))});ret.push(groupDescriptor)});return ret}};
/* module-key = 'jira.webresources:group-pickers', location = '/includes/jira/field/initMultiGroupPickers.js' */
(function(){function initMultiGroupPickers(ctx){ctx.find(".js-default-multi-group-picker").each(function(){var $el=jQuery(this);new AJS.MultiSelect({element:this,itemAttrDisplayed:"label",showDropdownButton:false,ajaxOptions:{data:function(query){return{query:query,exclude:$el.val()}},url:contextPath+"/rest/api/2/groups/picker",query:true,formatResponse:JIRA.GroupPickerUtil.formatResponse}})})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){initMultiGroupPickers(context)}})})();
/* module-key = 'jira.webresources:user-pickers', location = '/includes/jira/field/userPickerUtil.js' */
(function($){JIRA.UserPickerUtil={formatResponse:function(data){var ret=[];$(data).each(function(i,suggestions){var groupDescriptor=new AJS.GroupDescriptor({weight:i,label:suggestions.footer});$(suggestions.users).each(function(){groupDescriptor.addItem(new AJS.ItemDescriptor({value:this.name,label:this.displayName,html:this.html,icon:this.avatarUrl,allowDuplicate:false,highlighted:true}))});ret.push(groupDescriptor)});return ret}}})(AJS.$);
/* module-key = 'jira.webresources:user-pickers', location = '/includes/jira/field/initSingleUserPickers.js' */
(function($){function createSingleUserPickers(ctx){var restPath="/rest/api/1.0/users/picker";$(".js-default-user-picker",ctx).each(function(){var $this=$(this);if($this.data("aui-ss")){return }var data={showAvatar:true},inputText=$this.data("inputValue");new AJS.SingleSelect({element:$this,submitInputVal:true,showDropdownButton:!!$this.data("show-dropdown-button"),errorMessage:AJS.format("There is no user \'\'{0}\'\'.","'{0}'"),ajaxOptions:{url:contextPath+restPath,query:true,data:data,formatResponse:JIRA.UserPickerUtil.formatResponse},inputText:inputText})})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){createSingleUserPickers(context)}})})(AJS.$);
/* module-key = 'jira.webresources:user-pickers', location = '/includes/jira/field/NoBrowseUserNamePicker.js' */
AJS.NoBrowseUserNamePicker=AJS.MultiSelect.extend({_getDefaultOptions:function(){return AJS.$.extend(true,this._super(),{errorMessage:"The requested user does not exist.",showDropdownButton:false,removeOnUnSelect:true,itemAttrDisplayed:"label"})},_handleCharacterInput:function(){},_setSuggestions:function(){},_handleServerError:function(smartAjaxResult){if(smartAjaxResult.status===404){this.showErrorMessage()}else{this._super()}},_deactivate:function(){this.validateAndAdd()},validateAndAdd:function(){var instance=this;if(AJS.$.trim(this.$field.val())===""){this.hideErrorMessage()}else{jQuery.ajax({url:contextPath+"/rest/api/2/user",data:{username:AJS.$.trim(instance.getQueryVal())},success:function(user){instance.hideErrorMessage();instance.$field.val("");instance.addItem(new AJS.ItemDescriptor({label:user.displayName,value:user.name}))},error:function(){instance.showErrorMessage()}})}},_handleSpace:function(){this.validate()},_handleServerSuggestions:function(){this.hideErrorMessage();this.handleFreeInput()},handleFreeInput:function(){var value=AJS.$.trim(this.$field.val());if(value!==""){this.addItem({value:value,label:value});this.model.$element.trigger("change")}this.$field.val("")},keys:{"Return":function(event){event.preventDefault();this.validateAndAdd()},"Spacebar":function(event){event.preventDefault();this.validateAndAdd()}}});
/* module-key = 'jira.webresources:user-pickers', location = '/includes/jira/field/initMultiUserPickers.js' */
(function(){function initMultiUserPicker(ctx){ctx.find(".js-default-multi-user-picker").each(function(){var $el=jQuery(this);if(AJS.params.currentUserCanBrowseUsers){new AJS.MultiSelect({element:this,itemAttrDisplayed:"label",showDropdownButton:false,removeOnUnSelect:true,submitInputVal:true,ajaxOptions:{url:contextPath+"/rest/api/1.0/users/picker",query:true,data:function(query){return{showAvatar:true,query:query,exclude:$el.val()}},formatResponse:JIRA.UserPickerUtil.formatResponse}})}else{new AJS.NoBrowseUserNamePicker({element:this})}})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){initMultiUserPicker(context)}})})();
/* module-key = 'jira.webresources:ie-imitation-placeholder', location = '/includes/jira/field/IEImitationPlaceholder.js' */
(function($){$.fn.ieImitationPlaceholder=function(){if($.browser.msie){var form=this,fields=form.find("[placeholder]");fields.focus(clearTextIfUnchanged);fields.blur(setTextFromPlaceholder);form.submit(clearAllIfUnchanged);fields.each(setTextFromPlaceholder);function setTextFromPlaceholder(){var field=$(this);if(field.val()===""){field.val(field.attr("placeholder"));field.addClass("input-placeholder")}}function clearTextIfUnchanged(){var field=$(this);if(field.val()===field.attr("placeholder")){field.val("");field.removeClass("input-placeholder")}}function clearAllIfUnchanged(){fields.each(clearTextIfUnchanged)}}}})(AJS.$);
/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/field-templates.soy' */
// This file was automatically generated from field-templates.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.Fields == 'undefined') { JIRA.Templates.Fields = {}; }


JIRA.Templates.Fields.username = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.escape) ? soy.$$escapeHtml(opt_data.displayName) : opt_data.displayName);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Fields.recipientUsername = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li data-username="', soy.$$escapeHtml(opt_data.username), '" title=', soy.$$escapeHtml(opt_data.username), '><span><span class="user-hover" rel="', soy.$$escapeHtml(opt_data.username), '"><img src="', soy.$$escapeHtml(opt_data.icon), '" title="');
  JIRA.Templates.Fields.username(opt_data, output);
  output.append('"><span title="');
  JIRA.Templates.Fields.username(opt_data, output);
  output.append('">');
  JIRA.Templates.Fields.username(opt_data, output);
  output.append('</span></span>', (! opt_data.readOnly) ? '<span class="remove-recipient item-delete"/>' : '', '</span></li>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Fields.recipientEmail = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li data-email="', soy.$$escapeHtml(opt_data.email), '" title=', soy.$$escapeHtml(opt_data.email), '><span><img src="', soy.$$escapeHtml(opt_data.icon), '" title="', soy.$$escapeHtml(opt_data.email), '"><span title="', soy.$$escapeHtml(opt_data.email), '">', soy.$$escapeHtml(opt_data.email), '</span><span class="remove-recipient item-delete"/></span></li>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/IssuePicker.js' */
define("jira/field/issue-picker",["jira/ajs/select/multi-select","jira/ajs/list/group-descriptor","jira/ajs/list/item-descriptor","jquery"],function(MultiSelect,GroupDescriptor,ItemDescriptor,jQuery){var IssuePicker=MultiSelect.extend({_formatResponse:function(response){var ret=[],canonicalBaseUrl=(function(){var uri=parseUri(window.location);return uri.protocol+"://"+uri.authority})();if(response&&response.sections){jQuery(response.sections).each(function(i,section){var groupDescriptor=new GroupDescriptor({weight:i,label:section.label,description:section.sub});if(section.issues&&section.issues.length>0){jQuery(section.issues).each(function(){groupDescriptor.addItem(new ItemDescriptor({highlighted:true,value:this.key,label:this.key+" - "+this.summaryText,icon:this.img?canonicalBaseUrl+contextPath+this.img:null,html:this.keyHtml+" - "+this.summary}))})}ret.push(groupDescriptor)})}return ret},_getDefaultOptions:function(){return jQuery.extend(true,this._super(),{ajaxOptions:{formatResponse:this._formatResponse}})},_launchPopup:function(){function getWithDefault(value,def){if(typeof value=="undefined"||value==null){return def}else{return value}}var url,urlParam,vWinUsers,options,instance=this;IssuePicker.callback=function(items){if(typeof items==="string"){items=JSON.parse(items)}instance._addMultipleItems(items,true);instance.$field.focus()};options=this.options.ajaxOptions.data;url=contextPath+"/secure/popups/IssuePicker.jspa?";urlParam={singleSelectOnly:"false",decorator:"popup",currentIssue:options.currentIssueKey||"",showSubTasks:getWithDefault(options.showSubTasks,false),showSubTasksParent:getWithDefault(options.showSubTaskParent,false)};if(options.currentProjectId){urlParam["currentProjectId"]=options.currentProjectId}url+=jQuery.param(urlParam);vWinUsers=window.open(url,"IssueSelectorPopup","status=no,resizable=yes,top=100,left=200,width="+this.options.popupWidth+",height="+this.options.popupHeight+",scrollbars=yes,resizable");vWinUsers.opener=self;vWinUsers.focus()},_createFurniture:function(disabled){var $popupLink;this._super(disabled);$popupLink=this._render("popupLink");this._assignEvents("popupLink",$popupLink);this.$container.addClass("jira-issue-picker");this.$container.addClass("hasIcon");this.$container.after($popupLink)},handleFreeInput:function(){var values=this.$field.val().toUpperCase().match(/\S+/g);if(values){this._addMultipleItems(jQuery.map(values,function(value){return{value:value,label:value}}))}this.$field.val("")},_events:{popupLink:{click:function(e){this._launchPopup();e.preventDefault()}}},_renders:{popupLink:function(){return jQuery("<a class='issue-picker-popup' />").attr({href:"#",title:this.options.popupLinkMessage}).text(""+this.options.popupLinkMessage+"")}}});IssuePicker.callback=null;return IssuePicker});AJS.namespace("jira.issuepicker",null,require("jira/field/issue-picker"));AJS.namespace("AJS.IssuePicker",null,require("jira/field/issue-picker"));AJS.namespace("JIRA.IssuePicker",null,require("jira/field/issue-picker"));
/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/LabelPicker.js' */
define("jira/field/label-picker",["jira/ajs/select/multi-select","jira/ajs/list/group-descriptor","jira/ajs/list/item-descriptor","jquery"],function(MultiSelect,GroupDescriptor,ItemDescriptor,jQuery){return MultiSelect.extend({_getDefaultOptions:function(){return jQuery.extend(true,this._super(),{ajaxOptions:{url:contextPath+"/includes/js/ajs/layer/labeldata.js",query:true,formatResponse:this._formatResponse},removeDuplicates:true,removeOnUnSelect:true,userEnteredOptionsMsg:"New Label"})},isValidItem:function(itemValue){return !/\s/.test(itemValue)},_handleServerSuggestions:function(data){if(data&&data.token){if(jQuery.trim(this.$field.val())!==data.token){return }}this._super(data)},_handleSpace:function(){if(jQuery.trim(this.$field.val())!==""){if(this.handleFreeInput()){this.hideSuggestions()}}},keys:{"Spacebar":function(event){this._handleSpace();event.preventDefault()}},_formatResponse:function(data){var optgroup=new GroupDescriptor({label:"Suggestions",type:"optgroup",styleClass:"labels-suggested"});if(data&&data.suggestions){jQuery.each(data.suggestions,function(){optgroup.addItem(new ItemDescriptor({value:this.label,label:this.label,html:this.html,highlighted:true}))})}return[optgroup]},handleFreeInput:function(){var values=jQuery.trim(this.$field.val()).match(/\S+/g);if(values){for(var value,i=0;value=values[i];i++){this.addItem({value:value,label:value})}this.model.$element.trigger("change")}this.$field.val("")}})});AJS.namespace("AJS.LabelPicker",null,require("jira/field/label-picker"));AJS.namespace("JIRA.LabelPicker",null,require("jira/field/label-picker"));
/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/MultiUserListPicker.js' */
(function($){JIRA.MultiUserListPicker=AJS.MultiSelect.extend({init:function(options){var restPath="/rest/api/1.0/users/picker";function formatResponse(response){var ret=[];$(response).each(function(i,suggestions){var groupDescriptor=new AJS.GroupDescriptor({weight:i,label:suggestions.footer});$(suggestions.users).each(function(){groupDescriptor.addItem(new AJS.ItemDescriptor({value:this.name,label:this.displayName,html:this.html,icon:this.avatarUrl,allowDuplicate:false,highlighted:true}))});ret.push(groupDescriptor)});return ret}$.extend(options,{itemAttrDisplayed:"label",userEnteredOptionsMsg:"Email address",showDropdownButton:false,removeOnUnSelect:true,ajaxOptions:{url:contextPath+restPath,query:true,data:{showAvatar:true},formatResponse:formatResponse},suggestionsHandler:AJS.UserListSuggestHandler,itemGroup:new AJS.Group(),itemBuilder:function(descriptor){return new JIRA.MultiUserListPicker.Item({descriptor:descriptor,container:this.$selectedItemsContainer})}});this._super(options)},_createFurniture:function(disabled){this._super(disabled);if(this.options.description){this._render("description",this.options.description).insertAfter(this.$field)}},updateItemsIndent:$.noop,_renders:{selectedItemsWrapper:function(){return $('<div class="recipients"></div>')},selectedItemsContainer:function(){return $("<ol />")},description:function(description){return $("<div />").addClass("description").text(description)}}})}(AJS.$));
/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/MultiUserListPicker.Item.js' */
JIRA.MultiUserListPicker.Item=AJS.Control.extend({init:function(options){this._setOptions(options);this.$lozenge=this._render("item");this.$removeButton=this.$lozenge.find(".remove-recipient");this._assignEvents("instance",this);this._assignEvents("lozenge",this.$lozenge);this._assignEvents("removeButton",this.$removeButton);this.$lozenge.prependTo(this.options.container)},_getDefaultOptions:function(){return{label:null,title:null,container:null,focusClass:"focused"}},_renders:{"item":function(){var descriptor=this.options.descriptor;var data;if(descriptor.noExactMatch()!==true){data={escape:false,username:descriptor.value(),icon:descriptor.icon(),displayName:AJS.escapeHtml(descriptor.label())};return AJS.$(JIRA.Templates.Fields.recipientUsername(data))}else{data={email:descriptor.value(),icon:AJS.Meta.get("default-avatar-url")};return AJS.$(JIRA.Templates.Fields.recipientEmail(data))}}},_events:{"instance":{"remove":function(){this.$lozenge.remove()}},"removeButton":{"click":function(e){e.stopPropagation();this.trigger("remove")}}}});
/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initCascadingSelects.js' */
(function(){function initCascadingSelect(el){AJS.$(el||document.body).find("div.aui-field-cascadingselect").add("tr.aui-field-cascadingselect").add("td.aui-field-cascadingselect").each(function(){var $container=AJS.$(this),parent=$container.find(".cascadingselect-parent"),parentOptions=parent.find("option"),oldClass="",child=$container.find(".cascadingselect-child"),childOptions=child.find("option"),selectedChild=child.find(":selected");function update(){var placeholder,currentClass=parent.find("option:selected").attr("class");if(currentClass!==oldClass){placeholder=jQuery("<span />").insertAfter(child);child.detach();child.find("option").each(function(i,elem){elem.parentNode.removeChild(this)});child.insertAfter(placeholder);placeholder.remove();childOptions.filter("."+parent.find("option:selected").attr("class")).appendTo(child);if(selectedChild.hasClass(parent.find("option:selected").attr("class"))){child.val(selectedChild.val())}else{child.val(child.find("option:first").val())}oldClass=currentClass}}parent.bind("cascadingSelectChanged",update).change(function(){AJS.$(this).trigger("cascadingSelectChanged")}).trigger("cascadingSelectChanged")})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){initCascadingSelect(context)}})})();
/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initComponentPickers.js' */
(function(){JIRA.ComponentPicker=AJS.MultiSelect.extend({init:function(options){this._super(options);this.suggestionsHandler=new AJS.OnlyNewItemsSuggestHandler(this.options,this.model)},_getDefaultOptions:function(opts){var canCreate=false;if(opts&&opts.element){canCreate=AJS.$(opts.element).data("create-permission")}if(canCreate){return AJS.$.extend(true,this._super(),{userEnteredOptionsMsg:"New Component"})}else{return this._super(opts)}},_selectionHandler:function(selected,e){var allExistingDescriptors=this.model.getDisplayableSelectedDescriptors().concat(this.model.getDisplayableUnSelectedDescriptors());var selectedDescriptor=selected.data("descriptor");var existingDescriptor=_.find(allExistingDescriptors,function(descriptor){return descriptor.label()===selectedDescriptor.label()});if(!existingDescriptor){selectedDescriptor.properties.value="nv_"+selectedDescriptor.value();JIRA.trigger("Issue.Component.new.selected",[selectedDescriptor.value()])}this._super(selected,e)}});function createPicker($selectField){new JIRA.ComponentPicker({element:$selectField,itemAttrDisplayed:"label",errorMessage:"{0} is not a valid component.",maxInlineResultsDisplayed:15,expandAllResults:true})}function locateSelect(parent){var $parent=AJS.$(parent),$selectField;if($parent.is("select")){$selectField=$parent}else{$selectField=$parent.find("select")}return $selectField}var DEFAULT_SELECTORS=["div.aui-field-componentspicker.frother-control-renderer","td.aui-field-componentspicker.frother-control-renderer","tr.aui-field-componentspicker.frother-control-renderer"];function findComponentSelectAndConvertToPicker(context,selector){selector=selector||DEFAULT_SELECTORS.join(", ");AJS.$(selector,context).each(function(){var $selectField=locateSelect(this);if($selectField.length){createPicker($selectField)}})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){findComponentSelectAndConvertToPicker(context)}})})();
/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initMultiselectPickers.js' */
(function(){function createPicker($selectField){new AJS.MultiSelect({element:$selectField,itemAttrDisplayed:"label",errorMessage:"{0} is not a valid value.",maxInlineResultsDisplayed:15,submitInputVal:true,expandAllResults:true})}function locateSelect(parent){var $parent=AJS.$(parent),$selectField;if($parent.is("select")){$selectField=$parent}else{$selectField=$parent.find("select")}return $selectField}var DEFAULT_SELECTORS=["div.aui-field-multiselectpicker.frother-control-renderer"];function findComponentSelectAndConvertToPicker(context,selector){selector=selector||DEFAULT_SELECTORS.join(", ");AJS.$(selector,context).each(function(){var $selectField=locateSelect(this);if($selectField.length){createPicker($selectField)}})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){findComponentSelectAndConvertToPicker(context)}})})();
/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initDatePickers.js' */
(function(){function initDatePicker(el){AJS.$(el||document.body).find("div.aui-field-datepicker").add("tr.aui-field-datepicker").add("td.aui-field-datepicker").each(function(){var $container=AJS.$(this),field=$container.find("input:text"),defaultCheckbox=$container.find("#useCurrentDate"),params=JIRA.parseOptionsFromFieldset($container.find("fieldset.datepicker-params"));params.context=el;Calendar.setup(params);function toggleField(){field.prop("disabled",defaultCheckbox.is(":checked"))}if(defaultCheckbox.length){toggleField();defaultCheckbox.click(toggleField)}})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){initDatePicker(context)}})})();
/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initLegacyGroupPickers.js' */
(function(){function initLegacyGroupPicker(el){AJS.$(el||document.body).find("div.aui-field-grouppicker").add("tr.aui-field-grouppicker").add("td.aui-field-grouppicker").each(function(){var $container=AJS.$(this),trigger=$container.find("a.grouppicker-trigger"),url=trigger.attr("href");function openGroupPickerWindow(e){e.preventDefault();window.open(url,"GroupPicker","status=yes,resizable=yes,top=100,left=100,width=800,height=750,scrollbars=yes")}trigger.click(openGroupPickerWindow)})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){initLegacyGroupPicker(context)}})})();
/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initIssuePickers.js' */
(function(){var IssuePicker=require("jira/field/issue-picker");var Events=require("jira/util/events");var Types=require("jira/util/events/types");var Reasons=require("jira/util/events/reasons");var $=require("jquery");function initIssuePicker(el){$(el||document.body).find(".aui-field-issuepicker").each(function(){new IssuePicker({element:$(this),userEnteredOptionsMsg:"Enter issue key",uppercaseUserEnteredOnSelect:true})})}Events.bind(Types.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==Reasons.panelRefreshed){initIssuePicker(context)}})})();
/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initLabelPickers.js' */
define("jira/field/label-picker-factory",["jira/field/label-picker","jira/data/parse-options-from-fieldset","jquery","exports"],function(LabelPicker,parseOptionsFromFieldset,$,exports){exports.createPicker=function($fieldset,context){var opts=parseOptionsFromFieldset($fieldset),$select=$("#"+opts.id,context),issueId=opts.issueId,data={};if(/customfield_\d/.test(opts.id)){data.customFieldId=parseInt(opts.id.replace("customfield_",""),10)}new LabelPicker({element:$select,ajaxOptions:{url:contextPath+"/rest/api/1.0/labels"+(issueId?"/"+issueId:"")+"/suggest",data:data}})}});(function(){var LabelPickerFactory=require("jira/field/label-picker-factory");var Events=require("jira/util/events");var Types=require("jira/util/events/types");var Reasons=require("jira/util/events/reasons");var $=require("jquery");var FIELDSET_SELECTOR="fieldset.labelpicker-params";function locateFieldset(parent){var $parent=$(parent),$fieldset;if($parent.is(FIELDSET_SELECTOR)){$fieldset=$parent}else{$fieldset=$parent.find(FIELDSET_SELECTOR)}return $fieldset}function findLabelsFieldsetAndConvertToPicker(context,selector){selector=selector||".aui-field-labelpicker";$(selector,context).each(function(){var $fieldset=locateFieldset(this);if($fieldset.length>0){LabelPickerFactory.createPicker($fieldset,context)}})}Events.bind(Types.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==Reasons.panelRefreshed){findLabelsFieldsetAndConvertToPicker(context)}})})();
/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initVersionPickers.js' */
(function(){JIRA.VersionPicker=AJS.MultiSelect.extend({init:function(options){this._super(options);this.suggestionsHandler=new AJS.OnlyNewItemsSuggestHandler(this.options,this.model)},_getDefaultOptions:function(opts){var canCreate=false;if(opts&&opts.element){canCreate=AJS.$(opts.element).data("create-permission")}if(canCreate){return AJS.$.extend(true,this._super(),{userEnteredOptionsMsg:"New Version"})}else{return this._super(opts)}},_selectionHandler:function(selected,e){var allExistingVersionDescriptors=this.model.getDisplayableSelectedDescriptors().concat(this.model.getDisplayableUnSelectedDescriptors());var selectedDescriptor=selected.data("descriptor");var existingVersion=_.find(allExistingVersionDescriptors,function(descriptor){return descriptor.label()===selectedDescriptor.label()});if(!existingVersion){selectedDescriptor.properties.value="nv_"+selectedDescriptor.value();JIRA.trigger("Issue.Version.new.selected",[selectedDescriptor.value()])}this._super(selected,e)}});function createPicker($selectField){new JIRA.VersionPicker({element:$selectField,itemAttrDisplayed:"label",removeOnUnSelect:false,submitInputVal:true,errorMessage:"{0} is not a valid version.",maxInlineResultsDisplayed:15,expandAllResults:true})}function locateSelect(parent){var $parent=AJS.$(parent),$selectField;if($parent.is("select")){$selectField=$parent}else{$selectField=$parent.find("select")}return $selectField}function findVersionSelectAndConvertToPicker(context,selector){selector=selector||".aui-field-versionspicker.frother-control-renderer";AJS.$(selector,context).each(function(){var $selectField=locateSelect(this);if($selectField.length){createPicker($selectField)}})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){findVersionSelectAndConvertToPicker(context)}})})();
/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initCommentControls.js' */
(function($){function applyCommentControls($contexts){if($contexts.attr("id")==="addcomment"){$contexts=$contexts.find("#issue-comment-add")}$contexts.each(function(){var $context=$(this);var $commentLevel=$context.find("#commentLevel");if($commentLevel.length>0){new AJS.SecurityLevelSelect($commentLevel)}$context.find(".wiki-js-prefs").each(function(){JIRA.wikiPreview(this,$context).init()})})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context){applyCommentControls(context)})})(AJS.$);
/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/ProjectIssueTypeSelect.js' */
JIRA.ProjectIssueTypeSelect=Class.extend({init:function(options){var val,instance=this;this.$project=options.project;this.backgroundImages=this.removeBackgroundImages(options.issueTypeSelect);this.$refIssueTypeSelect=jQuery(options.issueTypeSelect).clone(true,true);this.$issueTypeSelect=options.issueTypeSelect;this.$projectIssueTypesSchemes=options.projectIssueTypesSchemes;this.$issueTypeSchemeIssueDefaults=options.issueTypeSchemeIssueDefaults;this.projectIssueTypeSchemes=this.getProjectIssueTypeSchemesFromDom();this.issueTypesSchemeDefaults=this.getIssueTypeSchemeIssueDefaults();if(instance.$project.length>0){val=instance.$project.val();instance.setIssueTypeScheme(instance.getIssueTypeSchemeForProject(val));if(this.$project.is("select")){this.$project.change(function(){var val=instance.$project.val();instance.lastIssueType=instance.$issueTypeSelect.find(":selected:first").val();instance.$refIssueTypeSelect.val("");instance.setIssueTypeScheme(instance.getIssueTypeSchemeForProject(val));instance.$issueTypeSelect.trigger("reset")})}}},getIssueTypeSchemeForProject:function(projectId){return this.projectIssueTypeSchemes[projectId]},getDefaultIssueTypeForScheme:function(issueTypeSchemeId){return this.issueTypesSchemeDefaults[issueTypeSchemeId]},removeBackgroundImages:function(issueTypeSelect){var map={};jQuery(issueTypeSelect).find("option[style]").each(function(){map[jQuery(this).attr("id")]=jQuery(this).css("background-image");jQuery(this).attr("style","");jQuery(this).removeAttr("style")});return map},addBackgroundImages:function(){var that=this;this.$issueTypeSelect.find("option").each(function(){jQuery(this).css("background-image",that.backgroundImages[jQuery(this).attr("id")])})},setIssueTypeScheme:function(issueTypeSchemeId){var selectedIssueType,instance=this,$toSelect,$placeholder=jQuery("<span class='hidden' />"),$optgroups=this.$refIssueTypeSelect.find("optgroup");$placeholder.insertAfter(this.$issueTypeSelect);this.$issueTypeSelect.detach().empty();if($optgroups.length){$optgroups.each(function(){var $optgroup=jQuery(this);if($optgroup.is("[data-scheme-id='"+issueTypeSchemeId+"']")){instance.$issueTypeSelect.append($optgroup.clone(true).children());return false}})}else{this.$issueTypeSelect.append(this.$refIssueTypeSelect.children())}selectedIssueType=this.$issueTypeSelect.find("option[data-selected]").val()||"";if(instance.lastIssueType){$toSelect=this.$issueTypeSelect.find("option[value='"+instance.lastIssueType+"']")}else{if(selectedIssueType){$toSelect=this.$issueTypeSelect.find("option[value='"+selectedIssueType+"']")}}if($toSelect&&$toSelect.length!==0){$toSelect.attr("selected","selected");this.$issueTypeSelect.val($toSelect.val())}else{this.setDefaultIssueType(issueTypeSchemeId)}this.$issueTypeSelect.insertAfter($placeholder);this.addBackgroundImages();this.$issueTypeSelect.attr("data-project",this.$project.val());$placeholder.remove()},setDefaultIssueType:function(issueTypeSchemeId){var defaultIssueType=this.getDefaultIssueTypeForScheme(issueTypeSchemeId);if(defaultIssueType!==""){this.$issueTypeSelect.find("option[value='"+defaultIssueType+"']").attr("selected","selected")}else{this.$issueTypeSelect.find("option").each(function(i,option){if(this.value&&this.value!==""){jQuery(option).attr("selected","selected");return false}})}},getProjectIssueTypeSchemesFromDom:function(){var projectIssueTypes={};this.$projectIssueTypesSchemes.find("input").each(function(i,input){var $input=jQuery(input),project=$input.attr("title"),issueTypes=$input.val();projectIssueTypes[project]=issueTypes});return projectIssueTypes},getIssueTypeSchemeIssueDefaults:function(){var issueTypesSchemeDefaults={};this.$issueTypeSchemeIssueDefaults.find("input").each(function(i,input){var $input=jQuery(input),issueTypeScheme=$input.attr("title"),defaultIssueType=$input.val();issueTypesSchemeDefaults[issueTypeScheme]=defaultIssueType});return issueTypesSchemeDefaults}});
/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initProjectIssueTypeSelect.js' */
(function(){function findProjectAndIssueTypeSelectAndConvertToPicker(ctx){var $ctx=ctx||jQuery("body"),$project=$ctx.find(".project-field, .project-field-readonly"),$issueTypeSelect=$ctx.find(".issuetype-field"),$projectIssueTypes=$ctx.find(".project-issue-types"),$defaultProjectIssueTypes=$ctx.find(".default-project-issue-type");$project.each(function(i){new JIRA.ProjectIssueTypeSelect({project:jQuery(this),issueTypeSelect:$issueTypeSelect.eq(i),projectIssueTypesSchemes:$projectIssueTypes.eq(i),issueTypeSchemeIssueDefaults:$defaultProjectIssueTypes.eq(i)})})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){findProjectAndIssueTypeSelectAndConvertToPicker(context)}})})();
/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initIssueTypePickers.js' */
(function(){function createissueTypePicker(context){context.find(".issuetype-field").each(function(){var $select=jQuery(this);$select.bind("reset",function(){$select.find("option[value='']").remove()}).trigger("reset");new AJS.SingleSelect({element:this,revertOnInvalid:true})})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){createissueTypePicker(context)}})})();
/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initProjectPickers.js' */
(function(){function createProjectPicker(context){context.find(".project-field").each(function(){new AJS.SingleSelect({element:this,revertOnInvalid:true})})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){createProjectPicker(context)}})})();
/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initLogWorkControls.js' */
(function($){JIRA.Events.VALIDATE_TIMETRACKING="validateTimeTracking";function toggleTimeTrackingContainer(context,activate){var $logWorkContainer=$(context).find("#worklog-logworkcontainer"),$timeTrackingContainer=$(context).find("#worklog-timetrackingcontainer"),$logWorkCheckbox=$(context).find("#log-work-activate");if(activate){$logWorkContainer.removeClass("hidden");$timeTrackingContainer.addClass("hidden");$logWorkCheckbox.prop("checked",true)}else{$logWorkContainer.addClass("hidden");$timeTrackingContainer.removeClass("hidden");$logWorkCheckbox.prop("checked",false)}}function applyLogworkControls(context){$("#log-work-adjust-estimate-new-value, #log-work-adjust-estimate-manual-value",context).attr("disabled","disabled");$("#log-work-adjust-estimate-"+$("input[name=worklog_adjustEstimate]:checked,input[name=adjustEstimate]:checked",context).val()+"-value",context).removeAttr("disabled");$("input[name=worklog_adjustEstimate],input[name=adjustEstimate]",context).change(function(){$("#log-work-adjust-estimate-new-value,#log-work-adjust-estimate-manual-value",context).attr("disabled","disabled");$("#log-work-adjust-estimate-"+$(this).val()+"-value",context).removeAttr("disabled")});$("#delete-log-work-adjust-estimate-new-value").change(function(){$("#delete-log-work-adjust-estimate-new").prop("checked",true)});$("#delete-log-work-adjust-estimate-manual-value").change(function(){$("#delete-log-work-adjust-estimate-manual").prop("checked",true)});$(context).find("#log-work-activate").change(function(){toggleTimeTrackingContainer(context,$(this).is(":checked"))})}JIRA.bind(JIRA.Events.VALIDATE_TIMETRACKING,function(e,context){toggleTimeTrackingContainer(context,true)});JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){applyLogworkControls(context)}})})(AJS.$);
/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initPriorityPickers.js' */
(function($){function createPriorityPicker(context){context.find("select#priority").each(function(i,el){new AJS.SingleSelect({element:el,revertOnInvalid:true})})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){createPriorityPicker(context)}})})(AJS.$);
/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initInlineAttach.js' */
(function(){var Events=require("jira/util/events");var Types=require("jira/util/events/types");var Reasons=require("jira/util/events/reasons");require("jira/jquery/plugins/attachment/inline-attach");function createInlineAttach(context){context.find("input[type=file]:not('.ignore-inline-attach')").inlineAttach()}Events.bind(Types.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==Reasons.panelRefreshed){createInlineAttach(context)}})})();
/* module-key = 'com.atlassian.jira.jira-quick-edit-plugin:quick-form', location = 'js/QuickForm/namespace.js' */
jQuery.namespace("JIRA.Forms");
/* module-key = 'com.atlassian.jira.jira-quick-edit-plugin:quick-form', location = 'js/QuickForm/util.js' */
Class.prototype.triggerEvent=function(C,A,B){jQuery(this).trigger(C,A);
if(B&&this.globalEventNamespaces){jQuery.each(this.globalEventNamespaces,function(E,D){jQuery(AJS).trigger(D+"."+C,A)
})
}return this
};
Class.prototype.bind=function(A,B){jQuery(this).bind(A,B);
return this
};
JIRA.makePropertyFunc=function(A){if(jQuery.isFunction(A)){return A
}else{return function(){return A
}
}};
JIRA.Dialog.getAttrFromActiveTrigger=function(B){var C=JIRA.Dialog.current,A=C.$activeTrigger;
if(A){return A.attr(B)
}};
JIRA.Dialog.getIssueActionTitle=function(B){var A=JIRA.Dialog.getActionIssueKey();
if(!A){return B
}return B+" : "+A
};
JIRA.Dialog.getActionIssueKey=function(){var A=JIRA.Dialog.getAttrFromActiveTrigger("data-issueKey");
if(!A&&JIRA.Issue){A=JIRA.Issue.getIssueKey()
}if(!A&&JIRA.IssueNavigator){A=JIRA.IssueNavigator.getSelectedIssueKey()
}if(!A&&JIRA.Issues){A=JIRA.Issues.Api.getSelectedIssueKey()
}return A
};
JIRA.activateTabWithChild=function(E){var C,B,A,D=E.closest(".tabs-pane");
if(D.length){B=D.closest(".aui-tabs");
C=D.attr("id");
A=B.find("a[href='#"+C+"']");
A.click()
}};
JIRA.applyErrorsToForm=function(C,D){var B,A=[];
jQuery.each(D,function(F,I){var H,E,G=C.find(":input[name='"+F+"']").last();
if(G.length===1){if(!B){B=G
}E=jQuery("<div class='error' />").attr("data-field",F).text(I);
H=G.closest(".field-group, .group");
H.find(".error").remove();
H.append(E)
}else{if(G.length===0){A.push(I)
}}});
if(A.length>0){JIRA.applyErrorMessageToForm(C,JIRA.Templates.Issue.undealtErrors({errors:A}))
}JIRA.activateTabWithChild(C.find(".error:first"));
if(B){B.focus()
}};
JIRA.extractScripts=function(B){var A=jQuery(B);
return{html:A.not("script"),scripts:A.filter("script")}
};
JIRA.applyMessageToForm=function(A,C,B,E){var D=C.find(".aui-message-context");
if(!D.length){D=jQuery("<div class='aui-message-context' />");
if(JIRA.useLegacyDecorator()){D.prependTo(C.find(".content-body"))
}else{D.prependTo(C.find(".form-body"))
}}D.empty();
AJS.messages[A](D,{shadowed:false,closeable:E,body:B})
};
JIRA.useLegacyDecorator=function(){return !JIRA.Version.isGreaterThanOrEqualTo("5.0")
};
JIRA.applyErrorMessageToForm=function(B,A){return JIRA.applyMessageToForm("error",B,A,false)
};
JIRA.applySuccessMessageToForm=function(B,A){return JIRA.applyMessageToForm("success",B,A,true)
};
/* module-key = 'com.atlassian.jira.jira-quick-edit-plugin:quick-form', location = 'js/QuickForm/model.js' */
JIRA.Forms.Model=Class.extend({init:function(A){this.userFieldsResource=A.userFieldsResource;
this.fieldsResource=A.fieldsResource;
this.retainedFields=[];
this._hasRetainFeature=false;
this._hasVisibilityFeature=true
},getFieldsResource:function(){return this.fieldsResource
},getAtlToken:function(){return this.atlToken
},getFormToken:function(){return this.formToken
},getActiveFieldIds:function(){return this.getUserFields()
},addFieldToRetainValue:function(A){if(this._hasRetainFeature){this.removeFieldToRetainValue(A);
this.retainedFields.push(A)
}else{throw new Error("getFieldsWithRetainedValues: cannot be called. Must enable retain feature first by specifiying [_hasRetainFeature=true]")
}},clearRetainedFields:function(){this.retainedFields=[]
},removeFieldToRetainValue:function(B){if(this._hasRetainFeature){var A=jQuery.inArray(B,this.retainedFields);
if(A!=-1){this.retainedFields.splice(A,1)
}}else{throw new Error("getFieldsWithRetainedValues: cannot be called. Must enable retain feature first by specifiying [_hasRetainFeature=true]")
}},getFieldsWithRetainedValues:function(){if(this._hasRetainFeature){return this.retainedFields
}else{throw new Error("getFieldsWithRetainedValues: cannot be called. Must enable retain feature first by specifiying [_hasRetainFeature=true]")
}},hasRetainedValue:function(A){if(this._hasRetainFeature){return jQuery.inArray(A.id,this.retainedFields)!==-1
}else{throw new Error("HasRetainedValue: cannot be called. Must enable retain feature first by specifiying [_hasRetainFeature=true]")
}},refresh:function(C){var A=this,B=jQuery.Deferred(),D;
if(C){D=C+"&retainValues=true"
}JIRA.SmartAjax.makeRequest({url:this.getFieldsResource(),type:"POST",data:D,success:function(E){A.atlToken=E.atl_token;
A.formToken=E.formToken;
A.fields=E.fields;
A.sortedTabs=E.sortedTabs;
A.userPreferences=E.userPreferences
},complete:function(F,G,E){if(E.successful){B.resolveWith(A,arguments)
}else{A.triggerEvent("serverError",[E]);
B.rejectWith(A,[E])
}}});
return B.promise()
},setFields:function(A){this.fields=A
},getConfigurableFields:function(){return this.getFields()
},getFields:function(){var A=this,B=jQuery.Deferred();
if(!this.fields){this.refresh().done(function(){B.resolve(A.fields)
})
}else{B.resolve(A.fields)
}return B.promise()
},_mungeTabs:function(B){var A=0,C=[];
jQuery.each(B,function(D,E){A++;
if(E.tab){if(!C[E.tab.position]){C[E.tab.position]=AJS.copyObject(E.tab)
}if(E.tab.position===0){C[E.tab.position].isFirst=true
}if(!C[E.tab.position].fields){C[E.tab.position].fields=[]
}C[E.tab.position].fields.push(AJS.copyObject(E))
}});
return C
},getTabs:function(){var A=this,B=jQuery.Deferred();
this.getFields().done(function(C){var D=A._mungeTabs(C);
B.resolve(D)
});
return B.promise()
},getSortedTabs:function(){var A=jQuery.Deferred();
if(!this.sortedTabs){this.refresh().done(function(){A.resolve(this.sortedTabs)
})
}else{A.resolve(this.sortedTabs)
}return A.promise()
},getUserFields:function(){var A=this,B=jQuery.Deferred();
if(!this.userPreferences){this.refresh().done(function(){B.resolve(A.userPreferences.fields)
})
}else{B.resolve(A.userPreferences.fields)
}return B.promise()
},setUserFields:function(A){var B={};
B.fields=A;
return this.updateUserPrefs(B)
},hasRetainFeature:function(){return !!this._hasRetainFeature
},hasVisibilityFeature:function(){return !!this._hasVisibilityFeature
},getUseConfigurableForm:function(){var A=this,B=jQuery.Deferred();
if(!this.userPreferences){this.refresh().done(function(){B.resolve(A.userPreferences.useQuickForm)
}).fail(function(){B.reject()
})
}else{B.resolve(A.userPreferences.useQuickForm)
}return B.promise()
},setUseConfigurableForm:function(A){var B={};
B.useQuickForm=A;
return this.updateUserPrefs(B)
},updateUserPrefs:function(C){var B=jQuery.Deferred(),A=this;
if(AJS.Meta.get("remote-user")===""){B.done();
return B.promise()
}if(!this.userPreferences){console.log("JIRA.Forms.Model: Cannot update user preferences if there are none to update");
B.reject();
return B.promise()
}if(!C.fields){C.fields=this.userPreferences.fields
}if(typeof C.showWelcomeScreen==="undefined"){C.showWelcomeScreen=this.userPreferences.showWelcomeScreen
}if(typeof C.useQuickForm==="undefined"){C.useQuickForm=this.userPreferences.useQuickForm
}return JIRA.SmartAjax.makeRequest({url:this.userFieldsResource,type:"POST",data:JSON.stringify(C),dataType:"json",contentType:"application/json",complete:function(E,F,D){if(D.successful){A.userPreferences=C
}else{A.triggerEvent("serverError",[D])
}}})
}});
/* module-key = 'com.atlassian.jira.jira-quick-edit-plugin:quick-form', location = 'js/QuickForm/quickform.soy' */
// This file was automatically generated from quickform.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.QuickForm == 'undefined') { JIRA.Templates.QuickForm = {}; }


JIRA.Templates.QuickForm.field = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append(opt_data.editHtml);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.QuickForm.fieldPicker = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="qf-picker"><div class="qf-picker-header"><dl><dt>', soy.$$escapeHtml("Show Fields:"), '</dt>', (opt_data.isConfigurable) ? '<dd><a class="qf-unconfigurable" href="#">' + soy.$$escapeHtml("All") + '</a></dd><dd>' + soy.$$escapeHtml("Custom") + '</dd>' : '<dd>' + soy.$$escapeHtml("All") + '</dd><dd><a class="qf-configurable" href="#">' + soy.$$escapeHtml("Custom") + '</a></dd>', '</dl></div><div class="qf-picker-content ', (! opt_data.isConfigurable) ? 'qf-picker-unconfigurable' : '', '"></div><div class="qf-picker-footer"></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.QuickForm.configurablePickerButton = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a title="', soy.$$escapeHtml(opt_data.label), '" data-field-id="', soy.$$escapeHtml(opt_data.fieldId), '" class="qf-picker-button', (opt_data.isActive) ? ' qf-active' : '', '" href="#">', soy.$$escapeHtml(opt_data.label), (opt_data.required) ? '<span class="aui-icon icon-required"></span>' : '', '</a>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.QuickForm.unconfigurablePickerButton = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<span title="', soy.$$escapeHtml(opt_data.label), '" data-field-id="', soy.$$escapeHtml(opt_data.fieldId), '" class="qf-picker-button', (opt_data.isActive) ? ' qf-active' : '', '" href="#">', soy.$$escapeHtml(opt_data.label), (opt_data.required) ? '<span class="aui-icon icon-required"></span>' : '', '</span>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.QuickForm.errorMessage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-message error"><span class="aui-icon icon-error"></span>', soy.$$escapeHtml(opt_data.message), '</div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-quick-edit-plugin:quick-form', location = 'js/QuickForm/field.js' */
JIRA.Forms.ConfigurableField=AJS.Control.extend({init:function(A){this.descriptor=A;
this.$element=jQuery("<div />").attr("id","qf-field-"+this.getId())
},focus:function(){this.$element.find(":input:first").focus()
},highlight:function(){var A=this;
this.$element.css("backgroundColor","#fff").animate({backgroundColor:"lightyellow"},function(){A.$element.animate({backgroundColor:"#fff"},function(){A.$element.css("backgroundColor","")
})
})
},getLabel:function(){return this.descriptor.label
},getId:function(){return this.descriptor.id
},activate:function(B){var A;
this.active=true;
this.$element.addClass("qf-field-active").show();
this.$element.find("textarea").trigger("refreshInputHeight");
if(!B){A=this.render();
this.$element.append(A.scripts);
this.focus();
JIRA.trigger(JIRA.Events.NEW_CONTENT_ADDED,[this.$element]);
this.$element.scrollIntoView();
this.triggerEvent("activated")
}},hasVisibilityFeature:function(){return !!this.descriptor.hasVisibilityFeature
},hasRetainFeature:function(){return !!this.descriptor.hasRetainFeature
},isActive:function(){return this.active
},disable:function(A){this.render();
this.active=false;
this.$element.removeClass("qf-field-active").hide();
if(!A){this.triggerEvent("disabled")
}},render:function(){var B=JIRA.Templates.QuickForm.field(this.descriptor),A=JIRA.extractScripts(B);
this.$element.html(A.html).addClass("qf-field").data("model",this);
return{element:this.$element,scripts:A.scripts}
}});
/* module-key = 'com.atlassian.jira.jira-quick-edit-plugin:quick-form', location = 'js/QuickForm/picker.js' */
JIRA.Forms.FieldPicker=AJS.Control.extend({INLINE_DIALOG_ID:"field_picker_popup",init:function(){this.buttons=[]
},switchToAll:function(A){this.isConfigurable=false;
if(A!==true){this.hideCallback=function(){this.remove()
};
this.inlineDialog.hide();
this.triggerEvent("switchedToAll")
}},setForm:function(A){this.form=A
},switchToCustom:function(A){this.isConfigurable=true;
if(A!==true){this.hideCallback=function(){this.remove()
};
this.inlineDialog.hide();
this.triggerEvent("switchedToCustom")
}},hideCallback:function(){},bindInlineDialog:function(){var B=this,A=this.getInlineDialogTrigger();
function C(F,D,E){B.render().done(function(G){if(F.find(".qf-picker").length===0){F.html(G);
F.click(function(K){K.stopPropagation()
})
}var J=jQuery("#qf-field-picker-trigger:visible").offset().top-jQuery(window).scrollTop(),I=jQuery(window).height(),H=I-J-110;
F.find(".qf-picker-content").css("maxHeight",H);
E()
})
}if(this.inlineDialog){this.inlineDialog.remove()
}this.inlineDialog=AJS.InlineDialog(A,this.INLINE_DIALOG_ID,C,{width:450,upfrontCallback:function(){A.parent().addClass("active")
},hideCallback:function(){A.parent().removeClass("active")
},nobind:true});
A.click(function(D){if(jQuery("#inline-dialog-"+B.INLINE_DIALOG_ID).is(":visible")){B.inlineDialog.hide()
}else{B.inlineDialog.show()
}});
return this.inlineDialog
},getInlineDialogTrigger:function(){return this.form.$element.find("#qf-field-picker-trigger")
},renderButtons:function(B){var A=this,C=jQuery('<ul class="qf-picker-buttons" />').appendTo(this.$content);
jQuery.each(B,function(E,F){var G,D;
if(A.isConfigurable){A.form.getFieldById(F.id).done(function(I){if(I&&I.hasVisibilityFeature()){var J=jQuery("<li />").appendTo(C);
var H=new JIRA.Forms.FieldPicker.ConfigurableButton({field:I});
H.render().appendTo(J);
A.buttons.push(H)
}})
}else{D=new JIRA.Forms.FieldPicker.UnconfigurableButton(F);
G=jQuery("<li />").appendTo(C);
D.render().appendTo(G)
}});
if(C.children().length===0){C.addClass("qf-no-fields").append("<li><em>"+"No fields can be configured for this tab"+"</em></li>")
}},renderContents:function(){var A=this,B=jQuery.Deferred();
this.form.model.getSortedTabs().done(function(C){if(C.length===1){A.renderButtons(C[0].fields)
}else{jQuery.each(C,function(D,E){if(E.fields.length>0){jQuery("<h4><span></span></h4>").appendTo(A.$content).find("span").text(E.label);
A.renderButtons(E.fields)
}})
}B.resolveWith(A,[A.$element])
});
return B.promise()
},show:function(){this.inlineDialog.show()
},render:function(){this.$element=jQuery(JIRA.Templates.QuickForm.fieldPicker({isConfigurable:this.isConfigurable}));
this.$content=this.$element.find(".qf-picker-content");
this._assignEvents("switchToCustom",this.$element.find(".qf-configurable"));
this._assignEvents("switchToAll",this.$element.find(".qf-unconfigurable"));
return this.renderContents()
},_events:{switchToCustom:{click:function(A){this.switchToCustom();
A.preventDefault()
}},switchToAll:{click:function(A){this.switchToAll();
A.preventDefault()
}}}});
JIRA.Forms.FieldPicker.UnconfigurableButton=AJS.Control.extend({init:function(A){this.descriptor=A
},render:function(){this.$element=jQuery(JIRA.Templates.QuickForm.unconfigurablePickerButton({required:this.descriptor.required,label:this.descriptor.label,fieldId:this.descriptor.id,isActive:true}));
return this.$element
}});
JIRA.Forms.FieldPicker.ConfigurableButton=AJS.Control.extend({init:function(B){var A=this;
this.field=B.field;
this.field.bind("disabled",function(){A.$element.removeClass("qf-active")
}).bind("activated",function(){A.$element.addClass("qf-active")
})
},toggle:function(){if(this.field.isActive()){this.field.disable()
}else{this.field.activate()
}},getId:function(){return this.field.getId()
},render:function(){this.$element=jQuery(JIRA.Templates.QuickForm.configurablePickerButton({required:this.field.descriptor.required,label:this.field.getLabel(),fieldId:this.field.getId(),isActive:this.field.isActive()}));
this._assignEvents("button",this.$element);
return this.$element
},_events:{button:{click:function(A){this.toggle();
A.preventDefault()
}}}});
/* module-key = 'com.atlassian.jira.jira-quick-edit-plugin:quick-form', location = 'js/QuickForm/form.js' */
JIRA.Forms.AbstractForm=AJS.Control.extend({submit:function(){var A=this;
A.getForm().addClass("submitting");
this.triggerEvent("submitting",[],true);
return JIRA.SmartAjax.makeRequest({url:this.getAction(),type:"POST",beforeSend:function(){A.disable()
},data:this.serialize(),complete:function(G,H,C){var E=C.data;
A.getForm().find(".aui-message-context").remove();
A.enable();
A.getForm().find(".error").remove();
if(C.successful){A.performAnalytics();
if(E&&E.fields){A.invalidateFieldsCache();
A.model.setFields(E.fields)
}if(typeof E==="string"){var F=AJS.$(AJS.extractBodyFromResponse(E));
var D=F.find("#atl_token").val();
if(D){A.model.atlToken=D;
A.getForm().find('input[name="atl_token"]').val(D)
}var B=new JIRA.FormDialog({offsetTarget:"body",content:F});
B._handleServerSuccess=function(){if(B.prev){B.prev._removeStackState();
B.prev._resetWindowTitle();
B._removeStackState()
}B.hide();
A.triggerEvent("sessionComplete",[],true);
A.handleSubmitSuccess()
};
B._handleServerError=function(I){B.hide();
A.handleSubmitError(I)
};
B.show()
}else{A.handleSubmitSuccess(C.data)
}}else{A.handleSubmitError(G)
}A.getForm().removeClass("submitting")
}})
},disable:function(){this.getForm().find(":input").attr("disabled","disabled").trigger("disable");
this.getForm().find(":submit").attr("disabled","disabled")
},enable:function(){this.getForm().find(":input").removeAttr("disabled").trigger("enable");
this.getForm().find(":submit").removeAttr("disabled")
},getActiveFieldIds:function(){throw new Error("getActiveFieldIds: Abstract, must be implemented by sub class")
},serialize:function(C){var A=this,B=this.getForm().serialize();
if(this.model.isInMultipleMode&&this.model.isInMultipleMode()){B=B+"&multipleMode=true"
}if(this.model.hasRetainFeature()){this.model.clearRetainedFields();
jQuery.each(this.getActiveFieldIds(),function(E,D){A.model.addFieldToRetainValue(D,C)
});
jQuery.each(this.model.getFieldsWithRetainedValues(),function(D,E){B=B+"&fieldsToRetain="+E
})
}return B
},invalidateFieldsCache:function(){delete this.fields
},setInitialFocus:function(){this.getFormContent().find(":input:first").focus()
},handleSubmitSuccess:function(){this.triggerEvent("submitted");
AJS.reloadViaWindowLocation()
},performAnalytics:function(){var A=function(D,E){var C="***** Analytics log ["+D+"]";
if(E){C+="["+JSON.stringify(E)+"]"
}AJS.log(C);
if(AJS.EventQueue){AJS.EventQueue.push({name:D,properties:E||{}})
}};
var B=function(E){var C={};
var F=_.filter(E,function(G){return !_.contains(["isCreateIssue","isEditIssue","atl_token","hasWorkStarted"],G.name)
});
var D=_.filter(F,function(G){return G.value!=""
});
_.each(D,function(H){var G=H.name;
if(!_.has(C,G)){C[G]=[]
}C[G].push(H.value)
});
return C
};
this.previousAnalytics=(function(K,O){var F=B(K);
var M=_.keys(F);
var G=_.keys(O.data);
var J=_.difference(M,G);
var N=_.difference(G,M);
var L=_.intersection(G,M);
var D=_.filter(L,function(P){return _.isEqual(O.data[P],F[P])
});
var C=_.difference(L,D);
var I=O.count+1;
var H=(JIRA.Dialog.current.options.id==="edit-issue-dialog");
var E={"atlassian.numCreates":I,"edit.form":H};
_.each(J,function(P){E[P]="added"
});
_.each(N,function(P){E[P]="removed"
});
_.each(D,function(P){E[P]="same"
});
_.each(C,function(P){E[P]="changed"
});
A("quick.create.fields",E);
return{data:F,count:I}
})(this.getForm().serializeArray(),this.previousAnalytics||{data:{},count:0})
},handleSubmitError:function(D){var A=this;
var E;
try{E=JSON.parse(D.responseText)
}catch(C){}if(E){if(E.errorMessages&&E.errorMessages.length){JIRA.applyErrorMessageToForm(this.getForm(),E.errorMessages[0])
}if(E&&E.errors&&D.status===400){if(this.getFieldById){jQuery.each(E.errors,function(F){if(/^timetracking/.test(F)){A.getFieldById("timetracking").done(function(G){JIRA.trigger(JIRA.Events.VALIDATE_TIMETRACKING,[A.$element]);
G.activate(true)
})
}else{if(/^worklog/.test(F)){A.getFieldById("worklog").done(function(G){JIRA.trigger(JIRA.Events.VALIDATE_TIMETRACKING,[A.$element]);
G.activate(true)
})
}else{A.getFieldById(F).done(function(G){G.activate(true)
})
}}})
}JIRA.applyErrorsToForm(this.getForm(),E.errors);
this.triggerEvent("validationError",[this,E.errors],true)
}var B=A.$element.find(".error");
if(B.length){B[0].scrollIntoView(false)
}}},getAction:function(){return this.action
},getFormContent:function(){return this.$element.find("div.content")
},getForm:function(){return this.$element.find("form")
},createField:function(){throw new Error("JIRA.Forms.AbstractForm: You must implement [createField] method in subclass.")
},_getActiveAttachments:function(A){var B=[];
if(!A){return B
}var D=A.split("&");
for(var C=0;
C<D.length;
C++){var E=D[C].split("=");
if(E[0]=="filetoconvert"){B.push(E[1])
}}return B
},_setActiveAttachments:function(B){var A=this.$element.find("input[name=filetoconvert]");
A.each(function(){var D=jQuery(this);
var C=_.contains(B,D.attr("value"));
D.prop("checked",C)
})
},render:function(C){var B=jQuery.Deferred(),A=this;
var D=A._getActiveAttachments(C);
if(C){this.invalidateFieldsCache();
this.model.refresh(C).done(function(){A._render().done(function(F,E){A.triggerEvent("rendered",[A.$element]);
B.resolveWith(A,[A.$element,E])
})
})
}else{A._render().done(function(F,E){A.triggerEvent("rendered",[A.$element]);
B.resolveWith(A,[A.$element,E])
})
}B.always(function(){A._setActiveAttachments(D)
});
return B.promise()
}});
JIRA.Forms.AbstractConfigurableForm=JIRA.Forms.AbstractForm.extend({getFields:function(){var B=jQuery.Deferred(),A=this;
if(!this.fields){this.fields=[];
this.model.getConfigurableFields().done(function(C){jQuery.each(C,function(D,F){var E=A.createField(F);
A.fields.push(E)
});
B.resolveWith(A,[A.fields])
})
}else{B.resolveWith(this,[this.fields])
}return B.promise()
},getActiveFieldIds:function(){var B=[],A=this.$element.find(".qf-field.qf-field-active:not(.qf-required)");
jQuery.each(A,function(D,E){var C=jQuery(E);
var F=C.data("model").getId();
B.push(F);
if(F==="attachment"){C.find(":checked").each(function(){B.push(this.id)
})
}});
return B
},createField:function(C){C.hasVisibilityFeature=this.model.hasVisibilityFeature(C);
if(this.model.hasRetainFeature(C)){C.hasRetainFeature=true;
C.retainValue=this.model.hasRetainedValue(C)
}var A=this,B=new JIRA.Forms.ConfigurableField(C);
if(C.hasVisibilityFeature){B.bind("activated",function(){A.model.setUserFields(A.getActiveFieldIds());
B.highlight();
A.triggerEvent("QuickForm.fieldAdded",[B])
}).bind("disabled",function(){A.model.setUserFields(A.getActiveFieldIds());
A.triggerEvent("QuickForm.fieldRemoved",[B])
})
}return B
},getFieldById:function(C){var A=this,B=jQuery.Deferred();
this.getFields().done(function(D){jQuery.each(D,function(E,F){if(F.getId()===C){B.resolveWith(A,[F])
}});
B.rejectWith(A,[])
});
return B.promise()
},hasNoVisibleFields:function(){var A=jQuery.Deferred();
A.resolve(this.getActiveFieldIds().length===0);
return A.promise()
},renderFormContents:function(){var C=jQuery.Deferred(),B=jQuery(),A=this;
A.getFields().done(function(D){A.model.getActiveFieldIds().done(function(E){jQuery.each(D,function(){var F=this.render();
B=B.add(F.scripts);
A.getFormContent().append(F.element)
});
jQuery.each(E,function(G,F){jQuery.each(D,function(){if(this.getId()===F){this.activate(true)
}})
});
jQuery.each(D,function(){if(!this.isActive()){this.disable(true)
}});
A.hasNoVisibleFields().done(function(G){if(G===true){for(var F=0;
F<3;
F++){if(D[F]){D[F].activate(true)
}}}C.resolveWith(this,[A.$element,B])
})
})
});
return C.promise()
}});
JIRA.Forms.AbstractUnconfigurableForm=JIRA.Forms.AbstractForm.extend({getFieldsHtml:function(){var A=this,B=jQuery.Deferred(),C={};
this.model.getTabs().done(function(D){if(D.length===1){C.fields=D[0].fields
}else{C.tabs=D;
C.hasTabs=true
}B.resolveWith(A,[JIRA.Templates.Issue.issueFields(C)])
});
return B.promise()
},getActiveFieldIds:function(){var B=[];
this.model.getFields().done(function(C){jQuery.each(C,function(D,E){B.push(E.id)
})
});
if(B.indexOf("attachment")){var A=this.$element.find("input[name=filetoconvert]").map(function(C,D){return D.id
}).toArray();
B.push.apply(B,A)
}return B
},getFields:function(){var B=jQuery.Deferred(),A=this;
if(!this.fields){this.fields=[];
this.model.getFields().done(function(C){jQuery.each(C,function(D,F){var E=A.createField(F);
A.fields.push(E)
});
B.resolveWith(A,[A.fields])
})
}else{B.resolveWith(this,[this.fields])
}return B.promise()
}});
JIRA.Forms.Error=AJS.Control.extend({getErrorMessageFromSmartAjax:function(A){var B,C;
if(A.hasData&&A.status!==401){try{C=JSON.parse(A.data);
if(C.errorMessages&&C.errorMessages.length>0){B=JIRA.Templates.QuickForm.errorMessage({message:C.errorMessages[0]})
}else{B=JIRA.SmartAjax.buildDialogErrorContent(A,true).html()
}}catch(D){B=JIRA.SmartAjax.buildDialogErrorContent(A,true).html()
}}else{B=JIRA.SmartAjax.buildDialogErrorContent(A,true).html()
}return B
},render:function(B){var A=this.getErrorMessageFromSmartAjax(B);
return this._render(A)
}});
/* module-key = 'com.atlassian.jira.jira-quick-edit-plugin:quick-form', location = 'js/QuickForm/container.js' */
JIRA.Forms.Container=AJS.Control.extend({init:function(A){this.$element=jQuery("<div />").addClass("qf-container");
this.options=JIRA.makePropertyFunc(A);
this.fieldPicker=new JIRA.Forms.FieldPicker();
this.successData=[]
},decorateRenderers:function(){var A=this;
if(!this.fieldPicker.decorated){this.fieldPicker.bind("switchedToAll",function(){A.unconfigurableForm.render(A.currentView.serialize(true)).done(function(){A.fieldPicker.show()
})
});
this.fieldPicker.bind("switchedToCustom",function(){A.configurableForm.render(A.currentView.serialize(true)).done(function(){A.fieldPicker.show()
})
});
this.fieldPicker.decorated=true
}if(!this.configurableForm.decorated){this.configurableForm.bind("rendered",function(C,B){A.currentView=A.configurableForm;
A.fieldPicker.switchToCustom(true);
A.fieldPicker.setForm(A.configurableForm);
A.fieldPicker.bindInlineDialog();
A.applyGlobalDecorator(B);
A.model.setUseConfigurableForm(true);
A.triggerEvent("configurableFormRendered")
});
this.configurableForm.bind("submitted",function(C,B){A.successData.push(B);
A.triggerEvent("configurableFormSubmitted")
});
this.configurableForm.decorated=true
}if(!this.unconfigurableForm.decorated){this.unconfigurableForm.bind("rendered",function(C,B){A.fieldPicker.switchToAll(true);
A.fieldPicker.setForm(A.unconfigurableForm);
A.fieldPicker.bindInlineDialog();
A.currentView=A.unconfigurableForm;
A.applyGlobalDecorator(B);
A.model.setUseConfigurableForm(false);
A.triggerEvent("unconfigurableFormRendered")
});
this.unconfigurableForm.bind("submitted",function(C,B){A.successData.push(B);
A.triggerEvent("unconfigurableFormSubmitted")
});
this.unconfigurableForm.decorated=true
}},applyGlobalDecorator:function(C){function B(){if(A.currentView.setInitialFocus){A.currentView.setInitialFocus()
}}var A=this;
C.detach();
this.$element.html(C);
this.triggerEvent("contentRefreshed",[this.$element]);
if(jQuery.browser.msie){window.setTimeout(B,0)
}else{B()
}},asDialog:function(B){var A=this,C;
this.dialog=C=new JIRA.FormDialog({id:B.id,trigger:B.trigger,windowTitle:B.windowTitle,width:JIRA.Dialog.WIDTH_PRESETS.large,delayShowUntil:JIRA.Dialogs.waitForSavesToComplete,content:function(D){A.render().done(function(){D(A.$element)
});
A.triggerEvent("dialogShown")
},submitHandler:function(E,D){E.preventDefault();
A.currentView.submit().then(D,D)
},stacked:true});
if(B.id==="edit-issue-dialog"){jQuery(this.dialog).on("beforeShow",function(D){if(!jira.app.issue.getIssueKey()&&!jira.app.issuenavigator.isRowSelected()){D.preventDefault()
}})
}this.dialog._focusFirstField=function(){JIRA.FormDialog.prototype._focusFirstField.apply(this,["div.content :input:visible:first"])
};
this.bind("initialized",function(){this.unconfigurableForm.bind("sessionComplete",function(){C.hide()
});
this.configurableForm.bind("sessionComplete",function(){C.hide()
})
}).bind("contentRefreshed",function(){C.notifyOfNewContent()
});
C.bind("Dialog.hide",function(){if(A.successData.length){A.triggerEvent("sessionComplete",[A.successData],true);
A.successData=[]
}});
A.$element.ajaxStart(function(){C.showFooterLoadingIndicator()
}).ajaxStop(function(){C.hideFooterLoadingIndicator()
});
C.getQuickForm=function(){return A
};
C.dirtyFormWarning();
return C
},lazyInit:function(){var A=this,B=this.options.call(this);
this.model=B.model;
this.errorHandler=B.errorHandler;
this.globalEventNamespaces=B.globalEventNamespaces;
this.configurableForm=B.configurableForm;
this.unconfigurableForm=B.unconfigurableForm;
this.sessionComplete=B.sessionComplete;
this.model.clearRetainedFields();
this.configurableForm.invalidateFieldsCache();
this.model.bind("serverError",function(D,C){A.$element.html(A.errorHandler.render(C));
A.triggerEvent("contentRefreshed",[this.$element])
});
this.triggerEvent("initialized");
this.decorateRenderers()
},render:function(){var A=this,B=jQuery.Deferred();
this.lazyInit();
A.model.getUseConfigurableForm().done(function(C){if(C===true){A.configurableForm.render().done(function(E,D){B.resolveWith(A,[A.$element]);
A.$element.append(D)
})
}else{A.unconfigurableForm.render().done(function(E,D){B.resolveWith(A,[A.$element,D]);
A.$element.append(D)
})
}}).fail(function(){B.resolveWith(A,[A.$element])
});
return B.promise()
}});
/* module-key = 'com.atlassian.jira.jira-quick-edit-plugin:quick-create-issue', location = 'js/Issue/create.js' */
JIRA.Forms.CreateIssueModel=JIRA.Forms.Model.extend({DEFAULT_NON_RETAINED_FIELDS:["summary","description","timetracking","timetracking_originalestimate","timetracking_remainingestimate","worklog","worklog_startDate","worklog_timeLogged","worklog_newEstimate","worklog_adjustmentAmount","attachment"],init:function(A){A=A||{};
this.userFieldsResource=contextPath+"/rest/quickedit/1.0/userpreferences/create";
this._hasRetainFeature=true;
this._hasVisibilityFeature=true;
this.retainedFields=[];
this.initIssueType=A.issueType;
this.initProjectId=A.projectId;
this.parentIssueId=A.parentIssueId;
this.nonRetainedFields=this.DEFAULT_NON_RETAINED_FIELDS;
if(A.nonRetainedFields){this.nonRetainedFields=_.union(A.nonRetainedFields,this.DEFAULT_NON_RETAINED_FIELDS)
}},getParentIssueId:function(){return this.parentIssueId
},isInMultipleMode:function(){return this.multipleMode
},setIsMultipleMode:function(A){this.multipleMode=A
},getActiveFieldIds:function(){var A=this,B=jQuery.Deferred(),C=[];
this.getUserFields().done(function(D){jQuery.each(D,function(F,E){C.push(E)
});
A.getRequiredFields().done(function(E){jQuery.each(E,function(G,F){if(jQuery.inArray(F.id,C)===-1){C.push(F.id)
}});
B.resolve(C)
})
});
return B.promise()
},hasVisibilityFeature:function(A){return !A.required
},getFieldsResource:function(){var A=contextPath+"/secure/QuickCreateIssue!default.jspa?decorator=none";
if(this.parentIssueId){return A+"&parentIssueId="+this.parentIssueId
}if(this.initIssueType){A=A+"&issuetype="+this.initIssueType;
delete this.initIssueType
}if(this.initProjectId){A=A+"&pid="+this.initProjectId;
delete this.initProjectId
}return A
},addFieldToRetainValue:function(D,B){var A=!_.contains(this.nonRetainedFields,D);
var C=D.match(/^filetoconvert/)!==null;
if(A||C||B){this._super(D)
}},getRequiredFields:function(){var A=jQuery.Deferred(),B=[];
this.getFields().done(function(C){jQuery.each(C,function(D,E){if(E.required){B.push(E)
}});
A.resolve(B)
});
return A.promise()
},getConfigurableFields:function(){var A=jQuery.Deferred(),B=[];
this.getFields().done(function(C){jQuery.each(C,function(D,E){if(E.id!=="project"&&E.id!=="issuetype"){B.push(E)
}});
A.resolve(B)
});
return A.promise()
},getIssueSetupFields:function(){var A=jQuery.Deferred(),B=[];
this.getFields().done(function(C){jQuery.each(C,function(D,E){if(E.id==="project"||E.id==="issuetype"){B.push(E)
}});
A.resolve(B)
});
return A.promise()
}});
JIRA.Forms.CreateIssueHelper=Class.extend({init:function(A){this.form=A
},handleSubmitSuccess:function(D){function C(E,G,F){var H='<a href="'+F+'">'+E+" - "+AJS.escapeHTML(G)+"</a>";
return AJS.format("Issue {0} has been successfully created",H)
}var A=this,B=this.form.$element.find("#summary").val();
D.summary=B;
this.form.triggerEvent("submitted",[D,this]);
this.form.triggerEvent("issueCreated",[D,this],true);
if(A.form.model.isInMultipleMode()){this.form.render().done(function(){var E=C(D.issueKey,B,contextPath+"/browse/"+D.issueKey);
JIRA.applySuccessMessageToForm(A.form.getForm(),E)
})
}else{this.form.triggerEvent("sessionComplete")
}},getCreateAnotherCheckbox:function(){return this.form.$element.find("#qf-create-another")
},isInMultipleMode:function(){return this.getCreateAnotherCheckbox().is(":checked")
},getProjectField:function(){return this.form.$element.find(".issue-setup-fields #project")
},getIssueTypeField:function(){return this.form.$element.find(".issue-setup-fields #issuetype")
},serializeForToggle:function(C){if(!this.form.model.hasRetainFeature()){return this.form.getForm().serialize()
}var E=this.form.model.prevActiveFields||[];
var K=this.form.getForm().serializeArray();
function I(L){return L.name=="filetoconvert"?L.name+"-"+L.value:L.name
}var D=this.form.getActiveFieldIds();
var F=jQuery.grep(K,function(L){return jQuery.inArray(I(L),D)!==-1
});
var A=jQuery.grep(E,function(L){return jQuery.inArray(I(L),D)===-1
});
var B=jQuery.map(A,function(L){return I(L)
});
var H=jQuery.merge(F,A);
var G=jQuery.merge(D,B);
this.form.model.prevActiveFields=jQuery.extend(true,[],H);
if(C){G=this.executeProjectChangedSecuritySettingAction(G)
}var J=jQuery.merge([{name:"retainValues",value:true}],H);
jQuery.each(K,function(L,M){if(M.name==="pid"||M.name==="issuetype"){J.push(M)
}});
J.push({name:"toggle",value:true});
jQuery.each(G,function(L,M){J.push({name:"fieldsToRetain",value:M})
});
J.push({name:"formToken",value:this.form.model.getFormToken()});
return jQuery.param(J)
},executeProjectChangedSecuritySettingAction:function(A){return _.reject(A,function(B){return B==="security"
})
},prepareFieldsToRetain:function(A,B){jQuery.each(A,function(C,D){B.push({name:"fieldsToRetain",value:D})
});
return B
},setIssueType:function(){var A=this,B=this.serializeForToggle();
this.form.invalidateFieldsCache();
this.form.disable();
this.form.render(B).done(function(){A.form.enable()
})
},setProjectId:function(){var A=this,B=this.serializeForToggle(true);
this.form.invalidateFieldsCache();
this.form.disable();
this.form.render(B).done(function(){A.form.enable()
})
},saveFormDirtyStatus:function(){this.form.isDirty=this.form.getForm().isDirty()
},restoreFormDirtyStatus:function(){if(this.form.isDirty){this.form.getForm().addClass(JIRA.DirtyForm.ClassNames.BY_DEFAULT)
}},decorate:function(){var A=this;
this.getProjectField().change(function(){A.saveFormDirtyStatus();
JIRA.trigger("dialogBeforeContentChange",["projectId",this.value,JIRA.Dialog.current.options.id]);
A.setProjectId(this.value)
});
this.getIssueTypeField().change(function(){A.saveFormDirtyStatus();
JIRA.trigger("dialogBeforeContentChange",["issueType",this.value,JIRA.Dialog.current.options.id]);
A.setIssueType(this.value)
});
this.getCreateAnotherCheckbox().change(function(){A.form.model.setIsMultipleMode(this.checked)
})
}});
JIRA.Forms.CreateIssueError=JIRA.Forms.Error.extend({_render:function(A){return jQuery(JIRA.Templates.Issue.createIssueError({errorHtml:A,useLegacyDecorator:JIRA.useLegacyDecorator()}))
}});
JIRA.Forms.UnconfigurableCreateIssueForm=JIRA.Forms.AbstractUnconfigurableForm.extend({init:function(A){this._serialization={};
this.globalEventNamespaces=A.globalEventNamespaces||[];
this.model=A.model;
this.helper=new JIRA.Forms.CreateIssueHelper(this);
this.title=A.title;
this.action=contextPath+"/secure/QuickCreateIssue.jspa?decorator=none";
this.$element=jQuery("<div class='qf-unconfigurable-form' />")
},handleSubmitSuccess:function(A){this.helper.handleSubmitSuccess(A)
},_render:function(){var B=jQuery.Deferred(),A=this;
this.getFieldsHtml().done(function(C){A.model.getIssueSetupFields().done(function(F){var E=JIRA.Templates.Issue.createIssueForm({issueSetupFields:F,fieldsHtml:C,parentIssueId:A.model.getParentIssueId(),atlToken:A.model.getAtlToken(),formToken:A.model.getFormToken(),title:A.title,multipleMode:A.model.isInMultipleMode(),useLegacyDecorator:JIRA.useLegacyDecorator(),showFieldConfigurationToolBar:!JIRA.Users.LoggedInUser.isAnonymous(),modifierKey:AJS.Navigator.modifierKey()}),D=JIRA.extractScripts(E);
A.$element.empty().append(D.html);
A.helper.restoreFormDirtyStatus();
A.helper.decorate();
B.resolveWith(A,[A.$element,D.scripts])
})
});
return B.promise()
}});
JIRA.Forms.ConfigurableCreateIssueForm=JIRA.Forms.AbstractConfigurableForm.extend({init:function(A){this.model=A.model;
this.helper=new JIRA.Forms.CreateIssueHelper(this);
this.globalEventNamespaces=A.globalEventNamespaces||[];
this.issueId=A.issueId;
this.title=A.title;
this._serialization={};
this.action=contextPath+"/secure/QuickCreateIssue.jspa?decorator=none";
this.$element=jQuery("<div />").addClass("qf-form qf-configurable-form")
},handleSubmitSuccess:function(A){return this.helper.handleSubmitSuccess(A)
},_render:function(){var B=jQuery.Deferred(),A=this;
A.model.getIssueSetupFields().done(function(D){var C=JIRA.Templates.Issue.createIssueForm({issueSetupFields:D,atlToken:A.model.getAtlToken(),formToken:A.model.getFormToken(),isConfigurable:true,title:A.title,parentIssueId:A.model.getParentIssueId(),useLegacyDecorator:JIRA.useLegacyDecorator(),multipleMode:A.model.isInMultipleMode(),showFieldConfigurationToolBar:!JIRA.Users.LoggedInUser.isAnonymous(),modifierKey:AJS.Navigator.modifierKey()});
A.$element.html(C);
A.helper.decorate();
A.renderFormContents().done(function(F,E){B.resolveWith(A,[A.$element,E])
})
});
return B.promise()
}});
JIRA.Forms.createCreateIssueForm=function(A){A=A||{};
return new JIRA.Forms.Container(function(){A.globalEventNamespaces=A.globalEventNamespaces||["QuickCreateIssue"];
var E="Create Issue",B=new JIRA.Forms.CreateIssueModel({projectId:A.pid,issueType:A.issueType}),D=new JIRA.Forms.ConfigurableCreateIssueForm({model:B,title:E,globalEventNamespaces:A.globalEventNamespaces}),C=new JIRA.Forms.UnconfigurableCreateIssueForm({model:B,title:E,globalEventNamespaces:A.globalEventNamespaces});
return{globalEventNamespaces:A.globalEventNamespaces,model:B,errorHandler:new JIRA.Forms.CreateIssueError(),configurableForm:D,unconfigurableForm:C}
})
};
JIRA.Forms.createSubtaskForm=(function(){var A=function A(C){return C.parentIssueId||JIRA.Issue.getIssueId()||JIRA.IssueNavigator.getSelectedIssueId()
};
var B=function B(C){C=C||{};
return new JIRA.Forms.Container(function(){C.globalEventNamespaces=C.globalEventNamespaces||["QuickCreateSubtask"];
var G=A(C),H=JIRA.Dialog.getIssueActionTitle("Create Subtask"),D=new JIRA.Forms.CreateIssueModel({parentIssueId:G,projectId:C.pid,issueType:C.issueType}),F=new JIRA.Forms.ConfigurableCreateIssueForm({model:D,title:H,globalEventNamespaces:C.globalEventNamespaces}),E=new JIRA.Forms.UnconfigurableCreateIssueForm({model:D,title:H,globalEventNamespaces:C.globalEventNamespaces});
return{globalEventNamespaces:C.globalEventNamespaces,model:D,errorHandler:new JIRA.Forms.CreateIssueError(),configurableForm:F,unconfigurableForm:E}
})
};
return B
})();
jQuery(function(){var A;
jQuery(document).on("simpleClick",".create-issue, .create-issue-type",function(E){var B=jQuery(E.target);
var D=B.is("a")?B:B.find("a");
var F=parseUri(D.attr("href")).queryKey;
var C={pid:F.pid,issueType:F.issuetype};
C=jQuery.extend(C,{pid:B.attr("data-pid"),issueType:B.attr("data-issue-type")});
JIRA.Forms.createCreateIssueForm(C).asDialog({trigger:document.createElement("a"),id:"create-issue-dialog",windowTitle:"Create Issue"}).show();
E.preventDefault()
});
A=document.getElementById("stqc_show");
if(A){A.onclick=null
}jQuery(document).on("simpleClick",".issueaction-create-subtask",function(E){var B=jQuery(E.target);
var D=B.is("a")?B:B.find("a");
var C={parentIssueId:D.attr("data-issueid")};
JIRA.Forms.createSubtaskForm(C).asDialog({windowTitle:function(){return JIRA.Dialog.getIssueActionTitle("Create Subtask")
},trigger:document.createElement("a"),id:"create-subtask-dialog"}).show();
E.preventDefault()
})
});
/* module-key = 'com.atlassian.jira.jira-quick-edit-plugin:quick-create-issue', location = 'js/Issue/issue.soy' */
// This file was automatically generated from issue.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.Issue == 'undefined') { JIRA.Templates.Issue = {}; }


JIRA.Templates.Issue.editIssueError = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<h2>', soy.$$escapeHtml("Edit Issue"), '</h2><div class="', (opt_data.useLegacyDecorator) ? 'content-body' : 'form-body', '">', opt_data.errorHtml, '</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issue.editIssueForm = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<form action="#" name="jiraform" class="aui"><h2>', (opt_data.showFieldConfigurationToolBar) ? '<div class="qf-form-operations aui-toolbar"><div class="toolbar-split toolbar-split-right"><div class="toolbar-group"><span class="toolbar-item"><a href="#" class="toolbar-trigger" id="qf-field-picker-trigger"><span class="icon icon-tools"></span>' + soy.$$escapeHtml("Configure Fields") + '<span class="icon drop-menu"></span></a></span></div></div></div>' : '', opt_data.title, '</h2><div class="', (opt_data.useLegacyDecorator) ? 'content-body' : 'form-body', '"><input type="hidden" name="id" value="', soy.$$escapeHtml(opt_data.issueId), '" /><input type="hidden" name="atl_token" value="', soy.$$escapeHtml(opt_data.atlToken), '" /><input type="hidden" name="formToken" value="', soy.$$escapeHtml(opt_data.formToken), '" /><div class="content">', (opt_data.fieldsHtml) ? opt_data.fieldsHtml : '', (opt_data.commentField) ? opt_data.commentField.editHtml : '', '<!-- fields inserted here via javascript --></div></div><div class="buttons-container ', (opt_data.useLegacyDecorator) ? 'content-footer' : 'form-footer', '"><div class="buttons"><input accesskey="', soy.$$escapeHtml("s"), '" title="', soy.$$escapeHtml(AJS.format("Press {1}+{0} to submit this form","s",opt_data.modifierKey)), '" class="button" id="edit-issue-submit" name="Edit" type="submit" value="', soy.$$escapeHtml("Update"), '" /><a href="#" accesskey="', soy.$$escapeHtml("`"), '" title="', soy.$$escapeHtml(AJS.format("Press {1}+{0} to cancel","`",opt_data.modifierKey)), '" class="cancel">', soy.$$escapeHtml("Cancel"), '</a></div></div></form>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issue.issueFields = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.hasTabs) {
    output.append('<div class="aui-tabs horizontal-tabs" id="horizontal"><ul class="tabs-menu">');
    var tabList68 = opt_data.tabs;
    var tabListLen68 = tabList68.length;
    for (var tabIndex68 = 0; tabIndex68 < tabListLen68; tabIndex68++) {
      var tabData68 = tabList68[tabIndex68];
      output.append((tabData68) ? '<li class="menu-item ' + ((tabData68.isFirst) ? 'first active-tab' : '') + ' "><a href="#tab-' + soy.$$escapeHtml(tabData68.position) + '" ><strong>' + soy.$$escapeHtml(tabData68.label) + '</strong></a></li>' : '');
    }
    output.append('</ul>');
    var tabList82 = opt_data.tabs;
    var tabListLen82 = tabList82.length;
    for (var tabIndex82 = 0; tabIndex82 < tabListLen82; tabIndex82++) {
      var tabData82 = tabList82[tabIndex82];
      if (tabData82) {
        output.append('<div class="tabs-pane ', (tabData82.isFirst) ? 'active-pane' : '', '" id="tab-', soy.$$escapeHtml(tabData82.position), '">');
        var fieldList92 = tabData82.fields;
        var fieldListLen92 = fieldList92.length;
        for (var fieldIndex92 = 0; fieldIndex92 < fieldListLen92; fieldIndex92++) {
          var fieldData92 = fieldList92[fieldIndex92];
          output.append((fieldData92.editHtml) ? fieldData92.editHtml : '');
        }
        output.append('</div>');
      }
    }
    output.append('</div>');
  } else {
    var fieldList102 = opt_data.fields;
    var fieldListLen102 = fieldList102.length;
    for (var fieldIndex102 = 0; fieldIndex102 < fieldListLen102; fieldIndex102++) {
      var fieldData102 = fieldList102[fieldIndex102];
      output.append((fieldData102.editHtml) ? fieldData102.editHtml : '');
    }
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issue.createIssueForm = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<form name="jiraform" action="#" class="aui"><h2>', (opt_data.showFieldConfigurationToolBar) ? '<div class="qf-form-operations aui-toolbar"><div class="toolbar-split toolbar-split-right"><div class="toolbar-group"><span class="toolbar-item"><a href="#" class="toolbar-trigger" id="qf-field-picker-trigger"><span class="icon icon-tools"></span>' + soy.$$escapeHtml("Configure Fields") + '<span class="icon drop-menu"></span></a></span></div></div></div>' : '', soy.$$escapeHtml(opt_data.title), '</h2><div class="', (opt_data.useLegacyDecorator) ? 'content-body' : 'form-body', '">');
  if (opt_data.issueSetupFields) {
    output.append('<div class="issue-setup-fields">');
    var fieldList126 = opt_data.issueSetupFields;
    var fieldListLen126 = fieldList126.length;
    for (var fieldIndex126 = 0; fieldIndex126 < fieldListLen126; fieldIndex126++) {
      var fieldData126 = fieldList126[fieldIndex126];
      output.append('<div class="qf-field qf-field-', soy.$$escapeHtml(fieldData126.id), ' qf-required">', fieldData126.editHtml, '</div>');
    }
    output.append('</div>');
  }
  output.append((opt_data.parentIssueId) ? '<input type="hidden" name="parentIssueId" value="' + soy.$$escapeHtml(opt_data.parentIssueId) + '" />' : '', '<input type="hidden" name="atl_token" value="', soy.$$escapeHtml(opt_data.atlToken), '" /><input type="hidden" name="formToken" value="', soy.$$escapeHtml(opt_data.formToken), '" /><div class="content">', (opt_data.fieldsHtml) ? opt_data.fieldsHtml : '', '<!-- fields inserted here via javascript --></div></div><div class="buttons-container ', (opt_data.useLegacyDecorator) ? 'content-footer' : 'form-footer', '"><div class="buttons"><label for="qf-create-another" class="qf-create-another"><input id="qf-create-another" type="checkbox" ', (opt_data.multipleMode) ? 'checked="checked"' : '', ' />', soy.$$escapeHtml("Create another"), '</label><input accesskey="', soy.$$escapeHtml("s"), '" title="', soy.$$escapeHtml(AJS.format("Press {1}+{0} to submit this form","s",opt_data.modifierKey)), '" class="aui-button aui-button-primary" id="create-issue-submit" name="Edit" type="submit" value="', soy.$$escapeHtml("Create"), '" /><a href="#" accesskey="', soy.$$escapeHtml("`"), '" title="', soy.$$escapeHtml(AJS.format("Press {1}+{0} to cancel","`",opt_data.modifierKey)), '" class="cancel">', soy.$$escapeHtml("Cancel"), '</a></div></div></form>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issue.createIssueError = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<h2>', soy.$$escapeHtml("Create Issue"), '</h2><div class="', (opt_data.useLegacyDecorator) ? 'content-body' : 'form-footer', '">', opt_data.errorHtml, '</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issue.undealtErrors = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div>', soy.$$escapeHtml("There were some errors when trying to create this issue"), '</div><ul>');
  var errorList191 = opt_data.errors;
  var errorListLen191 = errorList191.length;
  for (var errorIndex191 = 0; errorIndex191 < errorListLen191; errorIndex191++) {
    var errorData191 = errorList191[errorIndex191];
    output.append('<li>', soy.$$escapeHtml(errorData191), '</li>');
  }
  output.append('</ul>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.welcome.jira-welcome-plugin:whats-new-resources', location = 'templates/whats-new.soy' */
// This file was automatically generated from whats-new.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.WhatsNew == 'undefined') { JIRA.Templates.WhatsNew = {}; }


JIRA.Templates.WhatsNew.whatsNewDialogPanel = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="whats-new-dialog-text"><div class="whats-new-throbber hidden"></div><div class="whats-new-timeout hidden"><div class="aui-message warning"><p class="title"><span class="aui-icon icon-warning"></span><strong>', soy.$$escapeHtml("Oops."), '</strong></p><p>', AJS.format("We\u2019re having trouble downloading the \x3ca target\x3d\x22_blank\x22 href\x3d\x22{0}\x22\x3eWhat\u2019s New content\x3c/a\x3e from the Atlassian website. This may be because you have a slow internet connection or that no internet connection is available.",opt_data.whatsNewFullLink), '</p></div></div></div><iframe id="whats-new-iframe" class="hidden" scrolling="no" frameborder="0" src="', soy.$$escapeHtml(opt_data.whatsNewHelpLink), '"></iframe>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.WhatsNew.whatsNewDialogTipPanel = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="dialog-tip"><input id="dont-show-whats-new" type="checkbox" name="dontshow"', (opt_data.dontShowAgain) ? ' checked="checked"' : '', '><label for="dont-show-whats-new" type="checkbox"><span class="checkbox-label">', (opt_data.isOnDemand) ? soy.$$escapeHtml("Don\u2019t show again") : soy.$$escapeHtml("Don\u2019t show again. You will still be able to access this dialog through the \u2018Help\u2019 Menu in the application header."), '</span></label></div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.welcome.jira-welcome-plugin:whats-new-resources', location = 'js/whats-new.js' */
Raphael.spinner=function(k,f,h){var o=h||"#fff",n=f*13/60,s=f*35/60,p=f,d=p+n,c=p+n,m=Raphael(k,p*2+n*2,p*2+n*2),l=[],e=[],u=2*Math.PI/12,j={stroke:o,"stroke-width":n,"stroke-linecap":"round"};for(var q=0;q<12;q++){var g=u*q-Math.PI/2,b=Math.cos(g),a=Math.sin(g);e[q]=q/12;l[q]=m.path([["M",d+s*b,c+s*a],["L",d+p*b,c+p*a]]).attr(j)}var t;(function v(){e.unshift(e.pop());for(var r=0;r<12;r++){l[r].attr("opacity",e[r])}m.safari();t=setTimeout(v,80)})();return function(){clearTimeout(t);m.remove()}};var dim=AJS.dim;AJS.dim=function(){try{dim.apply(this,arguments)}catch(a){}};AJS.toInit(function(l){var i=l("#whats-new-menu-link"),e,c,a,m,h,g,k=function(p){var o=!l(this).attr("checked");var n=contextPath+"/rest/whatsnew/1.0/show";l.ajax({url:n,data:{},type:o?"POST":"DELETE",success:function(){AJS.log("whatsnew > toggleDontShow > isWelcomeDialogShownForUser set to: "+o)}})},d=function(){if(!c){return}g&&clearTimeout(g);f();AJS.setVisible(c,true)},j=function(p){var o=new AJS.Dialog({width:855,height:545,id:"whats-new-dialog",onCancel:function(){o.hide().remove();g&&clearTimeout(g)}});var q=AJS.Meta.get("whats-new-iframe-src");if(typeof(q)=="undefined"||q===""){q=AJS.Meta.get("whatsnew-full-link")}var r="What\u2019s New in JIRA";o.addHeader(r);var n=JIRA.Templates.WhatsNew.whatsNewDialogPanel({whatsNewHelpLink:q,whatsNewFullLink:AJS.Meta.get("whatsnew-full-link")});o.addPanel("default",n);o.addCancel("Close",function(){o.hide().remove();g&&clearTimeout(g);return false});a=o.popup.element;if(AJS.Meta.get("remote-user")){o.page[o.curpage].buttonpanel.append(JIRA.Templates.WhatsNew.whatsNewDialogTipPanel({isOnDemand:AJS.DarkFeatures.isEnabled("com.atlassian.jira.config.CoreFeatures.ON_DEMAND"),dontShowAgain:(!p)}));a.find("#dont-show-whats-new").change(k)}c=a.find("iframe");c.load(d);m=a.find(".whats-new-timeout");return o},f=function(){if(h){h();h=null}e.addClass("hidden")},b=function(){var n=contextPath+"/rest/whatsnew/1.0/show";l.getJSON(n,function(o){j(o.isShownForUser).show();e=a.find(".whats-new-throbber.hidden");e.removeClass("hidden");h=Raphael.spinner(e[0],80,"#666");g=setTimeout(function(){c=null;f();AJS.setVisible(m,true)},10000)})};i.click(function(n){n.preventDefault();b()});if(AJS.Meta.getBoolean("show-whats-new")){AJS.Popups.DisplayController.request({name:"jira-whats-new-dialog",weight:100,show:function(){b()}})}});
/* module-key = 'com.atlassian.jira.welcome.jira-welcome-plugin:welcome-screen-resources', location = 'templates/welcome.soy' */
// This file was automatically generated from welcome.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.WelcomeScreen == 'undefined') { JIRA.Templates.WelcomeScreen = {}; }


JIRA.Templates.WelcomeScreen.welcomeScreenPanel = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-group"><div class="welcome-screen-splash aui-item"><h1><span class="assistive">JIRA</span></h1></div><div class="welcome-screen-content-container aui-item"><div class="welcome-screen-content">', (opt_data.theirName) ? '<h1>' + soy.$$escapeHtml(AJS.format("Welcome, {0}!",opt_data.theirName)) + '</h1>' : '<h1>' + soy.$$escapeHtml("Welcome!") + '</h1>', '<p>', soy.$$escapeHtml("To begin working with JIRA, you need to create a project."), '</p><ul class="welcome-screen-options aui-group"><li class="aui-item">');
  JIRA.Templates.WelcomeScreen.welcomeScreenAction({type: 'demoproject', href: '/secure/CreateDemoProject.jspa?atl_token=' + opt_data.atl_token, title: "Start with a demo project", description: "Get started with a pre-populated project to get an idea of what you can do in JIRA.", cssClass: ''}, output);
  output.append('</li><li class="aui-item">');
  JIRA.Templates.WelcomeScreen.welcomeScreenAction({type: 'blankproject', href: '/secure/admin/AddProject!default.jspa?nextAction=browseprojects', title: "Create a blank project", description: "Start with an empty project to begin managing your issues.", cssClass: 'add-project-trigger'}, output);
  output.append('</li></ul></div><div class="welcome-screen-alternate-options"><p>', AJS.format("{0}I\x27\x27ll skip this{1}, I know what I\x27\x27m doing.",opt_data.cancelLinkHtml,'</a>'), '</p></div></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.WelcomeScreen.welcomeScreenAction = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a class="welcome-screen-action ', soy.$$escapeHtml(opt_data.cssClass), '" data-type="', soy.$$escapeHtml(opt_data.type), '" href="', soy.$$escapeHtml("/jira"), soy.$$escapeHtml(opt_data.href), '"><h3>', soy.$$escapeHtml(opt_data.title), '</h3>', (opt_data.description) ? '<p>' + soy.$$escapeHtml(opt_data.description) + '</p>' : '', '</a>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.welcome.jira-welcome-plugin:welcome-screen-resources', location = 'js/welcome.js' */
(function(d){var c=contextPath+"/rest/welcome/1.0/show/welcome",b=contextPath+"/rest/welcome/1.0/show/browseprojects",e="welcome-screen-cancel-trigger";function a(){return JIRA.Templates.WelcomeScreen.welcomeScreenPanel({theirName:AJS.Meta.get("remote-user-fullname")||"",cancelLinkHtml:'<a class="'+e+'" href="'+contextPath+'/">',atl_token:atl_token()})}JIRA.Dialogs.demoProject=new JIRA.FormDialog({id:"demo-project-dialog",trigger:"a.welcome-screen-action[data-type='demoproject']",stayVisibleOnRedirect:true,onContentRefresh:function(){jQuery(".overflow-ellipsis").textOverflow()}});d(document).bind("focusShifterTip.show",function(f){if(AJS.Meta.getBoolean("suppress-focus-shifter-tip")){f.preventDefault()}});AJS.toInit(function(j){var g;var f=function(){var k=new AJS.Dialog({width:860,height:500,id:"welcome-dialog",onCancel:function(){}});k.addPanel("default",a());JIRA.bind("Dialog.beforeHide",i);j("a",k.popup.element).click(function(l){JIRA.unbind("Dialog.beforeHide",i)});j("."+e,k.popup.element).click(h);j(".welcome-screen-action",k.popup.element).click(function(){AJS.EventQueue&&AJS.EventQueue.push({name:"welcomescreen.action",properties:{type:this.getAttribute("data-type")}});j.ajax({url:c,type:"DELETE",success:function(){AJS.log("welcome dialog > action clicked > don't show dialog anymore")}});k.hide().remove()});return k},i=function(k){if(JIRA.Dialog&&JIRA.Dialog.current&&g&&JIRA.Dialog.current.$popup==g.popup.element){k.preventDefault()}},h=function(k){k.preventDefault();g.hide().remove();AJS.EventQueue&&AJS.EventQueue.push({name:"welcomescreen.dismiss"});j.ajax({url:c,type:"DELETE",success:function(){AJS.log("welcome dialog > don't show dialog anymore")}})};if(AJS.Meta.getBoolean("show-welcome-screen")){}j(".browse-projects-info-dismiss").click(function(){AJS.EventQueue&&AJS.EventQueue.push({name:"browseprojectsinfo.dismisstext"});j.ajax({url:b,type:"DELETE",success:function(){AJS.log("browse projects > dismiss clicked > don't show info panel anymore")}});j("#browse-projects-info").fadeOut()});AJS.bind("messageClose",function(l,k){if(k.attr("id")=="browse-projects-info"){AJS.EventQueue&&AJS.EventQueue.push({name:"browseprojectsinfo.closebutton"});j.ajax({url:b,type:"DELETE",success:function(){AJS.log("browse projects > close button clicked > don't show info panel anymore")}})}})})})(AJS.$);
/* module-key = 'com.atlassian.plugins.jira-html5-attach-images:jira-html5-attach-images-resources', location = 'path.js' */
(function(){AJS.namespace("JIRA.AttachImagesPlugin");JIRA.AttachImagesPlugin.basename=function(a){return a.split(/\//).pop()};JIRA.AttachImagesPlugin.dirname=function(a){var b=JIRA.AttachImagesPlugin.basename(a);return a.substring(0,a.length-b.length)}})();
/* module-key = 'com.atlassian.plugins.jira-html5-attach-images:jira-html5-attach-images-resources', location = 'resource-uris.js' */
(function(){AJS.namespace("JIRA.AttachImagesPlugin");var a=null,b="com.atlassian.plugins.jira-html5-attach-images:jira-html5-attach-images-resources.resource-uris";JIRA.AttachImagesPlugin.resourceUris={_resetForTesting:function(){a=null},get:function(c){if(a===null){a=WRM.data.claim(b)||{}}return a[c]}}})();
/* module-key = 'com.atlassian.plugins.jira-html5-attach-images:jira-html5-attach-images-resources', location = 'templates/soy/attach-screenshot-form.soy' */
// This file was automatically generated from attach-screenshot-form.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.Html5Screenshot == 'undefined') { JIRA.Templates.Html5Screenshot = {}; }


JIRA.Templates.Html5Screenshot.attachScreenshotForm = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<h2 class="dialog-title">', soy.$$escapeHtml("Attach screenshot"), '</h2><form action="ShowAttachScreenshotFormAction.jspa" class="aui" method="post" id="attach-screenshot-form" data-attach-secure-token="', soy.$$escapeHtml(opt_data.attachUserToken), '" data-submit-secure-token="', soy.$$escapeHtml(opt_data.submitUserToken), '"><input type="hidden" name="id" value="', soy.$$escapeHtml(opt_data.id), '"/><input type="hidden" name="atl_token" value="', soy.$$escapeHtml(opt_data.atlToken), '"><input type="hidden" name="formToken" value="', soy.$$escapeHtml(opt_data.formToken), '"><input type="hidden" name="filetoconvert" value=""><div class="attach-screenshot-padding"><div class="attach-screenshot-container"><div id="attach-screenshot-inner-container"><div class="mod-content"><ul class="item-details"><li><dl><dt>Take a screenshot:</dt>', (opt_data.userPlatform == 'pc') ? '<dd><kbd>PrtScn</kbd></dd>' : '<dd><kbd> Ctrl</kbd> + <kbd> Cmd</kbd> + <kbd> Shift</kbd> + <kbd>3</kbd></dd>', '</dl></li><li><dl><dt>Paste the image:</dt>', (opt_data.userPlatform == 'pc') ? '<dd><kbd>Ctrl</kbd> + <kbd>v</kbd></dd>' : '<dd><kbd> Cmd</kbd> + <kbd>v</kbd></dd>', '</dl></li></ul></div><input type="text" id="attach-screenshot-fake-input"><div class="attach-screenshot-padding attach-screenshot-padding-inner"><div id="attach-screenshot-image-container" class="attach-screenshot-image-container"><div class="attach-screenshot-placeholder"><div class="mod-content"><ul class="item-details"><li><dl><dt id="attach-screenshot-placeholder-message">', soy.$$escapeHtml("Your image will be pasted here"), '</dt></dl></li></ul></div></div></div></div><div id=\'attach-max-size\' class="hidden">', soy.$$escapeHtml(opt_data.maxSize), '</div></div></div></div><fieldset><div><legend><span>Attach Screenshot</span></legend><div id="attach-screenshot-filename-group" class="field-group"><div id="attach-screenshot-progress-container"></div><label for="attachscreenshotname">', soy.$$escapeHtml("File name"), ' <span class="aui-icon icon-required">', soy.$$escapeHtml("Required"), '</span></label><input class="text" type="text" id="attachscreenshotname" name="attachscreenshotname" title="File Name" value="', soy.$$escapeHtml(opt_data.nextScreenshotName), '"><div class="description">', soy.$$escapeHtml("A file name to be used as attached image name"), '</div></div></div></fieldset><div class="buttons-container form-footer"><div class="buttons"><button class="aui-button" id="attach-screenshot-html5-upload">', soy.$$escapeHtml("Upload"), '</button><a href="#" class="cancel">', soy.$$escapeHtml("Cancel"), '</a></div></div></form>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.plugins.jira-html5-attach-images:jira-html5-attach-images-resources', location = 'base64decode.js' */
(function(){AJS.namespace("JIRA.AttachImagesPlugin");function a(b){return b>64&&b<91?b-65:b>96&&b<123?b-71:b>47&&b<58?b+4:b===43?62:b===47?63:0}JIRA.AttachImagesPlugin.base64decode=function(d){var k=d.replace(/[^A-Za-z0-9\+\/]/g,""),e=k.length,b=e*3+1>>2,i=new Uint8Array(b);for(var h,f,g=0,c=0,j=0;j<e;j++){f=j&3;g|=a(k.charCodeAt(j))<<18-6*f;if(f===3||e-j===1){for(h=0;h<3&&c<b;h++,c++){i[c]=g>>>(16>>>h&24)&255}g=0}}return i}})();
/* module-key = 'com.atlassian.plugins.jira-html5-attach-images:jira-html5-attach-images-resources', location = 'utility.js' */
(function(a){AJS.namespace("JIRA.AttachImagesPlugin");JIRA.AttachImagesPlugin.isPasteEvent=function(e,b){var c=86,d=(b||navigator.platform).indexOf("Mac")!==-1;return e.which===c&&(d?e.metaKey:e.ctrlKey)};JIRA.AttachImagesPlugin.browserIsSupported=function(b){var d=document.documentElement.className.split(/\s+/),e=(b||navigator.platform).indexOf("Mac")!==-1,c=a.inArray("safari",d)!==-1;return !(e&&c)}})(jQuery);
/* module-key = 'com.atlassian.plugins.jira-html5-attach-images:jira-html5-attach-images-resources', location = 'requireDeployJava.js' */
AJS.namespace("JIRA.AttachImagesPlugin");(function(b){var a=null;JIRA.AttachImagesPlugin.requireDeployJava=function(){var c;if(a!==null){return a}c=b.Deferred();a=c.promise();b('<iframe style="display: none !important; visibility: hidden !important; opacity: 0"/>').attr("src",JIRA.AttachImagesPlugin.resourceUris.get("deployJava.html")).one("load",function(){c.resolve(this.contentWindow.deployJava,this.contentWindow)}).one("error",c.reject.bind(c)).appendTo("body");return a};JIRA.AttachImagesPlugin.requireDeployJava._resetForTesting=function(){a=null}})(AJS.$);
/* module-key = 'com.atlassian.plugins.jira-html5-attach-images:jira-html5-attach-images-resources', location = 'polyfill.js' */
(function(e,b){AJS.namespace("JIRA.AttachImagesPlugin");var f,d,g,c;function a(){var h=e.Deferred();return h.reject.apply(h,arguments)}(function(){var j=document.documentElement.className.split(/\s+/),l=e.inArray("msie",j)>-1,m=e.inArray("msie-gt-7",j)>-1,k=e.inArray("msie-gt-8",j)>-1,i=e.inArray("msie-gt-9",j)>-1,h=e.inArray("msie-gt-10",j)>-1;f=l&&m&&!k;d=l&&k&&!i;g=l&&i&&!h})();JIRA.AttachImagesPlugin.polyfill=new (function(){var i;var j=b.bind(function(m){if(JIRA.AttachImagesPlugin.isPasteEvent(m)){c.reload();var l=c.getClipboardData();if(l){var k=c.getClipboardData(this.pasteImageWidth,this.pasteImageHeight);if(k.length>this.dataURILimit){var n=this.dataURILimit/k.length;k=c.getClipboardData(this.pasteImageWidth*n,this.pasteImageHeight*n)}i.trigger("polyPaste",[l,k])}}},this);this.install=b.once(function(k){i=e(k);return JIRA.AttachImagesPlugin.requireDeployJava().pipe(function(o,l){var n,r,m,p="1.7.0_06",q;if(o.getJREs().length===0){return a("java-absent")}else{if(!o.versionCheck(p+"+")){return a("java-version")}}m=!o.versionCheck("1.7.0_45+");q=JIRA.AttachImagesPlugin.resourceUris.get(m?"clipboard-legacy.jar":"clipboard.jar");n={id:"JIRA HTML5 Images Applet",codebase:JIRA.AttachImagesPlugin.dirname(q),code:"com.atlassian.plugins.jira.screenshot.applet.ScreenshotApplet.class",archive:JIRA.AttachImagesPlugin.basename(q),width:0,height:0};r={permissions:"all-permissions"};o.runApplet(n,r,p);c=l.document.getElementById(n.id);try{if(!c||!c.isSecurityOk()){return a("java-security")}}catch(s){return a("java-security")}i.on("keydown",j);return h},function(){return a("unknown")}).pipe(null,function(m){var l;if(m==="unknown"){l="A problem occurred while running Java."}else{if(m==="java-version"){l=AJS.format("You need to {0}upgrade Java{1}.",'<a href="//java.com">',"</a>")}else{if(m==="java-absent"){l=AJS.format("You need to install {0}Java{1}.",'<a href="//java.com">',"</a>")}else{if(m==="java-security"){l=AJS.format("Your Java security settings are blocking this feature. Please upgrade to the latest {0}Java{1}.",'<a href="//java.com">',"</a>")}}}}return a(m,l)})});this.isRequired=function(){return f||d||g};this.isRequiredForBinaryAjax=function(){return f||d};this.pasteImageWidth=510;this.pasteImageHeight=280;this.dataURILimit=f?32000:Number.MAX_VALUE;function h(n,l){var m=document.cookies,k=e.Deferred();c.doMultipartRequest(l,"UTF-8",window.navigator.userAgent,k);k.always(function(){document.cookies=m});return k}this.proxyAjaxRequest=function(k,l){return function(){var m=JIRA.SmartAjax.makeRequest;JIRA.SmartAjax.makeRequest=function(n){var o=b.reduce(b.keys(n.data),function(s,q){s.push(q,n.data[q]);return s},[]);o.push("secureToken",l());var p=c.doAjaxRequest(n.url,"UTF-8",window.navigator.userAgent,e.Deferred(),o);p.abort=e.noop;p.then(function(s){var r=b.filter(arguments,function(w,v){return v>0});r[0]="Status";r=b.reduce(b.reduce(r,function(y,x,v){var w=(v/2)<<0;(y[w]||(y[w]=[])).push(x);return y},[]),function(w,v){w[v[0]]=v[1];return w},{});var t={getResponseHeader:function(v){return r[v]}};var u="success";var q=new JIRA.SmartAjax.SmartAjaxResult(t,0,"success",s,true);n.complete(t,u,q)});return p};k.apply(this,arguments);JIRA.SmartAjax.makeRequest=m}}})})(AJS.$,_);
/* module-key = 'com.atlassian.plugins.jira-html5-attach-images:jira-html5-attach-images-resources', location = 'html5.js' */
AJS.namespace("JIRA.AttachImagesPlugin");JIRA.AttachImagesPlugin.handler=(function(){var a;AJS.EventQueue=AJS.EventQueue||[];a={REQUEST_TIMEOUT_MILLIS:5*60*1000,screenshotFileUpload:{},screenshotFileUploadUri:null,$document:undefined,$window:undefined,$container:undefined,$fakeInput:undefined,uploadError:false,uploadErrorMsg:"",progressView:{hidden:false,progress:0,old:0,progressBarContainer:undefined,progressEl:undefined,container:undefined,options:undefined,staticProgress:undefined,initProgress:function(){this.container=this.buildContainer();this.progressEl=this.buildProgress();this.container.append(this.progressEl);this.options={showPercentage:false,height:"2px"};this.progressBarContainer=AJS.$("#attach-screenshot-progress-container");this.progressBarContainer.empty();this.progressBarContainer.append(this.container);this.staticProgress=this.container;this.hidden=true},finish:function(){this.value(100)},progressHandler:function(d){var c=Math.round(d.loaded*100/d.total);a.progressView.value(c)},value:function(c){if(c>100){c=100}else{if(c<0){c=0}}if(this.hidden){this.progressEl.show();this.hidden=false}if(this.old!==c){this.progressEl.progressBar(c,this.options);if(c>=100){this.progressEl.fadeOut()}this.old=c}},buildContainer:function(){return AJS.$("<div>").addClass("file-progress")},buildProgress:function(){return AJS.$("<div>").attr("id","attach-screenshot-upload-progress")}},dialogView:{pasteCatcher:{},presenter:undefined,getMaxSize:function(){return AJS.$("#attach-max-size").text()},getFileSize:function(){if(AJS.$.isPlainObject(this.presenter.screenshotFileUpload)&&_.isEmpty(this.presenter.screenshotFileUpload)){return 0}return this.presenter.screenshotFileUpload.size},cleanGeneralErrors:function(){AJS.$("#error-attach-screenshot-image").closest(".field-group").remove()},cleanFileErrors:function(){AJS.$("#error-attachScreenshotFileName").remove()},displayErrors:function(c){a.dialogView.cleanFileErrors();a.dialogView.cleanGeneralErrors();if("compatibility" in c){AJS.$("#attach-screenshot-inner-container").before(aui.message.error({content:c.compatibility}))}if("fileName" in c){AJS.$("#attach-screenshot-filename-group").append('<div class="error" id="error-attach-screenshot-filename" data-field="attachscreenshotname">'+c.fileName+"</div>")}if("fileUpload" in c){AJS.$("#attach-screenshot-inner-container").append('<div class="field-group attach-screenshot-image-error"><div class="error" id="error-attach-screenshot-image">'+c.fileUpload+"</div></div>")}},appendBlobImage:function(c){var e=window.URL||window.webkitURL;var d=e.createObjectURL(c);this.presenter.screenshotFileUpload=c;this.createImage(d)},createImage:function(f){var d=new Image();d.onload=function(){};d.src=f;this.presenter.screenshotToUpload=d;var e=AJS.$(d);e.addClass("attach-screenshot-pasted-image");var c=AJS.$("#attach-screenshot-image-container");c.empty();c.append(e);this.presenter.$fakeInput.focus();a.imageCreatedHandler()},checkInput:function(){var d,c=a.dialogView.pasteCatcher.childNodes[0];if(c){if("IMG"===c.tagName){d=c.src}a.dialogView.pasteCatcher.innerHTML=""}if(!d){a.$fakeInput.focus()}return d},onPaste:function(e){a.dialogView.cleanFileErrors();a.dialogView.cleanGeneralErrors();if(e&&e.clipboardData&&e.clipboardData.items){var c=e.clipboardData.items;if(c){for(var d=0;d<c.length;d++){if(c[d].type.indexOf("image")!==-1){this.appendBlobImage(c[d].getAsFile())}}}}else{setTimeout(function(){var f=this.checkInput();if(f){a.screenshotFileUpload=a.decodeBase64DataUri(f);a.dialogView.createImage(f)}}.bind(this),0)}},getFakeInput:function(){return AJS.$("#attach-screenshot-fake-input")},getContainer:function(){return AJS.$("#attach-screenshot-image-container")},getIssueKey:function(){return AJS.$("input[name='id']").val()},getDocument:function(){return AJS.$(document)},getWindow:function(){return AJS.$(window)},getFileNameInput:function(){return AJS.$("#attachscreenshotname")},hasPngExtension:function(d){var c=/\.png$/i;return c.test(d)},setFileToConvert:function(c){AJS.$("input[name='filetoconvert']").val(c)},buildPasteCatcher:function(){if(!document.getElementById("attach-screenshot-form")){return}var c=document.createElement("div");c.setAttribute("contenteditable","true");c.style.width=0;c.style.height=0;c.style.position="absolute";c.style.top="-5000px";document.getElementById("attach-screenshot-form").appendChild(c);return c},_getFormSubmits:function(){return AJS.$("#attach-screenshot-form").find("button.aui-button")},disable:function(){this._getFormSubmits().attr("disabled","disabled");return this},enable:function(){this._getFormSubmits().removeAttr("disabled");return this},isEnabled:function(){return !this._getFormSubmits().attr("disabled")},initDialog:function(c){this.pasteCatcher={};this.presenter=c;if(!JIRA.AttachImagesPlugin.polyfill.isRequired()){this.pasteCatcher=this.buildPasteCatcher()}}},initScreenshotPasteHandler:function(){var c=a.dialogView;a.screenshotFileUpload={};a.resetUploadErrors();a.dialogView.initDialog(a.getPresenter());a.$document=c.getDocument();a.$window=c.getWindow();a.$container=c.getContainer();a.$fakeInput=c.getFakeInput();a.bindOnce(a.$container,"click",a.setFocusOnClickHandler);a.bindOnce(a.$fakeInput,"focus",a.showFocusOnFieldHandler);a.bindOnce(a.$fakeInput,"blur",a.hideFocusOnFieldHandler);a.bindOnce(a.$fakeInput,"keydown",a.keyDownHandler);if(!JIRA.AttachImagesPlugin.browserIsSupported()){c.displayErrors({compatibility:AJS.format("Your browser is not supported. Consider using an alternative supported browser such as {0}Google Chrome{1} or {2}Firefox{3}.",'<a href="//www.google.com/chrome/browser/">',"</a>",'<a href="//www.mozilla.org/firefox/">',"</a>")})}else{if(JIRA.AttachImagesPlugin.polyfill.isRequired()){JIRA.AttachImagesPlugin.polyfill.install(document).done(function(d){a.bindOnce(a.$document,"polyPaste",a.polyPasteHandler);if(JIRA.AttachImagesPlugin.polyfill.isRequiredForBinaryAjax()){a.executeAjaxUpload=d}}).fail(function(e,d){c.displayErrors({compatibility:d})})}else{a.bindOnce(a.$window,"paste",a.pasteHandler)}}},resetUploadErrors:function(){a.uploadError=false;a.uploadErrorMsg=undefined},setUploadError:function(c){a.uploadError=true;a.uploadErrorMsg=c},bindOnce:function(e,c,d){e.unbind(c,d);e.bind(c,d)},showFocusOnFieldHandler:function(){a.$container.addClass("focus")},hideFocusOnFieldHandler:function(){a.$container.addClass("focus")},setFocusOnClickHandler:function(){a.$fakeInput.focus()},pasteHandler:function(c){if(!a.dialogView.isEnabled()){return}a.dialogView.onPaste(c.originalEvent)},polyPasteHandler:function(d,c,e){if(!a.dialogView.isEnabled()){return}a.screenshotFileUpload={length:0};a.screenshotFileUploadUri=c;a.dialogView.createImage(e)},keyDownHandler:function(c){if(JIRA.AttachImagesPlugin.isPasteEvent(c)){if(a.dialogView.pasteCatcher.focus){a.dialogView.pasteCatcher.focus()}}},getPresenter:function(){return a},imageCreatedHandler:function(){a.doAjaxUpload(this.dialogView.getIssueKey())},getMimeType:function(){if(a.screenshotFileUploadUri){return"image/jpeg"}return"image/png"},createData:function(){if(JIRA.AttachImagesPlugin.polyfill.isRequired()&&!JIRA.AttachImagesPlugin.polyfill.isRequiredForBinaryAjax()){return this.decodeBase64DataUri(a.screenshotFileUploadUri)}return a.screenshotFileUpload},hasCharacter:function(d,e){return d.indexOf(e)!=-1},decodeBase64DataUri:function(d){var f=";base64,",e=d.slice(0,d.indexOf(f))+f,c=d.substring(e.length);return JIRA.AttachImagesPlugin.base64decode(c)},validateFileSize:function(f){var c=a.dialogView.getFileSize();var e=a.dialogView.getMaxSize();if(c>e){var d=AJS.InlineAttach.Text.fileSize(e,c);f.fileUpload=AJS.format("Screenshot is too large to attach. Attachment is {0} but the largest allowed attachment is {1}.",d[1],d[0])}},validateFormData:function(c,e){var d={};if(AJS.$.isPlainObject(c)&&_.isEmpty(c)){d.fileUpload="Please paste the image you wish to upload"}a.validateFileSize(d);if(a.uploadError){d.fileUpload="The error occurred during image upload - you will need to try the pasting image again. Sorry for the inconvenience."}if(""==e){d.fileName="You must specify a filename of the image."}if(this.hasCharacter(e,"\\")||this.hasCharacter(e,"/")||this.hasCharacter(e,'"')||this.hasCharacter(e,":")||this.hasCharacter(e,"?")||this.hasCharacter(e,"*")||this.hasCharacter(e,"<")||this.hasCharacter(e,"|")||this.hasCharacter(e,">")){d.fileName="Filename must not contain the characters \'\\\', \'/\', \'\"\', \':\', \'?\', \'*\', \'\u003c\', \'|\', \'\u003e\'"}return d},doAjaxUpload:function(c,j){a.dialogView.disable();var i=[];a.validateFileSize(i);if(!_.isEmpty(i)){a.dialogView.displayErrors(i);a.dialogView.enable();return}var g=a.createData(),h=a.getMimeType(),e=AJS.$("#attach-screenshot-form").data("attach-secure-token"),d=AJS.$("#attach-screenshot-form").find("input[name='formToken']").attr("value");var f=AJS.contextPath()+"/rest/internal/1.0/AttachTemporaryFile"+(JIRA.AttachImagesPlugin.polyfill.isRequired()?"/secure?":"?")+"filename="+encodeURIComponent(j)+"&atl_token="+encodeURIComponent(atl_token())+"&issueId="+encodeURIComponent(this.dialogView.getIssueKey())+(e?("&secureToken="+encodeURIComponent(e)):"")+(d?("&formToken="+encodeURIComponent(d)):"");a.resetUploadErrors();a.executeAjaxUpload(g,f,h).progress(function(k){if(k=="init"){a.progressView.initProgress()}}).done(function(k){if(typeof k=="string"){k=JSON.parse(k)}a.dialogView.setFileToConvert(k.id)}).fail(function(m,o,n,k){var l;if(k.statusText=="abort"){l="The call to the JIRA server did not complete within the timeout period.  We are unsure of the result of this operation."}else{l=JIRA.SmartAjax.buildSimpleErrorContent(k,{alert:false})}a.setUploadError(l);a.dialogView.displayErrors({fileUpload:l})}).always(function(){var k=AJS.$.Deferred();if(JIRA.AttachImagesPlugin.polyfill.isRequired()){a.reloadSecureToken(k)}else{k.resolve()}k.then(function(){a.dialogView.enable();a.progressView.finish()})}).progress(function(k){if(k!="init"){a.progressView.progressHandler(k)}})},executeAjaxUpload:function(e,d,f){var c=AJS.$.Deferred();JIRA.SmartAjax.makeRequest({type:"POST",url:d,contentType:f,processData:false,data:e,timeout:a.REQUEST_TIMEOUT_MILLIS,success:c.resolve.bind(c),error:c.reject.bind(c),xhr:function(){var g=AJS.$.ajaxSettings.xhr();c.notify("init");g.upload.addEventListener("progress",c.notify.bind(c));return g}});c.always(function(){AJS.$.ajaxSettings.xhr().removeEventListener("progress",a.progressView.progressHandler)});return c},reloadSecureToken:function(c){var d=AJS.contextPath()+"/secure/ShowAttachScreenshotFormAction!default.jspa?id="+encodeURIComponent(this.dialogView.getIssueKey())+"&inline=true&decorator=dialog&_="+(new Date().getTime());AJS.$.get(d).then(function(e){var f=AJS.$(e).find("#attach-screenshot-form").data("attach-secure-token");if(f){AJS.$("#attach-screenshot-form").data("attach-secure-token",f);c.resolve(f)}else{c.reject()}},_.bind(c.reject,c))}};var b=JIRA.FormDialog.extend({options:{}});JIRA.ScreenshotDialog=b;AJS.$(document).ready(function(){var d=AJS.$.Deferred();if(!JIRA.AttachImagesPlugin.browserIsSupported()||!JIRA.AttachImagesPlugin.polyfill.isRequired()){d.resolve()}JIRA.Dialogs.attachScreenshotDialog=new b({id:"attach-screenshot-dialog",trigger:"a.issueaction-attach-screenshot-html5",isIssueDialog:true,onContentRefresh:function c(){this.$form.bind("before-submit",function e(f){var g=a.validateFormData(a.screenshotFileUpload,AJS.$.trim(a.dialogView.getFileNameInput().val()));if(a.dialogView.getFileSize()==0){f.preventDefault();return false}else{if(!_.isEmpty(g)){a.dialogView.displayErrors(g);f.preventDefault();return false}}return true})},delayShowUntil:function(){if(JIRA.AttachImagesPlugin.polyfill.isRequired()){JIRA.AttachImagesPlugin.polyfill.install(document).done(function(){b.prototype._submitForm=JIRA.AttachImagesPlugin.polyfill.proxyAjaxRequest(b.prototype._submitForm,function(){return AJS.$("#attach-screenshot-form").data("submit-secure-token")})}).always(function(){d.resolve()})}return d}});AJS.$(document).bind("dialogContentReady",function(f,e){if(e===JIRA.Dialogs.attachScreenshotDialog&&document.getElementById("attach-screenshot-form")!==null){a.initScreenshotPasteHandler()}});AJS.$(document).ready(function(){AJS.$(document).on("click","#attach-screenshot-html5",function(){AJS.EventQueue.push({name:"attach.screenshot.html5.display",properties:{}})})})});return a})();
/* module-key = 'com.atlassian.plugins.jira-html5-attach-images:jira-html5-attach-images-resources', location = 'applet/deployJava.js' */
var deployJava=function(){var l={core:["id","class","title","style"],i18n:["lang","dir"],events:["onclick","ondblclick","onmousedown","onmouseup","onmouseover","onmousemove","onmouseout","onkeypress","onkeydown","onkeyup"],applet:["codebase","code","name","archive","object","width","height","alt","align","hspace","vspace"],object:["classid","codebase","codetype","data","type","archive","declare","standby","height","width","usemap","name","tabindex","align","border","hspace","vspace"]};var b=l.object.concat(l.core,l.i18n,l.events);var m=l.applet.concat(l.core);function g(o){if(!d.debug){return}if(console.log){console.log(o)}else{alert(o)}}function k(p,o){if(p==null||p.length==0){return true}var r=p.charAt(p.length-1);if(r!="+"&&r!="*"&&(p.indexOf("_")!=-1&&r!="_")){p=p+"*";r="*"}p=p.substring(0,p.length-1);if(p.length>0){var q=p.charAt(p.length-1);if(q=="."||q=="_"){p=p.substring(0,p.length-1)}}if(r=="*"){return(o.indexOf(p)==0)}else{if(r=="+"){return p<=o}}return false}function e(){var o="//java.com/js/webstart.png";try{return document.location.protocol.indexOf("http")!=-1?o:"http:"+o}catch(p){return"http:"+o}}function n(p){var o="http://java.com/dt-redirect";if(p==null||p.length==0){return o}if(p.charAt(0)=="&"){p=p.substring(1,p.length)}return o+"?"+p}function j(q,p){var o=q.length;for(var r=0;r<o;r++){if(q[r]===p){return true}}return false}function c(o){return j(m,o.toLowerCase())}function i(o){return j(b,o.toLowerCase())}function a(o){if("MSIE"!=deployJava.browserName){return true}if(deployJava.compareVersionToPattern(deployJava.getPlugin().version,["10","0","0"],false,true)){return true}if(o==null){return false}return !k("1.6.0_33+",o)}var d={debug:null,version:"20120801",firefoxJavaVersion:null,myInterval:null,preInstallJREList:null,returnPage:null,brand:null,locale:null,installType:null,EAInstallEnabled:false,EarlyAccessURL:null,oldMimeType:"application/npruntime-scriptable-plugin;DeploymentToolkit",mimeType:"application/java-deployment-toolkit",launchButtonPNG:e(),browserName:null,browserName2:null,getJREs:function(){var t=new Array();if(this.isPluginInstalled()){var r=this.getPlugin();var o=r.jvms;for(var q=0;q<o.getLength();q++){t[q]=o.get(q).version}}else{var p=this.getBrowser();if(p=="MSIE"){if(this.testUsingActiveX("1.7.0")){t[0]="1.7.0"}else{if(this.testUsingActiveX("1.6.0")){t[0]="1.6.0"}else{if(this.testUsingActiveX("1.5.0")){t[0]="1.5.0"}else{if(this.testUsingActiveX("1.4.2")){t[0]="1.4.2"}else{if(this.testForMSVM()){t[0]="1.1"}}}}}}else{if(p=="Netscape Family"){this.getJPIVersionUsingMimeType();if(this.firefoxJavaVersion!=null){t[0]=this.firefoxJavaVersion}else{if(this.testUsingMimeTypes("1.7")){t[0]="1.7.0"}else{if(this.testUsingMimeTypes("1.6")){t[0]="1.6.0"}else{if(this.testUsingMimeTypes("1.5")){t[0]="1.5.0"}else{if(this.testUsingMimeTypes("1.4.2")){t[0]="1.4.2"}else{if(this.browserName2=="Safari"){if(this.testUsingPluginsArray("1.7.0")){t[0]="1.7.0"}else{if(this.testUsingPluginsArray("1.6")){t[0]="1.6.0"}else{if(this.testUsingPluginsArray("1.5")){t[0]="1.5.0"}else{if(this.testUsingPluginsArray("1.4.2")){t[0]="1.4.2"}}}}}}}}}}}}}if(this.debug){for(var q=0;q<t.length;++q){g("[getJREs()] We claim to have detected Java SE "+t[q])}}return t},installJRE:function(r,p){var o=false;if(this.isPluginInstalled()&&this.isAutoInstallEnabled(r)){var q=false;if(this.isCallbackSupported()){q=this.getPlugin().installJRE(r,p)}else{q=this.getPlugin().installJRE(r)}if(q){this.refresh();if(this.returnPage!=null){document.location=this.returnPage}}return q}else{return this.installLatestJRE()}},isAutoInstallEnabled:function(o){if(!this.isPluginInstalled()){return false}if(typeof o=="undefined"){o=null}return a(o)},isCallbackSupported:function(){return this.isPluginInstalled()&&this.compareVersionToPattern(this.getPlugin().version,["10","2","0"],false,true)},installLatestJRE:function(q){if(this.isPluginInstalled()&&this.isAutoInstallEnabled()){var r=false;if(this.isCallbackSupported()){r=this.getPlugin().installLatestJRE(q)}else{r=this.getPlugin().installLatestJRE()}if(r){this.refresh();if(this.returnPage!=null){document.location=this.returnPage}}return r}else{var p=this.getBrowser();var o=navigator.platform.toLowerCase();if((this.EAInstallEnabled=="true")&&(o.indexOf("win")!=-1)&&(this.EarlyAccessURL!=null)){this.preInstallJREList=this.getJREs();if(this.returnPage!=null){this.myInterval=setInterval("deployJava.poll()",3000)}location.href=this.EarlyAccessURL;return false}else{if(p=="MSIE"){return this.IEInstall()}else{if((p=="Netscape Family")&&(o.indexOf("win32")!=-1)){return this.FFInstall()}else{location.href=n(((this.returnPage!=null)?("&returnPage="+this.returnPage):"")+((this.locale!=null)?("&locale="+this.locale):"")+((this.brand!=null)?("&brand="+this.brand):""))}}return false}}},runApplet:function(p,u,r){if(r=="undefined"||r==null){r="1.1"}var t="^(\\d+)(?:\\.(\\d+)(?:\\.(\\d+)(?:_(\\d+))?)?)?$";var o=r.match(t);if(this.returnPage==null){this.returnPage=document.location}if(o!=null){var q=this.getBrowser();if(q!="?"){if(this.versionCheck(r+"+")){this.writeAppletTag(p,u)}else{if(this.installJRE(r+"+")){this.refresh();location.href=document.location;this.writeAppletTag(p,u)}}}else{this.writeAppletTag(p,u)}}else{g("[runApplet()] Invalid minimumVersion argument to runApplet():"+r)}},writeAppletTag:function(r,w){var o="<applet ";var q="";var t="</applet>";var x=true;if(null==w||typeof w!="object"){w=new Object()}for(var p in r){if(!c(p)){w[p]=r[p]}else{o+=(" "+p+'="'+r[p]+'"');if(p=="code"){x=false}}}var v=false;for(var u in w){if(u=="codebase_lookup"){v=true}if(u=="object"||u=="java_object"||u=="java_code"){x=false}q+='<param name="'+u+'" value="'+w[u]+'"/>'}if(!v){q+='<param name="codebase_lookup" value="false"/>'}if(x){o+=(' code="dummy"')}o+=">";document.write(o+"\n"+q+"\n"+t)},versionCheck:function(p){var v=0;var x="^(\\d+)(?:\\.(\\d+)(?:\\.(\\d+)(?:_(\\d+))?)?)?(\\*|\\+)?$";var y=p.match(x);if(y!=null){var r=false;var u=false;var q=new Array();for(var t=1;t<y.length;++t){if((typeof y[t]=="string")&&(y[t]!="")){q[v]=y[t];v++}}if(q[q.length-1]=="+"){u=true;r=false;q.length--}else{if(q[q.length-1]=="*"){u=false;r=true;q.length--}else{if(q.length<4){u=false;r=true}}}var w=this.getJREs();for(var t=0;t<w.length;++t){if(this.compareVersionToPattern(w[t],q,r,u)){return true}}return false}else{var o="Invalid versionPattern passed to versionCheck: "+p;g("[versionCheck()] "+o);alert(o);return false}},isWebStartInstalled:function(r){var q=this.getBrowser();if(q=="?"){return true}if(r=="undefined"||r==null){r="1.4.2"}var p=false;var t="^(\\d+)(?:\\.(\\d+)(?:\\.(\\d+)(?:_(\\d+))?)?)?$";var o=r.match(t);if(o!=null){p=this.versionCheck(r+"+")}else{g("[isWebStartInstaller()] Invalid minimumVersion argument to isWebStartInstalled(): "+r);p=this.versionCheck("1.4.2+")}return p},getJPIVersionUsingMimeType:function(){for(var p=0;p<navigator.mimeTypes.length;++p){var q=navigator.mimeTypes[p].type;var o=q.match(/^application\/x-java-applet;jpi-version=(.*)$/);if(o!=null){this.firefoxJavaVersion=o[1];if("Opera"!=this.browserName2){break}}}},launchWebStartApplication:function(r){var o=navigator.userAgent.toLowerCase();this.getJPIVersionUsingMimeType();if(this.isWebStartInstalled("1.7.0")==false){if((this.installJRE("1.7.0+")==false)||((this.isWebStartInstalled("1.7.0")==false))){return false}}var u=null;if(document.documentURI){u=document.documentURI}if(u==null){u=document.URL}var p=this.getBrowser();var q;if(p=="MSIE"){q='<object classid="clsid:8AD9C840-044E-11D1-B3E9-00805F499D93" width="0" height="0"><PARAM name="launchjnlp" value="'+r+'"><PARAM name="docbase" value="'+u+'"></object>'}else{if(p=="Netscape Family"){q='<embed type="application/x-java-applet;jpi-version='+this.firefoxJavaVersion+'" width="0" height="0" launchjnlp="'+r+'"docbase="'+u+'" />'}}if(document.body=="undefined"||document.body==null){document.write(q);document.location=u}else{var t=document.createElement("div");t.id="div1";t.style.position="relative";t.style.left="-10000px";t.style.margin="0px auto";t.className="dynamicDiv";t.innerHTML=q;document.body.appendChild(t)}},createWebStartLaunchButtonEx:function(q,p){if(this.returnPage==null){this.returnPage=q}var o="javascript:deployJava.launchWebStartApplication('"+q+"');";document.write('<a href="'+o+'" onMouseOver="window.status=\'\'; return true;"><img src="'+this.launchButtonPNG+'" border="0" /></a>')},createWebStartLaunchButton:function(q,p){if(this.returnPage==null){this.returnPage=q}var o="javascript:if (!deployJava.isWebStartInstalled(&quot;"+p+"&quot;)) {if (deployJava.installLatestJRE()) {if (deployJava.launch(&quot;"+q+"&quot;)) {}}} else {if (deployJava.launch(&quot;"+q+"&quot;)) {}}";document.write('<a href="'+o+'" onMouseOver="window.status=\'\'; return true;"><img src="'+this.launchButtonPNG+'" border="0" /></a>')},launch:function(o){document.location=o;return true},isPluginInstalled:function(){var o=this.getPlugin();if(o&&o.jvms){return true}else{return false}},isAutoUpdateEnabled:function(){if(this.isPluginInstalled()){return this.getPlugin().isAutoUpdateEnabled()}return false},setAutoUpdateEnabled:function(){if(this.isPluginInstalled()){return this.getPlugin().setAutoUpdateEnabled()}return false},setInstallerType:function(o){this.installType=o;if(this.isPluginInstalled()){return this.getPlugin().setInstallerType(o)}return false},setAdditionalPackages:function(o){if(this.isPluginInstalled()){return this.getPlugin().setAdditionalPackages(o)}return false},setEarlyAccess:function(o){this.EAInstallEnabled=o},isPlugin2:function(){if(this.isPluginInstalled()){if(this.versionCheck("1.6.0_10+")){try{return this.getPlugin().isPlugin2()}catch(o){}}}return false},allowPlugin:function(){this.getBrowser();var o=("Safari"!=this.browserName2&&"Opera"!=this.browserName2);return o},getPlugin:function(){this.refresh();var o=null;if(this.allowPlugin()){o=document.getElementById("deployJavaPlugin")}return o},compareVersionToPattern:function(v,p,r,t){if(v==undefined||p==undefined){return false}var w="^(\\d+)(?:\\.(\\d+)(?:\\.(\\d+)(?:_(\\d+))?)?)?$";var x=v.match(w);if(x!=null){var u=0;var y=new Array();for(var q=1;q<x.length;++q){if((typeof x[q]=="string")&&(x[q]!="")){y[u]=x[q];u++}}var o=Math.min(y.length,p.length);if(t){for(var q=0;q<o;++q){if(y[q]<p[q]){return false}else{if(y[q]>p[q]){return true}}}return true}else{for(var q=0;q<o;++q){if(y[q]!=p[q]){return false}}if(r){return true}else{return(y.length==p.length)}}}else{return false}},getBrowser:function(){if(this.browserName==null){var o=navigator.userAgent.toLowerCase();g("[getBrowser()] navigator.userAgent.toLowerCase() -> "+o);if((o.indexOf("msie")!=-1)&&(o.indexOf("opera")==-1)){this.browserName="MSIE";this.browserName2="MSIE"}else{if(o.indexOf("trident")!=-1||o.indexOf("Trident")!=-1){this.browserName="MSIE";this.browserName2="MSIE"}else{if(o.indexOf("iphone")!=-1){this.browserName="Netscape Family";this.browserName2="iPhone"}else{if((o.indexOf("firefox")!=-1)&&(o.indexOf("opera")==-1)){this.browserName="Netscape Family";this.browserName2="Firefox"}else{if(o.indexOf("chrome")!=-1){this.browserName="Netscape Family";this.browserName2="Chrome"}else{if(o.indexOf("safari")!=-1){this.browserName="Netscape Family";this.browserName2="Safari"}else{if((o.indexOf("mozilla")!=-1)&&(o.indexOf("opera")==-1)){this.browserName="Netscape Family";this.browserName2="Other"}else{if(o.indexOf("opera")!=-1){this.browserName="Netscape Family";this.browserName2="Opera"}else{this.browserName="?";this.browserName2="unknown"}}}}}}}}g("[getBrowser()] Detected browser name:"+this.browserName+", "+this.browserName2)}return this.browserName},testUsingActiveX:function(o){var q="JavaWebStart.isInstalled."+o+".0";if(typeof ActiveXObject=="undefined"||!ActiveXObject){g("[testUsingActiveX()] Browser claims to be IE, but no ActiveXObject object?");return false}try{return(new ActiveXObject(q)!=null)}catch(p){return false}},testForMSVM:function(){var p="{08B0E5C0-4FCB-11CF-AAA5-00401C608500}";if(typeof oClientCaps!="undefined"){var o=oClientCaps.getComponentVersion(p,"ComponentID");if((o=="")||(o=="5,0,5000,0")){return false}else{return true}}else{return false}},testUsingMimeTypes:function(p){if(!navigator.mimeTypes){g("[testUsingMimeTypes()] Browser claims to be Netscape family, but no mimeTypes[] array?");return false}for(var q=0;q<navigator.mimeTypes.length;++q){s=navigator.mimeTypes[q].type;var o=s.match(/^application\/x-java-applet\x3Bversion=(1\.8|1\.7|1\.6|1\.5|1\.4\.2)$/);if(o!=null){if(this.compareVersions(o[1],p)){return true}}}return false},testUsingPluginsArray:function(p){if((!navigator.plugins)||(!navigator.plugins.length)){return false}var o=navigator.platform.toLowerCase();for(var q=0;q<navigator.plugins.length;++q){s=navigator.plugins[q].description;if(s.search(/^Java Switchable Plug-in (Cocoa)/)!=-1){if(this.compareVersions("1.5.0",p)){return true}}else{if(s.search(/^Java/)!=-1){if(o.indexOf("win")!=-1){if(this.compareVersions("1.5.0",p)||this.compareVersions("1.6.0",p)){return true}}}}}if(this.compareVersions("1.5.0",p)){return true}return false},IEInstall:function(){location.href=n(((this.returnPage!=null)?("&returnPage="+this.returnPage):"")+((this.locale!=null)?("&locale="+this.locale):"")+((this.brand!=null)?("&brand="+this.brand):""));return false},done:function(p,o){},FFInstall:function(){location.href=n(((this.returnPage!=null)?("&returnPage="+this.returnPage):"")+((this.locale!=null)?("&locale="+this.locale):"")+((this.brand!=null)?("&brand="+this.brand):"")+((this.installType!=null)?("&type="+this.installType):""));return false},compareVersions:function(r,t){var p=r.split(".");var o=t.split(".");for(var q=0;q<p.length;++q){p[q]=Number(p[q])}for(var q=0;q<o.length;++q){o[q]=Number(o[q])}if(p.length==2){p[2]=0}if(p[0]>o[0]){return true}if(p[0]<o[0]){return false}if(p[1]>o[1]){return true}if(p[1]<o[1]){return false}if(p[2]>o[2]){return true}if(p[2]<o[2]){return false}return true},enableAlerts:function(){this.browserName=null;this.debug=true},poll:function(){this.refresh();var o=this.getJREs();if((this.preInstallJREList.length==0)&&(o.length!=0)){clearInterval(this.myInterval);if(this.returnPage!=null){location.href=this.returnPage}}if((this.preInstallJREList.length!=0)&&(o.length!=0)&&(this.preInstallJREList[0]!=o[0])){clearInterval(this.myInterval);if(this.returnPage!=null){location.href=this.returnPage}}},writePluginTag:function(){var o=this.getBrowser();if(o=="MSIE"){document.write('<object classid="clsid:CAFEEFAC-DEC7-0000-0001-ABCDEFFEDCBA" id="deployJavaPlugin" width="0" height="0" style="position: absolute; top: -5000px;"></object>')}else{if(o=="Netscape Family"&&this.allowPlugin()){this.writeEmbedTag()}}},refresh:function(){navigator.plugins.refresh(false);var o=this.getBrowser();if(o=="Netscape Family"&&this.allowPlugin()){var p=document.getElementById("deployJavaPlugin");if(p==null){this.writeEmbedTag()}}},writeEmbedTag:function(){var o=false;if(navigator.mimeTypes!=null){for(var p=0;p<navigator.mimeTypes.length;p++){if(navigator.mimeTypes[p].type==this.mimeType){if(navigator.mimeTypes[p].enabledPlugin){document.write('<embed id="deployJavaPlugin" type="'+this.mimeType+'" hidden="true" />');o=true}}}if(!o){for(var p=0;p<navigator.mimeTypes.length;p++){if(navigator.mimeTypes[p].type==this.oldMimeType){if(navigator.mimeTypes[p].enabledPlugin){document.write('<embed id="deployJavaPlugin" type="'+this.oldMimeType+'" hidden="true" />')}}}}}}};d.writePluginTag();if(d.locale==null){var h=null;if(h==null){try{h=navigator.userLanguage}catch(f){}}if(h==null){try{h=navigator.systemLanguage}catch(f){}}if(h==null){try{h=navigator.language}catch(f){}}if(h!=null){h.replace("-","_");d.locale=h}}return d}();
/* module-key = 'com.atlassian.jira-core-project-templates:jira-sample-project-resources', location = '/js/DemoProjectTemplate.js' */
JPT.DemoProjectTemplate={};JPT.DemoProjectTemplate.init=function init(){AJS.$("body").on("com.atlassian.jira-core-project-templates:jira-sample-item",function(b,a){JPT.DemoProjectTemplate.createDemoProject(a)})};JPT.DemoProjectTemplate.createDemoProject=function createDemoProject(a){a.addPanel("DemoProjectTemplate",JIRA.Templates.ProjectTemplates.CoreTemplates.renderLoadingSampleProject(),"");$demoProjectForm=AJS.$("<form></form>");$demoProjectForm.attr("action",contextPath+"/secure/CreateDemoProject.jspa");$demoProjectAtlTokenField=AJS.$("<input type='hidden' name='atl_token' value='' />");$demoProjectAtlTokenField.val(atl_token());$demoProjectForm.append($demoProjectAtlTokenField);$demoProjectForm.appendTo(JPT.DialogController.$dialogElement);$demoProjectForm.submit()};AJS.$(JPT.DemoProjectTemplate.init);
/* module-key = 'com.atlassian.jira-core-project-templates:jira-sample-project-resources', location = '/soy/CoreProjectTemplates.soy' */
// This file was automatically generated from CoreProjectTemplates.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.ProjectTemplates == 'undefined') { JIRA.Templates.ProjectTemplates = {}; }
if (typeof JIRA.Templates.ProjectTemplates.CoreTemplates == 'undefined') { JIRA.Templates.ProjectTemplates.CoreTemplates = {}; }


JIRA.Templates.ProjectTemplates.CoreTemplates.renderLoadingSampleProject = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class=\'demo-loading-container\'><span class=\'icon throbber loading\'/><span class=\'demo-loading-message\'>', soy.$$escapeHtml("Loading Demo Project"), '</span></div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira-core-project-templates:jira-sample-project-resources', location = '/soy/IssueTrackingTemplates.soy' */
// This file was automatically generated from IssueTrackingTemplates.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.ProjectTemplates == 'undefined') { JIRA.Templates.ProjectTemplates = {}; }
if (typeof JIRA.Templates.ProjectTemplates.CoreTemplates == 'undefined') { JIRA.Templates.ProjectTemplates.CoreTemplates = {}; }


JIRA.Templates.ProjectTemplates.CoreTemplates.renderIssueTrackingExplanation = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="issue-tracking-info"><div class="left-info"><p>', soy.$$escapeHtml("This project provides you with a quick and easy way to get JIRA up and running for simple issue tracking. Select this project to keep things simple. You can optionally configure these later."), '</p><h3>', soy.$$escapeHtml("Issue Types"), '</h3><ul class="project-template-issuetype-list"><li><span class="issuetype-list-label"><span class="issuetype-icon newfeature"></span><span class="issuetype-name">', soy.$$escapeHtml("New Feature"), '</span></span></li><li><span class="issuetype-list-label"><span class="issuetype-icon task"></span><span class="issuetype-name">', soy.$$escapeHtml("Task"), '</span></span></li><li><span class="issuetype-list-label"><span class="issuetype-icon subtask"></span><span class="issuetype-name">', soy.$$escapeHtml("Sub-task"), '</span></span></li></ul></div><div class="right-info issue-tracking-screenshot"></div></div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-issue-link-confluence-plugin:issue-link-confluence-js', location = 'js/issuelink-confluence.js' */
(function($){var settings={getCurrentAppId:function(context){return $("#issue-link-confluence-app-id",context).val()},shouldExecute:function(context){return $("#confluence-page-link",context).length!==0},getIssueId:function(context){return $("input[name=id]",context).val()}};JIRA.bind(JIRA.Events.NEW_PAGE_ADDED,function(e,context){IssueLinkAppLinks.init(settings,context)})})(AJS.$);
/* module-key = 'com.atlassian.jira.jira-issue-link-confluence-plugin:confluence-page-resource', location = 'js/ConfluencePageSearch.js' */
AJS.$(function($){var confluenceSearchDialog=new JIRA.FormDialog({id:"confluence-page-search-dialog",trigger:"#confluence-page-link .confluence-search-trigger",widthClass:"large",height:"565px",content:function(render){var dialog=this;JIRA.SmartAjax.makeRequest({url:contextPath+"/rest/confluenceIssueLink/1/confluence/applink",complete:function(xhr,textStatus,smartAjaxResult){if(smartAjaxResult.successful){var appLinks=smartAjaxResult.data.applicationLinks;render(JIRA.Templates.ConfluencePageSearch.result({appLinks:appLinks}));initAppLinks(dialog).done(function(context,helper){initSearchDialog(context,helper);$("#link-search-text",context).focus()})}else{AJS.messages.error("#search-results-table",{body:"The JIRA server could not be contacted. This may be a temporary glitch or the server may be down.",closeable:false});render()}}})},submitHandler:function(e,callback){e.preventDefault();$("#search-panel-button").click().removeAttr("disabled");callback()}});function initSearchDialog($dialog,helper){$("#confluence-app-link",$dialog).change(function(){var authenticationRequired=helper.selectServer($(this).val()).authenticationRequired;if(!authenticationRequired){populateSpaces($dialog,$(this).val(),helper)}$("#search-results-table",$dialog).empty();setSearchControlsEnabled(true,$dialog)});$("#search-panel-button",$dialog).click(function(){$("#search-results-table",$dialog).empty();var searchText=$("#link-search-text",$dialog).val();searchText=$.trim(searchText);if(searchText){doSearch(searchText,$dialog)}else{AJS.messages.info("#search-results-table",{body:"Please enter search value.",closeable:false})}return false})}var spaceAjaxId=0;function populateSpaces($context,appId,helper){$("select#search-panel-space",$context).html(JIRA.Templates.ConfluencePageSearch.allSpacesOption());var myAjaxId=++spaceAjaxId;JIRA.SmartAjax.makeRequest({url:contextPath+"/rest/confluenceIssueLink/1/confluence/space?appId="+appId,complete:function(xhr,textStatus,smartAjaxResult){if(myAjaxId!==spaceAjaxId){return }if(smartAjaxResult.successful){var spaces=smartAjaxResult.data.spaces;$("select#search-panel-space",$context).html(JIRA.Templates.ConfluencePageSearch.spaceOptions({spaces:spaces}))}else{if(smartAjaxResult.status===401){helper.setAuthenticationRequired(appId,true)}else{setSearchControlsEnabled(false,$context);var msg;if(smartAjaxResult.status===403){msg="Content on the Confluence site could not be accessed because the Confluence server\'s \'Remote API\' feature is disabled. The Confluence system administrator must enable this \'Remote API\' feature for JIRA to successfully access this content."}else{msg="Unable to gather information from the selected Confluence instance."}AJS.messages.error("#search-results-table",{body:msg,closeable:false})}}}})}function setSearchControlsEnabled(enabled,$context){if(enabled){$("#link-search-text",$context).removeAttr("disabled");$("#search-panel-space",$context).removeAttr("disabled");$("#search-panel-button",$context).removeAttr("disabled")}else{$("#link-search-text",$context).attr("disabled","disabled");$("#search-panel-space",$context).attr("disabled","disabled");$("#search-panel-button",$context).attr("disabled","disabled")}}function setLoadingIconVisible(visible,$context){$("#link-search-loading",$context).toggleClass("hidden",!visible)}function doSearch(searchText,$context){setLoadingIconVisible(true,$context);var appLinkId=$("#confluence-app-link",$context).val();var spaceKey=$("#search-panel-space option:selected",$context).val();JIRA.SmartAjax.makeRequest({url:contextPath+"/rest/confluenceIssueLink/1/confluence/search?query="+searchText+"&appId="+appLinkId+"&spaceKey="+spaceKey+"&maxResults=10",complete:function(xhr,textStatus,smartAjaxResult){setLoadingIconVisible(false,$context);if(smartAjaxResult.successful){var results=smartAjaxResult.data.result;var resultHtml=JIRA.Templates.ConfluencePageSearch.resultsTable({results:results});$("#search-results-table",$context).html(resultHtml)}else{var msg;if(smartAjaxResult.hasData){msg="The JIRA server was contacted but has returned an error response. We are unsure of the result of this operation."}else{msg="The JIRA server could not be contacted. This may be a temporary glitch or the server may be down."}AJS.messages.error("#search-results-table",{body:msg,closeable:false})}$("#confluence-searchresult tbody tr",$context).click(function(){var linkUrl=$(this).children().first().data("url");$("#confluence-page-url").val(linkUrl);$("#link-issue-dialog .error").hide();confluenceSearchDialog.hide();$("#link-issue-dialog").show();$("#confluence-page-url").focus().select()})}})}function initAppLinks(dialog){var settings={getCurrentAppId:function(context){return $("#confluence-app-link",context).val()},shouldExecute:function(context){return $("#confluence-app-link",context).length!==0},onAuthenticationSuccessCallback:function(context,currentAppId,helper){populateSpaces(context,currentAppId,helper)},getIssueId:function(context){return $("#confluence-page-link input[name=id]").val()}};return IssueLinkAppLinks.init(settings,dialog.$popup).done(function(context,helper){populateSpaces(context,settings.getCurrentAppId(context),helper)})}});
/* module-key = 'com.atlassian.jira.jira-issue-link-confluence-plugin:confluence-page-resource', location = 'templates/dialog/searchresult.soy' */
// This file was automatically generated from searchresult.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.ConfluencePageSearch == 'undefined') { JIRA.Templates.ConfluencePageSearch = {}; }


JIRA.Templates.ConfluencePageSearch.result = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<h2>', soy.$$escapeHtml("Find a Confluence page"), '</h2><form class="aui search-form" id="confluence-page-search-form" action="#" method="post"><div class="field-group"><label for="confluence-app-link">', soy.$$escapeHtml("Server"), ':</label>');
  if (opt_data.appLinks.length == 1) {
    output.append('<span class="field-value">', soy.$$escapeHtml(opt_data.appLinks[0].name), '</span><input id="confluence-app-link" class="hidden" type="hidden" name="appId" value="', soy.$$escapeHtml(opt_data.appLinks[0].id), '"/>');
  } else {
    output.append('<select id="confluence-app-link" class="select medium-field" name="appId">');
    var appLinkList17 = opt_data.appLinks;
    var appLinkListLen17 = appLinkList17.length;
    for (var appLinkIndex17 = 0; appLinkIndex17 < appLinkListLen17; appLinkIndex17++) {
      var appLinkData17 = appLinkList17[appLinkIndex17];
      output.append('<option value="', soy.$$escapeHtml(appLinkData17.id), '">', soy.$$escapeHtml(appLinkData17.name), '</option>');
    }
    output.append('</select>');
  }
  output.append('</div><div class="issue-link-applinks-authentication-message applinks-message-bar"></div><div class="hidden"><input class="issue-link-applinks-application-type" type="hidden" value="com.atlassian.applinks.api.application.confluence.ConfluenceApplicationType"/></div><div class="issue-link-oauth-toggle field-group"><label for="link-search-text" id="linkSearch-label">', soy.$$escapeHtml("Search"), ':</label><input id="link-search-text" type="text" tabindex="0" class="text" name="linkSearch" size="50" /> <select tabindex="0" class="search-space select" id="search-panel-space"><option value="">', soy.$$escapeHtml("All Spaces"), '</option></select> <input type="submit" tabindex="0" class="aui-button" id="search-panel-button" value="', soy.$$escapeHtml("Search"), '"/><span id="link-search-loading" class="icon loading throbber hidden"/></div><div class="message-panel hidden"></div><div id="search-results-table" class="data-table"></div><div class="buttons-container form-footer"><div class="buttons"><button class="aui-button aui-button-link cancel" id="confluence-link-cancel" title="', soy.$$escapeHtml("Press Esc to close"), '">', soy.$$escapeHtml("Close"), '</button></div></div></form>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ConfluencePageSearch.resultsTable = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.results.length > 0) {
    output.append('<table id="confluence-searchresult" class="aui"><thead><tr><th width="180px">', soy.$$escapeHtml("Title"), '</th><th width="550px">', soy.$$escapeHtml("Excerpt"), '</th></tr></thead><tbody>');
    var resultList44 = opt_data.results;
    var resultListLen44 = resultList44.length;
    for (var resultIndex44 = 0; resultIndex44 < resultListLen44; resultIndex44++) {
      var resultData44 = resultList44[resultIndex44];
      output.append('<tr title="', soy.$$escapeHtml(resultData44.title), '"><td class="title" data-url="', soy.$$escapeHtml(resultData44.url), '">', soy.$$escapeHtml(resultData44.title), '</td><td class="excerpt">', soy.$$escapeHtml(resultData44.excerpt), '</td></tr>');
    }
    output.append('</tbody></table>');
  } else {
    output.append('<div class="aui-message info"><span class="aui-icon icon-info"></span><p>', soy.$$escapeHtml("Search returned no results."), '</p></div>');
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ConfluencePageSearch.spaceOptions = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<option value="">', soy.$$escapeHtml("All Spaces"), '</option>');
  var spaceList64 = opt_data.spaces;
  var spaceListLen64 = spaceList64.length;
  for (var spaceIndex64 = 0; spaceIndex64 < spaceListLen64; spaceIndex64++) {
    var spaceData64 = spaceList64[spaceIndex64];
    output.append('<option value="', soy.$$escapeHtml(spaceData64.key), '">', soy.$$escapeHtml(spaceData64.name), '</option>');
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ConfluencePageSearch.allSpacesOption = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<option value="">', soy.$$escapeHtml("All Spaces"), '</option><option value="" disabled="disabled">', soy.$$escapeHtml("Loading..."), '</option>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-feedback-plugin:shared-resources', location = '/js/shared/Link.js' */
(function(){var c;var a=function(d){return AJS.Meta.getBoolean(d)===true};var b=Class.extend({suppress:function(){c=true;return undefined},isSuppressed:function(){if(c===true){return true}return a("disable-issue-collector")}});JIRA=JIRA||{};JIRA.Feedback=JIRA.Feedback||{};JIRA.Feedback.Link=new b()})();
/* module-key = 'com.atlassian.jira.jira-feedback-plugin:bootstrap-resources', location = '/templates/feedback-link.soy' */
// This file was automatically generated from feedback-link.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Feedback == 'undefined') { JIRA.Feedback = {}; }
if (typeof JIRA.Feedback.Plugin == 'undefined') { JIRA.Feedback.Plugin = {}; }


JIRA.Feedback.Plugin.subtleLink = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class=\'jira-feedback-link-container float subtle-style\'><a class=\'js-feedback-link jira-feedback-link\' href=\'#\'>', soy.$$escapeHtml("Got Feedback?"), '</a></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Feedback.Plugin.footerLink = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li class=\'jira-feedback-link-container footer-style\'><a class="aui-button jira-feedback-link ">', soy.$$escapeHtml("Got Feedback?"), '</a></li>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-feedback-plugin:bootstrap-resources', location = '/js/jic-bootstrap.js' */
(function($){var ATL_JQ=function(){return $.apply($,arguments)};var baseUrl="https://jira.atlassian.com";var css=".atlwdg-blanket {background: black;height: 100%;left: 0;opacity: .5;position: fixed;top: 0;width: 100%;z-index: 1000000;}.atlwdg-popup {background: white;border: 1px solid #666;position: fixed;top: 50%;left: 50%;z-index: 10000011;}.atlwdg-popup.atlwdg-box-shadow {-moz-box-shadow: 10px 10px 20px rgba(0,0,0,0.5);-webkit-box-shadow: 10px 10px 20px rgba(0,0,0,0.5);box-shadow: 10px 10px 20px rgba(0,0,0,0.5);background-color: white;}.atlwdg-hidden {display: none;}.atlwdg-trigger {position: fixed;background: #013466;padding: 5px;border: 2px solid white;border-top: none;font-weight: bold;color: white !important;display: block;white-space: nowrap;text-decoration: none !important;font-family: arial, FreeSans, Helvetica, sans-serif;font-size: 12px;box-shadow: 5px 5px 10px rgba(0, 0, 0, 0.5);-webkit-box-shadow: 5px 5px 10px rgba(0, 0, 0, 0.5);-moz-box-shadow: 5px 5px 10px rgba(0, 0, 0, 0.5);border-radius: 0 0 5px 5px;-moz-border-radius: 0 0 5px 5px;}.atlwdg-trigger.atlwdg-TOP {left: 45%;top: 0;}.atlwdg-trigger.atlwdg-RIGHT {left: 100%;top: 40%;-webkit-transform-origin: top left;-webkit-transform: rotate(90deg);-moz-transform: rotate(90deg);-moz-transform-origin: top left;-ms-transform: rotate(90deg);-ms-transform-origin: top left;}.atlwdg-trigger.atlwdg-SUBTLE {right: 0;bottom: 0;border: 1px solid #ccc;border-bottom: none;border-right: none;background-color: #f5f5f5;color: #444;font-size: 11px;padding: 6px;box-shadow: -1px -1px 2px rgba(0, 0, 0, 0.5);border-radius: 2px 0 0 0;}.atlwdg-loading {position: absolute;top: 220px;left: 295px;}";var cssIE=".atlwdg-trigger {position: absolute;}.atlwdg-blanket {position: absolute;filter: alpha(opacity=50);width: 110%;}.atlwdg-popup {position: absolute;}.atlwdg-trigger.atlwdg-RIGHT {left: auto;right: 0;filter: progid:DXImageTransform.Microsoft.BasicImage(rotation=1);}";ATL_JQ.isQuirksMode=function(){return document.compatMode!="CSS1Compat"};ATL_JQ.IssueDialog=function(options){var $body=$("body"),that=this,showDialog=function(){that.show();return false};this.options=options;this.frameUrl=baseUrl+"/rest/collectors/1.0/template/form/"+this.options.collectorId+"?os_authType=none";$("head").append("<style type='text/css'>"+css+"</style>");if(this.options.triggerPosition==="CUSTOM"){var oldTriggerFunction;if(this.options.triggerFunction){try{oldTriggerFunction=eval("("+this.options.triggerFunction+")")}catch(ex){}}$(function(){try{var newTriggerFunction;if(window.ATL_JQ_PAGE_PROPS&&((window.ATL_JQ_PAGE_PROPS.triggerFunction)||(window.ATL_JQ_PAGE_PROPS[this.options.collectorId]&&window.ATL_JQ_PAGE_PROPS[this.options.collectorId].triggerFunction))){newTriggerFunction=window.ATL_JQ_PAGE_PROPS.triggerFunction||window.ATL_JQ_PAGE_PROPS[this.options.collectorId].triggerFunction}else{newTriggerFunction=oldTriggerFunction}if($.isFunction(newTriggerFunction)){newTriggerFunction(showDialog)}}catch(ex){}})}else{if($.isFunction(this.options.triggerPosition)){try{this.options.triggerPosition(showDialog)}catch(ex){}}else{if(this.options.triggerPosition&&this.options.triggerText){var triggerClass="atlwdg-trigger atlwdg-"+this.options.triggerPosition;var $trigger=$("<a href='#' id='atlwdg-trigger'/>").addClass(triggerClass).text(this.options.triggerText);$body.append($trigger);$trigger.click(showDialog)}}}var $iframeContainer=$("<div id='atlwdg-container'/>").addClass("atlwdg-popup atlwdg-box-shadow atlwdg-hidden");var $blanket=$("<div id='atlwdg-blanket' class='atlwdg-blanket'/>").hide();$body.append($blanket).append($iframeContainer);if($.browser.msie&&(ATL_JQ.isQuirksMode()||$.browser.version<9)){$("head").append("<style type='text/css'>"+cssIE+"</style>");var triggerAdjuster=function(e){};if(this.options.triggerPosition==="TOP"){triggerAdjuster=function(e){$("#atlwdg-trigger").css("top",$(window).scrollTop()+"px")}}else{if(this.options.triggerPosition==="RIGHT"){triggerAdjuster=function(e){var $trigger=$("#atlwdg-trigger");$trigger.css("top",($(window).height()/2-$trigger.outerWidth()/2+$(window).scrollTop())+"px");if(!ATL_JQ.isQuirksMode()&&$.browser.version==="8.0"){$trigger.css("right",-($trigger.outerHeight()-$trigger.outerWidth())+"px")}}}else{if(this.options.triggerPosition==="SUBTLE"){var outerHeight=$trigger.outerHeight();triggerAdjuster=function(e){var $window=$(window);$trigger.css("top",($window.scrollTop()+$window.height()-outerHeight)+"px")}}}}$(window).bind("scroll resize",triggerAdjuster);triggerAdjuster()}};ATL_JQ.IssueDialog.prototype={hideDialog:undefined,updateContainerPosition:function(){var width=810,height=450;$("#atlwdg-container").css({height:height+"px",width:width+"px","margin-top":-Math.round(height/2)+"px","margin-left":-Math.round(width/2)+"px"});$("#atlwdg-frame").height("100%").width("100%")},show:function(){var that=this,$iframeContainerElem=$("#atlwdg-container"),$body=$("body"),$iframeElem=$('<iframe id="atlwdg-frame" frameborder="0" src="'+this.frameUrl+'"></iframe>'),$loadingImage=$('<img class="atlwdg-loading" style="display:none;" src="https://jira.atlassian.com/images/throbber/loading_barber_pole_horz.gif">');hideDialog=function(e){if(e.keyCode===27){that.hide()}};$iframeContainerElem.append($loadingImage);var throbberTimeout=setTimeout(function(){$loadingImage.show()},300);$body.css("overflow","hidden").keydown(hideDialog);window.scroll(0,0);var feedbackString="";if(this.options.collectFeedback){var feedback=this.options.collectFeedback();for(var prop in feedback){if(feedback.hasOwnProperty(prop)&&feedback[prop]!==undefined&&feedback[prop]!==""&&typeof feedback[prop]==="string"){feedbackString+="*"+prop+"*: "+feedback[prop]+"\n"}}}var fieldValues={};if(this.options.fieldValues&&!$.isEmptyObject(this.options.fieldValues)){$.extend(fieldValues,this.options.fieldValues)}$iframeElem.load(function(){var message={feedbackString:feedbackString,fieldValues:fieldValues};$iframeElem[0].contentWindow.postMessage(JSON.stringify(message),"https://jira.atlassian.com");$(window).bind("message",function(e){if(e.originalEvent.data&&e.originalEvent.data==="cancelFeedbackDialog"){that.hide()}})});$iframeElem.load(function(e){clearTimeout(throbberTimeout);$loadingImage.hide();$iframeElem.show()});var currentMilis=new Date().getTime();var dummyElement=document.createElement("a");dummyElement.href="https://jira.atlassian.com";$iframeContainerElem.append($iframeElem);this.updateContainerPosition();$iframeContainerElem.show();$("#atlwdg-blanket").show()},hide:function(){$("body").css("overflow","auto").unbind("keydown",hideDialog);$("#atlwdg-container").hide().empty();$("#atlwdg-blanket").hide()}};var filterStrings=function(obj,recursingIn){for(var key in obj){if(!obj.hasOwnProperty(key)){continue}var value=obj[key];if(recursingIn===undefined&&$.isArray(value)){filterStrings(value,key);continue}if(typeof value!=="string"){var paramName=recursingIn===undefined?key:recursingIn+":"+key;console.log("bootstrap.js:filterStrings ignoring key for value '"+paramName+"'; typeof must be string");delete obj[key]}}return obj};window.JIRAS_OWN_ATL_JQ=ATL_JQ})(jQuery);var JSON;if(!JSON){JSON={}}(function(){function f(n){return n<10?"0"+n:n}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(key){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(key){return this.valueOf()}}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(string){escapable.lastIndex=0;return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+string+'"'}function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];if(value&&typeof value==="object"&&typeof value.toJSON==="function"){value=value.toJSON(key)}if(typeof rep==="function"){value=rep.call(holder,key,value)}switch(typeof value){case"string":return quote(value);case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null"}gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==="[object Array]"){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||"null"}v=partial.length===0?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]";gap=mind;return v}if(rep&&typeof rep==="object"){length=rep.length;for(i=0;i<length;i+=1){if(typeof rep[i]==="string"){k=rep[i];v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}else{for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}v=partial.length===0?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}";gap=mind;return v}}if(typeof JSON.stringify!=="function"){JSON.stringify=function(value,replacer,space){var i;gap="";indent="";if(typeof space==="number"){for(i=0;i<space;i+=1){indent+=" "}}else{if(typeof space==="string"){indent=space}}rep=replacer;if(replacer&&typeof replacer!=="function"&&(typeof replacer!=="object"||typeof replacer.length!=="number")){throw new Error("JSON.stringify")}return str("",{"":value})}}if(typeof JSON.parse!=="function"){JSON.parse=function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==="object"){for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v}else{delete value[k]}}}}return reviver.call(holder,key,value)}text=String(text);cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})}if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse")}}}());
/* module-key = 'com.atlassian.jira.jira-feedback-plugin:bootstrap-resources', location = '/js/jira-feedback-plugin.js' */
AJS.$(function(f){var d="d3de7fb5";var g="c612fb25";var e=AJS.Meta.get("version-number");var c=!(f.browser.msie&&parseInt(f.browser.version,10)<9);var b=function(){if(!c){return false}if(AJS.DarkFeatures.isEnabled("com.atlassian.jira.config.CoreFeatures.ON_DEMAND")){return g}if(AJS.params.baseURL&&AJS.params.baseURL.indexOf("sandbox.onjira.com")>=0){return d}if(AJS.Meta.get("is-beta")||AJS.Meta.get("is-rc")||AJS.Meta.get("is-snapshot")||AJS.Meta.get("is-milestone")){return d}if(f(".licensemessagered:contains('JIRA evaluation license')").length>0){return d}return false};var a=b();if(!JIRA.Feedback.Link.isSuppressed()&&a){h();JIRA.bind(JIRA.Events.LAYOUT_RENDERED,i);JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,i)}function i(o,l,n){if((o.type==="newContentAdded"&&n==="pageLoad")||(o.type==="layoutRendered"&&l==="list-view")){var m=f(".navigator-sidebar").hasClass("collapsed");var k=f(".jira-feedback-link-container");k.remove();k=h();if(m&&k.hasClass("subtle-style")){k.addClass("left noborder")}}}function j(){var k=f("#footer-build-information").text();var m=function(){return{Location:window.location.href,"User-Agent":navigator.userAgent,Referrer:document.referrer,"Screen Resolution":screen.width+" x "+screen.height,"JIRA Version":e,"JIRA Footer Version":k}};var l=new JIRAS_OWN_ATL_JQ.IssueDialog({collectorId:a,collectFeedback:m});l.show()}function h(){var m=f("#footer .atlassian-footer:visible").eq(0);var l;if(m.length>0){l=m;l.append(JIRA.Feedback.Plugin.footerLink())}else{l=f("body");l.append(JIRA.Feedback.Plugin.subtleLink())}var k=l.find(".jira-feedback-link-container");k.on("click",".jira-feedback-link",j);return k}});
/* module-key = 'com.pyxis.greenhopper.jira:gh-analytics-tracker', location = 'includes/js/rapid/AnalyticsTracker.js' */
if(typeof GH==="undefined"){window.GH={}}GH.AnalyticsTracker=function(b,d,a){if(_.isUndefined(b)){throw new Error("You must specify a category")}this.params={};this.params.category=b;var c=0;if(!_.isUndefined(d)){this.params.action=d;c++;if(!_.isUndefined(a)){this.params.label=a;c++}}this.requiredArgumentNames=["action","label","value"].slice(c);this.useAsync=true};GH.AnalyticsTracker.prototype.setAsync=function(a){this.useAsync=a;return this};GH.AnalyticsTracker.prototype.trigger=function(){if(this.requiredArgumentNames.length<arguments.length){AJS.log("Warning: too many arguments passed in. Needed at most "+this.requiredArgumentNames.length+" but got "+arguments.length)}var c=_.clone(this.params);for(var b=0;b<arguments.length&&!_.isUndefined(this.requiredArgumentNames[b]);b++){c[this.requiredArgumentNames[b]]=arguments[b]}this._validateParams(c);var a="gh.analytics.async";AJS.$(AJS).trigger(a,c)};GH.AnalyticsTracker.prototype._validateParams=function(b){var a=["category","action","label"];_.each(a,function(c){if(!_.isUndefined(b[c])&&!_.isString(b[c])){b[c]=b[c].toString()}else{if(_.isUndefined(b[c])){b[c]=""}}});_.each(["category","action"],function(c){b[c]=b[c].replace(/\s+/g,"")});if(!_.isUndefined(b.value)){b.value=parseInt(b.value,10);if(isNaN(b.value)){b.value=undefined}}};
/* module-key = 'com.pyxis.greenhopper.jira:gh-help-analytics', location = 'includes/js/rapid/ui/help/HelpAnalytics.js' */
AJS.$(function(){var a=function(c){if(GH&&GH.AnalyticsTracker){return new GH.AnalyticsTracker(c).setAsync(false)}else{return{trigger:function(){}}}};AJS.$("#gh_view_help").click(function(c){a("gh.gethelp").trigger("usermenu","docs");return b(AJS.$(this))});AJS.$("#greenhopper-my-jira-home-enablement").click(function(c){a("gh.myjirahome").trigger("usermenu","enabled");return b(AJS.$(this))});AJS.$("#greenhopper-my-jira-home-enablement-ondemand").click(function(c){a("gh.myjirahome").trigger("usermenu","set");return b(AJS.$(this))});AJS.$("#greenhopper-my-jira-home-disablement-ondemand").click(function(c){a("gh.myjirahome").trigger("usermenu","disable");return b(AJS.$(this))});AJS.$("#greenhopper-my-jira-home-set").click(function(c){a("gh.myjirahome").trigger("usermenu","set");return b(AJS.$(this))});AJS.$("#beta_gh\\.configuration\\.rapid\\.removal").click(function(f){var c=AJS.$(this),d=c.attr("checked")?"on":"off";a("gh.labs.feature").trigger("rapid_removal",d);return true});AJS.$(document).delegate("#js-classic-link_lnk","click",function(c){a("gh.agile.menu").trigger("classic");return true});var b=function(c){if(c.attr("target")=="_blank"){return true}else{setTimeout('document.location = "'+c.attr("href")+'"',100);return false}}});
/* module-key = 'com.pyxis.greenhopper.jira:gh-help-analytics', location = 'includes/js/rapid/Analytics.js' */
if(typeof GH==="undefined"){window.GH={}}(function(c,g,e,d){d.AnalyticsEnabled=true;var b="gh.analytics.async";function f(){g(document).on(b,function(i,h){a(h)})}function a(i){var j={};var h=i.category;if(!e.isUndefined(i.action)){h=h+"."+i.action}if(!e.isUndefined(i.label)){j.label=i.label}if(!e.isUndefined(i.value)){j.value=i.value}c.trigger("analytics",{name:h,data:j})}f()})(AJS,AJS.$,_,GH);
/* module-key = 'com.pyxis.greenhopper.jira:gh-globalissueoperations', location = 'includes/js/gh-globalissueoperations.js' */
(function(){var c=new GH.AnalyticsTracker("gh.issueaction.gotorapidboard").setAsync(false);var b=JIRA.FormDialog.extend({_performRedirect:function(e){c.trigger("direct");window.location.href=e}});var d=new b({id:"gh-rapidboard-dialog",trigger:"a.issueaction-greenhopper-rapidboard-operation",ajaxOptions:function(){return JIRA.Dialogs.getDefaultAjaxOptions.apply(this,arguments)}});var a=function(f,g){var h="";var e=AJS.$(f);if(e.hasClass("js-rapidboard-operation-sprint")){h="sprint."}else{if(e.hasClass("js-rapidboard-operation-issue")){h="issue."}}h+=g;return h};AJS.$(function(){AJS.$(document).on("simpleClick",".issueaction-greenhopper-rapidboard-operation",function(f){f.preventDefault();var e=a(f.currentTarget,"open");c.trigger(e);d.show()});AJS.$(document).on("simpleClick",".js-select-rapidboard",function(f){var e=a(f.currentTarget,"chosen");c.trigger(e)})})})();
/* module-key = 'com.pyxis.greenhopper.jira:gh-custom-field-pickers', location = 'includes/js/gh-namespace.js' */
if(typeof GH!=="object"){window.GH={}}GH.namespace=function(d,c,e){var f=d.split(".");c=c||window;for(var b=0,g=f.length-1;b<g;b++){var a=c[f[b]];c=(a!=null)?a:c[f[b]]={}}c[f[b]]=e||c[f[b]]||{};return c[f[b]]};
/* module-key = 'com.pyxis.greenhopper.jira:gh-custom-field-pickers', location = 'includes/js/field/initFieldPickers.js' */
(function(c){function b(d){c(".js-epic-picker",d).each(function(){var f=c(this);var e=new JIRA.EpicPicker({element:f});c(document).trigger(JIRA.EpicPicker.READY_EVENT,e)})}function a(d){c(".js-sprint-picker",d).each(function(){var f=c(this);var e=new JIRA.SprintPicker({element:f});c(document).trigger(JIRA.SprintPicker.READY_EVENT,e)})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(g,d,f){if(f!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){b(d);a(d)}})})(AJS.$);
/* module-key = 'com.pyxis.greenhopper.jira:gh-custom-field-pickers', location = 'includes/js/field/EpicPicker.js' */
JIRA.EpicPicker=AJS.SingleSelect.extend({init:function(n){var f=n.element;var c;var m=this;AJS.$.extend(n,{submitInputVal:true,showDropdownButton:true,removeDuplicates:true,ajaxOptions:{url:contextPath+"/rest/greenhopper/1.0/epics",query:true,data:b,formatResponse:d,error:i}});g();function b(o){return{searchQuery:o,projectKey:"",maxResults:10}}function k(u,p,r){u=AJS.escapeHTML(String(u));p=AJS.escapeHTML(String(p));r=AJS.escapeHTML(String(r));var v=r.toUpperCase();var q=u.toUpperCase();var w=p.toUpperCase();var v=(v+"").replace(/([\\\.\+\*\?\[\^\]\$\(\)\{\}\=\!\<\>\|\:])/g,"\\$1");var o=new RegExp("("+v+")","gi");var s=q.search(o);var t;if(s>-1){t=u.slice(s,s+r.length);u=u.replace(t,"<em>"+t+"</em>")}s=w.search(o);if(s>-1){t=p.slice(s,s+r.length);p=p.replace(t,"<em>"+t+"</em>")}return u+" - ("+p+")"}function d(p){if(!p.epicNames){return[]}var r=[];var q=p.epicNames;var v;var u=m.getQueryVal();var t=a(u.length,q.length,p.total);for(var s=0,o=q.length;s<o;s++){v=q[s];t.addItem(j(v,u))}r.push(t);return r}function j(r,q){var p=r.key;var s=r.name;var o=k(s,p,q);return new AJS.ItemDescriptor({value:"key:"+p,fieldText:s,label:o,html:o,allowDuplicate:false,highlighted:true})}function a(o,q,p){return new AJS.GroupDescriptor({weight:1,id:"epic-names",label:o===0?"Suggestions":AJS.format("Showing {0} of {1} matching epics",q,p),replace:true})}function i(q,r,p){var o=AJS.$(f);o.siblings(".ghx-error").remove();o.before(GH.tpl.rapid.notification.renderAuiMessage({message:("Error"+": "+p),type:"error",className:"ghx-error aui-ss"}))}function h(q){var o="";var p=false;if(q&&q.length>0){o=AJS.format("Epic with key \'\'{0}\'\' does not exist.",q);p=true}return{isError:p,message:o}}function l(p){var o,q;c.apply(m,[p]);p=p||AJS.$.trim(m.$field.val());q=m.model.getDescriptor(p);if(!q&&m.$container.hasClass("aui-ss-editing")){o=h(p);if(o.isError){m.options.errorMessage=o.message;m.showErrorMessage(p)}else{m.hideErrorMessage()}}}function e(){AJS.$(m.$field[0].form).submit()}function g(){m._super(n);c=m.handleFreeInput;m.handleFreeInput=l}}});JIRA.EpicPicker.READY_EVENT="gh.epic-picker.ready";
/* module-key = 'com.pyxis.greenhopper.jira:gh-custom-field-pickers', location = 'includes/js/field/SprintPicker.js' */
JIRA.SprintPicker=AJS.SingleSelect.extend({init:function(f){var n={ACTIVE:"ACTIVE",FUTURE:"FUTURE",CLOSED:"CLOSED"};var j=10;var b=f.element;var l,o;var u=b.data("saved-state"),t=b.data("saved-id");var h,q=this;var e=AJS.SelectSuggestHandler.extend({formatSuggestions:function(x,y){x=this._super(x,y);if(y.length===0){x[x.length-1].footerText("Start typing for sprints.")}return x}});AJS.$.extend(f,{submitInputVal:false,showDropdownButton:true,removeOnUnSelect:false,maxInlineResultsDisplayed:j,ajaxOptions:{url:contextPath+"/rest/greenhopper/1.0/sprint/picker",query:true,formatResponse:v,error:s}});p();function i(y){var x=l.apply(this,arguments);x.find("a").append(GH.tpl.customfields.sprintpicker.renderSuggestionMeta(y.properties));return x}function w(z){var y=this.getSelectedDescriptor(),x;if(!z&&!y){c(null)}k();this.hideErrorMessage();if(!y){x=d(z)}else{x=r(y)}if(x.message){this.options.errorMessage=x.message;o.apply(this,arguments);this.$errorMessage.addClass("inline-edit-error")}if(x.needsScopeChangeWarning){m()}}function d(z){var y=null,x=false;if(z&&z.length>0){if(u){y=AJS.format("{0} is not a valid sprint name. This issue will be returned to the backlog.",z);if(u===n.ACTIVE){x=true}}else{y=AJS.format("{0} is not a valid sprint name.",z)}}else{if(u===n.ACTIVE){x=true}}return{message:y,needsScopeChangeWarning:x}}function r(y){var x=false;if(u===n.ACTIVE){if(t!=y.properties.value){x=true}}else{if(u===n.FUTURE){if(y.properties.stateKey===n.ACTIVE){x=true}}else{if(!u){if(y.properties.stateKey===n.ACTIVE){x=true}}}}return{message:null,needsScopeChangeWarning:x}}function m(){if(!h){h=AJS.$(GH.tpl.rapid.notification.renderAuiMessage({type:"warning",className:"ghx-sprint-picker-scope-warning",icon:true,title:"Sprint scope will be affected by this action."}));var x=q.$container.closest(".inline-edit-fields");if(x.size()>0){x.closest(".editable-field").append(h)}else{q.$container.closest(".field-group").append(h)}}h.show()}function k(){if(h){h.remove();h=null}}function v(x){if(!x.suggestions&&!x.allMatches){return[]}var z=new AJS.GroupDescriptor({weight:0,label:"Suggestions"});var y=new AJS.GroupDescriptor({weight:1,label:"All sprints"});_.each(a(x.suggestions),function(A){z.addItem(g(A,true))});_.each(a(x.allMatches),function(A){y.addItem(g(A,false))});return[z,y]}function g(z,y){var x=AJS.escapeHTML(String(z.name));return new AJS.ItemDescriptor({value:z.id.toString(),label:z.name,html:x,stateKey:z.stateKey,boardName:z.boardName,allowDuplicate:false,isSuggestion:y})}function a(x){return _.sortBy(x,function(y){return y.name.toLowerCase()})}function c(x){if(GH.SprintConfig){AJS.$(GH).trigger("QuickEdit.fieldChange",{fieldId:GH.SprintConfig.getSprintFieldId(),fieldChangeData:{original:t,updated:x?x.properties.value:null}})}}function p(){q._super(f);l=q.listController._renders.suggestion;o=q.showErrorMessage;q.listController._renders.suggestion=i;q.showErrorMessage=w;b.bind("selected",function(z,y,x){x.showErrorMessage(x.getQueryVal());c(y)});q.suggestionsHandler=new e(q.options,q.model)}function s(y,A,z){var x=AJS.$(b);x.siblings(".ghx-error").remove();x.before(GH.tpl.rapid.notification.renderAuiMessage({message:("Error"+": "+z),type:"error",className:"ghx-error aui-ss"}))}}});JIRA.SprintPicker.READY_EVENT="gh.sprint-picker.ready";
/* module-key = 'com.pyxis.greenhopper.jira:gh-custom-field-pickers', location = 'includes/js/field/SprintPicker.soy' */
// This file was automatically generated from SprintPicker.soy.
// Please don't edit this file by hand.

if (typeof GH == 'undefined') { var GH = {}; }
if (typeof GH.tpl == 'undefined') { GH.tpl = {}; }
if (typeof GH.tpl.customfields == 'undefined') { GH.tpl.customfields = {}; }
if (typeof GH.tpl.customfields.sprintpicker == 'undefined') { GH.tpl.customfields.sprintpicker = {}; }


GH.tpl.customfields.sprintpicker.renderSuggestionMeta = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.boardName && ! opt_data.isSuggestion) {
    output.append('<span class=\'ghx-sprint-picker-meta\'> (');
    GH.tpl.customfields.sprintpicker.renderMetaWithBoardName(opt_data, output);
    output.append(')</span>');
  } else {
    output.append('<span class=\'ghx-sprint-picker-meta\'> (');
    GH.tpl.customfields.sprintpicker.renderMetaWithoutBoardName(opt_data, output);
    output.append(')</span>');
  }
  return opt_sb ? '' : output.toString();
};


GH.tpl.customfields.sprintpicker.renderMetaWithoutBoardName = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.stateKey == 'ACTIVE') ? soy.$$escapeHtml("Active sprint") : (opt_data.stateKey == 'FUTURE') ? soy.$$escapeHtml("Future sprint") : '');
  return opt_sb ? '' : output.toString();
};


GH.tpl.customfields.sprintpicker.renderMetaWithBoardName = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.stateKey == 'ACTIVE') ? soy.$$escapeHtml(AJS.format("Active sprint in {0}",opt_data.boardName)) : (opt_data.stateKey == 'FUTURE') ? soy.$$escapeHtml(AJS.format("Future sprint in {0}",opt_data.boardName)) : '');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.pyxis.greenhopper.jira:gh-custom-field-pickers', location = 'includes/js/rapid/ui/notification/Notification.js' */
GH.namespace("GH.Notification");GH.Notification={};GH.Notification.autoHideEnabled=true;GH.Notification.showErrors=function(d,a){var b=GH.Notification.prepareNotificationDiv();var c=GH.tpl.rapid.notification.renderErrorMessages(d);if(typeof a=="undefined"){a=true}AJS.messages.error(b,{title:"Error",body:c,closeable:a});if(GH.Notification._divStyle(b)){b.css(GH.Notification._divStyle(b))}b.show()};GH.Notification.showWarnings=function(f,e){var b={autoHide:true,autoHideDelay:5000,preRendered:false,showTitle:false};e=_.extend({},b,e);var c=GH.Notification.prepareNotificationDiv();var a;if(!e.preRendered){a=GH.tpl.rapid.notification.renderErrorMessages({errors:f})}else{a=f}var d={body:a,closeable:true};if(e.showTitle){d.title="Warning"}AJS.messages.warning(c,d);if(GH.Notification._divStyle(c)){c.css(GH.Notification._divStyle(c))}c.show();if(e.autoHide&&GH.Notification.autoHideEnabled){setTimeout(function(){c.hide()},e.autoHideDelay)}};GH.Notification.showWarning=function(b){var a=GH.Notification.prepareNotificationDiv();AJS.messages.warning(a,{body:b,closeable:true});if(GH.Notification._divStyle(a)){a.css(GH.Notification._divStyle(a))}a.show()};GH.Notification.clear=function(){GH.Notification.prepareNotificationDiv().hide()};GH.Notification.handleDateFormatMismatchError=function(c){var b='<a href="'+GH.Ajax.CONTEXT_PATH+'/secure/admin/AdvancedApplicationProperties.jspa">';b+="Advanced Settings";b+="</a>";var a=AJS.format("It appears your JIRA date format settings are misconfigured. Please check the {0} and ensure that \'\'jira.date.time.picker.java.format\'\' and \'\'jira.date.time.picker.javascript.format\'\' have matching output.",b);GH.Notification.showWarnings(a,{autoHide:false,preRendered:true})};GH.Notification.auiMessage=function(b){var a=_.extend({type:"generic",icon:true,messageHtml:false},b);return GH.tpl.rapid.notification.renderAuiMessage({type:a.type,title:a.title,icon:a.icon,messageHtml:a.messageHtml,message:a.message})};GH.Notification.Handler={_defaultNotificationHandler:function(){var a=AJS.$("<div/>");AJS.$(".global-msg").remove();a.addClass("global-msg").appendTo("body");return a},_defaultDivStyleHandler:function(a){return{marginLeft:-a.outerWidth()/2,top:20}},setCustomDivStyleHandler:function(a){this._customDivStyleHandler=a;this._useDefault=false},_useDefault:true,setCustomNotificationHandler:function(a){this._customNotificationHandler=a;this._useDefault=false},removeCustomHandlers:function(){this._useDefault=true},getNotificationHandler:function(){if(!this._useDefault&&this._customNotificationHandler!=null){return this._customNotificationHandler}else{return this._defaultNotificationHandler}},getDivStyleHandler:function(){if(!this._useDefault&&this._customDivStyleHandler!=null){return this._customDivStyleHandler}else{return this._defaultDivStyleHandler}}};GH.Notification._divStyle=function(b){var a=GH.Notification.Handler.getDivStyleHandler();return a(b)};GH.Notification.prepareNotificationDiv=function(){var a=GH.Notification.Handler.getNotificationHandler();return a()};GH.Notification.showSuccess=function(d,b){clearTimeout(GH.Notification.current);var a={timeout:5000,closeable:true,shadowed:true};b=_.extend(a,b,{body:d});var c=GH.Notification.prepareNotificationDiv();AJS.messages.success(c,b);if(GH.Notification._divStyle(c)){c.css(GH.Notification._divStyle(c))}c.show();if(GH.Notification.autoHideEnabled){GH.Notification.current=setTimeout(function(){AJS.$(".global-msg").hide()},b.timeout)}};GH.Notification.showIssueMessage=function(d){var c=JIRA.SessionStorage;var b=null;var a=null;if(!d){d=c.getItem("selectedIssueId")}if(d){a=c.getItem("selectedIssueKey");b=c.getItem("selectedIssueMsg");GH.Notification.showIssueMessageImpl(d,b,a)}c.removeItem("selectedIssueId");c.removeItem("selectedIssueKey");c.removeItem("selectedIssueMsg")};GH.Notification.showIssueMessageImpl=function(d,c,a){if(!c){c="thanks_issue_updated"}var b=AJS.params[c];if(b&&a){b=AJS.format(b,a);GH.Notification.showSuccess(b)}};GH.Notification.addPageLoadMessage=function(c,a){var b=GH.storage.get("gh.pageloadmessages",true)||[];b.push({message:c,type:a||"success"});GH.storage.put("gh.pageloadmessages",b,true)};GH.Notification._displayPageLoadMessages=function(){var c=GH.storage.get("gh.pageloadmessages",true);if(c){var a=c[0].type;var b="";_.each(c,function(d){if(b.length>0){b+="<br>"}b+=d.message});switch(a){case"warning":GH.Notification.showWarning(b);break;case"success":default:GH.Notification.showSuccess(b);break}GH.storage.put("gh.pageloadmessages",null,true)}};GH.Notification.showBoardUpdatedMessage=function(){GH.Notification.clearBoardUpdatedMessage();var b=AJS.$.Deferred();var a=AJS.$(GH.tpl.rapid.notification.renderGHtvMessage()).appendTo("#gh");a.data("deferred",b);a.find(".js-refresh-now").click(function(c){c.preventDefault();a.removeData("deferred");GH.Notification.clearBoardUpdatedMessage();b.resolve()});a.find(".js-ignore-refresh").click(function(c){c.preventDefault();GH.Notification.clearBoardUpdatedMessage()});return b.promise()};GH.Notification.clearBoardUpdatedMessage=function(){var a=AJS.$("#ghx-update-message");if(a.length){var b=a.data("deferred");if(b&&b.reject){b.reject()}a.remove()}};GH.Notification.isBoardUpdatedMessageVisible=function(){var a=AJS.$("#ghx-update-message");return a.length>0};AJS.$(document).ready(function(){GH.Notification.showIssueMessage();if(GH.storage){GH.Notification._displayPageLoadMessages()}});
/* module-key = 'com.pyxis.greenhopper.jira:gh-custom-field-pickers', location = 'includes/js/rapid/ui/notification/Notification.soy' */
// This file was automatically generated from Notification.soy.
// Please don't edit this file by hand.

if (typeof GH == 'undefined') { var GH = {}; }
if (typeof GH.tpl == 'undefined') { GH.tpl = {}; }
if (typeof GH.tpl.rapid == 'undefined') { GH.tpl.rapid = {}; }
if (typeof GH.tpl.rapid.notification == 'undefined') { GH.tpl.rapid.notification = {}; }


GH.tpl.rapid.notification.renderErrorMessages = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.errors.length > 1) {
    output.append('<ul>');
    var errorList6 = opt_data.errors;
    var errorListLen6 = errorList6.length;
    for (var errorIndex6 = 0; errorIndex6 < errorListLen6; errorIndex6++) {
      var errorData6 = errorList6[errorIndex6];
      output.append('<li>', (errorData6.noAutoescape) ? errorData6.message : soy.$$escapeHtml(errorData6.message), '</li>');
    }
    output.append('</ul>');
  } else {
    var errorList18 = opt_data.errors;
    var errorListLen18 = errorList18.length;
    for (var errorIndex18 = 0; errorIndex18 < errorListLen18; errorIndex18++) {
      var errorData18 = errorList18[errorIndex18];
      output.append('<p>', (errorData18.noAutoescape) ? errorData18.message : soy.$$escapeHtml(errorData18.message), '</p>');
    }
  }
  return opt_sb ? '' : output.toString();
};


GH.tpl.rapid.notification.renderContextualErrors = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var errorList29 = opt_data.errors;
  var errorListLen29 = errorList29.length;
  for (var errorIndex29 = 0; errorIndex29 < errorListLen29; errorIndex29++) {
    var errorData29 = errorList29[errorIndex29];
    output.append('<div class="ghx-error">', soy.$$escapeHtml(errorData29.message), '</div>');
  }
  return opt_sb ? '' : output.toString();
};


GH.tpl.rapid.notification.renderMessageHolder = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="ghx-body-warning">', soy.$$escapeHtml(AJS.format("This version of {0} is not a supported browser.",opt_data.browser)), ' <a href="', soy.$$escapeHtml(opt_data.docsUrl), '">', soy.$$escapeHtml("See our documentation for the list of supported browsers."), '</a></div>');
  return opt_sb ? '' : output.toString();
};


GH.tpl.rapid.notification.renderAuiMessage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-message ', soy.$$escapeHtml(opt_data.type), (opt_data.className) ? ' ' + soy.$$escapeHtml(opt_data.className) : '', '">', (opt_data.title) ? '<p class="title">' + ((opt_data.icon) ? '<span class="aui-icon icon-' + soy.$$escapeHtml(opt_data.type) + '"></span>' : '') + '<strong>' + soy.$$escapeHtml(opt_data.title) + '</strong></p>' : '', (opt_data.message) ? '<p>' + ((! opt_data.title && opt_data.icon) ? '<span class="aui-icon icon-' + soy.$$escapeHtml(opt_data.type) + '"></span>' : '') + ((opt_data.messageHtml) ? opt_data.message : soy.$$escapeHtml(opt_data.message)) + '</p>' : '', '</div>');
  return opt_sb ? '' : output.toString();
};


GH.tpl.rapid.notification.renderGHtvMessage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div id="ghx-update-message" class="ghx-tv-message"><p>', soy.$$escapeHtml("This board has been updated"), ': <a href="" class="js-refresh-now">', soy.$$escapeHtml("Refresh"), '</a><span class="ghx-divider">&bull;</span><a href="" class="js-ignore-refresh">', soy.$$escapeHtml("Ignore"), '</a></p></div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.pyxis.greenhopper.jira:gh-custom-field-pickers', location = 'includes/js/field/SprintMultiselect.js' */
JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(f,d){function c(e){var h=new AJS.GroupDescriptor({weight:0,label:"Suggestions",items:_.map(e.suggestions,b)});var g=new AJS.GroupDescriptor({weight:1,label:"All sprints",items:_.map(e.allMatches,b)});return[h,g]}function b(g){g.date=moment(g.date,"YYYY-MM-DDTHH:mm:ssZ").format("LL");var e=GH.tpl.customfields.sprintmultiselect.renderSuggestionMeta(g);return new AJS.ItemDescriptor({value:g.id,label:g.name,html:e,title:GH.tpl.customfields.sprintmultiselect.renderTooltip(g),date:g.date,boardName:g.boardName,stateKey:g.stateKey,highlighted:true,allowDuplicate:false})}function a(e){return _.sortBy(e,"id")}AJS.$(".js-sprint-checkboxmultiselect",d).each(function(){var e=new AJS.CheckboxMultiSelect({element:this,maxInlineResultsDisplayed:5,content:"ajax",removeOnUnSelect:true,ajaxOptions:{url:AJS.contextPath()+"/rest/greenhopper/1.0/sprint/picker",error:function(){e._setSuggestions([])},data:{excludeCompleted:false},query:true,formatResponse:c},suggestionsHandler:GH.SprintSuggestHandler})})});
/* module-key = 'com.pyxis.greenhopper.jira:gh-custom-field-pickers', location = 'includes/js/field/SprintMultiselect.soy' */
// This file was automatically generated from SprintMultiselect.soy.
// Please don't edit this file by hand.

if (typeof GH == 'undefined') { var GH = {}; }
if (typeof GH.tpl == 'undefined') { GH.tpl = {}; }
if (typeof GH.tpl.customfields == 'undefined') { GH.tpl.customfields = {}; }
if (typeof GH.tpl.customfields.sprintmultiselect == 'undefined') { GH.tpl.customfields.sprintmultiselect = {}; }


GH.tpl.customfields.sprintmultiselect.renderSuggestionMeta = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div>', soy.$$escapeHtml(opt_data.name), '</div><div><span class=\'ghx-sprint-multiselect-meta\'> ');
  if (opt_data.boardName) {
    GH.tpl.customfields.sprintmultiselect.renderMetaWithBoardName(opt_data, output);
  } else {
    GH.tpl.customfields.sprintmultiselect.renderMetaWithoutBoardName(opt_data, output);
  }
  output.append('</span></div>');
  return opt_sb ? '' : output.toString();
};


GH.tpl.customfields.sprintmultiselect.renderMetaWithoutBoardName = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.stateKey == 'ACTIVE') ? soy.$$escapeHtml("Active") : (opt_data.stateKey == 'FUTURE') ? soy.$$escapeHtml("Future") : (opt_data.stateKey == 'CLOSED') ? soy.$$escapeHtml("Closed") : '');
  return opt_sb ? '' : output.toString();
};


GH.tpl.customfields.sprintmultiselect.renderMetaWithBoardName = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.stateKey == 'ACTIVE') ? soy.$$escapeHtml(AJS.format("Active \xb7 {0}",opt_data.boardName)) : (opt_data.stateKey == 'FUTURE') ? soy.$$escapeHtml(AJS.format("Future \xb7 {0}",opt_data.boardName)) : (opt_data.stateKey == 'CLOSED') ? soy.$$escapeHtml(AJS.format("Closed \xb7 {0}",opt_data.boardName)) : '');
  return opt_sb ? '' : output.toString();
};


GH.tpl.customfields.sprintmultiselect.renderTooltip = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.stateKey == 'ACTIVE') ? soy.$$escapeHtml(AJS.format("Started on {0}",opt_data.date)) : (opt_data.stateKey == 'FUTURE') ? soy.$$escapeHtml("Future") : (opt_data.stateKey == 'CLOSED') ? soy.$$escapeHtml(AJS.format("Closed on {0}",opt_data.date)) : '');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.pyxis.greenhopper.jira:gh-custom-field-pickers', location = 'includes/js/field/SprintSuggestHandler.js' */
define("includes/js/field/sprint-suggest-handler",["jira/ajs/select/suggestions/checkbox-multi-select-suggest-handler"],function(a){return a.extend({formatSuggestions:function(c,d){var b=this.model.getDisplayableSelectedDescriptors();prepareSelectedDescriptors(b);var e=function(f){var g;for(g in b){if(b[g].properties.value===f.properties.value.toString()){return false}}return true};c=_.map(c,function(g){var f=_.filter(g.properties.items,e);g.properties.items=f;return g});return this._super(c,d)}})});function prepareSelectedDescriptors(a){_.each(a,function(c){var b=JSON.parse(c.properties.meta);b.date=moment(b.date).format("LL");c.properties.title=GH.tpl.customfields.sprintmultiselect.renderTooltip(b);c.properties.html=GH.tpl.customfields.sprintmultiselect.renderSuggestionMeta(b)})}AJS.namespace("GH.SprintSuggestHandler",null,require("includes/js/field/sprint-suggest-handler"));
/* module-key = 'com.pyxis.greenhopper.jira:gh-custom-field-pickers', location = 'includes/js/field/EpicLinkMultiselect.js' */
require(["require"],function(c){var d=c("jquery");var b=c("underscore");function e(f){if(f.indexOf("project")!==0){return""}return a(f).trim()}function a(f){function g(i){var j=i.match(/\bproject\s*=\s*(\S+)/i);return j?j[1]:null}function h(i){var j=i.match(/\bproject\s+in\s+\((.*?)\)/i);return j?j[1]:null}return g(f)||h(f)}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(h,f){var g=d("#jql",this).val();f.find(".js-epiclink-checkboxmultiselect").each(function(){var i=new AJS.CheckboxMultiSelect({element:this,matchingStrategy:"(^|.*?(.*))({0})(.*)",maxInlineResultsDisplayed:5,content:"ajax",removeOnUnSelect:true,ajaxOptions:{url:AJS.contextPath()+"/rest/greenhopper/1.0/epics",error:function(){i._setSuggestions([])},data:{searchQuery:"",projectKey:e(g),maxResults:100},query:true,minQueryLength:0,formatResponse:function(j){return[new AJS.GroupDescriptor({weight:1,items:[new AJS.ItemDescriptor({highlighted:true,label:"No Epic Link",value:"EMPTY",title:"EMPTY"})]}),new AJS.GroupDescriptor({items:b.map(j.epicNames,function(k){return new AJS.ItemDescriptor({highlighted:true,label:k.name+" - ("+k.key+")",value:k.key,title:k.key})}),label:"Suggestions",weight:0})]}},suggestionsHandler:GH.EpicLinkSuggestHandler})})})});
/* module-key = 'com.pyxis.greenhopper.jira:gh-custom-field-pickers', location = 'includes/js/field/EpicLinkSuggestHandler.js' */
define("includes/js/field/epic-link-suggest-handler",["jira/ajs/select/suggestions/checkbox-multi-select-suggest-handler"],function(a){return a.extend({formatSuggestions:function(c,e){var b=this.model.getDisplayableSelectedDescriptors();var d=function(f){var g;for(g in b){if(b[g].properties.value===f.properties.value.toString()){return false}}return true};c=_.map(c,function(g){var f=_.filter(g.properties.items,d);g.properties.items=f;return g});return this._super(c,e)}})});AJS.namespace("GH.EpicLinkSuggestHandler",null,require("includes/js/field/epic-link-suggest-handler"));
/* module-key = 'com.pyxis.greenhopper.jira:sprintmigration-banner', location = 'includes/js/sprintmigration/SprintMigrationBanner.js' */

/* module-key = 'com.pyxis.greenhopper.jira:sprintmigration-banner', location = 'includes/js/sprintmigration/SprintMigrationBanner.soy' */

/* module-key = 'com.pyxis.greenhopper.jira:project-template-resources', location = '/projecttemplates/soy/ProjectTemplates.soy' */
// This file was automatically generated from ProjectTemplates.soy.
// Please don't edit this file by hand.

if (typeof GH == 'undefined') { var GH = {}; }
if (typeof GH.tpl == 'undefined') { GH.tpl = {}; }
if (typeof GH.tpl.projecttemplates == 'undefined') { GH.tpl.projecttemplates = {}; }


GH.tpl.projecttemplates.kanbanInfoPageLegacy = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  GH.tpl.projecttemplates.kanbanInfoPage({issueTypeListClass: 'gh-legacy'}, output);
  return opt_sb ? '' : output.toString();
};


GH.tpl.projecttemplates.kanbanInfoPage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  GH.tpl.projecttemplates.infoPage({description: "Use this project to optimize the flow of work in your development project. Add constraints to work-in-progress, analyze how long it takes to complete issues, find bottlenecks in your process, and more. This project includes a Kanban board, a basic Agile workflow and issue type configuration, which you can change later on.", extraIssueTypes: '<li><span class="issuetype-list-label"><span class="issuetype-icon story"></span><span class="issuetype-name">' + soy.$$escapeHtml("Story") + '</span></span></li><li><span class="issuetype-list-label"><span class="issuetype-icon epic"></span><span class="issuetype-name">' + soy.$$escapeHtml("Epic") + '</span></span></li>', issueTypeListClass: opt_data.issueTypeListClass, workflowScreenshotClass: 'kanban-workflow-screenshot'}, output);
  return opt_sb ? '' : output.toString();
};


GH.tpl.projecttemplates.scrumInfoPageLegacy = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  GH.tpl.projecttemplates.scrumInfoPage({issueTypeListClass: 'gh-legacy'}, output);
  return opt_sb ? '' : output.toString();
};


GH.tpl.projecttemplates.scrumInfoPage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  GH.tpl.projecttemplates.infoPage({description: "Use this project to manage your Agile development work. Create a backlog, organise work into sprints, check progress using reports, and more. This project includes a Scrum board, a basic Agile workflow and issue type configuration, which you can change later on.", extraIssueTypes: '<li><span class="issuetype-list-label"><span class="issuetype-icon story"></span><span class="issuetype-name">' + soy.$$escapeHtml("Story") + '</span></span></li><li><span class="issuetype-list-label"><span class="issuetype-icon epic"></span><span class="issuetype-name">' + soy.$$escapeHtml("Epic") + '</span></span></li>', issueTypeListClass: opt_data.issueTypeListClass, workflowScreenshotClass: 'scrum-workflow-screenshot'}, output);
  return opt_sb ? '' : output.toString();
};


GH.tpl.projecttemplates.softwareDevelopmentInfoPageLegacy = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  GH.tpl.projecttemplates.softwareDevelopmentInfoPage({issueTypeListClass: 'gh-legacy'}, output);
  return opt_sb ? '' : output.toString();
};


GH.tpl.projecttemplates.softwareDevelopmentInfoPage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  GH.tpl.projecttemplates.infoPage({description: "Use this project to work on new features for your product and also track any bugs. This project provides you with a basic workflow and issue type configuration, which you can change later on.", extraIssueTypes: '<li><span class="issuetype-list-label"><span class="issuetype-icon improvement"></span><span class="issuetype-name">' + soy.$$escapeHtml("Improvement") + '</span></span></li><li><span class="issuetype-list-label"><span class="issuetype-icon newfeature"></span><span class="issuetype-name">' + soy.$$escapeHtml("New Feature") + '</span></span></li><li><span class="issuetype-list-label"><span class="issuetype-icon epic"></span><span class="issuetype-name">' + soy.$$escapeHtml("Epic") + '</span></span></li>', issueTypeListClass: opt_data.issueTypeListClass, workflowScreenshotClass: 'basic-development-workflow-screenshot'}, output);
  return opt_sb ? '' : output.toString();
};


GH.tpl.projecttemplates.infoPage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div><div class="left-info"><p>', soy.$$escapeHtml(opt_data.description), '</p><h3>', soy.$$escapeHtml("Issue Types"), '</h3><ul class="project-template-issuetype-list ', soy.$$escapeHtml(opt_data.issueTypeListClass), '"><li><span class="issuetype-list-label"><span class="issuetype-icon bug"></span><span class="issuetype-name">', soy.$$escapeHtml("Bug"), '</span></span></li><li><span class="issuetype-list-label"><span class="issuetype-icon task"></span><span class="issuetype-name">', soy.$$escapeHtml("Task"), '</span></span></li><li><span class="issuetype-list-label"><span class="issuetype-icon subtask"></span><span class="issuetype-name">', soy.$$escapeHtml("Sub-task"), '</span></span></li>', opt_data.extraIssueTypes, '</ul></div><div class="right-info ', soy.$$escapeHtml(opt_data.workflowScreenshotClass), '"></div></div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.pyxis.greenhopper.jira:project-template-resources', location = '/projecttemplates/soy/ProjectTemplatesJira7.soy' */
// This file was automatically generated from ProjectTemplatesJira7.soy.
// Please don't edit this file by hand.

if (typeof GH == 'undefined') { var GH = {}; }
if (typeof GH.tpl == 'undefined') { GH.tpl = {}; }
if (typeof GH.tpl.projecttemplates == 'undefined') { GH.tpl.projecttemplates = {}; }


GH.tpl.projecttemplates.kanbanInfoPageJira7 = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  GH.tpl.projecttemplates.templateInfoDialog({description: "Use this project to optimize the flow of work in your development project. Add constraints to work-in-progress, analyze how long it takes to complete issues, find bottlenecks in your process, and more. This project includes a Kanban board, a basic Agile workflow and issue type configuration, which you can change later on.", extraIssueTypes: '<li><span class="issuetype-list-label"><span class="issuetype-icon story"></span><span class="issuetype-name">' + soy.$$escapeHtml("Story") + '</span></span></li><li><span class="issuetype-list-label"><span class="issuetype-icon epic"></span><span class="issuetype-name">' + soy.$$escapeHtml("Epic") + '</span></span></li>', workflowScreenshotClass: 'kanban-workflow-screenshot'}, output);
  return opt_sb ? '' : output.toString();
};


GH.tpl.projecttemplates.scrumInfoPageJira7 = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  GH.tpl.projecttemplates.templateInfoDialog({description: "Use this project to manage your Agile development work. Create a backlog, organise work into sprints, check progress using reports, and more. This project includes a Scrum board, a basic Agile workflow and issue type configuration, which you can change later on.", extraIssueTypes: '<li><span class="issuetype-list-label"><span class="issuetype-icon story"></span><span class="issuetype-name">' + soy.$$escapeHtml("Story") + '</span></span></li><li><span class="issuetype-list-label"><span class="issuetype-icon epic"></span><span class="issuetype-name">' + soy.$$escapeHtml("Epic") + '</span></span></li>', workflowScreenshotClass: 'scrum-workflow-screenshot'}, output);
  return opt_sb ? '' : output.toString();
};


GH.tpl.projecttemplates.softwareDevelopmentInfoPageJira7 = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  GH.tpl.projecttemplates.templateInfoDialog({description: "Use this project to work on new features for your product and also track any bugs. This project provides you with a basic workflow and issue type configuration, which you can change later on.", extraIssueTypes: '<li><span class="issuetype-list-label"><span class="issuetype-icon improvement"></span><span class="issuetype-name">' + soy.$$escapeHtml("Improvement") + '</span></span></li><li><span class="issuetype-list-label"><span class="issuetype-icon newfeature"></span><span class="issuetype-name">' + soy.$$escapeHtml("New Feature") + '</span></span></li><li><span class="issuetype-list-label"><span class="issuetype-icon epic"></span><span class="issuetype-name">' + soy.$$escapeHtml("Epic") + '</span></span></li>', workflowScreenshotClass: 'basic-development-workflow-screenshot'}, output);
  return opt_sb ? '' : output.toString();
};


GH.tpl.projecttemplates.templateInfoDialog = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div><div class="top-panel"><p>', soy.$$escapeHtml(opt_data.description), '</p></div><div class="left-panel"><h6>', soy.$$escapeHtml("Issue Types"), '</h6><ul class="project-template-issuetype-list" ><li><span class="issuetype-list-label"><span class="issuetype-icon bug"></span><span class="issuetype-name">', soy.$$escapeHtml("Bug"), '</span></span></li><li><span class="issuetype-list-label"><span class="issuetype-icon task"></span><span class="issuetype-name">', soy.$$escapeHtml("Task"), '</span></span></li><li><span class="issuetype-list-label"><span class="issuetype-icon subtask"></span><span class="issuetype-name">', soy.$$escapeHtml("Sub-task"), '</span></span></li>', opt_data.extraIssueTypes, '</ul></div><div class="right-panel"><h6>', soy.$$escapeHtml("workflow"), '</h6><div class="workflow ', soy.$$escapeHtml(opt_data.workflowScreenshotClass), '"></div></div></div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.pyxis.greenhopper.jira:gh-globalkeyboardshortcuts', location = 'includes/js/gh-globalkeyboardshortcuts.js' */
(function(b){b.namespace("gh.app.globalkeyboardshortcuts");var a=gh.app.globalkeyboardshortcuts;a.findSelectedIssueId=function(){var c;if(jira&&jira.app&&jira.app.issuenavigator&&jira.app.issuenavigator.getSelectedIssueId){c=jira.app.issuenavigator.getSelectedIssueId()}if(!c&&jira&&jira.app&&jira.app.issue&&jira.app.issue.getIssueId){c=jira.app.issue.getIssueId()}return c};a.goToAgile=function(){var c=(contextPath?contextPath:"")+"/secure/GreenHopper.jspa";window.location.href=c};a.followLink=function(c){var d=b(c);if(d.length>0&&(d[0].nodeName.toLowerCase()==="a"||d[0].nodeName.toLowerCase()==="link")){d.click();window.location.href=d.attr("href")}};a.sendToTop=function(d,e){if(window.GH&&GH.RapidBoard&&GH.Shortcut&&GH.Shortcut.sendToTop){GH.Shortcut.sendToTop(d);a.closeDialogAndPopMessage();return}if(d!="Action"){return}var c=e||a.findSelectedIssueId();if(!contextPath){contextPath=""}JIRA.SmartAjax.makeRequest({type:"post",contentType:"application/json",url:contextPath+"/rest/greenhopper/1.0/rank/global/first",data:JSON.stringify({issueId:c}),success:a.handleRankSuccess});AJS.$(AJS).trigger("gh.global.rankissues",{action:"rankToTop"+(d?d:""),count:1})};a.sendToBottom=function(d,e){if(window.GH&&GH.RapidBoard&&GH.Shortcut&&GH.Shortcut.sendToBottom){GH.Shortcut.sendToBottom(d);a.closeDialogAndPopMessage();return}if(d!="Action"){return}var c=e||a.findSelectedIssueId();if(!contextPath){contextPath=""}JIRA.SmartAjax.makeRequest({type:"post",contentType:"application/json",url:contextPath+"/rest/greenhopper/1.0/rank/global/last",data:JSON.stringify({issueId:c}),success:a.handleRankSuccess});AJS.$(AJS).trigger("gh.global.rankissues",{action:"rankToBottom"+(d?d:""),count:1})};a.closeDialogAndPopMessage=function(){if(JIRA.IssueNavigator.isNavigator()){AJS.reloadViaWindowLocation()}else{if(JIRA.Dialog&&JIRA.Dialog.current){JIRA.Dialog.current.hide()}if(window.GH){if(GH.Message&&GH.Message.showIssueMessage){GH.Message.showIssueMessage()}else{if(GH.RapidBoard&&GH.Notification&&GH.Notification.showIssueMessage){GH.Notification.showIssueMessage()}}if(window.Boards){Boards.refreshAll()}}else{if(JIRA.IssueNavigator&&JIRA.IssueNavigator.Shortcuts&&JIRA.IssueNavigator.Shortcuts.flashIssueRow){JIRA.IssueNavigator.Shortcuts.flashIssueRow()}}}};a.handleRankSuccess=function(c,e,d){a.storeSuccessMessage(c.issueId,c.issueKey,"thanks_issue_updated");a.closeDialogAndPopMessage()};a.storeSuccessMessage=function(e,c,d){var f=JIRA.SessionStorage;f.setItem("selectedIssueId",e);f.setItem("selectedIssueKey",c);f.setItem("selectedIssueMsg",d)};AJS.$(function(){AJS.$(document).delegate(".issueaction-greenhopper-rank-top-operation","click",function(c){c.preventDefault();var d=AJS.$(this).attr("data-issueid");a.sendToTop("Action",d)});AJS.$(document).delegate(".issueaction-greenhopper-rank-bottom-operation","click",function(c){c.preventDefault();var d=AJS.$(this).attr("data-issueid");a.sendToBottom("Action",d)})})})(AJS.$);
/* module-key = 'com.atlassian.jira.plugin.ext.bamboo:bamboo-soy-resources', location = 'templates/plugins/bamboo/components.soy' */
// This file was automatically generated from components.soy.
// Please don't edit this file by hand.

if (typeof bamboo == 'undefined') { var bamboo = {}; }
if (typeof bamboo.components == 'undefined') { bamboo.components = {}; }


bamboo.components.pageHeader = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var param3 = new soy.StringBuilder();
  if (opt_data.headerImageContent) {
    aui.page.pageHeaderImage({content: opt_data.headerImageContent}, param3);
  }
  aui.page.pageHeaderMain({content: opt_data.headerMainContent}, param3);
  if (opt_data.headerActionsContent) {
    aui.page.pageHeaderActions({content: opt_data.headerActionsContent}, param3);
  }
  aui.page.pageHeader({content: param3.toString()}, output);
  return opt_sb ? '' : output.toString();
};


bamboo.components.icon = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<span class="bamboo-icon bamboo-icon-', soy.$$escapeHtml(opt_data.type), '"', (opt_data.text && opt_data.showTitle) ? ' title="' + soy.$$escapeHtml(opt_data.text) + '"' : '', '>', (opt_data.text) ? '<span>' + soy.$$escapeHtml(opt_data.text) + '</span>' : '', '</span>');
  return opt_sb ? '' : output.toString();
};


bamboo.components.buildDetail = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<dl><dt class="', soy.$$escapeHtml(opt_data.keyClass), '">', soy.$$escapeHtml(opt_data.key), '</dt><dd>', opt_data.value, '</dd></dl>');
  return opt_sb ? '' : output.toString();
};


bamboo.components.artifacts = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<ul id="shared-artifacts">');
  var artifactList42 = opt_data.artifacts;
  var artifactListLen42 = artifactList42.length;
  for (var artifactIndex42 = 0; artifactIndex42 < artifactListLen42; artifactIndex42++) {
    var artifactData42 = artifactList42[artifactIndex42];
    bamboo.components.artifactItem(soy.$$augmentData(artifactData42, {id: artifactData42.name, url: artifactData42.link.href}), output);
  }
  output.append('</ul>');
  return opt_sb ? '' : output.toString();
};


bamboo.components.artifactItem = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li>');
  bamboo.components.icon({type: 'artifact-shared'}, output);
  output.append(' <a id="artifact-', soy.$$escapeHtml(opt_data.id), '" href="', soy.$$escapeHtml(opt_data.url), '">', soy.$$escapeHtml(opt_data.name), '</a><span class="filesize">(', soy.$$escapeHtml(opt_data.prettySizeDescription), ')</span></li>');
  return opt_sb ? '' : output.toString();
};


bamboo.components.labels = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<ul class="labels">');
  var labelList63 = opt_data.labels;
  var labelListLen63 = labelList63.length;
  for (var labelIndex63 = 0; labelIndex63 < labelListLen63; labelIndex63++) {
    var labelData63 = labelList63[labelIndex63];
    bamboo.components.labelItem(soy.$$augmentData(labelData63, {url: opt_data.baseBambooUrl + '/browse/label/' + labelData63.name}), output);
  }
  output.append('</ul>');
  return opt_sb ? '' : output.toString();
};


bamboo.components.labelItem = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li><a class="lozenge" href="', soy.$$escapeHtml(opt_data.url), '" title="', soy.$$escapeHtml(opt_data.name), '"><span>', soy.$$escapeHtml(opt_data.name), '</span></a></li>');
  return opt_sb ? '' : output.toString();
};


bamboo.components.errorResponseMessage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  bamboo.components.auiWarning({body: (opt_data.errorMessage.messageBody) ? '<p>' + soy.$$escapeHtml(opt_data.errorMessage.messageBody) + '</p>' : (opt_data.errorMessage.oauthCallback) ? '<p><a href="' + opt_data.errorMessage.oauthCallback + '&amp;redirectUrl=' + opt_data.oAuthDanceReturnUrl + '">' + soy.$$escapeHtml("Log in \x26 approve") + '</a></p>' : '<p>' + soy.$$escapeHtml(opt_data.errorMessage.message) + '</p>'}, output);
  return opt_sb ? '' : output.toString();
};


bamboo.components.auiWarning = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-message warning"><span class="aui-icon icon-warning"></span>', opt_data.body, '</div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.ext.calendar:browse-project-tip', location = 'com/atlassian/jira/ext/calendar/resources/js/BrowseProjectTip.js' */
AJS.toInit(function(d){var c=WRM.data.claim("com.atlassian.jira.ext.calendar:tipDataProvider.tip").suppressTip;if(!c){var a="browse-project-calendar-info";var b=function(e){if(e.length){var f=d("<div/>");AJS.messages.info(f,{body:AJS.format("This calendar shows when issues are due to be completed. This is set by the {0} field for an issue.","Due Date"),closeable:true});f.find(".aui-message").attr("id",a);e.prepend(f)}};JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(i,g,h){var f;if(g.attr("id")=="project-tab"){f=d(".issues-calendar-container",g)}else{f=d("#project-tab .issues-calendar-container",g)}b(f)});b(d("#project-tab .issues-calendar-container"));AJS.bind("messageClose",function(g,f){if(f.attr("id")==a){AJS.EventQueue&&AJS.EventQueue.push({name:"browseprojectcalendarinfo.closebutton"});d.ajax({data:{tipKey:"browseProjectCalendarTab"},type:"POST",url:contextPath+"/rest/calendar-plugin/1.0/suppressedTips"})}})}});
